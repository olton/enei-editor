/*!
 * ENEI Editor for ENEI CMS
 * Copyright 2023 Serhii Pimenov
 * Licensed under MIT
 !*/
var EneiEditor=function(e){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function i(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function a(e,t){return function(n,r){t(n,r,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(6===l[0]&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}var c=Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function d(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||c(t,e,n)}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)r[o]=i[a];return r}function g(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function A(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||l(e,t)}))})}function l(e,t){try{(n=o[e](t)).value instanceof m?Promise.resolve(n.value.v).then(s,u):c(i[0][2],n)}catch(e){c(i[0][3],e)}var n}function s(e){l("next",e)}function u(e){l("throw",e)}function c(e,t){e(t),i.shift(),i.length&&l(i[0][0],i[0][1])}}function y(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:m(e[r](t)),done:!1}:o?o(t):t}:o}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&c(t,e,n);return C(t,e),t}function S(e){return e&&e.__esModule?e:{default:e}}function T(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function D(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}function k(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function x(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if("function"!=typeof r)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var I="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function L(e){function t(t){e.error=e.hasError?new I(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var o=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(o).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}var N={__extends:n,__assign:r,__rest:o,__decorate:i,__param:a,__metadata:l,__awaiter:s,__generator:u,__createBinding:c,__exportStar:d,__values:f,__read:p,__spread:h,__spreadArrays:v,__spreadArray:g,__await:m,__asyncGenerator:A,__asyncDelegator:y,__asyncValues:b,__makeTemplateObject:E,__importStar:w,__importDefault:S,__classPrivateFieldGet:T,__classPrivateFieldSet:D,__classPrivateFieldIn:k,__addDisposableResource:x,__disposeResources:L},R=Object.freeze({__proto__:null,__addDisposableResource:x,get __assign(){return r},__asyncDelegator:y,__asyncGenerator:A,__asyncValues:b,__await:m,__awaiter:s,__classPrivateFieldGet:T,__classPrivateFieldIn:k,__classPrivateFieldSet:D,__createBinding:c,__decorate:i,__disposeResources:L,__esDecorate:function(e,t,n,r,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,s=r.kind,u="getter"===s?"get":"setter"===s?"set":"value",c=!t&&e?r.static?e:e.prototype:null,d=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),f=!1,p=n.length-1;p>=0;p--){var h={};for(var v in r)h[v]="access"===v?{}:r[v];for(var v in r.access)h.access[v]=r.access[v];h.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var g=(0,n[p])("accessor"===s?{get:d.get,set:d.set}:d[u],h);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(l=a(g.get))&&(d.get=l),(l=a(g.set))&&(d.set=l),(l=a(g.init))&&o.unshift(l)}else(l=a(g))&&("field"===s?o.unshift(l):d[u]=l)}c&&Object.defineProperty(c,r.name,d),f=!0},__exportStar:d,__extends:n,__generator:u,__importDefault:S,__importStar:w,__makeTemplateObject:E,__metadata:l,__param:a,__propKey:function(e){return"symbol"==typeof e?e:"".concat(e)},__read:p,__rest:o,__runInitializers:function(e,t,n){for(var r=arguments.length>2,o=0;o<t.length;o++)n=r?t[o].call(e,n):t[o].call(e);return r?n:void 0},__setFunctionName:function(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},__spread:h,__spreadArray:g,__spreadArrays:v,__values:f,default:N});function B(e,t,n){e.addUndoSnapshot(t,"Format",void 0,n&&""!=n?{formatApiName:n}:void 0)}function M(e,t){var n;if("Range"==t)return"[object Range]"==Object.prototype.toString.apply(e)&&!!(null===(n=e)||void 0===n?void 0:n.commonAncestorContainer);var r=function(e){var t=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return t&&(t.defaultView||window)}(e),o=r&&r[t],i=window,a=i&&i[t];return a&&e instanceof a||o&&e instanceof o}function P(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(M(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}function O(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}function _(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,o=r.cloneNode(!1);if(o.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)o.appendChild(r.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?null===(n=r.parentNode)||void 0===n||n.insertBefore(o,t?r:r.nextSibling):o=null,o}function F(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,r=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(r){if(O(t,n)){var o=n;n=t,t=o}_(t,!0),_(n,!1)}return r}function H(e){return[].slice.call(e)}function U(e,t,n,r){var o;if(!P(e,t)||!P(e,n))return[];if(P(t=z(e,t,n,!0,r),n=z(e,n,t,!1,r),!0))return[t];if(P(n,t))return[n];if(t.parentNode==n.parentNode){var i=t.parentNode?H(null===(o=t.parentNode)||void 0===o?void 0:o.childNodes):[],a=i.indexOf(t),l=i.indexOf(n);return i.slice(a,l+1)}return[t,n]}function z(e,t,n,r,o){for(;t.parentNode!=e&&!P(t.parentNode,n);){if(r&&t.previousSibling||!r&&t.nextSibling){if(!o)break;_(t,r)}if(!t.parentNode)break;t=t.parentNode}return t}function j(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}var Q="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),K=["block","list-item","table-cell"];function V(e){var t=j(e);return!(!t||!(K.indexOf(e.style.display)>=0||Q.indexOf(t)>=0))}var W=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return O(this.element,e.getEndNode())},e.prototype.contains=function(e){return P(this.element,e,!0)},e.prototype.getTextContent=function(){var e;return(null===(e=this.element)||void 0===e?void 0:e.textContent)||""},e}(),q="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");function G(e){return!!e&&q.indexOf(j(e))>=0}function Y(e,t){return M(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)}function J(e,t,n){var r=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(r&&n)if(r.closest)r=r.closest(n);else for(;r&&r!=t&&!Y(r,n);)r=r.parentElement;return!t||P(t,r)?r:null}var X=function(){function e(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=Z(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=Z(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=$(this.node),this.isAtEnd=!0;break;default:var r=$(this.node);this.offset=Math.max(0,Math.min(t,r)),this.isAtEnd=t>0&&t>=r}this.element=J(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType||11==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:O(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function Z(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function $(e){var t;return 3==e.nodeType?(null===(t=e.nodeValue)||void 0===t?void 0:t.length)||0:1==e.nodeType||11==e.nodeType?e.childNodes.length:1}function ee(e,t,n,r){var o,i=null,a=null;if(ne(e)?(i=e,a=ne(t)?t:null):M(e,"Node")&&(Array.isArray(t)?(i=re(e,t),a=Array.isArray(n)?re(e,n):null):"number"==typeof t?(i=new X(e,t),a=M(n,"Node")?new X(n,r):null):!M(t,"Node")&&t||(i=new X(e,-2),a=new X(t||e,-3))),null===(o=null==i?void 0:i.node)||void 0===o?void 0:o.ownerDocument){var l=i.node.ownerDocument.createRange();return i=te(i),a=te(a||i),l.setStart(i.node,i.offset),l.setEnd(a.node,a.offset),l}return null}function te(e){return 1==e.node.nodeType&&G(e.node)?new X(e.node,e.isAtEnd?-3:-2):e}function ne(e){return e&&e.node}function re(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new X(e,n)}function oe(e){return Object.keys(e)}var ie=/android/i;var ae,le,se,ue,ce,de,fe,pe,he,ve,ge,me,Ae,ye="undefined"!=typeof window&&window?(ae=window.navigator.userAgent,le=window.navigator.appVersion,se=window.navigator.vendor,ce=-1!=ae.indexOf("rv:")&&-1!=ae.indexOf("Trident"),de=-1!=ae.indexOf("MSIE")||ce,fe=!1,pe=!1,he=!1,ve=!1,ge=-1!=ae.indexOf("WebKit"),me=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(ue=ae||se||"")||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ue.substr(0,4)))&&(me=!0),de||(fe=-1!=ae.indexOf("Chrome"),pe=-1!=ae.indexOf("Firefox"),-1!=ae.indexOf("Safari")&&(he=-1==ae.indexOf("Chrome")&&-1==ae.indexOf("Android")),(ve=-1!=ae.indexOf("Edge"))&&(ge=fe=pe=!1)),{isMac:-1!=le.indexOf("Mac"),isWin:-1!=le.indexOf("Win")||-1!=le.indexOf("NT"),isWebKit:ge,isIE:de,isIE11OrGreater:ce,isSafari:he,isChrome:fe,isFirefox:pe,isEdge:ve,isIEOrEdge:de||ve,isAndroid:ie.test(ae),isMobileOrTablet:me}):{},be=((Ae={})[0]={tag:""},Ae[1]=ye.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},Ae[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},Ae[3]={tag:"div",style:"width: 600px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},Ae[4]={tag:"li",style:"display:block"},Ae[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},Ae[6]={tag:"span",style:"max-width:100%;position:relative",children:[{tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"}]},Ae[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},Ae[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},Ae[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},Ae[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},Ae[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},Ae[12]={tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]},Ae);function Ee(e,t){if("number"==typeof e&&(e=be[e]),!e||!e.tag)return null;var n=e.tag,r=e.namespace,o=e.className,i=e.style,a=e.dataset,l=e.attributes,s=e.children,u=r?t.createElementNS(r,n):t.createElement(n);return i&&u.setAttribute("style",i),o&&(u.className=o),a&&M(u,"HTMLElement")&&oe(a).forEach((function(e){u.dataset[e]=a[e]})),l&&oe(l).forEach((function(e){u.setAttribute(e,l[e])})),s&&s.forEach((function(e){if("string"==typeof e)u.appendChild(t.createTextNode(e));else if(e){var n=Ee(e,t);n&&u.appendChild(n)}})),u}function Ce(e,t){var n,r,o,i,a;if(0==(e=e?M(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;if(t||(t="div"),!M(t,"HTMLElement")){var l=e[0].ownerDocument;t="string"==typeof t?/^\w+$/.test(t)?l.createElement(t):(o=t,i=l,a=i.createElement("DIV"),a.innerHTML=o,H(a.childNodes))[0]:Ee(t,l)}var s=e[0].parentNode;s&&s.insertBefore(t,e[0]);try{for(var u=f(e),c=u.next();!c.done;c=u.next()){var d=c.value;t.appendChild(d)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return t}var we=["TD","TH","LI","BLOCKQUOTE"],Se=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(var t=e;t&&!V(t);)t=t.parentNode;return t},e.prototype.collapseToSingleElement=function(){for(var t=e.getBlockContext(this.startNode),n=t?U(t,this.startNode,this.endNode,!0):[],r=e.getBlockContext(this.startNode);n[0]&&n[0]!=r&&n[0].parentNode!=this.rootNode&&we.indexOf(j(n[0].parentNode))<0;){var o=F(n);if(!o)break;n=[o]}return 1==n.length&&V(n[0])?n[0]:Ce(n)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return O(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return P(this.startNode,e,!0)||P(this.endNode,e,!0)||O(e,this.startNode)&&O(this.endNode,e)},e.prototype.getTextContent=function(){var e=ee(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();function Te(e,t){if(!P(e,t))return null;var n=Se.getBlockContext(t);if(!n)return null;if(n==t)return new W(n);var r=De(t,n,!1),o=De(t,n,!0);if(!r||!o)return null;var i=U(e,r,o,!1);if(0===i.length)return null;if(r=i[0],o=i[i.length-1],r.parentNode!=o.parentNode)return new Se(e,r,o);for(;!r.previousSibling&&!o.nextSibling;){var a=r.parentNode;if(a==n){n!=e&&(r=o=a);break}if(!a||a==e)break;r=o=a}return r==o&&V(r)?new W(r):new Se(e,r,o)}function De(e,t,n){var r=e;if("BR"==j(r)&&n)return r;for(;r;){for(var o=e;e.parentNode&&!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if(V(o))return r;if("BR"==j(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}function ke(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&Te(e,n)||null}function xe(e,t,n){var r,o,i,a=(null===(r=e.nodeValue)||void 0===r?void 0:r.substring(0,t))||"",l=(null===(o=e.nodeValue)||void 0===o?void 0:o.substring(t))||"",s=e.ownerDocument.createTextNode(n?a:l);return e.nodeValue=n?l:a,null===(i=e.parentNode)||void 0===i||i.insertBefore(s,n?e:e.nextSibling),s}function Ie(e,t){var n,r;void 0===t&&(t=["font-family","font-size","color","background-color"]);var o=J(e),i=[];if(t=Array.isArray(t)?t:[t],o){var a=(o.ownerDocument.defaultView||window).getComputedStyle(o);if(a)try{for(var l=f(t),s=l.next();!s.done;s=l.next()){var u=s.value,c=a.getPropertyValue(u)||"";c="font-family"!=u?c.toLowerCase():c,c="font-size"==u?Ne(c):c,i.push(c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}return i}function Le(e,t){return Ie(e,t)[0]||""}function Ne(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}var Re=/^[\r\n]+$/g,Be=/[\t\r\n\u0020\u200B]/gm;function Me(e,t){if(3==e.nodeType)return!(e.nodeValue&&""!=e.textContent&&!Re.test(e.nodeValue))||!(!t||""!=e.nodeValue.replace(Be,""));if(1==e.nodeType){if("none"==Le(e,"display"))return!0;var n=j(e);if("DIV"==n||"SPAN"==n){for(var r=e.firstChild;r;r=r.nextSibling)if(!Me(r,t))return!1;return!0}return!1}return!0}function Pe(e,t,n,r,o){var i=null,a=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},l=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(P(e,t))for(var s=t,u=!0;u;){var c=(null==s?void 0:s.parentNode)||null;for(s=a(s);!s&&c!=e;)s=a(c),c=(null==c?void 0:c.parentNode)||null;for(;s&&(!r||r.indexOf(j(s))<0)&&l(s);)s=l(s);if(!(u=!!s&&Me(s,o))){i=s;break}}return i}function Oe(e,t,n){return Pe(e,t,!0,n)}function _e(e,t,n){return Pe(e,t,!1,n)}var Fe="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL,SUP,SUB".split(",");function He(e,t,n,r){void 0===n&&(n=new X(e,0).normalize()),void 0===r&&(r=new X(e,-1).normalize());for(var o=[],i=n,a=r;i&&a&&a.isAfter(i);){var l=i.node,s=j(l.parentNode),u=Oe(e,l);3==l.nodeType&&["TR","TABLE"].indexOf(s)<0&&(l!=a.node||a.isAtEnd||(l=xe(l,a.offset,!0)),i.offset>0&&(l=xe(l,i.offset,!1)),o.push(l)),i=u&&new X(u,0)}if(o.length>0){if(o.every((function(e){return e.parentNode==o[0].parentNode}))){var c=o.shift();o.forEach((function(e){var t,n=(c.nodeValue||"")+(e.nodeValue||"");c.nodeValue=n,null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),o=[c]}o.forEach((function(e){for(var n=e;n&&"SPAN"!=j(n)&&Fe.indexOf(j(n.parentNode))>=0;)Ue(n,t),n=F(n);n&&"SPAN"!=j(n)&&(Ue(n,t),n=Ce(n,"SPAN")),M(n,"HTMLElement")&&t(n)}))}}function Ue(e,t){e&&1==e.nodeType&&t(e,!0)}var ze=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return(3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent)||""},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new X(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new X(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&O(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){He(this.containerNode,e)},e}(),je=function(e){function t(t,n){return e.call(this,t,n)||this}return n(t,e),t}(ze),Qe=function(e){function t(t,n){return e.call(this,t,n)||this}return n(t,e),t}(ze);function Ke(e,t){var n=M(e,"Node")?Te(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],o=e.parentNode;o&&t.contains(o);o=o.parentNode)r.push(o);for(var i=r.length-1;i>=0&&!n;i--){var a=r[i],l=j(a);"A"==l?n=new Qe(a,t):"IMG"==l&&(n=new je(a,t))}return n||new ze(e,t)}(t,n)}function Ve(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},r=n(e);r&&n(r);)r=n(r);return r&&Me(r)&&(r=Pe(e,r,t)),r}function We(e){return Ve(e,!0)}function qe(e){var t=We(e);return t?Ke(e,t):null}function Ge(e){var t=function(e){return Ve(e,!1)}(e);return t?Ke(e,t):null}var Ye=function(){function e(e,t){this.rootNode=e,this.startNode=P(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?Te(this.rootNode,this.startNode):ke(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?Ke(this.rootNode,this.startNode):qe(this.rootNode)},e.prototype.isBlockInScope=function(e){return P(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}(),Je=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}(),Xe=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return ee(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end?new e(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start?new e(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),r=this.getContainerNode();if(t.isAtEnd){var o=Oe(r,t.node);t=o?new X(o,0):null}if(0==n.offset){var i=_e(r,n.node);n=i?new X(i,-1):null}He(r,e,t||void 0,n||void 0)},e}();function Ze(e,t){return $e(e,t,!0)}function $e(e,t,n){if(!e||!t||!t.node)return null;var r=(t=t.normalize()).offset,o=t.isAtEnd,i=t.node,a=!1;!n&&0==r&&!o||n&&o?i=Pe(e,i,n):3==i.nodeType&&(!n&&!o||n&&r>0)&&(a=!0),i&&Me(i)&&(i=Pe(e,i,n));var l=Ke(e,i);return l&&(a||l.contains(t))&&(l=n?new Xe(l,t,void 0):new Xe(l,void 0,t)),l}var et=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,M(t,"Range")&&(t=X.getStart(t)),this.position=t.normalize(),this.block=Te(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof W){var n=e.getStartNode();return t?qe(n):Ge(n)}return Ke(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=Ze(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new Je(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();var tt=function(){function e(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=X.getStart(t).normalize(),this.end=X.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=Te(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(Ze(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=!!n&&n.equals(e);else{var r=Te(this.rootNode,this.end.node);t=!!n&&!!r&&(e.equals(n)||e.equals(r)||e.isAfter(n)&&r.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,o=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,o=!0),t.isAfter(n)||t.equalTo(n)?null:r||o?new Xe(e,r?t:void 0,o?n:void 0):e},e}(),nt=function(){function e(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}return e.createBodyTraverser=function(t,n,r){return new e(new Ye(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new tt(t,n),r)},e.createBlockTraverser=function(t,n,r,o){return void 0===r&&(r=3),new e(new et(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=Pe(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?Te(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof Je?null:this.currentInline},enumerable:!1,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof Je?(t=$e(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):(t=function(e,t,n){if(!t)return null;if(t instanceof Xe){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var o=t.getContainerNode();return o=Pe(e,o,n),Ke(e,o)}(this.scoper.rootNode,n,e),t=t&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null),t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();var rt=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,ot=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word||""},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=nt.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n=null,r=null,o=e.length-1;return this.forEachTextInlineElement((function(i){for(var a=i.getTextContent()||"",l=a.length-1;l>=0&&o>=0;l--)if(e.charCodeAt(o)==a.charCodeAt(l))o--,r||(r=i.getStartPosition().move(l+1));else if(t||r)return!0;return-1==o&&(n=i.getStartPosition().move(l+1),!0)})),n&&r&&ee(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||nt.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var r=rt.exec(n);r&&2==r.length&&(this.word=r[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}(),it="​";function at(e){return e&&M(e,"HTMLSpanElement")&&(e.classList.contains("entityDelimiterAfter")||e.classList.contains("entityDelimiterBefore"))&&e.textContent===it?e:null}var lt,st="​";function ut(e){var t,n,r,o,i=p((n=[],r=(t=e).nextElementSibling,o=t.previousElementSibling,n.push(ct(r,"entityDelimiterAfter"),ct(o,"entityDelimiterBefore")),n),2),a=i[0],l=i[1];return a||(a=dt(e,"entityDelimiterAfter")),l||(l=function(e){return dt(e,"entityDelimiterBefore")}(e)),[a,l]}function ct(e,t){return e&&at(e)&&e.classList.contains(t)?e:void 0}function dt(e,t){var n=Ee({tag:"span",className:t,children:[st]},e.ownerDocument);if(n){var r="entityDelimiterAfter"==t?"afterend":"beforebegin";e.insertAdjacentElement(r,n)}return n}function ft(e,t){if(e){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}var pt=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,ht="text/*",vt="link-preview",gt=((lt={})["text/html"]=function(e,t){return e.rawHtml=ye.isEdge?function(e){var t=pt.exec(e);if(3==(null==t?void 0:t.length)){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}(t):t},lt["text/plain"]=function(e,t){return e.text=t},lt[ht]=function(e,t,n){return!!n&&(e.customValues[n]=t)},lt["text/"+vt]=function(e,t){try{e.customValues[vt]=t,e.linkPreview=JSON.parse(t)}catch(e){}},lt);function mt(e,t,n){var r={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:n};return Promise.all((e||[]).map((function(e){var n=e.type;if(0!=n.indexOf("image/")||r.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var o=e.getAsFile();o&&(r.types.push(n),r.files.push(o)),t()}));var o=function(e,t){var n=0==e.indexOf("text/")?e.substring(5):null,r=t&&n?t.indexOf(n):-1;return n&&r>=0?n:void 0}(n,null==t?void 0:t.allowedCustomPasteType),i=gt[n]||(o?gt[ht]:null);return new Promise((function(t){return i?e.getAsString((function(e){r.types.push(n),i(r,e,o),t()})):t()}))}return r.types.push(n),r.image=e.getAsFile(),new Promise((function(e){r.image?ft(r.image,(function(t){r.imageDataUri=t,e()})):e()}))}))).then((function(){return r}))}function At(e,t,n,r){var o,i=e.clipboardData||(null===(o=e.target.ownerDocument)||void 0===o?void 0:o.defaultView).clipboardData;i.items?(e.preventDefault(),mt(H(i.items),n,!0).then((function(e){var n;n=r,ye.isAndroid&&n&&n.deleteContents(),t(e)}))):function(e,t,n){for(var r,o,i,a={types:e.types?H(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0},l=0;l<(e.files?e.files.length:0);l++){var s=e.files.item(l);if(0==(null===(r=null==s?void 0:s.type)||void 0===r?void 0:r.indexOf("image/"))){a.image=s;break}}var u=function(){a.image?ft(a.image,(function(e){a.imageDataUri=e,t(a)})):t(a)};if((null==n?void 0:n.getTempDiv)&&(null==n?void 0:n.removeTempDiv)){var c=n.getTempDiv();c.contentEditable="true",c.innerHTML="",c.focus(),null===(i=null===(o=c.ownerDocument)||void 0===o?void 0:o.defaultView)||void 0===i||i.setTimeout((function(){var e;a.rawHtml=c.innerHTML,null===(e=n.removeTempDiv)||void 0===e||e.call(n,c),u()}),0)}else a.rawHtml=void 0,u()}(i,t,n)}var yt=" ",bt=" ",Et=6;function Ct(e,t,n){var r=n.ownerDocument;e.split("\n").forEach((function(e,o,i){(e=e.replace(/^ /g,yt).replace(/\r/g,"").replace(/ {2}/g," "+yt)).includes("\t")&&(e=function(e,t){void 0===t&&(t=0);var n,r=e;for(;-1!=(n=r.indexOf("\t"));){var o=r.slice(0,n),i=r.slice(n+1),a=Et-(o.length+t)%Et;r=o+Array(a).fill(bt).join("")+i}return r}(e,0===o?null==t?void 0:t.offset:0));var a=r.createTextNode(e);2==i.length&&0==o?(n.appendChild(a),n.appendChild(r.createElement("br"))):o>0&&o<i.length-1?n.appendChild(Ce(""==e?r.createElement("br"):a)):n.appendChild(a)}))}var wt="\x3c!--StartFragment--\x3e",St="\x3c!--EndFragment--\x3e";function Tt(e,t){H(e.querySelectorAll("style")).forEach(t)}var Dt="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");function kt(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&e&&t.getComputedStyle(e),r={};return Dt.forEach((function(e){return r[e]=n&&n.getPropertyValue(e)||""})),r}function xt(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}function It(e,t){var n;if(!e||!t)return null;var r=j(e);if(r==t.toUpperCase())return e;for(var o=e.ownerDocument.createElement(t),i=0;i<e.attributes.length;i++){var a=e.attributes[i];o.setAttribute(a.name,a.value)}return xt(o,e),"P"!=r&&"P"!=j(o)||(n=p(Ie(e,["margin-top","margin-bottom"]),2),o.style.marginTop=n[0],o.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(o,e),o}var Lt={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};function Nt(e,t){var n=j(e);return Lt[n]||(t||{})[n]}function Rt(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n),o=e.slice(n+1);r&&o&&(t[r.trim()]=o.trim())})),t}function Bt(e,t){if(e){var n=oe(t||{}).map((function(e){var n=t[e],r=e?e.trim():null,o=n?n.trim():null;return r&&o?r+":"+o:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}var Mt=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n,r,o=t||{};if(e)try{for(var i=f(oe(e)),a=i.next();!a.done;a=i.next()){var l=a.value;o[l]=e[l]}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o};function Pt(e,t){return Mt(e,t)}var Ot=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/;var _t={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},Ft="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap,bgColor".split(","),Ht={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},Ut=[];function zt(){return null}function jt(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}var Qt=function(){function e(e){var t,n,o,i,a,l;e=e||{},this.elementCallbacks=Pt(e.elementCallbacks),this.styleCallbacks=(t=e.cssStyleCallbacks,(n=Pt(t)).position=n.position||zt,n.width=n.width||jt,n),this.attributeCallbacks=Pt(e.attributeCallbacks),this.tagReplacements=function(e){var t=r({},_t),n=e||{};return oe(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t}(e.additionalTagReplacements),this.allowedAttributes=(o=e.additionalAllowedAttributes,(i=Ft.concat(o||[]),i.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}))),this.allowedCssClassesRegex=(a=e.additionalAllowedCssClasses,(l=Ut.concat(a||[])).length>0?new RegExp(l.join("|")):null),this.defaultStyleValues=function(e){var t=Pt(Ht);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t}(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),o=M(n.currentElementOrStyle,"HTMLElement")?kt(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,o)},e.prototype.exec=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,n)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=Pt(t,kt(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){var t,n,r=H(e.querySelectorAll("style")),o=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(r.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));try{for(var i=f(o),a=i.next();!a.done;a=i.next())for(var l=a.value,s=function(t){var n,r,o=l.cssRules[t],i=o&&o.style?o.style.cssText:null;if(o.type!=CSSRule.STYLE_RULE||!i||!o.selectorText)return"continue";try{for(var a=(n=void 0,f(o.selectorText.split(","))),s=a.next();!s.done;s=a.next()){var u=s.value;if(u&&u.trim()&&!(u.indexOf(":")>=0))H(e.querySelectorAll(u)).forEach((function(e){return e.setAttribute("style",i+(e.getAttribute("style")||""))}))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},u=l.cssRules.length-1;u>=0;u--)s(u)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}r.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var r,o=e.nodeType,i=1==o,a=3==o,l=11==o,s=8==o,u=!1;if(i){var c=j(e),d=this.elementCallbacks[c],f=this.tagReplacements[c.toLowerCase()];void 0===f&&(f=this.unknownTagReplacement),d?u=d(e,n):c.indexOf(":")>0||c==f||"*"==f?u=!0:f&&/^[a-zA-Z][\w\-]*$/.test(f)&&(e=It(e,f),u=!0)}else if(a){var p=t["white-space"];u="pre"==p||"pre-line"==p||"pre-wrap"==p||!/^[\r\n]*$/g.test(e.nodeValue||"")}else u=!!l||!!s&&this.preserveHtmlComments;if(u)if(!a||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(i||l){var h=Pt(t),v=e;i&&(this.processAttributes(v,n),this.preprocessCss(v,h),this.processCss(v,h,n));for(var g=v.firstChild,m=void 0;g;g=m)m=g.nextSibling,this.processNode(g,h,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm," ").replace(/ {2}/g,"  ");else null===(r=e.parentNode)||void 0===r||r.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=Nt(e,this.additionalPredefinedCssForElement);n&&oe(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var r=this,o=Rt(e);oe(o).forEach((function(i){var a=o[i],l=r.styleCallbacks[i],s=null!=t[i],u=!0;u&&l&&(u=l(a,e,t,n)),u&&function(e){return 0==e.indexOf("var(")}(a)&&(u=!!(a=function(e){var t=Ot.exec(e);return(null==t?void 0:t[2])||""}(a))),(u=u&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=i.substr(0,1)&&r.defaultStyleValues[i]!=a&&(s&&a!=t[i]||!s&&"initial"!=a&&"normal"!=a))&&s&&(t[i]=a),u?o[i]=a:delete o[i]})),Bt(e,o)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],l=a?a(i,e,t):this.allowedAttributes.indexOf(o)>=0||0==o.indexOf("data-")?i:null;"class"==o&&this.allowedCssClassesRegex&&(l=this.processCssClass(i,l)),null==l||l.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=l}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],o=t?t.split(" "):[];return r.forEach((function(e){var t;(null===(t=n.allowedCssClassesRegex)||void 0===t?void 0:t.test(e))&&o.indexOf(e)<0&&o.push(e)})),(null==o?void 0:o.length)>0?o.join(" "):null},e}();var Kt=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,Vt=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,Wt=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,qt=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/;function Gt(e){var t;return(t=(e=(e||"").trim()).match(Kt))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(Vt))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(Wt)||e.match(qt))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}var Yt,Jt="#ffffff",Xt="#333333",Zt="#000000",$t="transparent";!function(e){e[e.BRIGHT=0]="BRIGHT",e[e.DARK=1]="DARK",e[e.NONE=2]="NONE"}(Yt||(Yt={}));var en=20,tn=80;function nn(e,t,n,r,o,i){var a="string"==typeof t?t.trim():"",l="string"==typeof t?null:t,s=n?"background-color":"color";if(a||l){if(i){var u=i.registerColor((null==l?void 0:l.lightModeColor)||a,!!r,null==l?void 0:l.darkModeColor);e.style.setProperty(s,u)}n&&o&&function(e,t,n,r){if(!t||t===$t)return;switch(function(e){var t=function(e){var t=Gt(e);if(t){var n=t[0]/255,r=t[1]/255,o=t[2]/255;return 50*(Math.max(n,r,o)+Math.min(n,r,o))}return 255}(e);if(t<en)return 1;if(t>tn)return 0;return 2}(t)){case 1:nn(e,{lightModeColor:Jt,darkModeColor:Xt},!1,n,!1,r);break;case 0:nn(e,{lightModeColor:Zt,darkModeColor:Jt},!1,n,!1,r)}}(e,(null==l?void 0:l.lightModeColor)||a,r,i)}}function rn(e,t,n,r){if(t){var o=e.style,i=t.fontFamily,a=t.fontSize,l=t.textColor,s=t.textColors,u=t.backgroundColor,c=t.backgroundColors,d=t.bold,f=t.italic,p=t.underline;i&&(o.fontFamily=i),a&&(o.fontSize=a),s?nn(e,s,!1,n,!1,r):l&&nn(e,l,!1,n,!1,r),c?nn(e,c,!0,n,!1,r):u&&nn(e,u,!0,n,!1,r),d&&(o.fontWeight="bold"),f&&(o.fontStyle="italic"),p&&(o.textDecoration="underline")}}var on={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"};var an=["IMG"],ln=["TABLE","IMG","LI"].join(","),sn=/\u200b/g;function un(e,t,n){if(!e)return!1;if(3==e.nodeType)return""==cn(e.nodeValue||"",t);if(1==e.nodeType){var r=e,o=cn(r.textContent||"",t),i=n?ln+",BR":ln;if(""!=o||an.indexOf(j(r))>=0||r.querySelectorAll(i)[0])return!1}return!0}function cn(e,t){return e=e.replace(sn,""),t?e.trim():e}var dn=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,fn="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",pn="(?:"+fn+"\\.)*"+fn+"(?:\\:[0-9]+)?"+"(?:[\\/\\?]\\S*)?",hn={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+pn+"|www\\."+pn,"i"),except:dn,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+pn,"i"),except:dn},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+pn+"|ftp\\."+pn,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+pn,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+pn,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+pn,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+pn,"i")}};function vn(e){var t,n;if(e)try{for(var r=f(oe(hn)),o=r.next();!o.done;o=r.next()){var i=o.value,a=hn[i],l=e.match(a.match);if(l&&l[0]==e&&(!a.except||!a.except.test(e)))return{scheme:i,originalUrl:e,normalizedUrl:a.normalizeUrl?a.normalizeUrl(e):e}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}function gn(e,t,n,r,o){if(void 0===r&&(r=0),!e||!t)return[];var i=H(e.querySelectorAll(t));if(0!=r&&o){var a=o.startOffset,l=o.endOffset,s=o.startContainer,u=o.endContainer;if(1==s.nodeType&&s.firstChild){var c=s.childNodes[a];s=c||s.lastChild}u=1==u.nodeType&&u.firstChild&&l>0?u.childNodes[l-1]:u,i=i.filter((function(e){return function(e,t,n,r){var o=e.compareDocumentPosition(t),i=e.compareDocumentPosition(n),a=[0,8];r||a.push(16);return mn(o,a)||mn(i,a)||mn(o,[2])&&mn(i,[4])&&!mn(i,[16])}(e,s,u,2==r)}))}return n&&i.forEach(n),i}function mn(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}function An(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}function yn(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,r=t.right,o=t.top,i=t.bottom;return 0===n&&0===r&&0===o&&0===i?null:{left:Math.round(n),right:Math.round(r),top:Math.round(o),bottom:Math.round(i)}}function bn(e,t,n,r,o){return{type:1,isOptional:e,value:t,maxValue:r,minValue:n,allowNull:o}}function En(e,t,n){return{type:0,isOptional:e,value:t,allowNull:n}}function Cn(e,t,n){return{type:2,isOptional:e,value:t,allowNull:n}}function wn(e,t,n){return{type:4,isOptional:t,propertyDef:e,allowNull:n}}function Sn(e,t){var n,r,o=!1;if(t.isOptional&&void 0===e||t.allowNull&&null===e)o=!0;else{if(!t.isOptional&&void 0===e||!t.allowNull&&null===e)return!1;switch(t.type){case 2:o="string"==typeof e&&(void 0===t.value||e===t.value);break;case 1:o="number"==typeof e&&(void 0===t.value||(n=t.value,r=e,Math.abs(n-r)<.001))&&(void 0===t.minValue||e>=t.minValue)&&(void 0===t.maxValue||e<=t.maxValue);break;case 0:o="boolean"==typeof e&&(void 0===t.value||e===t.value);break;case 3:o=Array.isArray(e)&&(void 0===t.minLength||e.length>=t.minLength)&&(void 0===t.maxLength||e.length<=t.maxLength)&&e.every((function(e){return Sn(e,t.itemDef)}));break;case 4:o="object"==typeof e&&oe(t.propertyDef).every((function(n){return Sn(e[n],t.propertyDef[n])}));break;case 5:o=t.validator(e)}}return o}var Tn="editingInfo";function Dn(e,t,n){var r,o=e.dataset[Tn];try{r=o?JSON.parse(o):null}catch(e){}if(void 0!==r){if(!t)return r;if(Sn(r,t))return r}return n||null}function kn(e,t,n){return!(n&&!Sn(t,n))&&(e.dataset[Tn]=JSON.stringify(t),!0)}function xn(e,t){if(t){var n=Dn(e);n&&(delete n[t],e.dataset[Tn]=JSON.stringify(n))}else delete e.dataset[Tn]}var In=En(!0,void 0,!0),Ln=wn({bgColorOverride:In,vAlignOverride:In,borderOverride:In},!1,!0);function Nn(e){return Dn(e,Ln)}function Rn(e,t){e&&t&&kn(e,t,Ln)}var Bn="transparent",Mn="TD",Pn="TH";function On(e,t,n,r){n&&(e.style.borderCollapse="collapse",function(e,t){e.forEach((function(n,r){n.forEach((function(o,i){o.td&&!function(e){var t;if(!e.td)return!1;return!!(null===(t=Nn(e.td))||void 0===t?void 0:t.borderOverride)}(o)&&function(e,t,n,r,o,i){switch(function(e,t){e.style.borderTop=Fn(t.topBorderColor),e.style.borderLeft=Fn(t.verticalBorderColor),e.style.borderRight=Fn(t.verticalBorderColor),e.style.borderBottom=Fn(t.bottomBorderColor)}(t,e),e.tableBorderFormat){case 0:return;case 1:o||(t.style.borderLeftColor=Bn),i||(t.style.borderRightColor=Bn);break;case 4:n||(t.style.borderTopColor=Bn),r||n||(t.style.borderBottomColor=Bn),o||(t.style.borderLeftColor=Bn),i||o||(t.style.borderRightColor=Bn),o&&n&&(t.style.borderRightColor=Bn);break;case 2:n&&(t.style.borderTopColor=Bn,t.style.borderRightColor=Bn,t.style.borderLeftColor=Bn),o&&(t.style.borderLeftColor=Bn),i&&(t.style.borderRightColor=Bn);break;case 3:o&&(t.style.borderLeftColor=Bn),i&&(t.style.borderRightColor=Bn);break;case 5:n&&(t.style.borderRightColor=Bn,t.style.borderLeftColor=Bn),o&&(t.style.borderBottomColor=Bn,t.style.borderTopColor=Bn),n&&o&&(t.style.borderLeftColor=e.verticalBorderColor||Bn,t.style.borderBottomColor=e.bottomBorderColor||Bn,t.style.borderTopColor=e.topBorderColor||Bn);break;case 6:n&&(t.style.borderRightColor=Bn,t.style.borderLeftColor=Bn),o&&(t.style.borderBottomColor=Bn,t.style.borderTopColor=Bn),n&&o&&(t.style.borderLeftColor=e.verticalBorderColor||Bn,t.style.borderBottomColor=e.bottomBorderColor||Bn,t.style.borderTopColor=e.topBorderColor||Bn),n||o||(t.style.borderLeftColor=Bn,t.style.borderBottomColor=Bn,t.style.borderTopColor=Bn,t.style.borderRightColor=Bn);break;case 7:n&&(t.style.borderLeftColor=Bn,t.style.borderTopColor=Bn,t.style.borderRightColor=Bn),o&&(t.style.borderLeftColor=Bn,t.style.borderTopColor=Bn,t.style.borderBottomColor=Bn),n||o||(t.style.borderLeftColor=Bn,t.style.borderBottomColor=Bn,t.style.borderTopColor=Bn,t.style.borderRightColor=Bn),n&&o&&(t.style.borderBottomColor=e.bottomBorderColor||Bn)}}(t,o.td,0===r,r===e.length-1,0===i,i===n.length-1)}))}))}(t,n),function(e,t,n){var r=function(e){return e%2==0?t.bgColorEven:t.bgColorOdd},o=t.hasBandedRows,i=t.hasBandedColumns,a=t.bgColorOdd,l=t.bgColorEven,s=!o&&a===l;e.forEach((function(e,i){e.forEach((function(e){if(e.td){if(!_n(e))if(o){var a=r(i);nn(e.td,a||Bn,!0,void 0,!0,n)}else nn(e.td,s&&t.bgColorOdd||Bn,!0,void 0,!0,n);t.verticalAlign&&!function(e){var t;if(!e.td)return!1;return!!(null===(t=Nn(e.td))||void 0===t?void 0:t.vAlignOverride)}(e)&&(e.td.style.verticalAlign=t.verticalAlign)}}))})),i&&e.forEach((function(e){e.forEach((function(e,t){var o=r(t);e.td&&o&&!_n(e)&&nn(e.td,o,!0,void 0,!0,n)}))}))}(t,n,r),function(e,t){if(!t.hasFirstColumn)return void e.forEach((function(e){e.forEach((function(e,t){e.td&&0===t&&(e.td=It(e.td,Mn),e.td.scope="")}))}));e.forEach((function(t,n){t.forEach((function(t,r){t.td&&0===r&&(0===n||_n(t)||(t.td.style.borderTopColor=Bn,nn(t.td,Bn,!0,void 0,!0)),n!==e.length-1&&0!==n&&(t.td.style.borderBottomColor=Bn),t.td=It(t.td,Pn),t.td.scope="col")}))}))}(t,n),function(e,t,n){var r,o;if(!t.hasHeaderRow)return void(null===(r=e[0])||void 0===r||r.forEach((function(e){e.td&&(e.td=It(e.td,Mn),e.td.scope="")})));null===(o=e[0])||void 0===o||o.forEach((function(e){e.td&&t.headerRowColor&&(_n(e)||nn(e.td,t.headerRowColor,!0,void 0,!0,n),e.td.style.borderRightColor=t.headerRowColor,e.td.style.borderLeftColor=t.headerRowColor,e.td.style.borderTopColor=t.headerRowColor,e.td=It(e.td,Pn),e.td.scope="row")}))}(t,n,r))}function _n(e){var t;return!!e.td&&!!(null===(t=Nn(e.td))||void 0===t?void 0:t.bgColorOverride)}function Fn(e){return"solid 1px "+(e||"transparent")}var Hn=Cn(!1,void 0,!0),Un=En(!1),zn=wn({topBorderColor:Hn,bottomBorderColor:Hn,verticalBorderColor:Hn,hasHeaderRow:Un,headerRowColor:Hn,hasFirstColumn:Un,hasBandedColumns:Un,hasBandedRows:Un,bgColorEven:Hn,bgColorOdd:Hn,tableBorderFormat:bn(!1,void 0,0,8),keepCellShade:En(!0),verticalAlign:Hn},!1,!0);function jn(e){return Dn(e,zn)}var Qn,Kn={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0,keepCellShade:!1,verticalAlign:null},Vn=function(){function e(e,t,n){var r=this;if(this.cells=null,this.formatInfo=null,this.trs=[],this.tableSelection=null,this.table=M(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var o=M(e,"HTMLTableElement")?null:e,i=H(this.table.rows);this.cells=i.map((function(e){return[]})),i.forEach((function(e,t){var n;r.trs[t%2]=e;for(var i=0,a=0;i<e.cells.length;i++){for(;r.cells[t][a];a++);var l=e.cells[i];l==o&&(r.col=a,r.row=t);for(var s=0;s<l.colSpan;s++,a++)for(var u=0;u<l.rowSpan;u++){var c=s+u==0,d=l.getBoundingClientRect();(null===(n=r.cells)||void 0===n?void 0:n[t+u])&&(r.cells[t+u][a]={td:c?l:null,spanLeft:s>0,spanAbove:u>0,width:c?d.width:void 0,height:c?d.height:void 0})}}for(var f=0;f<r.cells[t].length;f++)r.cells[t][f]||(r.cells[t][f]={td:null,spanLeft:!1,spanAbove:!1,width:void 0,height:void 0})})),this.formatInfo=jn(this.table),t&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n)}}return Object.defineProperty(e.prototype,"selection",{get:function(){return this.tableSelection||null},set:function(e){if(e){var t=e.firstCell;this.row=null==t?void 0:t.y,this.col=null==t?void 0:t.x}this.tableSelection=e},enumerable:!1,configurable:!0}),e.prototype.writeBack=function(e,t){var n,r,o,i=this;this.cells?(xt(this.table),this.cells.forEach((function(e,t){var n=Gn(i.trs[t%2]||i.trs[0]);n&&(i.table.appendChild(n),e.forEach((function(e,r){e.td&&(i.recalculateSpans(t,r),i.recalculateCellHeight(e.td),n.appendChild(e.td))})))})),this.formatInfo&&!e&&(r=this.table,o=this.formatInfo,r&&o&&kn(r,o,zn),On(this.table,this.cells,this.formatInfo,t))):this.table&&(null===(n=this.table.parentNode)||void 0===n||n.removeChild(this.table))},e.prototype.recalculateCellHeight=function(e){if(this.isEmptyCell(e)&&e.rowSpan>1)for(var t=1;t<e.rowSpan;t++){var n=document.createElement("br");e.appendChild(n)}},e.prototype.applyFormat=function(e){this.table&&(this.formatInfo=r(r(r({},Kn),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},e.prototype.deleteCellShadeDataset=function(e){null==e||e.forEach((function(e){e.forEach((function(e){e.td&&xn(e.td,"bgColorOverride")}))}))},e.prototype.edit=function(e){var t,n,r=this;if(this.table&&this.cells&&void 0!==this.row&&null!=this.col){var o=this.cells[this.row],i=o[this.col],a=this.selection?this.selection.firstCell.y:this.row,l=this.selection?this.selection.lastCell.y:this.row,s=this.selection?this.selection.firstCell.x:this.col,u=this.selection?this.selection.lastCell.x:this.col;switch(e){case 0:for(var c=a;c<=l;c++)this.cells.splice(a,0,o.map(qn));break;case 1:var d=function(e){var t=l+f.countSpanAbove(l,f.col);f.cells.splice(t,0,f.cells[t-1].map((function(e,n){var o=r.getCell(t,n);if(o.spanAbove)return qn(o);if(e.spanLeft){var i=qn(e);return i.spanAbove=!1,i}return{td:Gn(r.getTd(r.row,n))}})))},f=this;for(c=a;c<=l;c++)d();break;case 2:var p=function(e){h.forEachCellOfCurrentColumn((function(t,n){n.splice(e,0,qn(t))}))},h=this;for(c=s;c<=u;c++)p(c);break;case 3:var v=function(e){var t=u+g.countSpanLeft(g.row,u);g.forEachCellOfColumn(t-1,(function(e,n,o){var i,a=r.getCell(o,t);a.spanLeft?i=qn(a):e.spanAbove?(i=qn(e)).spanLeft=!1:i={td:Gn(r.getTd(o,r.col))},n.splice(t,0,i)}))},g=this;for(c=s;c<=u;c++)v();break;case 6:for(var m=function(e){A.forEachCellOfRow(e,(function(t,n){var o=r.getCell(e+1,n);t.td&&t.td.rowSpan>1&&o.spanAbove&&(o.td=t.td)}))},A=this,y=a;y<=l;y++)m(y);var b=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(a,b+1),0===this.cells.length&&(this.cells=null);break;case 5:for(var E=0,C=function(e){w.forEachCellOfColumn(e,(function(t,n,o){var i=r.getCell(o,e+1);t.td&&t.td.colSpan>1&&i.spanLeft&&(i.td=t.td);var a=r.selection?e-E:r.col;n.splice(a,1)})),E++},w=this,S=s;S<=u;S++)C(S);(0===(null===(t=this.cells)||void 0===t?void 0:t.length)||(null===(n=this.cells)||void 0===n?void 0:n.every((function(e){return 0===e.length}))))&&(this.cells=null);break;case 7:case 8:var T=7==e?-1:1;for(y=this.row+T;y>=0&&y<this.cells.length;y+=T){if((N=this.getCell(y,this.col)).td&&!N.spanAbove){var D=y<this.row?N:i,k=y<this.row?i:N;this.mergeCells(D,k);break}}break;case 9:case 10:var x=9==e?-1:1;for(S=this.col+x;S>=0&&S<this.cells[this.row].length;S+=x){if((N=this.getCell(this.row,S)).td&&!N.spanLeft){var I=S<this.col?N:i,L=S<this.col?i:N;this.mergeCells(I,L,!0);break}}break;case 11:for(S=s;S<=u;S++)for(y=a+1;y<=l;y++){var N=this.getCell(a,S),R=this.getCell(y,S);this.mergeCells(N,R)}for(S=s+1;S<=u;S++){N=this.getCell(a,s);var B=this.getCell(a,S);this.mergeCells(N,B,!0)}break;case 4:this.cells=null;break;case 13:if(i.td&&i.td.rowSpan>1)this.getCell(this.row+1,this.col).td=Gn(i.td);else{var M=o.map((function(e){return{td:e==i?Gn(e.td):null,spanAbove:e!=i,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,M)}break;case 12:i.td&&i.td.colSpan>1?this.getCell(this.row,this.col+1).td=Gn(i.td):this.forEachCellOfCurrentColumn((function(e,t){t.splice(r.col+1,0,{td:t==o?Gn(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=o})}));break;case 14:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 16:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 18:this.setAlignmentToSelectedCells(a,l,s,u,"center");break;case 17:this.setAlignmentToSelectedCells(a,l,s,u,"left");break;case 19:this.setAlignmentToSelectedCells(a,l,s,u,"right");break;case 20:this.setAlignmentToSelectedCells(a,l,s,u,"top",!0);break;case 21:this.setAlignmentToSelectedCells(a,l,s,u,"middle",!0);break;case 22:this.setAlignmentToSelectedCells(a,l,s,u,"bottom",!0)}}},e.prototype.setAlignmentToSelectedCells=function(e,t,n,o,i,a){for(var l,s,u=e;u<=t;u++)for(var c=n;c<=o;c++)if(this.cells){var d=this.cells[u][c].td;if(a&&d){null===(l=d.style)||void 0===l||l.setProperty("vertical-align",i);var f=Nn(d);Rn(d,r(r({},f),{vAlignOverride:!0}))}else d&&(null===(s=d.style)||void 0===s||s.setProperty("text-align",i))}},e.prototype.mergeCells=function(e,t,n){var r,o,i,a,l=n?(null===(r=e.td)||void 0===r?void 0:r.rowSpan)===(null===(o=t.td)||void 0===o?void 0:o.rowSpan)&&!e.spanLeft:(null===(i=e.td)||void 0===i?void 0:i.colSpan)===(null===(a=t.td)||void 0===a?void 0:a.colSpan)&&!e.spanAbove;e.td&&t.td&&l&&(this.mergeCellContents(e.td,t.td),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},e.prototype.isEmptyCell=function(e){return 1===e.childElementCount&&"BR"===j(e.firstChild)},e.prototype.mergeCellContents=function(e,t){if(this.isEmptyCell(t))xt(e,t,!1);else{var n=document.createElement("br");e.appendChild(n),xt(e,t,!0)}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;this.cells&&r<this.cells.length;r++)for(var o=0;o<this.cells[r].length;o++){var i=this.getCell(r,o);if(i.td){var a=yn(i.td.getBoundingClientRect());if(a){var l=!1;if(t){if(a.right==e)l=!0,n.push(i.td);else if(l)break}else if(a.left==e)l=!0,n.push(i.td);else if(l)break}}}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;this.cells&&r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;this.cells&&r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},e.prototype.normalizeEmptyTableCells=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)for(var n=0,r=void 0;r=t.cells[n];n++)r&&(r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br")))},e.prototype.normalizeTableCellSize=function(e){for(var t=0,n=void 0;n=this.table.rows[t];t++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(t=0;this.cells&&t<this.cells.length;t++)for(var r=0;r<this.cells[t].length;r++){var o=this.cells[t][r];if(o){var i="number"==typeof e?function(t){return t/e}:e,a=o.width||0,l=o.height||0;Wn(o.td,(null==i?void 0:i(a))||a,(null==i?void 0:i(l))||l)}}},e.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();Wn(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},e}();function Wn(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function qn(e){return{td:Gn(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function Gn(e){var t=e?e.cloneNode(!1):null;return M(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function Yn(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,r=t.lastCell,o=e.cells.length-1,i=e.cells[o];if(!i)return!1;var a=i.length-1,l=n.x,s=n.y,u=r.x,c=r.y;return 0==l&&0==s&&u==a&&c==o}function Jn(e){switch(j(e)){case"OL":return 1;case"UL":return 2;default:return 0}}function Xn(e){return 0!=Jn(e)}var Zn=((Qn={})[1]="disc",Qn[3]="∎ ",Qn[2]="- ",Qn[5]="➔ ",Qn[8]="➔ ",Qn[4]="➢ ",Qn[6]="➪ ",Qn[7]="— ",Qn);function $n(e,t,n){void 0===n&&(n=!0);var r=function(e,t,n){var r,o,i=[],a=nt.createBodyTraverser(e),l=null,s=function(){var s=(null==(l=a.currentInlineElement)?void 0:l.getContainerNode())||null,u=null;s=s?J(s):null;for(var c=function(){var e=s;t.forEach((function(t){var r=n?e.style.getPropertyValue(t):e.getAttribute(t);u||(u={}),r&&!u[t]&&(u[t]=r)})),s=1===(null===(o=null==s?void 0:s.parentNode)||void 0===o?void 0:o.childNodes.length)?s.parentNode:null};s&&s!==e&&M(s,"HTMLElement")&&(0==i.length||((null===(r=s.textContent)||void 0===r?void 0:r.trim().length)||0)>0);)c();u&&i.push(u),a.getNextInlineElement()};for(;a.currentInlineElement!=l;)s();return i}(e,t,n);t.forEach((function(t){var o=r.map((function(e){return void 0!==e[t]?e[t]:""}));o&&(1==o.length||1==new Set(o).size)&&o[0]&&(n?e.style.setProperty(t,o[0]):e.setAttribute(t,o[0]))}))}var er={0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",10:"K",11:"L",12:"M",13:"N",14:"O",15:"P",16:"Q",17:"R",18:"S",19:"T",20:"U",21:"V",22:"W",23:"X",24:"Y",25:"Z"};function tr(e,t){for(var n="";e>=0;)n=er[e%26]+n,e=Math.floor(e/26)-1;return t?n.toLowerCase():n}var nr,rr,or={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};function ir(e,t){var n,r,o="";try{for(var i=f(oe(or)),a=i.next();!a.done;a=i.next()){var l=a.value,s=Math.floor(e/or[l]);e-=s*or[l],o+=l.repeat(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t?o.toLocaleLowerCase():o}!function(e){e[e.Decimal=0]="Decimal",e[e.Roman=1]="Roman",e[e.Alpha=2]="Alpha"}(rr||(rr={}));var ar=((nr={})[1]={markerType:rr.Decimal,markerSeparator:". "},nr[2]={markerType:rr.Decimal,markerSeparator:"- "},nr[3]={markerType:rr.Decimal,markerSeparator:") "},nr[4]={markerType:rr.Decimal,markerSeparator:") ",markerSecondSeparator:"("},nr[5]={markerType:rr.Alpha,markerSeparator:". ",lowerCase:!0},nr[8]={markerType:rr.Alpha,markerSeparator:"- ",lowerCase:!0},nr[6]={markerType:rr.Alpha,markerSeparator:") ",lowerCase:!0},nr[7]={markerType:rr.Alpha,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},nr[9]={markerType:rr.Alpha,markerSeparator:". "},nr[12]={markerType:rr.Alpha,markerSeparator:"- "},nr[10]={markerType:rr.Alpha,markerSeparator:") "},nr[11]={markerType:rr.Alpha,markerSeparator:") ",markerSecondSeparator:"("},nr[13]={markerType:rr.Roman,markerSeparator:". ",lowerCase:!0},nr[16]={markerType:rr.Roman,markerSeparator:"- ",lowerCase:!0},nr[14]={markerType:rr.Roman,markerSeparator:") ",lowerCase:!0},nr[15]={markerType:rr.Roman,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},nr[17]={markerType:rr.Roman,markerSeparator:". "},nr[20]={markerType:rr.Roman,markerSeparator:"- "},nr[18]={markerType:rr.Roman,markerSeparator:") "},nr[19]={markerType:rr.Roman,markerSeparator:") ",markerSecondSeparator:"("},nr),lr=[null,"lower-alpha","lower-roman"],sr=["disc","circle","square"],ur="-.25in",cr=["font-size","font-family","color"],dr=["data-ogsc","data-ogsb","data-ogac","data-ogab"],fr=wn({orderedStyleType:bn(!0,void 0,1,20),unorderedStyleType:bn(!0,void 0,1,9)},!0,!0),pr=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=M(e,"HTMLLIElement")?e:Ce(e,4);var r=this.node.style.display;this.dummy="list-item"!=r&&""!=r,this.listTypes=g([0],p(t),!1)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.getNewListStart=function(){return this.newListStart},e.prototype.contains=function(e){return P(this.node,e,!0)},e.prototype.isDummy=function(){return this.dummy},e.prototype.isOrphanItem=function(){return!1},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;vr((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){if(this.node.style.marginLeft==ur)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(e){void 0===e&&(e=!1);var t=e?2:1;this.listTypes.length>t&&this.listTypes.pop()},e.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft=ur},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.setIsDummy=function(e){this.dummy=e},e.prototype.setNewListStart=function(e){this.newListStart=e},e.prototype.applyListStyle=function(e,t){var n,r,o,i,a=Dn(e,fr),l=this.listTypes.length<3;a&&(l&&2===this.listTypes[1]&&a.unorderedStyleType?(n=this.node,r=a.unorderedStyleType,o=Zn[r],i=1===r,n.style.listStyleType=i?o:'"'+o+'"'):l&&1===this.listTypes[1]&&a.orderedStyleType?function(e,t,n){var r=ar[t],o=r.markerSeparator,i=r.markerSecondSeparator,a=r.markerType,l=r.lowerCase,s=n.toString();a===rr.Roman?s=ir(n,l):a===rr.Alpha&&(s=tr(n-1,l));var u=i?i+s+o:s+o;e.style.listStyleType='"'+u+'"'}(this.node,a.orderedStyleType,t):this.node.style.removeProperty("list-style-type"))},e.prototype.writeBack=function(e,t,n){var o,i=this;void 0===n&&(n=!1);var a,l,s=1;if(n){e.length>this.listTypes.length&&e.splice(this.listTypes.length);var u=e.length-1;u===this.listTypes.length-1&&Jn(e[u])!==this.listTypes[u]&&e.splice(u),s=e.length}else for(;s<e.length;s++)if(Jn(e[s])!==this.listTypes[s]){e.splice(s);break}for(;s<this.listTypes.length;s++){var c=e.length-1,d=hr(e[0],this.listTypes[s],s,t);if(e[c].appendChild(d),e.push(d),this.getDeepChildIndex(t)==c){var f=null===(o=this.node.parentElement)||void 0===o?void 0:o.style.listStyleType;f&&j(this.node.parentElement)===j(d)&&(d.style.listStyleType=f)}}if(e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),this.listTypes.length>1&&($n(this.node,cr,!0),$n(this.node,dr,!1)),this.listTypes.length<=1){var p="LI"==j(this.node),h=p?{"font-family":this.node.style.fontFamily,"font-size":this.node.style.fontSize,color:this.node.style.color}:void 0,v=p?(a=this.node,l=H(a.childNodes),An(a),l):[this.node];if(h)for(var g=function(e){M(v[e],"Text")&&(v[e]=Ce(v[e],"span"));var t=v[e];if(M(t,"HTMLElement")){var n=r(r({},h),Rt(t));Bt(t,n),dr.forEach((function(e){var n=i.node.getAttribute(e);n&&t.setAttribute(e,n)}))}},m=0;m<v.length;m++)g(m);vr(v,!0,!0)}},e.prototype.getDeepChildIndex=function(e){var t=this.node.parentElement;if(e&&t){for(var n=0;t&&t!=e;)n++,t=(null==t?void 0:t.parentElement)||null;return n}return-1},e}();function hr(e,t,n,r){var o,i=e.ownerDocument;if(1==n&&r&&t==Jn(r)?P(e,r)?(o=r.cloneNode(!1)).removeAttribute("id"):(xt(r),o=r):o=i.createElement(1==t?"ol":"ul"),"0px"==(null==r?void 0:r.style.marginBlockStart)&&"0px"==(null==r?void 0:r.style.marginBlockEnd)&&(o.style.marginBlockStart="0px",o.style.marginBlockEnd="0px"),r&&1==n&&t!=Jn(r)){var a=Dn(r,fr);a&&kn(o,a,fr)}return 1==t&&n>1&&o.style.setProperty("list-style-type",lr[(n-1)%lr.length]),2==t&&n>1&&o.style.setProperty("list-style-type",sr[(n-1)%sr.length]),o}function vr(e,t,n){return!(e.length>0)||t&&V(e[0])||n&&V(e[e.length])||(e=[Ce(e)]),e}var gr=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");mr(this.rootList),gn(this.rootList,"ol,ul",mr),gn(this.rootList,"li",Ar),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter((function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()})).length},e.prototype.writeBack=function(e,t){var n=this;if(!this.rootList)throw new Error("rootList must not be null");var r,o=this.rootList.ownerDocument,i=[o.createDocumentFragment()],a=o.createTextNode(""),l=this.getStart()||1;this.rootList.parentNode.replaceChild(a,this.rootList),this.items.forEach((function(o){var a=o.getNewListStart();a&&a!=l&&(i.splice(1,i.length-1),l=a),o.writeBack(i,n.rootList,e);var s=i[1];o.applyListStyle(n.rootList,l),M(s,"HTMLOListElement")&&(r!=s&&(1==l?s.removeAttribute("start"):s.start=l),1!=o.getLevel()||o.isDummy()||t||l++),r=s})),a.parentNode.replaceChild(i[0],a)},e.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},e.prototype.setIndentation=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var a=!1;if(this.findListItems(e,t,(function(e){a=a||0==i.items.indexOf(e),1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent(o):e.indent()})),a&&o)for(var l=0;l<this.items.length;l++)this.items[l].addNegativeMargins()},e.prototype.setAlignment=function(e,t,n){this.rootList.style.display="flex",this.rootList.style.flexDirection="column",this.findListItems(e,t,(function(e){var t="start";1==n?t="center":2==n&&(t="end"),e.getNode().style.alignSelf=t}))},e.prototype.removeMargins=function(){this.rootList.style.marginTop||this.rootList.style.marginBottom||(this.rootList.style.marginBlockStart="0px",this.rootList.style.marginBlockEnd="0px")},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.setListStyleType=function(e,t){var n=function(e,t,n){return{orderedStyleType:yr(t,null==e?void 0:e.orderedStyleType,1),unorderedStyleType:yr(n,null==e?void 0:e.unorderedStyleType,1)}}(Dn(this.rootList,fr),e,t);kn(this.rootList,n,fr)},e.prototype.appendItem=function(e,t){var n=j(e);"DIV"==n?e=It(e,"LI"):"LI"!=n&&(e=Ce(e,"LI")),this.items.push(0==t?new pr(e):new pr(e,t))},e.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},e.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var r=this.items[n];if(1!=r.getLevel()||r.isDummy()||t++,r.getNode()==e)return t}return-1},e.prototype.getStart=function(){return M(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new X(this.items[0].getNode(),0),o=new X(this.items[this.items.length-1].getNode(),-1),i=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(o)?1:0);this.items.forEach((function(n,r){i=n.contains(e.node)?r:i,a=n.contains(t.node)?r:a})),i=a<this.items.length?Math.max(0,i):i,a=i>=0?Math.min(this.items.length-1,a):a;var l=i<=a?this.items.slice(i,a+1):[];return n&&l.forEach(n),l},e.prototype.populateItems=function(e,t){var n=this;void 0===t&&(t=[]);var r=Jn(e);H(e.childNodes).forEach((function(e){var o=g(g([],p(t),!1),[r],!1);Xn(e)?n.populateItems(e,o):3==e.nodeType&&""==(e.nodeValue||"").trim()||n.items.push(new(pr.bind.apply(pr,g([void 0,e],p(o),!1))))}))},e}();function mr(e){var t=null;H(e.childNodes).forEach((function(e){"LI"==j(e)?t=e:Xn(e)?t=null:t&&!un(e,!0)&&t.appendChild(V(e)?e:Ce(e))}))}function Ar(e){for(;!Xn(e.parentNode);){_(e,!0);var t=H(e.parentNode.childNodes).slice(1);t.length>0&&(V(t[0])||(t=[Ce(t)]),t.forEach((function(t){return e.appendChild(t)}))),An(e.parentNode)}}function yr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return void 0!==e}))[0]}function br(e,t,n){var r=e&&J(n,e.rootNode,t);if(r)for(var o=void 0;o=J(r.parentNode,e.rootNode,t);)r=o;return r}function Er(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,r=e.rootNode,o=e.skipTags,i=t?Oe(e.rootNode,t,e.skipTags):r.firstChild,a=n?_e(r,n,o):r.lastChild,l=i&&a&&ee(i,a);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return l;if(l){var s=X.getStart(l).normalize(),u=X.getEnd(l).normalize(),c=e.fullSelectionEnd,d=e.fullSelectionStart;if(!d.isAfter(u)&&!s.isAfter(c))return ee(d.isAfter(s)?d:s,c.isAfter(u)?u:c)}return null}function Cr(e,t,n){var r=Er(e),o=[];if(r){for(var i=e.rootNode,a=e.skipTags,l=nt.createSelectionTraverser(i,r,a),s=null==l?void 0:l.currentBlockElement;s;s=l.getNextBlockElement())o.push(s);o=o.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!Me(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==o.length&&e&&!e.rootNode.firstChild&&t){var u=Ee(1,e.rootNode.ownerDocument);e.rootNode.appendChild(u),(s=Te(e.rootNode,u))&&o.push(s)}return o}function wr(e,t){return!(!e||!P(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}var Sr="ol,ul";function Tr(e,t,n){if(!e)return null;var r=[];if(n){var o=br(e,Sr,n);o&&r.push(o)}else{if(Cr(e,void 0).forEach((function(n){var o=br(e,Sr,n.getStartNode());o?(r[r.length-1]!=o&&r.push(o),1==r.length&&M(o,"HTMLOListElement")&&o.start>1&&(t=!1)):r.push(n.collapseToSingleElement())})),0==r.length&&!e.rootNode.firstChild){var i=Ee(1,e.rootNode.ownerDocument);e.rootNode.appendChild(i),r.push(i),e.fullSelectionStart=new X(i,0),e.fullSelectionEnd=new X(i,-1)}t&&(Dr(e,r,!1),Dr(e,r,!0)),r=r.filter((function(e){return!Me(e,!0)}))}var a=null;if(r.length>0){var l=r.shift()||null;(a=Xn(l)?new gr(l):l?function(e){var t=H(e.childNodes),n=1==t.length?t[0]:Ce(t,"SPAN"),r=e.ownerDocument.createElement("ol");e.appendChild(r);var o=new gr(r);return o.appendItem(n,0),o}(l):null)&&r.forEach((function(e){Xn(e)?a.mergeVList(new gr(e)):a.appendItem(e,0)}))}return a}function Dr(e,t,n){var r=t[n?t.length-1:0];r=Pe(e.rootNode,r,n,e.skipTags,!0),wr(e,r=br(e,Sr,r))&&Xn(r)&&(n?M(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}function kr(e,t){Array.prototype.push.apply(e,t)}var xr,Ir="listchain",Lr="listchainafter",Nr=0,Rr=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,r){var o=Array.isArray(t)?t:t?[t]:[],i=[];return o.forEach((function(t){var o,a=[];gn(t.rootNode,"ol",(function(i){var l=br(t,"ol",i);if(o!=l){var s=a.filter((function(e){return e.canAppendToTail(l)}))[0]||new e(t,(r||Br)()),u=a.indexOf(s),c=!!n&&O(l,n);c?u<0&&a.push(s):(u>=0&&a.splice(u,1),a.unshift(s)),s.append(l,c),o=l}})),kr(i,a)})),i},e.prototype.canAppendAtCursor=function(e){return e>1&&this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e&&e.parentNode){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var r=new gr(n);return r.appendItem(e,0),r}return null},e.prototype.commit=function(e,t){for(var n=this.getLists(),r=0,o=0;o<n.length;o++){var i=n[o];t||(i.start>1?i.start=i.start===r?r+1:i.start:i.start=r+1);var a=new gr(i);r=a.getLastItemNumber()||0,delete i.dataset[Ir],delete i.dataset[Lr],a.writeBack(e)}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new gr(e).getLastItemNumber()||0,t?e.dataset[Lr]="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset[Ir]=this.name},e.prototype.getLists=function(){var e=this;return gn(this.region.rootNode,"ol[data-"+Ir+"="+this.name+"]").filter((function(t){return wr(e.region,t)}))},e}();function Br(){return"__List_Chain_"+Nr++}var Mr=((xr={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},xr);function Pr(e,t,n){var r=[];if(e&&t){var o=Mr[n],i=o.innerSelector,a=o.skipTags,l=function(e,t,n){var r=[{innerNode:e,children:[]}],o=Mr[n],i=o.outerSelector,a=o.innerSelector,l=gn(e,i,null,2,t);return gn(e,a,(function(t){var n=J(t,e,i);if(n&&l.indexOf(n)<0){for(var o={innerNode:t,children:[]},a=r.length-1;a>=0;a--){var s=r[a],u=s.innerNode,c=s.children;if(P(u,n)){var d=c.filter((function(e){return e.outerNode==n}))[0];d||(d={outerNode:n,boundaries:[]},c.push(d)),d.boundaries.push(o);break}}r.push(o)}}),1,t),r[0]}(e,t,n),s=J(t.startContainer,e,i)||e,u=J(t.endContainer,e,i)||e,c=function(e,t){var n=X.getStart(e).normalize(),r=X.getEnd(e).normalize();return function(e,o,i){return function(e,t,n,r){if(e){var o=t&&Oe(e,t,r),i=n&&_e(e,n,r),a=!t||P(e,t)&&P(e,o),l=!n||P(e,n)&&P(e,i),s=!(t&&n&&(P(t,n,!0)||P(t,i,!0)||P(n,t,!0)||P(n,o,!0)));return a&&l&&s}return!1}(e,o,i,t)?{rootNode:e,nodeBefore:o,nodeAfter:i,skipTags:t,fullSelectionStart:n,fullSelectionEnd:r}:null}}(t,a);r=p(Or(c,l,s,u),1)[0]}return r.filter((function(e){return!!e}))}function Or(e,t,n,r,o){var i;o=o||t.innerNode==n;var a=!1,l=t.children,s=t.innerNode,u=[];if(0==l.length)(d=e(s))&&u.push(d);else for(var c=0;c<=l.length&&!a;c++){var d,f=l[c]||{},h=f.outerNode,v=f.boundaries,g=null===(i=l[c-1])||void 0===i?void 0:i.outerNode;if(o)(d=e(s,g,h))&&u.push(d);null==v||v.forEach((function(t){var i,l;l=(i=p(Or(e,t,n,r,o),3))[0],o=i[1],a=i[2],u=u.concat(l)}))}return[u,o,a||s==r]}function _r(e,t){if(!t||0==t.length)return[];var n=M(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],r=(n=n&&n.filter((function(t){return wr(e,t)})))[0],o=n[n.length-1];return wr(e,r)&&wr(e,o)?U(e.rootNode,r,o,!0):[]}function Fr(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&P(t,n)&&Hr(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1}function Hr(e){for(;e.previousSibling;)if("BR"==j(e=e.previousSibling)||!un(e))return!1;return!0}function Ur(e,t){return t?{start:zr(X.getStart(t),e),end:zr(X.getEnd(t),e)}:null}function zr(e,t){var n,r;if(!e||!t)return[];var o,i=e.node,a=e.offset,l=[];if(!P(t,i,!0))return[];if(3==i.nodeType){for(o=i.parentNode;i.previousSibling&&3==i.previousSibling.nodeType;)a+=(null===(n=i.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,i=i.previousSibling;l.unshift(a)}else o=i,i=i.childNodes[a];do{a=0;for(var s=!1,u=(null==o?void 0:o.firstChild)||null;u&&u!=i;u=u.nextSibling){if(3==u.nodeType){if(0===(null===(r=u.nodeValue)||void 0===r?void 0:r.length)||s)continue;s=!0}else s=!1;a++}l.unshift(a),i=o,o=(null==o?void 0:o.parentNode)||null}while(i&&i!=t);return l}function jr(e,t){if(!e)return"";var n=function(e){if(M(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}(e),r=t&&Ur(e,t);return r?n+"\x3c!--"+JSON.stringify(r)+"--\x3e":n}var Qr,Kr,Vr,Wr,qr,Gr=(Qr=bn(),{type:3,isOptional:Kr,itemDef:Qr,minLength:Vr,maxLength:Wr,allowNull:qr}),Yr=wn({x:bn(),y:bn()}),Jr=En(!0),Xr=wn({type:bn(!0,0),isDarkMode:Jr,start:Gr,end:Gr}),Zr=wn({type:bn(!1,1),isDarkMode:Jr,tableId:Cn(),firstCell:Yr,lastCell:Yr}),$r=wn({type:bn(!1,2),isDarkMode:Jr,imageId:Cn()});function eo(e){var t=e.lastChild;if(M(t,"Comment"))try{var n=JSON.parse(t.nodeValue||"");if(Sn(n,Xr)||Sn(n,Zr)||Sn(n,$r))return e.removeChild(t),n.type=void 0===n.type?0:n.type,n.isDarkMode=n.isDarkMode||!1,n}catch(e){}}function to(e,t){var n,r,o,i=null===(o=null===(r=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===r?void 0:r.defaultView)||void 0===o?void 0:o.getSelection();if(i){var a=!0;if(i.rangeCount>0)try{var l=null;(t||ye.isEdge)&&(l=1==i.rangeCount?i.getRangeAt(0):null)&&l.startContainer==e.startContainer&&l.startOffset==e.startOffset&&l.endContainer==e.endContainer&&l.endOffset==e.endOffset?a=!1:i.removeAllRanges()}catch(e){}a&&i.addRange(e)}}function no(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}function ro(e,t){if(t=t||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},no(e,1)){for(var n=0,r=e.currentIndex+1;r<e.snapshots.length;r++)n+=t(e.snapshots[r]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}function oo(e,t,n){!function(e,t,n,r,o){r=r||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},o=o||ao;var i=e.snapshots[e.currentIndex],a=i&&o(i,t);if(e.currentIndex<0||!i||!a){ro(e,r),e.snapshots.push(t),e.currentIndex++,e.totalSize+=r(t);for(var l=0;l<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=r(e.snapshots[l]),l++;l>0&&(e.snapshots.splice(0,l),e.currentIndex-=l,e.autoCompleteIndex-=l),n&&(e.autoCompleteIndex=e.currentIndex)}else a&&e.snapshots.splice(e.currentIndex,1,t)}(e,t,n,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}),io)}function io(e,t){return e.html==t.html&&!e.entityStates&&!t.entityStates}function ao(e,t){return e==t}function lo(e,t,n){if(e[t]){var r=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,g([],p(e),!1)),n.apply(void 0,g([],p(e),!1))}}else e[t]=n}var so="contenteditable";function uo(e){var t,n=!1,r="",o="",i=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?r=e.substr(7):0==e.indexOf("_EId_")?o=e.substr(5):0==e.indexOf("_EReadonly_")&&(i="1"==e.substr(11))})),n?{wrapper:e,id:o,type:r,isReadonly:i}:null}function co(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}function fo(e,t,n,r){for(var o=t.firstChild,i=co(),a=e.firstChild;a;){var l=a.nextSibling,s=ho(n,a);if(s)(o=po(o,s))?o=o.nextSibling:t.appendChild(s);else{var u=r?a.cloneNode(!0):a;t.insertBefore(u,o),M(u,"HTMLElement")&&u.querySelectorAll(i).forEach((function(e){var t,r=ho(n,e);r&&(null===(t=e.parentNode)||void 0===t||t.replaceChild(r,e))}))}a=l}po(o)}function po(e,t){for(var n;e&&(!t||e!=t);){var r=e;e=e.nextSibling,null===(n=r.parentNode)||void 0===n||n.removeChild(r)}return e}function ho(e,t){var n,r=M(t,"HTMLElement")&&t.classList.contains("_Entity")&&(null===(n=uo(t))||void 0===n?void 0:n.id),o=r?null==e?void 0:e[r]:null;return o?M(o,"HTMLElement")?o:(null==o?void 0:o.canPersist)?o.element:null:null}function vo(e,t){return t[e.id]=e.wrapper,e.wrapper.cloneNode(!0)}function go(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}var mo="Control",Ao="Alt",yo="Meta";function bo(e){return!function(e){var t=e.ctrlKey||e.key===mo,n=e.altKey||e.key===Ao,r=e.metaKey||e.key===yo;return t||n||r}(e)&&!!e.key&&1==e.key.length}var Eo=ye.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};function Co(e){return Eo(e)}function wo(e,t){var n=Rt(e),r=0;t.forEach((function(e){var t;if((null===(t=n[e])||void 0===t?void 0:t.indexOf("!important"))>-1){var o=n[e].indexOf("!");n[e]=n[e].substring(0,o),r++}})),r>0&&Bt(e,n)}function So(e,t,n){var r;if(t){var o=e.getElementById(n);o||((o=e.createElement("style")).id=n,e.head.appendChild(o)),null===(r=o.sheet)||void 0===r||r.insertRule(t)}}function To(e,t){var n,r=e.getElementById(t);r&&(null===(n=r.parentNode)||void 0===n||n.removeChild(r))}function Do(e,t){var n=t.getAttribute("style");if(n){e.setAttribute("style",n);var o=Nn(t);o&&Rn(e,r({},o))}}var ko="[contenteditable=false]",xo=[function(e,t,n,r){var o,i,a=Te(e,n.node);if(a){var l=gn(e,"a[href]",null,1,ee(n)).filter((function(e){return a.contains(e)}))[0];if(l&&un(l)&&(n=new X(l,-2),Io(l),l=null),l&&(null===(o=t)||void 0===o?void 0:o.querySelector)&&(null===(i=t)||void 0===i?void 0:i.querySelector("a[href]"))){var s=n.normalize(),u=s.node.parentNode,c=3==s.node.nodeType?xe(s.node,s.offset,!1):s.isAtEnd?s.node.nextSibling:s.node,d=e.ownerDocument.createTextNode("");for(u.insertBefore(d,c);d&&P(l,d);)d=F(d);d&&(n=new X(d,-2),Io(d))}}return n},function(e,t,n,r){var o=t,i=!1;if(11==o.nodeType){i=!0;var a=H(o.childNodes).filter((function(e){return"BR"!=j(e)}));o=1==a.length?a[0]:null}var l=j(o),s=l&&o&&"BR"==j(o.nextSibling),u=J(n.node,e,"LI"),c=u&&J(u,e,"OL,UL"),d=J(n.node,e,"TD,TH");"LI"==l&&(o=Ce(o,l=c?j(c):"UL"));if(("OL"==l||"UL"==l)&&o&&"LI"==j(o.firstChild)){var f=!o.firstChild.nextSibling&&!s;s&&o.parentNode&&Io(o.nextSibling),f?(An(o.firstChild),An(o)):j(c)==l&&(An(o),n=new X(u,Fr(n,u)?-2:-3))}i&&"TABLE"==l&&d&&(!function(e,t,n,r){var o,i,a,l,s=new Vn(t),u=new Vn(e),c=u.row,d=u.col,f=null!==(i=c+(null===(o=s.cells)||void 0===o?void 0:o.length))&&void 0!==i?i:0,p=null!==(l=d+(null===(a=s.cells)||void 0===a?void 0:a[0].length))&&void 0!==l?l:0;for(u.row=u.cells.length-1;u.cells.length<f;)u.edit(1);for(u.col=u.cells[0].length-1;u.cells[0].length<p;)u.edit(3);for(var h=c;h<f;h++)for(var v=d;v<p;v++){var g=u.getCell(h,v),m=s.getTd(h-c,v-d);g.td&&m?(xt(g.td,m),Do(g.td,m)):g.td=document.createElement("td")}u.writeBack()}(d,o),n=new X(o,0),xt(t));return n},function(e,t,n,r){if("P"==j(n.node)){var o=n.normalize(),i=It(n.node,"div");o.node!=i&&(n=o)}return n},function(e,t,n,r){G(n.node)&&(n=new X(n.node,n.isAtEnd?-3:-2));return n},function(e,t,n,r){if(r&&r.collapsed){var o=new ot(e,X.getStart(r)),i=o.getInlineElementBefore(),a=o.getInlineElementAfter();i instanceof Qe?n=new X(i.getContainerNode(),-3):a instanceof Qe&&(n=new X(a.getContainerNode(),-2))}return n},function e(t,n,r,o){var i;if(!(null===(i=r.element)||void 0===i?void 0:i.isContentEditable)){for(var a=void 0,l=J(r.node,t,ko);l;)l=(null==(a=l)?void 0:a.parentElement)?J(a.parentElement,t,ko):null;if(a)return r=new X(a,-3),e(t,n,r)}return r},function(e,t,n,r){if(1==t.childNodes.length&&"TABLE"==j(t.childNodes[0])||"TABLE"==j(t)){var o=n.element,i=ee(new X(o,-2),n),a=nt.createSelectionTraverser(e,i),l=a&&a.currentBlockElement;if(l){for(var s=l;!s;)(s=a.getNextBlockElement())&&(l=s);var u=null==l?void 0:l.getEndNode();if(u&&J(u,e,"TABLE")){var c=ee(n);c.collapse(!1);var d=e.ownerDocument.createElement("br");c.insertNode(d),c=ee(d),n=X.getEnd(c)}}}return n}];function Io(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}function Lo(e,t){var n=null,o=gn(e,"table,tr",null,2,t),i=Pr(e,t,0).map((function(e){var t=Er(e);if(!t)return null;var r=t.startContainer,i=t.endContainer,a=t.startOffset,l=t.endOffset,s=t.commonAncestorContainer;if(M(s,"HTMLElement")&&!s.isContentEditable)return null;var u=p(No(i,l,!1),2),c=u[0],d=u[1],f=p(No(r,a,!0),2),h=f[0],v=f[1];n=n||h;var g=_r(e,[v,c]);return kr(o,g),{region:e,beforeStart:h,afterEnd:d}})).filter((function(e){return!!e}));return o.forEach((function(e){var t;return(null===(t=e.parentElement)||void 0===t?void 0:t.isContentEditable)&&e.parentElement.removeChild(e)})),i.forEach((function(e){e&&function(e,t,n){var o,i,a,l;if(wr(e,t)&&wr(e,n)&&(l=Te(e.rootNode,n))&&!l.contains(t)){for(var s=l.collapseToSingleElement(),u=z(e.rootNode,s,t,!1,!0),c=s;P(u,c);){var d=c.parentNode;M(d,"HTMLElement")&&Bt(s,r(r(r({},Nt(d)||{}),Rt(d)),Rt(s))),c=d}var f=null,p=1==s.childNodes.length&&0==s.attributes.length?s.firstChild:It(s,"SPAN");for(c=p;P(u,c)&&1==(null===(o=c.parentNode)||void 0===o?void 0:o.childNodes.length);c=c.parentNode)f=c.parentNode;null===(i=t.parentNode)||void 0===i||i.insertBefore(p,t.nextSibling),null===(a=null==f?void 0:f.parentNode)||void 0===a||a.removeChild(f)}}(e.region,e.beforeStart,e.afterEnd)})),n&&new X(n,-1)}function No(e,t,n){var r,o;if(M(e,"Text")){var i=xe(e,t,n);return n?[i,e]:[e,i]}var a=e.childNodes[t-1],l=e.childNodes[t];if(a||l||(n?a=(l=e).previousSibling:l=(a=e).nextSibling),(a||l)&&(!a||!l)){var s=e.ownerDocument.createTextNode("");null===(o=null===(r=a||l)||void 0===r?void 0:r.parentNode)||void 0===o||o.insertBefore(s,l),a?l=s:a=s}return[a,l]}var Ro='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,'+["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return'table div[class^="'+e+'"]'})).join(","),Bo="ProgId",Mo="xmlns:x",Po=new Map([[0,function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t[Bo]}],[1,function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes[Mo]}],[2,function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t[Bo]&&null==t[Mo]}],[3,function(e){return"PowerPoint.Slide"==e.htmlAttributes[Bo]}],[5,function(e){return!!e.fragment.querySelector(Ro)}],[4,function(e){return!!e.fragment.querySelector("google-sheets-html-origin")}],[7,function(e){var t,n=e.shouldConvertSingleImage,r=e.clipboardData;return n&&1==(null===(t=r.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==r.htmlFirstLevelChildTags[0]}]]);function Oo(e,t,n){e.focus();var r=e.getSelectionRangeEx(),o=function(e,n){return e.isContentEditable&&t(e,n)};if(r&&r.areAllCollapsed){var i=r.ranges[0].startContainer;"SPAN"==j(i)&&(!i.firstChild||"BR"==j(i.firstChild)&&!i.firstChild.nextSibling)?(e.addUndoSnapshot(),o(i)):(e.triggerPluginEvent(13,{formatState:{},formatCallback:t}),e.triggerContentChangedEvent("Format"))}else B(e,(function(){var t,n;r.ranges.forEach((function(r){var i=e.getSelectionTraverser(r);if(i)for(var a=i&&i.currentInlineElement;a;){var l=i.getNextInlineElement();a.applyStyle((function(e,r){o(e,r),t=t||e,n=e})),a=l}})),t&&n&&0==r.type&&e.select(t,-2,n,-3)}),n)}var _o=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],Fo=1,Ho=1e3;function Uo(e,t,n){void 0===n&&(n=_o);var r=0==t?1:-1;Oo(e,(function(e){var t=parseFloat(Le(e,"font-size")||e.style.fontSize);e.style.fontSize=function(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,Fo);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),Ho);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}(t,r,n)+"pt";var o=Le(e,"line-height");o&&"normal"!=o&&(e.style.lineHeight="normal")}),"changeFontSize")}function zo(e,t,n,r){var o=[];Oo(e,(function(t,r){n(t,r);var i=e.getElementAtCursor("LI",t);i&&-1===o.indexOf(i)&&o.push(i)}),r),function(e,t){e.forEach((function(e){M(e,"HTMLLIElement")&&$n(e,t)}))}(o,[t])}function jo(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),r=n&&X.getStart(n),o=n&&X.getEnd(n),i=e.isFeatureEnabled("ReuseAllAncestorListElements"),a=e.isFeatureEnabled("DisableListChain");t.forEach((function(e){return e.commit(i,a)})),r&&o&&e.select(r,o)}}function Qo(e,t,n,r){e.focus();var o=e.getSelectionRangeEx();B(e,(function(r,i){if(!n||n()){var a=e.getSelectedRegions();if(a.length>0){var l=Rr.createListChains(a,null==r?void 0:r.node);a.forEach((function(e){return t(e,r,i,l)})),jo(e,l)}}0==o.type&&r&&i?e.select(r,i):e.select(o)}),r)}function Ko(e,t,n){e.focus();var r=function(){return e.getDocument().execCommand(t,!1,void 0)},o=e.getSelectionRangeEx();if(o&&o.areAllCollapsed){e.addUndoSnapshot();var i=e.getPendableFormatState(!1);r();var a=oe(on).filter((function(e){return on[e]==t}))[0];a&&(i[a]=!i[a],e.triggerPluginEvent(13,{formatState:i}))}else B(e,(function(){var t=0!=o.type;o.ranges.forEach((function(n){t&&e.select(n),r()})),t&&e.select(o)}),n)}function Vo(e,t){Oo(e,(function(n,r){nn(n,r?"":t,!0,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setBackgroundColor")}function Wo(e,t,n){zo(e,"color",(function(r,o){n&&!n(r)||nn(r,o?"":t,!1,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setTextColor")}function qo(e){Ko(e,"bold","toggleBold")}function Go(e){Ko(e,"italic","toggleItalic")}function Yo(e){Ko(e,"underline","toggleUnderline")}var Jo=["font","text-decoration","color","background"],Xo="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),Zo=["href","src","cellpadding","cellspacing"],$o=["TD","TH","TR","TABLE","TBODY","THEAD"];function ei(e){var t=H(e.childNodes).map(ei).every((function(e){return e})),n=V(e),r=j(e);return r&&(Xo.indexOf(r)>=0||t&&!G(e)&&$o.indexOf(r)<0?(n&&!t&&Ce(e),An(e)):function(e){var t,n,r=M(e,"HTMLTableCellElement"),o=M(e,"HTMLTableElement");try{for(var i=f(H(e.attributes)),a=i.next();!a.done;a=i.next()){var l=a.value;r&&"style"==l.name?ni(e):o&&"style"==l.name?ri(e):Zo.indexOf(l.name.toLowerCase())<0&&0!=l.name.indexOf("data-")&&e.removeAttribute(l.name)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}(e)),n}function ti(e,t){var n=Rt(e),r={};return oe(n).forEach((function(e){return t(e,n,r)})),Bt(e,n),r}function ni(e){return ti(e,(function(e,t,n){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])}))}function ri(e){return ti(e,(function(e,t,n){"border-collapse"!=e&&(n[e]=t[e],delete t[e])}))}function oi(e){var t=function(e){var t=e.getSelectionTraverser();return!!(null==t?void 0:t.currentBlockElement)&&!!(null==t?void 0:t.getNextBlockElement())}(e);if(!t){var n=e.getSelectionTraverser(),r=null==n?void 0:n.currentInlineElement,o=r instanceof Xe||r instanceof ze&&!function(e,t){for(var n,r=e,o=function(){if(r.nextSibling||r.previousSibling){if(M(r,"HTMLLIElement"))return{value:!0};var e=!0;return null===(n=r.parentNode)||void 0===n||n.childNodes.forEach((function(t){var n;t!=r&&(null===(n=t.textContent)||void 0===n?void 0:n.length)&&(e=!1)})),{value:e}}r=r.parentNode};r&&t.contains(r.parentNode);){var i=o();if("object"==typeof i)return i.value}return!0}(r.getContainerNode(),e);if(o)return void si(e)}ii(e)}function ii(e){B(e,(function(){Qo(e,(function(t){var n=_r(t,Cr(t));if(e.contains(t.rootNode)){var r=ni(t.rootNode);if(oe(r).length>0)Bt(Ce(H(t.rootNode.childNodes)),r)}for(;n.length>0&&n[0].parentNode&&wr(t,n[0].parentNode);){var o=F(n);n=o?[o]:[]}n.forEach(ei)})),ai(e)}),"clearBlockFormat")}function ai(e){var t=e.getDefaultFormat(),n=0===oe(t).length;if(e.queryElements("[style]",2,(function(e){var t=j(e);-1==$o.indexOf(t)?li(t,e,n):e.childNodes.forEach((function(e){e.childNodes.forEach((function(e){var t=j(e);M(e,"HTMLElement")&&li(t,e,n)}))}))})),!n){if(t.fontFamily&&function(e,t){zo(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}),"setFontName")}(e,t.fontFamily),t.fontSize&&function(e,t){zo(e,"font-size",(function(e,n){e.style.fontSize=n?"":t;var r=Le(e,"line-height");r&&"normal"!=r&&(e.style.lineHeight="normal")}),"setFontSize")}(e,t.fontSize),t.textColor){var r=e.queryElements("a *, a",1),o=r.length>0?function(e){return-1==r.indexOf(e)}:void 0;t.textColors?Wo(e,t.textColors,o):Wo(e,t.textColor,o)}t.backgroundColor&&(t.backgroundColors?Vo(e,t.backgroundColors):Vo(e,t.backgroundColor)),t.bold?qo(e):function(e,t){void 0===t&&(t="400"),zo(e,"font-weight",(function(e){return e.style.fontWeight=t}),"setDefaultFontWeight")}(e),t.italic&&Go(e),t.underline&&Yo(e)}}function li(e,t,n){-1==$o.indexOf(e)&&(Jo.forEach((function(e){return t.style.removeProperty(e)})),n&&""===t.getAttribute("style")&&t.removeAttribute("style"))}function si(e,t){switch(void 0===t&&(t=0),t){case 0:!function(e){e.focus(),e.addUndoSnapshot((function(){return Ko(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")})),ai(e),"clearInlineFormat"}),"Format")}(e);break;case 1:ii(e);break;default:oi(e)}}var ui=/^[a-zA-Z]+:/i,ci=/^[\w.%+-]+@/i,di=/^ftp\./i;function fi(e,t,n,r,o){e.focus();var i=(function(e){var t=new Qt,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(i){var a=vn(i),l=a?a.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(ui)<0&&(t=0==e.search(ci)?"mailto:":0==e.search(di)?"ftp://":"http://"),t+e}(i),s=a?a.originalUrl:i;e.addUndoSnapshot((function(){var t=e.getSelectionRangeEx(),i=null;if(0===t.type){var a=t.ranges[0];if(a&&a.collapsed)(i=pi(e))?(i.href=l,hi(i,r)):((i=e.getDocument().createElement("A")).textContent=r||s,i.href=l,e.insertNode(i));else{e.getDocument().execCommand("createLink",!1,l);for(var u=e.getSelectionTraverser(),c=null==u?void 0:u.getNextInlineElement(),d=[];c;)d.push(c.getContainerNode()),c=null==u?void 0:u.getNextInlineElement();d.forEach((function(t){return e.deleteNode(t)})),hi(i=pi(e),r)}}else 2===t.type&&((i=Ce(t.image,"A")).href=l);return n&&i&&(i.title=n),i&&function(e,t){t?e.target=t:!t&&e.getAttribute("target")&&e.removeAttribute("target")}(i,o),i}),"CreateLink")}}function pi(e){return e.queryElements("a[href]",1)[0]}function hi(e,t){t&&e.textContent!=t&&(e.textContent=t)}function vi(e,t){return r(r(r(r(r({},e.getPendableFormatState(!1)),function(e,t){var n=j(e.getElementAtCursor("OL,UL",void 0,t)),r=e.getSelectionRange(),o=!1;if(r&&!r.collapsed){var i=e.getBlockElementAtNode(r.startContainer),a=e.getBlockElementAtNode(r.endContainer);o=!(!a||!i||a.equals(i))}var l=j(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",void 0,t)),s=e.queryElements("table",1)[0],u=s?jn(s):void 0,c=(null==s?void 0:s.rows[0])?H(s.rows[0].cells).every((function(e){return"TH"==j(e)})):void 0,d=l&&parseInt(l[1])||0;return{isBullet:"UL"==n,isNumbering:"OL"==n,isMultilineSelection:o,headingLevel:d,headerLevel:d,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0],isCodeInline:!!e.queryElements("code",1)[0],isCodeBlock:!!e.queryElements("pre>code",1)[0],isInTable:!!s,tableFormat:u||{},tableHasHeader:c,canMergeTableCell:gi(e)}}(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})}var gi=function(e){var t=e.getSelectionRangeEx();if(t&&1===t.type&&t.coordinates){var n=t.coordinates,r=n.firstCell,o=n.lastCell;return r.x!==o.x||r.y!==o.y}return!1};function mi(e,t,n){"string"==typeof t?Ai(e,t,n):ft(t,(function(t){t&&!e.isDisposed()&&Ai(e,t,n)}))}function Ai(e,t,n){B(e,(function(){var r=e.getDocument().createElement("img");r.src=t,n&&oe(n).forEach((function(e){return r.setAttribute(e,n[e])})),e.insertNode(r)}),"insertImage")}function yi(e,t){var n=e.getElementAtCursor("TD,TH");n&&B(e,(function(){var r=new Vn(n);if(function(e,t){var n,r=e.getSelectionRangeEx();r&&1===r.type&&(t.selection=null!==(n=r.coordinates)&&void 0!==n?n:null)}(e,r),r.edit(t),r.writeBack(!1,e.getDarkColorHandler()),e.transformToDarkColor(r.table),e.focus(),!bi(r.row)&&!bi(r.col)){var o=function(e,t,n){var r=t,o=n;switch(e){case 0:o=0;break;case 1:r+=1,o=0;break;case 2:r=0;break;case 3:r=0,o+=1}return{newRow:r,newCol:o}}(t,r.row,r.col),i=o.newCol,a=o.newRow,l=r.getCell(a,i).td;l&&e.select(l,0)}}),"editTable")}function bi(e){return null==e}function Ei(e){e.focus(),B(e,(function(t,n){e.queryElements("a[href]",1,An),t&&n&&e.select(t,n)}),"removeLink")}function Ci(e,t){if(M(e,"HTMLElement")){var n=e.style.textAlign,r=J(e,void 0,"blockquote");if(!r)return;var o="rtl"==Le(i=e,"direction")||"rtl"==i.getAttribute("dir");if(t){if(t.indexOf(r)>-1)return;t.push(r)}for(;r;)"center"==n?o?(r.style.removeProperty("marginInlineEnd"),r.style.marginInlineStart="auto"):(r.style.removeProperty("marginInlineStart"),r.style.marginInlineEnd="auto"):(r.style.removeProperty("marginInlineEnd"),r.style.removeProperty("marginInlineStart")),r=J(r.parentElement,void 0,"blockquote")}var i}function wi(e,t){B(e,(function(){var n=e.getSelectionRangeEx(),r=n&&1===n.type,o=e.getElementAtCursor();r&&n.coordinates&&Yn(new Vn(n.table),n.coordinates)?function(e,t){var n=e.table;1==t?(n.style.marginLeft="auto",n.style.marginRight="auto"):2==t?(n.style.marginLeft="auto",n.style.marginRight=""):(n.style.marginLeft="",n.style.marginRight="auto")}(n,t):o&&J(o,void 0,"LI")?function(e,t){Qo(e,(function(e,n,r){var o=Tr(e,!0,Cr(e)[0].getStartNode());n&&r&&(null==o||o.setAlignment(n,r,t))}),void 0,"alignList")}(e,t):function(e,t){var n="left",r="justifyLeft";1==t?(r="justifyCenter",n="center"):2==t&&(r="justifyRight",n="right");Ko(e,r);var o=e.queryElements("[align]",1,(function(e){e.style.textAlign=n,Ci(e)}));if(0==o.length){var i=e.getElementAtCursor();i&&Ci(i)}}(e,t)}),"setAlignment")}function Si(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(j(t.parentNode))>=0}function Ti(e,t){e.focus(),B(e,(function(n,r){!function(e,t){var n=e.getSelectionTraverser();if(n){for(var r=n.currentBlockElement,o=[];r;)Si(r)||o.push(r),r=n.getNextBlockElement();o.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}}(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),n&&r&&e.select(n,r)}),"setDirection")}function Di(e,t){var n=0==t?function(e,t){var n=_r(e,t);Ce(n,2);var r=[];n.forEach((function(e){return Ci(e,r)}))}:ki;Qo(e,(function(r,o,i){for(var a=Cr(r,!0),l=[[]],s=0;s<a.length;s++){var u=a[s].getStartNode(),c=Tr(r,!0,u);if(c){for(;a[s+1]&&c.contains(a[s+1].getStartNode());)s++;var d=e.isFeatureEnabled("TabKeyTextFeatures");if(d&&xi(c,u)&&Ii(t,e,u)){var f=e.getBlockElementAtNode(c.rootList);f&&l.push([f])}else o&&i&&(1==t?c.setIndentation(o,i,t,!1,d):c.setIndentation(o,i,t),c.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")),l.push([]))}else l[l.length-1].push(a[s])}l.forEach((function(e){return n(r,e)}))}),(function(){var n=e.getSelectionRangeEx();if(1==n.type&&n.coordinates&&Yn(new Vn(n.table),n.coordinates)){if(1==t){var r=e.getElementAtCursor("blockquote",n.table);r&&An(r)}else 0==t&&Ce(n.table,2);return!1}return!0}),"setIndentation")}function ki(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=J(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=Ce(H(n.childNodes)));n&&wr(e,n)&&"BLOCKQUOTE"!=j(n);)n=F(n);n&&wr(e,n)&&An(n)}}))}function xi(e,t){var n;return(null===(n=e.items[0])||void 0===n?void 0:n.getNode())==t&&e.getListItemIndex(t)==(e.getStart()||1)}function Ii(e,t,n){return 0==e||t.getElementAtCursor("blockquote",n)}function Li(e,t,n,r,o,i,a){void 0===n&&(n=0),void 0===r&&(r=!0),Qo(e,(function(a,l,s,u){var c,d,f=n>0&&u.filter((function(e){return e.canAppendAtCursor(n)}))[0],p=null===(d=Te(a.rootNode,null!==(c=null==l?void 0:l.node)&&void 0!==c?c:null))||void 0===d?void 0:d.collapseToSingleElement();if(p){var h=f&&s&&(null==l?void 0:l.equalTo(s))?f.createVListAtBlock(p,n):Tr(a,1!==n&&r);h&&l&&s&&(h.changeListType(l,s,t),h.setListStyleType(o,i),function(e){var t=null==e?void 0:e.rootList;if(t)return 0===t.childElementCount;return!1}(h)&&h.removeMargins(),h.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")))}}),void 0,a||"toggleListType")}function Ni(e,t,n){Li(e,2,void 0,!1,void 0,t,n)}function Ri(e,t,n,r){Li(e,1,t,void 0,n,void 0,r)}function Bi(e,t,n,r){Qo(e,(function(e){var n=_r(e,Cr(e,!0));if(n.length>0){if(1==n.length){var r=j(n[0]);"BR"==r?n=[Ce(n[0])]:"LI"!=r&&"TD"!=r||(n=H(n[0].childNodes))}for(;n[0]&&n[0].parentNode&&wr(e,n[0].parentNode)&&n.some((function(e){return"LI"==j(e)}));){var o=F(n);n=o?[o]:[]}t(n)}}),n,r)}var Mi=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};var Pi="code",Oi="pre>"+Pi;var _i=/[.+=\s:;"',>]+$/i,Fi=5,Hi={keys:[13,32,257],shouldHandleEvent:zi,handleEvent:function(e,t){var n=zi(e,t);if(!n)return;var r=t.getDocument().createElement("a"),o=t.getContentSearcherOfCursor();r.textContent=n.originalUrl,r.href=n.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return function(e,t,n,r,o){var i,a,l;if(!t||!n)return!1;if(l="string"==typeof t?null!==(a=null==(o=null!==(i=o||e.getContentSearcherOfCursor())&&void 0!==i?i:void 0)?void 0:o.getRangeFromText(t,r))&&void 0!==a?a:null:t){var s=e.getSelectionRange();return(null==s?void 0:s.collapsed)&&l.endContainer==s.startContainer&&l.endOffset==s.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:l}),!0}}(t,n.originalUrl,r,!1,null!=o?o:void 0),function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}(e),r}),"AutoLink",!0)}))}},Ui={keys:[8],shouldHandleEvent:function(e,t){var n=t.getContentSearcherOfCursor(e);return(null==n?void 0:n.getInlineElementBefore())instanceof Qe},handleEvent:function(e,t){e.rawEvent.preventDefault(),Ei(t)},defaultDisabled:!0};function zi(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?go(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data||null,r=vn(((null==n?void 0:n.text)||"").trim()),o=t.getContentSearcherOfCursor(e);if(r&&(null==o?void 0:o.getRangeFromText(r.originalUrl,!1)))return r;var i=o&&o.getWordBefore();if(i&&i.length>Fi){var a=(i.match(_i)||[])[0]||"",l=i.substring(0,i.length-a.length);return["()","{}","[]"].forEach((function(e){l[l.length-1]==e[1]&&l.indexOf(e[0])<0&&(l=l.substr(0,l.length-1))})),vn(l)}return null})):null}var ji={autoLink:Hi,unlinkWhenBackspaceAfterLink:Ui},Qi={keys:[13],shouldHandleEvent:function(e,t){var n=Vi(e,t);return n&&un(n)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){Wi(e,t)}),void 0,!0)}},Ki={keys:[8],shouldHandleEvent:function(e,t){var n=Vi(e,t);return n&&un(n)&&!n.previousSibling},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){return Wi(e,t)}))}};function Vi(e,t){return go(e,"CODE_CHILD",(function(){var e,n=null!==(e=t.getElementAtCursor("code"))&&void 0!==e?e:t.queryElements("code",1)[0];if(n){var r=t.getFocusedPosition(),o=r&&t.getBlockElementAtNode(r.normalize().node);if(o){var i=o.getStartNode()==n.parentNode?o.getStartNode():o.collapseToSingleElement();return un(i)?i:null}}return null}))}function Wi(e,t){var n=Vi(e,t);if(M(n,"HTMLElement")){var r=n.querySelector("code");if(r)An(r);else{var o=F(n);if(o&&An(o),M(n.parentElement,"HTMLPreElement")){var i=F(n);i&&An(i)}}t.select(n,0)}}var qi={removeCodeWhenEnterOnEmptyLine:Qi,removeCodeWhenBackspaceOnEmptyFirstLine:Ki},Gi={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var r,o=null;if(!(n&&(o=t.getSelectionRange())&&o.collapsed&&(r=X.getStart(o))&&t.isPositionAtBeginning(r)))return!1;var i="rtl"==Le(r.element,"direction"),a=e.rawEvent;return!i&&37==a.which||i&&39==a.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!ye.isChrome},Yi={noCycleCursorMove:Gi},Ji={keys:[13],shouldHandleEvent:function(e,t){return Zi(e,t)},handleEvent:function(e,t){Zi(e,t,1)}},Xi={keys:[27],shouldHandleEvent:function(e,t){return Zi(e,t)},handleEvent:function(e,t){Zi(e,t,3)}};function Zi(e,t,n){var r=go(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,r=n&&t.getElementAtCursor(co(),n);return r&&!r.isContentEditable?r:null}));if(r&&void 0!==n){var o=uo(r);o&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:o})}return r}var $i={keys:[13],shouldHandleEvent:function(e,t){return na(e,t,!0,!1)},handleEvent:function(e,t){var n,r,o;e.rawEvent.preventDefault();var i=t.getSelectionRange();if(i){var a=X.getEnd(i).normalize().node,l=t.getDocument().createElement("BR");null===(n=a.parentNode)||void 0===n||n.insertBefore(l,a.nextSibling);var s,u=t.getBlockElementAtNode(a);u&&(s=u.collapseToSingleElement(),null===(r=l.parentNode)||void 0===r||r.removeChild(l)),null===(o=t.getSelectionRange())||void 0===o||o.deleteContents(),(null==s?void 0:s.nextSibling)&&t.select(s.nextSibling,0)}}},ea={keys:[8],shouldHandleEvent:function(e,t){return na(e,t,!1,!0)},handleEvent:function(e,t){na(e,t,!1,!0,5)}},ta={keys:[46],shouldHandleEvent:function(e,t){return na(e,t,!0,!0)},handleEvent:function(e,t){na(e,t,!0,!0,4)}};function na(e,t,n,r,o){var i=go(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+r,(function(){var e,o=t.getSelectionRange();if(!o||r&&!o.collapsed)return null;var i=null===(e=t.getSelectedRegions()[0])||void 0===e?void 0:e.rootNode;o.commonAncestorContainer.normalize();var a=X.getEnd(o).normalize(),l=null;if((0==a.offset||a.isAtEnd)&&i){var s=nt.createBodyTraverser(i,a.node),u=n?0==a.offset?s.currentInlineElement:s.getNextInlineElement():a.isAtEnd?s.currentInlineElement:s.getPreviousInlineElement(),c=u&&u.getContainerNode();if(!r){var d=t.getBlockElementAtNode(a.node);(!d||c&&!d.contains(c))&&(c=null)}l=c&&t.getElementAtCursor(co(),c)}return l}));if(i&&void 0!==o){var a=uo(i);a&&ua(a,t,o,e)}return i}var ra={keys:[39,37],allowFunctionKeys:!0,shouldHandleEvent:function(e,t){if(e.rawEvent.altKey)return!1;var n=t.getElementAtCursor();return!!n&&ia(e,t,"rtl"===Le(n,"direction")==(37===e.rawEvent.which))},handleEvent:function(e,t){var n=ca(e),r=la(e,n);if(r){var o=da(r,n,t),i=o.delimiterPair,a=o.entity;i&&a&&Y(a,co())&&(e.rawEvent.preventDefault(),t.runAsync((function(){var r=n?e.rawEvent.shiftKey?-3:-1:-2,o=new X(i,r);if(e.rawEvent.shiftKey){var a=i.ownerDocument.getSelection();null==a||a.extend(o.node,o.offset)}else t.select(o)})))}}},oa={keys:[8,46],shouldHandleEvent:function(e,t){var n=t.getSelectionRange();if(!(null==n?void 0:n.collapsed))return!1;var r=46===e.rawEvent.which;if(ia(e,t,r)){var o=la(e,r);return!!sa(e,t,r,r?null==o?void 0:o.nextElementSibling:null==o?void 0:o.previousElementSibling)}return!1},handleEvent:function(e,t){var n=46===e.rawEvent.which;sa(e,t,n,null,n?4:5)}};function ia(e,t,n){var r,o=null===(r=t.getFocusedPosition())||void 0===r?void 0:r.normalize();if(ca(e,n),!o)return!1;var i=3==o.node.nodeType?o.node:o.node==o.element?o.element.childNodes.item(o.offset):o.element,a=n?{class:"entityDelimiterBefore",pairClass:"entityDelimiterAfter",isAtEndOrBeginning:o.isAtEnd}:{class:"entityDelimiterAfter",pairClass:"entityDelimiterBefore",isAtEndOrBeginning:0==o.offset},l=function(e,t,n){var r=aa(e,t);if(!r)return;var o=function(e){return n?e.getNextInlineElement():e.getPreviousInlineElement()},i=r.currentInlineElement;for(;i&&i.getContainerNode()===t;)i=o(r);return null==i?void 0:i.getContainerNode()}(t,i,n);if(a.isAtEndOrBeginning&&l){var s=t.getElementAtCursor("."+a.class,l);if(s&&u(s))return!0}return!!u(i&&t.getElementAtCursor("."+a.class,i));function u(r){if(!r)return!1;var o=da(r,n,t).delimiterPair;return o&&(o.className||"").indexOf(a.pairClass)>-1&&la(e,n,r)}}function aa(e,t){var n;if(t){var r=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();if(r&&V(r))return nt.createBodyTraverser(r,t)}}function la(e,t,n){return go(e,"delimiter_cache_key_"+t,(function(){return n}))}function sa(e,t,n,r,o){var i=go(e,"entity_delimiter_cache_key_"+n,(function(){return r&&t.getElementAtCursor(co(),r)}));if(i&&void 0!==o){var a=uo(i);a&&ua(a,t,o,e)}return i}function ua(e,t,n,r){var o=e.wrapper,i=o.nextElementSibling,a=o.previousElementSibling;t.triggerPluginEvent(15,{operation:n,rawEvent:r.rawEvent,entity:e}),e.isReadonly&&!V(e.wrapper)&&(r.rawEvent.defaultPrevented?t.runAsync((function(){if(t.contains(e.wrapper)){var n=p(ut(e.wrapper),1)[0];n&&t.select(n,-3)}else!function(e,t){[e,t].forEach((function(e){var t;at(e)&&(null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e))}))}(i,a)})):at(i)&&at(a)&&t.select(ee(a,i)))}function ca(e,t){return!!go(e,"Check_Before",(function(){return t}))}function da(e,t,n){var r=null,o=null,i=aa(n,e);if(!i)return{delimiterPair:o,entity:r};for(var a,l="."+(t?"entityDelimiterAfter":"entityDelimiterBefore"),s=function(e,t){var r,o=null==e?void 0:e.getContainerNode();return null!==(r=o&&n.getElementAtCursor(t,o))&&void 0!==r?r:null},u=co(),c=i.currentInlineElement;c&&(!r||!o);){if(r=r||s(c,u),o=o||s(c,l),r&&!o&&!s(c,u)){o=null;break}a=i,c=t?a.getNextInlineElement():a.getPreviousInlineElement()}return{entity:r,delimiterPair:o}}var fa={clickOnEntity:Ji,escapeFromEntity:Xi,enterBeforeReadonlyEntity:$i,backspaceAfterEntity:ea,deleteBeforeEntity:ta,moveBetweenDelimitersFeature:ra,removeEntityBetweenDelimiters:oa};var pa,ha,va,ga,ma,Aa,ya,ba,Ea={"*":1,"-":2,"--":3,"->":5,"--\x3e":8,"=>":6,">":4,"—":7};function Ca(e){var t=e.trim();return Ea[t]||null}!function(e){e[e.Decimal=1]="Decimal",e[e.LowerAlpha=2]="LowerAlpha",e[e.UpperAlpha=3]="UpperAlpha",e[e.LowerRoman=4]="LowerRoman",e[e.UpperRoman=5]="UpperRoman"}(ya||(ya={})),function(e){e[e.Dot=1]="Dot",e[e.Dash=2]="Dash",e[e.Parenthesis=3]="Parenthesis",e[e.DoubleParenthesis=4]="DoubleParenthesis"}(ba||(ba={}));var wa={".":1,"-":2,")":3},Sa=[13,16,15,14],Ta=[17,20,19,18],Da=["1","a","A","I","i"],ka=["i","v","x","l","c","d","m"],xa=["I","V","X","L","C","D","M"],Ia=((pa={})[1]=function(e){return Ma[e]||null},pa[2]=function(e){return Ba[e]||null},pa[3]=function(e){return Ra[e]||null},pa[4]=function(e){return Na[e]||null},pa[5]=function(e){return La[e]||null},pa),La=((ha={})[1]=17,ha[2]=20,ha[3]=18,ha[4]=19,ha),Na=((va={})[1]=13,va[2]=16,va[3]=14,va[4]=15,va),Ra=((ga={})[1]=9,ga[2]=12,ga[3]=10,ga[4]=11,ga),Ba=((ma={})[1]=5,ma[2]=8,ma[3]=6,ma[4]=7,ma),Ma=((Aa={})[1]=1,Aa[2]=2,Aa[3]=3,Aa[4]=4,Aa),Pa=function(e,t,n){var r=t?4:wa[e[e.length-1]];if(r){var o=function(e,t){if(!isNaN(parseInt(e)))return 1;if(/[a-z]+/g.test(e)){if(null!=t&&Sa.indexOf(t)>-1&&ka.indexOf(e[0])>-1||!t&&"i"===e)return 4;if(t||!t&&"a"===e)return 2}else if(/[A-Z]+/g.test(e)){if(null!=t&&Ta.indexOf(t)>-1&&xa.indexOf(e[0])>-1||!t&&"I"===e)return 5;if(t||!t&&"A"===e)return 3}}(t?e.slice(1,-1):e.slice(0,-1),n);return o?Ia[o](r):null}return null};function Oa(e,t,n){var r,o=e.trim(),i="("===o[0]&&")"===o[o.length-1],a=i?o.slice(1,-1):o.slice(0,-1),l=parseInt(a),s=isNaN(l)?function(e){var t=e.toLocaleLowerCase();if(t){var n=t.length-1;return 26*n+t.charCodeAt(n)-96}return null}(a):l;if(!s||s<1)return null;if(t&&s>1&&(t.length<1&&Da.indexOf(a)<0||(null==t?void 0:t.length)>0&&!(null===(r=t[t.length-1])||void 0===r?void 0:r.canAppendAtCursor(s))))return null;var u=function(e){return Number(e)||/^[A-Za-z\s]*$/.test(e)}(a)?Pa(o,i,n):null;return u}var _a="previousBlock",Fa="nextBlock",Ha=wn({orderedStyleType:bn(!0,void 0,1,20),unorderedStyleType:bn(!0,void 0,1,9)},!0,!0),Ua=function(e){return function(t,n){var r=t.rawEvent,o=r.keyCode,i=r.altKey,a=r.shiftKey,l=r.ctrlKey,s=r.metaKey;return!l&&!s&&(9===o?!i&&a===!e:a&&i&&o===(e?39:37))&&ol(t,n)}},za=function(e){return function(t,n){var r=null,o=9!==t.rawEvent.keyCode&&(r=n.getElementAtCursor())&&"rtl"==Le(r,"direction");n.addUndoSnapshot((function(){Di(n,o==e?1:0)}),"Format",!1,{getAnnounceData:function(){return function(e,t){if(M(t,"HTMLLIElement")){if(t&&M(e,"HTMLOListElement")){var n=new gr(e).getListItemIndex(t),r=-1==n?"":n.toString();switch(e.style.listStyleType){case"lower-alpha":case"lower-latin":case"upper-alpha":case"upper-latin":r=tr(n-1);break;case"lower-roman":case"upper-roman":r=ir(n)}return{defaultStrings:1,formatStrings:[r]}}return M(e,"HTMLUListElement")?{defaultStrings:2}:void 0}}(n.getElementAtCursor("OL,UL"),n.getElementAtCursor("LI"))}}),t.rawEvent.preventDefault()}},ja={keys:[9],shouldHandleEvent:Ua(!0),handleEvent:za(!0)},Qa={keys:[9],shouldHandleEvent:Ua(!1),handleEvent:za(!1),allowFunctionKeys:!0},Ka={keys:[39],shouldHandleEvent:Ua(!0),handleEvent:za(!0),allowFunctionKeys:!0,defaultDisabled:ye.isMac},Va={keys:[37],shouldHandleEvent:Ua(!1),handleEvent:za(!1),allowFunctionKeys:!0,defaultDisabled:ye.isMac},Wa={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&Fr(X.getStart(r),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);(null==n?void 0:n.previousSibling)?Qo(t,(function(r,o,i){var a=Tr(r,!1,null!=n?n:void 0);a&&o&&i&&(a.setIndentation(o,i,1,!0),a.writeBack(t.isFeatureEnabled("ReuseAllAncestorListElements"),t.isFeatureEnabled("DisableListChain")),e.rawEvent.preventDefault())})):rl(e,t)},defaultDisabled:!0},qa={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return n&&un(n)&&!n.previousSibling&&!n.getElementsByTagName("blockquote").length},handleEvent:rl},Ga={keys:[46],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),r=t.getSelectionRange();if(n||!r)return!1;var o=X.getEnd(r).isAtEnd?function(e,t){var n=go(e,"nextSibling",(function(){var e,n=t.getSelectionRange(),r=n&&X.getEnd(n).normalize(),o=r&&t.getBodyTraverser(r.node);return null===(e=null==o?void 0:o.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}));return n}(e,t):void 0;return t.getElementAtCursor("LI",o,e)},handleEvent:function(e,t){var n=tl(t);t.runAsync((function(e){return jo(e,n)}))}},Ya={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return!e.rawEvent.shiftKey&&n&&un(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return rl(e,t,!1)}),void 0,!0)},defaultDisabled:!ye.isIE&&!ye.isChrome},Ja={keys:[32],shouldHandleEvent:function(e,t){return!ol(e,t)&&il(e,t,Ca,2)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n=t.getContentSearcherOfCursor();if(n){var r=n.getSubStringBefore(5),o=n.getRangeFromText(r,!0),i=Ca(r);o&&(nl(t,o),Ni(t,null!=i?i:void 0,"autoToggleList")),null===(e=n.getRangeFromText(r,!0))||void 0===e||e.deleteContents()}}),void 0,!0)}},Xa={keys:[32],shouldHandleEvent:function(e,t){return!ol(e,t)&&il(e,t,Oa,1)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,r=t.getContentSearcherOfCursor();if(r){var o=r.getSubStringBefore(5),i=r.getRangeFromText(o,!0);if(i){var a=el(o)?1:parseInt(o),l=Za(t,i),s=null!==(e=Oa(o))&&void 0!==e?e:void 0;nl(t,i),Ri(t,l&&1!==a?void 0:a,s,"autoToggleList")}null===(n=r.getRangeFromText(o,!0))||void 0===n||n.deleteContents()}}),void 0,!0)}},Za=function(e,t){var n,r=e.getBodyTraverser(null==t?void 0:t.startContainer).getPreviousBlockElement(),o=null!==(n=null==r?void 0:r.getEndNode())&&void 0!==n?n:null;return"LI"===j(o)?o:void 0},$a=function(e,t,n){var r=1===n?"orderedStyleType":"unorderedStyleType",o=Za(e,t),i=o?J(o,void 0,1===n?"ol":"ul"):null,a=i?Dn(i,Ha):null;return a?a[r]:null},el=function(e){var t=parseInt(e);if(t&&1===t)return 1;var n=e.replace(/\(|\)|\-|\./g,"").trim();return 1===n.length&&["i","a","I","A"].indexOf(n)>-1?1:void 0};function tl(e){return Rr.createListChains(e.getSelectedRegions())}function nl(e,t){var n,r=e.getBlockElementAtNode(t.startContainer),o=null==r?void 0:r.getEndNode();if(o&&"BR"!=j(o)){var i=e.getDocument().createElement("BR");V(o)?o.appendChild(i):null===(n=o.parentNode)||void 0===n||n.insertBefore(i,o.nextSibling),e.select(t.startContainer,t.startOffset)}}function rl(e,t,n){void 0===n&&(n=!0);var r=ol(e,t);if(r){var o=j(r[0]);"UL"!=o&&"OL"!=o||Li(t,"UL"==o?2:1,void 0,n),t.focus(),e.rawEvent.preventDefault()}}function ol(e,t){var n=t.getElementAtCursor("LI,TABLE",void 0,e),r=n&&"LI"==j(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}function il(e,t,n,r){var o=t.getContentSearcherOfCursor(e);if(!o)return!1;var i=o.getSubStringBefore(4),a=t.getBlockTraverser(),l=a&&a.currentBlockElement?a.currentBlockElement.getTextContent().slice(0,i.length):null,s=l&&l===i,u=tl(t),c=o.getRangeFromText(i,!0),d=c&&$a(t,c,r),f=el(i),p=n(i,u,null!=d?d:void 0),h=f||!d||d===p||2===r;return s&&!o.getNearestNonTextInlineElement()&&p&&h}var al={keys:[8],shouldHandleEvent:function(e,t){var n,r,o=t.getElementAtCursor();if(o){var i=null===(n=t.getBlockElementAtNode(o))||void 0===n?void 0:n.getStartNode(),a=null!==(r=null==i?void 0:i.previousElementSibling)&&void 0!==r?r:null;if(sl(a)){var l=t.getSelectionRange(),s=t.getContentSearcherOfCursor(e),u=null==s?void 0:s.getSubStringBefore(4),c=null==s?void 0:s.getNearestNonTextInlineElement();if(l&&l.collapsed&&""===u&&!c){var d=null==i?void 0:i.nextElementSibling,f=sl(d)?d:null==d?void 0:d.firstChild;if(sl(f)&&j(a)==j(f)){var p=go(e,_a,(function(){return a})),h=go(e,Fa,(function(){return f}));return!!p&&!!h}}}}return!1},handleEvent:function(e,t){t.runAsync((function(t){var n=go(e,_a,(function(){return null})),r=go(e,Fa,(function(){return null})),o=t.getSelectionRange();if(n&&r&&o){var i=new gr(n);i.mergeVList(new gr(r));var a=t.getDocument().createElement("span");a.id="restoreRange",o.insertNode(a),i.writeBack(),(a=t.queryElements("#restoreRange")[0]).parentElement&&(t.select(new X(a,-3)),a.parentElement.removeChild(a))}}))}},ll={autoBullet:{keys:[32],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){},defaultDisabled:!0},indentWhenTab:ja,outdentWhenShiftTab:Qa,outdentWhenBackspaceOnEmptyFirstLine:qa,outdentWhenEnterOnEmptyLine:Ya,mergeInNewLineWhenBackspaceOnFirstChar:Wa,maintainListChain:{keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).filter((function(e){return!e.getElementsByTagName("blockquote").length})).length>0},handleEvent:function(e,t){var n=tl(t);t.runAsync((function(e){return jo(e,n)}))}},maintainListChainWhenDelete:Ga,autoNumberingList:Xa,autoBulletList:Ja,mergeListOnBackspaceAfterList:al,outdentWhenAltShiftLeft:Va,indentWhenAltShiftRight:Ka};function sl(e){return!!e&&(M(e,"HTMLOListElement")||M(e,"HTMLUListElement"))}var ul="​";function cl(e,t,n,r){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===r&&!!dl(e,n,t)},handleEvent:function(e,r){r.runAsync((function(r){!function(e,t,n,r){t.addUndoSnapshot((function(){var o=dl(e,t,n);if(o){var i=new X(o.endContainer,-1),a=o.endOffset+1<=i.offset;if(o&&a){var l=o.cloneRange();l.setStart(l.startContainer,l.startOffset+1);var s=l.extractContents().textContent,u=Ce(t.getDocument().createTextNode(null!=s?s:""),r);o.setEnd(o.endContainer,o.endOffset+1),o.deleteContents();var c=t.getDocument().createTextNode(ul);o.insertNode(c),o.insertNode(u),t.select(c,-1)}}}),"Format",!0)}(e,r,t,n)}))}}}function dl(e,t,n){return go(e,"MARKDOWN_RANGE",(function(){var r=t.getContentSearcherOfCursor(e),o=null,i=null;return null==r||r.forEachTextInlineElement((function(e){if(i&&o)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;var r=e.getParentBlock().getTextContent();if(r[r.length-1].trim()===n)return!1;if(i||(i=e.getStartPosition().move(t.length)),t[0]==n)o=e.getStartPosition();else for(var a=t.length-1;a>0;a--){if(o)return!0;if(t[a]==n&&0==t[a-1].trim().length)return o=e.getStartPosition().move(a),!0}})),o&&i&&ee(o,i)}))}var fl={markdownBold:cl(56,"*","b",!0),markdownItalic:cl(189,"_","i",!0),markdownStrikethru:cl(192,"~","s",!0),markdownInlineCode:cl(192,"`","code",!1)},pl="BLOCKQUOTE",hl=[pl,"LI","TD","TH"].join(","),vl={keys:[8],shouldHandleEvent:function(e,t){var n=ml(e,t);return n&&un(n)&&!n.previousSibling},handleEvent:Al},gl={keys:[13],shouldHandleEvent:function(e,t){var n=ml(e,t);return!e.rawEvent.shiftKey&&n&&un(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return Al(e,t)}),void 0,!0)}};function ml(e,t){return go(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(hl);if(e&&j(e)==pl){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var o=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return un(o)?o:null}}return null}))}function Al(e,t){t.addUndoSnapshot((function(){var n=ml(e,t);if(n){j(n)==pl&&(n=Ce(H(n.childNodes)));var r=F(n),o=!!r&&yl(r),i=r&&An(r);t.select(n,0),o&&(M(i,"HTMLLIElement")&&i.style.removeProperty("color"),si(t))}})),e.rawEvent.preventDefault()}var yl=function(e){return!!(e&&M(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)},bl={unquoteWhenBackspaceOnEmptyFirstLine:vl,unquoteWhenEnterOnEmptyLine:gl};function El(e,t,n,r){return void 0===r&&(r=!1),r?null:{winKey:e,macKey:t,action:n}}var Cl=[El(4162,8258,qo),El(4169,8265,Go),El(4181,8277,Yo),El(4128,8224,si),El(4186,8282,(function(e){return e.undo()})),El(26,26,(function(e){return e.undo()}),ye.isMac),El(4185,24666,(function(e){return e.redo()})),El(4286,8382,Ni),El(4287,8383,Ri),El(20670,24766,(function(e){return Uo(e,0)})),El(20668,24764,(function(e){return Uo(e,1)}))].filter((function(e){return!!e})),wl={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191,32,8],shouldHandleEvent:Sl,handleEvent:function(e,t){var n=Sl(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function Sl(e){return go(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.getModifierState("AltGraph")?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096)|(t.altKey&&18);return n&&Cl.filter((function(e){return(ye.isMac?e.macKey:e.winKey)==n}))[0]}))}var Tl={defaultShortcut:wl},Dl={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},kl=oe(Dl).join(","),xl={keys:[13],shouldHandleEvent:Il,handleEvent:function(e,t){var n=Il(e,t),r=Ee(1,t.getDocument());t.addUndoSnapshot((function(){var e;null===(e=null==n?void 0:n.parentNode)||void 0===e||e.insertBefore(r,n),"TABLE"==j(n)&&t.select(new X(r,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function Il(e,t){return go(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(kl);if(n){var r=t.getSelectionRange();if(r&&r.collapsed&&Fr(X.getStart(r),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(Dl[j(n)])}return null}))}var Ll={insertLineBeforeStructuredNodeFeature:xl},Nl={keys:[9],shouldHandleEvent:function(e,t){return Pl(e,t)&&!Ol(e,t)},handleEvent:function(e,t){var n,r,o,i=e.rawEvent.shiftKey,a=Pl(e,t);if(a){for(var l=_l(e,a),s=i?-1:1,u=null!==(n=l.row)&&void 0!==n?n:0,c=(null!==(r=l.col)&&void 0!==r?r:0)+s;;c+=s){var d=null!==(o=l.cells)&&void 0!==o?o:[];if(c<0||c>=d[u].length){if((u+=s)<0){t.select(l.table,-2);break}if(u>=d.length){yi(t,1);break}c=i?d[u].length-1:0}var f=l.getCell(u,c);if(f.td){var p=new X(f.td,0).normalize();t.select(p);break}}e.rawEvent.preventDefault()}}},Rl={keys:[9],shouldHandleEvent:function(e,t){return Pl(e,t)&&Ol(e,t)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var n=e.rawEvent.shiftKey,r=t.getSelectionRangeEx(),o=Pl(e,t);if(o){var i=_l(e,o);n&&t.getElementAtCursor("blockquote",i.table,e)?Di(t,1):n||Di(t,0),r.coordinates&&t.select(r.table,r.coordinates)}}))}},Bl={keys:[38,40],shouldHandleEvent:function(e,t){return Pl(e,t)&&!Ol(e,t)},handleEvent:function(e,t){var n,r,o,i=Pl(e,t);if(i){var a=new Vn(i),l=38==e.rawEvent.which,s=l?-1:1,u=e.rawEvent.shiftKey,c=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),d=null;if(c){for(var f=c.anchorNode,p=c.anchorOffset,h=null!==(r=a.row)&&void 0!==r?r:0;h>=0&&a.cells&&h<a.cells.length;h+=s){var v=a.getCell(h,null!==(o=a.col)&&void 0!==o?o:0);if(v.td&&v.td!=i){d=v.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if(P(a.table,n)&&!P(i,n,!0)){var r=d?new X(d,0):new X(a.table,l?-2:-3);if(u){r=1==r.node.nodeType&&G(r.node)?new X(r.node,r.isAtEnd?-3:-2):r;var o=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();f&&(null==o||o.setBaseAndExtent(f,p,r.node,r.offset))}else e.select(r.normalize())}}))}}}},Ml={keys:[8],shouldHandleEvent:function(e,t){return t.isFeatureEnabled("DeleteTableWithBackspace")&&Ol(e,t)},handleEvent:function(e,t){var n=Pl(e,t);if(n){var r=new Vn(n);r.edit(4),r.writeBack()}}};function Pl(e,t){return go(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==j(n)?null:n)}))}function Ol(e,t){return go(e,"WHOLE_TABLE_SELECTED_FOR_FEATURES",(function(){var n=Pl(e,t);if(!n)return!1;var r=_l(e,n),o=t.getSelectionRangeEx();return 1==o.type&&o.coordinates&&Yn(r,o.coordinates)}))}function _l(e,t){return go(e,"VTABLE_FOR_TABLE_FEATURES",(function(){return new Vn(t)}))}var Fl={tabInTable:Nl,upDownInTable:Bl,indentTableOnTab:Rl,deleteTableWithBackspace:Ml},Hl={keys:[9],shouldHandleEvent:function(e,t){if(t.isFeatureEnabled("TabKeyTextFeatures")&&!e.rawEvent.shiftKey){var n=t.getDocument().activeElement,r=t.getElementAtCursor("LI,TABLE",void 0,e),o=t.getElementAtCursor(co(),void 0,e);return!r&&(o?o.isContentEditable:n.isContentEditable)}return!1},handleEvent:function(e,t){var n=t.getSelectionRangeEx();0==n.type&&(t.addUndoSnapshot((function(){if(n.areAllCollapsed)Kl(t,e);else{var r=n.ranges,o=r[0];if(jl(t,o))Di(t,0);else{var i=ee(o.startContainer,o.startOffset);r.forEach((function(e){return e.deleteContents()})),t.select(i),Kl(t,e)}}})),e.rawEvent.preventDefault())}},Ul={keys:[9],shouldHandleEvent:function(e,t){if(e.rawEvent.shiftKey&&t.isFeatureEnabled("TabKeyTextFeatures")){var n=t.getSelectionRangeEx();return 0==n.type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",void 0,e)&&!t.getElementAtCursor("LI,TABLE",void 0,e)&&jl(t,n.ranges[0])}return!1},handleEvent:function(e,t){t.addUndoSnapshot((function(){return Di(t,1)})),e.rawEvent.preventDefault()}},zl={indentWhenTabText:Hl,outdentWhenTabText:Ul,autoHyphen:{keys:[],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){return!1},defaultDisabled:!0}};function jl(e,t){var n=!1,r=X.getStart(t),o=X.getEnd(t),i=e.getBlockElementAtNode(r.node),a=e.getBlockElementAtNode(o.node);if(!i||!a)return!1;if(i.equals(a)){var l=new X(i.getStartNode(),0),s=new X(i.getEndNode(),-1),u=ee(l,X.getStart(t)),c=ee(X.getEnd(t),s);return!n&&Ql(u)&&Ql(c)&&(n=!0),n}return!0}function Ql(e){return""==e.toString()&&0==gn(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function Kl(e,t){var n=e.getDocument().createElement("span"),r=e.getContentSearcherOfCursor(t);if(r){for(var o=6-r.getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,i=null,a="",l=0;l<o;l++)a+="&ensp;";e.insertNode(n),n.nextElementSibling&&"A"==j(n.nextElementSibling)&&((i=e.getDocument().createElement("span")).textContent=" ",e.insertNode(i),e.select(ee(i,-2))),e.insertContent(a,{position:5,range:ee(n,0),updateCursor:!1}),e.select(ee(n,-3)),i&&e.deleteNode(i)}}var Vl=r(r(r(r(r(r(r(r(r(r(r({},ll),bl),Fl),Ll),ji),Tl),Yi),fl),fa),zl),qi);function Wl(){return Vl}var ql,Gl=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t,this.editor=void 0,this.features=[]}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e;var n=Wl();oe(n).forEach((function(e){var r,o=n[e],i=t.settingsOverride&&void 0!==t.settingsOverride[e];(i&&(null===(r=t.settingsOverride)||void 0===r?void 0:r[e])||!i&&!o.defaultDisabled)&&t.features.push(o)})),this.features=this.features.concat(this.additionalFeatures||[]),this.features.forEach((function(e){var n;return null===(n=t.editor)||void 0===n?void 0:n.addContentEditFeature(e)}))},e.prototype.disposeFeatures=function(){var e=this;this.editor&&this.features.forEach((function(t){return e.editor.removeContentEditFeature(t)})),this.features=[]},e.prototype.dispose=function(){this.disposeFeatures(),this.editor=void 0},e}(),Yl=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.originalHref=null,this.trackedLink=null,this.editor=null,this.disposer=null,this.onMouse=function(e){var t,n,o=null===(t=r.editor)||void 0===t?void 0:t.getElementAtCursor("a[href]",e.target),i=o&&r.tryGetHref(o);i&&(null===(n=r.editor)||void 0===n||n.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(i,o):null))},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n,r;if(6==e.eventType||2==e.eventType&&(!this.isContentEditValue(e.rawEvent)||32==e.rawEvent.which)||7==e.eventType){var o,i=(o=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("A[href]",void 0,e))&&o!==this.trackedLink||2==e.eventType||7==e.eventType;7==e.eventType&&"Keyboard"==e.source&&this.trackedLink!=o&&o&&(this.trackedLink=o),this.trackedLink&&(i||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(i&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&o&&this.doesLinkDisplayMatchHref(o)&&(this.trackedLink=o,this.originalHref=this.tryGetHref(o))}if(6==e.eventType&&(o=null===(n=this.editor)||void 0===n?void 0:n.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(o,e.rawEvent))return;var a;if((a=this.tryGetHref(o))&&Co(e.rawEvent)&&0===e.rawEvent.button){e.rawEvent.preventDefault();try{var l=this.target||"_blank",s=null===(r=this.editor)||void 0===r?void 0:r.getDocument().defaultView;null==s||s.open(a,l)}catch(e){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){return null}},e.prototype.isContentEditValue=function(e){return bo(e)||8==e.which||46==e.which},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.trackedLink&&!this.doesLinkDisplayMatchHref(this.trackedLink)&&this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),r=this.tryGetHref(e);if(null!==r)return n.test(r)}return!1},e.prototype.updateLinkHref=function(){var e,t=this;if(this.trackedLink){var n=vn(this.trackedLink.innerText.trim());null!==n&&(null===(e=this.editor)||void 0===e||e.addUndoSnapshot((function(){t.trackedLink.href=n.normalizedUrl})))}},e}(),Jl=["angleRad"],Xl=["leftPercent","rightPercent","topPercent","bottomPercent"],Zl=g(g([],p(Jl),!1),p(Xl),!1),$l=g(g([],p(Zl),!1),p(["widthPx","heightPx"]),!1);function es(e,t){return e&&e.src&&!$l.some((function(t){return!("number"==typeof e[t])}))?!Zl.every((function(t){return ts(e[t],0)}))||e.flippedHorizontal||e.flippedVertical||t&&(!t||e.angleRad!==t.angleRad)?t&&Jl.every((function(t){return ts(e[t],0)}))&&Jl.every((function(e){return ts(t[e],0)}))&&Xl.every((function(n){return ts(e[n],t[n])}))&&t.flippedHorizontal===e.flippedHorizontal&&t.flippedVertical===e.flippedVertical?2:3:1:0}function ts(e,t){return Math.abs(e-t)<.001}function ns(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),a=r/(1-e.topPercent-e.bottomPercent),l=t?i:n,s=t?a:r;return{targetWidth:Math.abs(l*Math.cos(o))+Math.abs(s*Math.sin(o)),targetHeight:Math.abs(l*Math.sin(o))+Math.abs(s*Math.cos(o)),originalWidth:i,originalHeight:a,visibleWidth:l,visibleHeight:s}}function rs(e,t){var n=t.angleRad,r=t.widthPx,o=t.heightPx,i=t.bottomPercent,a=t.leftPercent,l=t.rightPercent,s=t.topPercent,u=t.naturalWidth,c=t.naturalHeight,d=u*(1-a-l),f=c*(1-s-i),p=window.devicePixelRatio||1,h=document.createElement("canvas"),v=ns(t),g=v.targetWidth,m=v.targetHeight;h.width=g*p,h.height=m*p;var A=h.getContext("2d");return A&&(A.scale(p,p),A.translate(g/2,m/2),A.rotate(n),A.scale(t.flippedHorizontal?-1:1,t.flippedVertical?-1:1),A.drawImage(e,u*a,c*s,d,f,-r/2,-o/2,r,o)),h.toDataURL("image/png",1)}function os(e){e&&xn(e)}function is(e){var t=Dn(e);return t&&0!=es(t)?t:function(e){return{src:e.getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}}(e)}function as(e,t,n,r,o,i,a){var l="",s=es(n,is(null!=i?i:t));switch(s){case 1:l=n.src;break;case 2:l=r;break;case 3:l=rs(null!=i?i:t,n)}l!=r?l=e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:r,newSrc:l}).newSrc:a&&e.triggerPluginEvent(7,{source:"ImageResize"});l==n.src?os(t):function(e,t){e&&kn(e,t)}(t,n);var u=ns(n),c=u.targetWidth,d=u.targetHeight;t.src=l,(o||3==s)&&(t.width=c,t.height=d,t.style.removeProperty("width"),t.style.removeProperty("height"),t.style.removeProperty("max-width"),t.style.removeProperty("max-height"))}!function(e){e[e.Invalid=0]="Invalid",e[e.ResizeOnly=1]="ResizeOnly",e[e.SameWithLast=2]="SameWithLast",e[e.FullyChanged=3]="FullyChanged"}(ql||(ql={}));var ls={MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:us},ss={MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:cs};function us(e){return[e.pageX,e.pageY]}function cs(e){var t=0,n=0;if(e.targetTouches&&e.targetTouches.length>0){var r=e.targetTouches[0];t=r.pageX,n=r.pageY}return[t,n]}var ds,fs=function(){function e(e,t,n,r,o,i){var a=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=r,this.zoomScale=o,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(e){var t,n,r;e.preventDefault(),e.stopPropagation(),a.addDocumentEvents(),t=p(a.dndMouse.getPageXY(e),2),a.initX=t[0],a.initY=t[1],a.initValue=null===(r=(n=a.handler).onDragStart)||void 0===r?void 0:r.call(n,a.context,e)},this.onMouseMove=function(e){var t,n,r;e.preventDefault();var o=p(a.dndMouse.getPageXY(e),2),i=o[0],l=o[1],s=(i-a.initX)/a.zoomScale,u=(l-a.initY)/a.zoomScale;a.initValue&&(null===(n=(t=a.handler).onDragging)||void 0===n?void 0:n.call(t,a.context,e,a.initValue,s,u))&&(null===(r=a.onSubmit)||void 0===r||r.call(a,a.context,a.trigger))},this.onMouseUp=function(e){var t,n,r;e.preventDefault(),a.removeDocumentEvents(),(null===(n=(t=a.handler).onDragEnd)||void 0===n?void 0:n.call(t,a.context,e,a.initValue))&&(null===(r=a.onSubmit)||void 0===r||r.call(a,a.context,a.trigger))},this.dndMouse=i||ye.isMobileOrTablet?ss:ls,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(e.prototype,"mouseType",{get:function(){return this.dndMouse==ss?"touch":"mouse"},enumerable:!1,configurable:!0}),e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e}(),ps=32,hs=180/Math.PI,vs=8,gs={sw:0,nw:90,ne:180,se:270},ms=["w","","e"],As=["s","","n"],ys=22,bs=7,Es=["w","e"],Cs=["s","n"];!function(e){e[e.SquareHandles=0]="SquareHandles",e[e.CircularHandlesCorner=1]="CircularHandlesCorner"}(ds||(ds={}));var ws={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var i,a=e.x,l=e.y,s=e.editInfo,u=e.options,c=n.widthPx>0&&n.heightPx>0?1*n.widthPx/n.heightPx:0;if(r=(i=p(Ss(r,o,s.angleRad),2))[0],o=i[1],void 0!==u.minWidth&&void 0!==u.minHeight){var d=""==a,f=""==l,h=!(d||f)&&(u.preserveRatio||t.shiftKey),v=d?n.widthPx:Math.max(n.widthPx+r*("w"==a?-1:1),u.minWidth),g=f?n.heightPx:Math.max(n.heightPx+o*("n"==l?-1:1),u.minHeight);return h&&c>0&&(c>1?(v=g*c)<u.minWidth&&(g=(v=u.minWidth)/c):(g=v/c)<u.minHeight&&(v=(g=u.minHeight)*c)),s.widthPx=v,s.heightPx=g,!0}return!1}};function Ss(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function Ts(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}}function Ds(e,t,n,r){var o="w"==e?"left":"right",i="n"==t?"top":"bottom",a=t+e;return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+o+":"+(""==e?"50%":"0px")+";"+i+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:ks[r](a,i,o,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}var ks={0:function(e,t,n,r){return"position:relative;width:10px;height:10px;background-color: "+r+";cursor:"+e+"-resize;"+n+":-6px;"+t+":-6px;"},1:function(e,t,n){return"position:relative;width:10px;height:10px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-6px;"+t+":-6px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}},xs={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var i,a=e.editInfo,l=e.x,s=e.y,u=e.options;r=(i=p(Ss(r,o,a.angleRad),2))[0],o=i[1];var c=a.widthPx,d=a.heightPx,f=a.leftPercent,h=a.rightPercent,v=a.topPercent,g=a.bottomPercent,m=u.minWidth,A=u.minHeight,y=1-f-h,b=1-v-g;if(y>0&&b>0&&void 0!==m&&void 0!==A){var E=c/y,C=d/b,w="e"!=l?Is(n.leftPercent,r,E,h,m):f,S="w"!=l?Is(n.rightPercent,-r,E,f,m):h,T="s"!=s?Is(n.topPercent,o,C,g,A):v,D="n"!=s?Is(n.bottomPercent,-o,C,v,A):g;return a.leftPercent=w,a.rightPercent=S,a.topPercent=T,a.bottomPercent=D,a.widthPx=E*(1-w-S),a.heightPx=C*(1-T-D),!0}return!1}};function Is(e,t,n,r,o){var i=n*(1-r)-o,a=n*e+t;return Math.max(Math.min(a,i),0)/n}function Ls(){var e=[];return[0,1].forEach((function(t){return[0,1].forEach((function(n){e.push(function(e,t){var n=0==t?"right:"+e+"px;height:"+(bs-2*e)+"px;":"top:"+e+"px;width:"+(bs-2*e)+"px;",r=0==e?"white":"black";return{tag:"div",style:"position:absolute;left:"+e+"px;bottom:"+e+"px;"+n+";background-color:"+r}}(t,n))}))})),e}var Ns,Rs={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var i=e.editInfo,a=e.options,l=i.heightPx/2+31,s=l*Math.sin(n.angleRad)+r,u=l*Math.cos(n.angleRad)-o,c=Math.atan2(s,u);if(!t.altKey&&a&&void 0!==a.minRotateDeg){var d=c*hs;c=Math.round(d/a.minRotateDeg)*a.minRotateDeg/hs}return i.angleRad!=c&&(i.angleRad=c,!0)}};function Bs(e){var t;return{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: "+vs+"px "+vs+"px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:(t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"},t["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]}}var Ms=Math.PI,Ps=8,Os=2*Ms/Ps,_s=["nw","n","ne","e","se","s","sw","w"],Fs={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:"",disableCrop:!1,disableRotate:!1,disableSideResize:!1,onSelectState:7,applyChangesOnMouseUp:!1},Hs=((Ns={})[1]=function(e,t){var n=e.borderColor,r=[];return ms.forEach((function(e){return As.forEach((function(o){var i=""==e==(""==o)?Ds(e,o,n,1):null;t&&i&&t(i,e,o),i&&r.push(i)}))})),r},Ns[2]=function(e,t){var n=e.borderColor,r=[];return ms.forEach((function(e){return As.forEach((function(o){var i=""==e!=(""==o)?Ds(e,o,n,1):null;t&&i&&t(i,e,o),i&&r.push(i)}))})),r},Ns[4]=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t+";top:"+"-21px;height:15px;margin-left:"+"-1px;",children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:"+"32px;height:"+"32px;left:-17px;cursor:move;top:"+"-32px;",children:[Bs(t)]}]}]},Ns[8]=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},t={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return t&&Es.forEach((function(e){return Cs.forEach((function(n){var r;return null===(r=t.children)||void 0===r?void 0:r.push(function(e,t){var n="w"==e?"left":"right",r="n"==t?"top":"bottom",o=gs[t+e];return{tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+t+e+"-resize;"+n+":0;"+r+":0;width:"+ys+"px;height:"+ys+"px;transform:rotate("+o+"deg)",dataset:{x:e,y:t},children:Ls()}}(e,n))}))})),[t,e,e,e,e]},Ns),Us=function(){function e(e,t){var n=this;this.onShowResizeHandle=t,this.editor=null,this.disposer=null,this.image=null,this.clonedImage=null,this.wrapper=null,this.editInfo=null,this.lastSrc=null,this.dndHelpers=[],this.wasResized=!1,this.shadowSpan=null,this.isCropping=!1,this.pngSource=null,this.onBlur=function(){n.setEditingImage(null,!1)},this.removeWrapper=function(){var e;n.shadowSpan&&An(n.shadowSpan),n.options.applyChangesOnMouseUp&&(null===(e=n.wrapper)||void 0===e||e.removeEventListener("mouseup",n.changesWhenMouseUp,!0)),n.wrapper=null,n.shadowSpan=null},this.changesWhenMouseUp=function(){n.editor&&n.image&&n.editInfo&&n.lastSrc&&n.clonedImage&&as(n.editor,n.image,n.editInfo,n.lastSrc,n.wasResized,n.clonedImage,n.options.applyChangesOnMouseUp)},this.updateWrapper=function(e){var t,r,o,i,a,l,s,u,c,d,f=n.wrapper;if(f&&n.editInfo&&n.image&&n.clonedImage&&n.options&&(null===(t=n.shadowSpan)||void 0===t?void 0:t.parentElement)){var p=Qs(f,"r_cropC"),h=Qs(f,"r_cropO"),v=Qs(f,"r_resizeH"),g=Qs(f,"r_rotateC")[0],m=Qs(f,"r_rotateH")[0],A=Qs(f,"r_cropH");n.isCropping=1==p.length&&4==h.length;var y=n.editInfo,b=y.angleRad,E=y.bottomPercent,C=y.leftPercent,w=y.rightPercent,S=y.topPercent,T=y.flippedHorizontal,D=y.flippedVertical,k=ns(n.editInfo,n.isCropping),x=k.targetWidth,I=k.targetHeight,L=k.originalWidth,N=k.originalHeight,R=k.visibleWidth,B=k.visibleHeight,P=(x-R)/2,O=(I-B)/2,_=L*C,F=L*w,H=N*S,U=N*E;if(f.style.margin=O+"px "+P+"px",f.style.transform="rotate("+b+"rad)",function(e,t,n,r){if(t.style.borderStyle){var o=t.style.borderWidth?2*parseInt(t.style.borderWidth):2;return e.style.width=js(n+o),void(e.style.height=js(r+o))}e.style.width=js(n),e.style.height=js(r)}(f,n.image,R,B),f.style.textAlign=M(d=n.shadowSpan.parentElement,"HTMLElement")&&"rtl"==Le(d,"direction")?"right":"left",n.clonedImage.style.width=js(L),n.clonedImage.style.height=js(N),function(e,t,n){e&&(e.style.transform="scale("+(t?-1:1)+", "+(n?-1:1)+")")}(n.clonedImage.parentElement,T,D),n.isCropping)zs(p[0],_,H,F,U,void 0,void 0),zs(h[0],0,0,F,void 0,void 0,H),zs(h[1],void 0,0,0,U,F,void 0),zs(h[2],_,void 0,0,0,void 0,U),zs(h[3],0,H,void 0,0,_,void 0),Vs(A,b);else{if(n.clonedImage.style.margin=-H+"px 0 0 "+-_+"px","r_resizeH"==(null==e?void 0:e.elementClass)){var z=f.clientWidth,j=f.clientHeight;n.wasResized=!0,o=n.editInfo,i=n.options.preserveRatio||!1,a=z,l=j,s=o.widthPx,u=o.heightPx,c=u>0?s/u:0,a=Math.floor(a),l=Math.floor(l),s=Math.floor(s),u=Math.floor(u),o.widthPx=a,o.heightPx=l,i&&c>0&&(s!==a||u!==l)&&(a<s?o.heightPx=a/c:o.widthPx=l*c),n.updateWrapper()}var Q=null===(r=n.editor)||void 0===r?void 0:r.getVisibleViewport(),K=qs(x,I);m&&g&&Q&&function(e,t,n,r,o,i){if(i)return r.style.display="none",void(o.style.display="none");r.style.display="",o.style.display="";var a=r.getBoundingClientRect(),l=n.getBoundingClientRect();if(a&&l){var s=Number.MAX_SAFE_INTEGER,u=t*hs;if(u<45&&u>-45&&l.top-e.top<53)s=a.top-e.top;else if(u<=-80&&u>=-100&&l.left-e.left<53)s=a.left-e.left;else if(u>=80&&u<=100&&e.right-l.right<53){var c=a.right-e.right;s=Math.min(e.right-l.right,c)}else if((u<=-160||u>=160)&&e.bottom-l.bottom<53){var d=a.bottom-e.bottom;s=Math.min(e.bottom-l.bottom,d)}var f=Math.max(Math.min(15,s),0),p=Math.max(Math.min(ps,s-f),0);r.style.top=-f-6+"px",r.style.height=f+"px",o.style.top=-p+"px"}}(Q,b,f,g,m,K),function(e,t){e.forEach((function(e){var n=e.dataset,r=n.y,o=n.x,i=["n","s","e","w"].indexOf((null!=r?r:"")+(null!=o?o:""))>-1;e.style.display=i&&t?"none":""}))}(v,K),Vs(v,b)}}},this.options=r(r({},Fs),e||{}),this.allowedOperations=1|(this.options.disableCrop?0:8)|(this.options.disableRotate?0:4)|(this.options.disableSideResize?0:2)}return e.prototype.getName=function(){return"ImageEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler({blur:function(){return t.onBlur()},dragstart:function(e){t.image&&e.preventDefault()}})},e.prototype.dispose=function(){var e;this.clearDndHelpers(),null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 22:e.selectionRangeEx&&2===e.selectionRangeEx.type&&this.options&&void 0!==this.options.onSelectState&&this.setEditingImage(e.selectionRangeEx.image,this.options.onSelectState);break;case 5:var n=e.rawEvent.target,r=e.rawEvent.button;(this.shadowSpan!==n||this.shadowSpan===n&&0!==r||this.isCropping)&&this.setEditingImage(null);break;case 6:this.editor&&this.image&&this.shadowSpan&&this.editor.select(this.image);break;case 0:this.setEditingImage(null);break;case 7:case 12:this.removeWrapper();break;case 8:(null===(t=this.options)||void 0===t?void 0:t.imageSelector)&&H(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach((function(e){os(e)}))}},e.prototype.isOperationAllowed=function(e){return!!(this.allowedOperations&e)},e.prototype.setEditingImage=function(e,t){var n=this,r="number"==typeof t?t:0,o="number"!=typeof t&&!!t;!e&&this.image&&this.editor&&this.editInfo&&this.lastSrc&&this.clonedImage&&(this.clearDndHelpers(),this.pngSource&&(this.clonedImage.src=this.editInfo.src),as(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized||this.isCropping,this.clonedImage),this.removeWrapper(),this.editor.addUndoSnapshot((function(){return n.image}),"ImageResize"),o&&this.editor.select(this.image),this.pngSource=null,this.image=null,this.editInfo=null,this.lastSrc=null,this.clonedImage=null,this.isCropping=!1),!this.image&&(null==e?void 0:e.isContentEditable)&&this.editor&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=is(e),this.pngSource=function(e){var t=e.src,n=e.widthPx,r=e.heightPx,o=e.naturalHeight,i=e.naturalWidth;if(t.indexOf(".gif")>-1||t.indexOf("image/gif")>-1)try{var a=document.createElement("img");return a.src=t,rs(a,{src:t,widthPx:n,heightPx:r,naturalWidth:i,naturalHeight:o,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0})}catch(e){return null}return null}(this.editInfo),this.wasResized=function(e){var t=e.width,n=e.height,r=e.style;return!(""!==r.maxWidth&&"initial"!==r.maxWidth&&"auto"!==r.maxWidth||!(Ws(r.height)||Ws(r.width)||Ws(t)||Ws(n)))}(this.image),r=(function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas");t.width=10,t.height=10;var n=t.getContext("2d");return!!n&&(n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0)}catch(e){return!1}}(e)?r:3)&this.allowedOperations,this.createWrapper(r),this.updateWrapper(),this.dndHelpers=g(g(g(g([],p(this.createDndHelpers("r_resizeH",ws)),!1),p(this.createDndHelpers("r_rotateH",Rs)),!1),p(this.createDndHelpers("r_cropH",xs)),!1),p(this.createDndHelpers("r_cropC",xs)),!1),this.editor.select(this.image))},e.prototype.flipImage=function(e,t){var n;this.image=e,this.editInfo=is(e);var r=this.editInfo.angleRad;r>=Math.PI/2&&r<3*Math.PI/4||r<=-Math.PI/2&&r>-3*Math.PI/4?"horizontal"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal:"vertical"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.rotateImage=function(e,t){var n;this.image=e,this.editInfo=is(e),this.editInfo.angleRad=this.editInfo.angleRad+t,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.createWrapper=function(e){var t,n,r,o=this;if(this.image&&this.editor&&this.options&&this.editInfo){this.clonedImage=this.image.cloneNode(!0),this.clonedImage.removeAttribute("id"),this.clonedImage.style.removeProperty("max-width"),this.clonedImage.style.removeProperty("max-height"),this.clonedImage.style.width=this.editInfo.widthPx+"px",this.clonedImage.style.height=this.editInfo.heightPx+"px",this.wrapper=Ee(6,this.image.ownerDocument),null===(n=null===(t=this.wrapper)||void 0===t?void 0:t.firstChild)||void 0===n||n.appendChild(this.clonedImage),this.wrapper.style.display=ye.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.clonedImage&&(this.clonedImage.src=null!==(r=this.pngSource)&&void 0!==r?r:this.editInfo.src,this.clonedImage.style.position="absolute");var i={borderColor:Gs(this.options.borderColor,this.editor.isDarkMode()),rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:qs(this.editInfo.widthPx,this.editInfo.heightPx)},a=[Ts(i)];oe(Hs).forEach((function(t){var n=Hs[t](i,o.onShowResizeHandle);(e&t)==t&&n&&kr(a,n)})),a.forEach((function(e){var t=Ee(e,o.image.ownerDocument);t&&o.wrapper&&o.wrapper.appendChild(t)})),this.insertImageWrapper(this.wrapper)}},e.prototype.insertImageWrapper=function(e){if(this.image&&(this.shadowSpan=Ce(this.image,"span"),this.shadowSpan)){var t=this.shadowSpan.attachShadow({mode:"open"});this.shadowSpan.style.verticalAlign="bottom",e.style.fontSize="24px",this.options.applyChangesOnMouseUp&&e.addEventListener("mouseup",this.changesWhenMouseUp,!0),t.appendChild(e)}},e.prototype.createDndHelpers=function(e,t){var n=this,r=this.wrapper;return r&&this.editInfo?Qs(r,e).map((function(r){return new fs(r,{editInfo:n.editInfo,options:n.options,elementClass:e,x:r.dataset.x,y:r.dataset.y},n.updateWrapper,t,n.editor?n.editor.getZoomScale():1)})):[]},e.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach((function(e){return e.dispose()})),this.dndHelpers=[]},e}();function zs(e,t,n,r,o,i,a){e.style.left=void 0!==t?js(t):e.style.left,e.style.top=void 0!==n?js(n):e.style.top,e.style.right=void 0!==r?js(r):e.style.right,e.style.bottom=void 0!==o?js(o):e.style.bottom,e.style.width=void 0!==i?js(i):e.style.width,e.style.height=void 0!==a?js(a):e.style.height}function js(e){return e+"px"}function Qs(e,t){return H(e.querySelectorAll("."+t))}function Ks(e,t,n){void 0===t&&(t=""),void 0===n&&(n="");var r=function(e){var t=Math.round(e/Os)%Ps;return t<0?t+Ps:t}(e),o=t+n,i=_s.indexOf(o),a=i>=0&&i+r;return a?_s[a%Ps]:""}function Vs(e,t){e.forEach((function(e){var n=e.dataset,r=n.y,o=n.x;e.style.cursor=Ks(t,r,o)+"-resize"}))}function Ws(e){var t="string"==typeof e?parseInt(e):e;return!isNaN(t)}function qs(e,t){return!!(e&&t&&(e<42||t<42))}function Gs(e,t){return"string"==typeof e?e.trim():t?e.darkModeColor.trim():e.lightModeColor.trim()}function Ys(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf(j(e))<0){var t=!1;if(H(e.childNodes).every((function(e){var n;return!(!M(e,"Text")||(null===(n=e.nodeValue)||void 0===n?void 0:n.trim()))||"LI"==j(e)&&(t=!0,!0)}))&&t)return!0}return!1}!function(e){function t(t,n,r,o,i){return void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r="#DB626C"),void 0===o&&(o=!1),void 0===i&&(i="img"),e.call(this,{minHeight:n,minWidth:t,borderColor:r,preserveRatio:o,imageSelector:i})||this}n(t,e),t.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},t.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)}}(Us);var Js=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,Xs=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,Zs=/<tr[^>]*>[^<]*/i,$s=/<table[^>]*>[^<]*/i;function eu(e,t){var n=e.fragment,r=e.sanitizingOption,o=e.htmlBefore,i=e.clipboardData,a=i.html?function(e,t){if(e.match(Js)){var n=t.match(Zs);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(Xs)){var r=t.match($s);e=(r?r[0]:"<TABLE>")+e+"</TABLE>"}return e}(i.html,o):void 0;if(a&&i.html!=a){var l=(new DOMParser).parseFromString(t(a),"text/html");xt(n,null==l?void 0:l.body)}var s=n.firstChild;s&&s.childNodes.length>0&&"DIV"==j(s)&&(Array.from(s.childNodes).every((function(e){return"META"==j(e)||"TABLE"==j(e)&&e==s.lastChild}))&&s.lastChild&&e.fragment.replaceChildren(s.lastChild));lo(r.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))}function tu(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}var nu='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img',ru="ListContainerWrapper",ou="WACImageContainer",iu=["111","9643","9830"];function au(e){!function(e){var t=H(e.querySelectorAll(nu));t.forEach((function(e){var t=new RegExp("\\b"+ru+"\\b","g");if(e.previousSibling){var n=_(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=_(e,!1);r.className=r.className.replace(t,"")}}))}(e);var t=function(e){for(var t=e.querySelectorAll("."+ru),n=[],r=null,o=0;o<t.length;o++){var i=t[o];if(r){var a=r.listItemContainers,l=a[a.length-1];i==l.nextSibling||l.parentNode&&We(i)==Oe(l.parentNode,l)?(a.push(i),r.endElement=i):(r.endElement=l,n.push(r),r=tu(i))}else r=tu(i)}r&&r.listItemContainers.length>0&&n.push(r);return n}(e);t.forEach((function(t){var n,r,o;!function(e,t){if(t.startElement&&t.endElement){U(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==j(e.firstChild)&&An(e)}))}}(e,t),t.insertPositionNode=null!==(r=null===(n=t.endElement)||void 0===n?void 0:n.nextSibling)&&void 0!==r?r:null;var i=void 0,a=e.ownerDocument;t.listItemContainers.forEach((function(n){var r=function(e){var t=j(e.firstChild);return"UL"==t||"OL"==t?t:null}(n);r&&(i||(i=lu(n,a,r)),H(n.querySelectorAll("li")).forEach((function(o){var l,s=parseInt(null!==(l=o.getAttribute("data-aria-level"))&&void 0!==l?l:"");i&&j(i)!=r&&1==s&&r&&(su(i,e,t),i=lu(n,a,r)),i&&r&&function(e,t,n,r){var o;if(!n)return;var i=parseInt(null!==(o=t.getAttribute("data-aria-level"))&&void 0!==o?o:""),a=t.getAttribute("data-leveltext");"UL"==n&&a&&iu.indexOf(a.charCodeAt(0).toString())>-1&&(t.style.listStyleType='"'+a+'  "');var l=e;for(;i>1;){if(l.firstChild){var s=l.lastElementChild,u=j(s);!s||"UL"!=u&&"OL"!=u?(l.appendChild(r.createElement(n)),l.lastElementChild&&(l=l.lastElementChild)):l=s}else l.appendChild(r.createElement(n)),l.firstElementChild&&(l=l.firstElementChild);i--}l.appendChild(t)}(i,o,r,a)})))})),i&&su(i,e,t);var l=null===(o=t.startElement)||void 0===o?void 0:o.parentNode;l&&t.listItemContainers.forEach((function(e){l.removeChild(e)}))}));var n=function(e){return e.querySelectorAll("."+ou)}(e);n.forEach((function(e){M(e,"HTMLSpanElement")&&e.childNodes.forEach((function(e){var t;"IMG"!=j(e)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e))}))}))}function lu(e,t,n){var r,o=t.createElement(n),i=null===(r=e.firstElementChild)||void 0===r?void 0:r.getAttribute("start");return i&&o.setAttribute("start",i),o}function su(e,t,n){var r;if(e){var o,i=n.insertPositionNode;if(i)(o=i.parentNode)&&o.insertBefore(e,i);else(o=null===(r=n.startElement)||void 0===r?void 0:r.parentNode)?o.appendChild(e):t.appendChild(e)}}var uu=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return"."+e})).join(",");function cu(e,t){e.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer').forEach((function(e){var t=e;t.style.removeProperty("display"),t.style.removeProperty("margin")})),function(e){return!(!e||!e.querySelector(nu))}(e)&&au(e),lo(t.cssStyleCallbacks,"border",(function(e,t){return"IMG"!=t.tagName||"none"!=e})),e.querySelectorAll(uu).forEach((function(e){var t;return null===(t=e.parentElement)||void 0===t?void 0:t.removeChild(e)}))}var du="mso-comment-parent",fu="mso-comment-reference",pu="mso-comment-date",hu=/#_msocom_/,vu="mso-special-character",gu="comment",mu="mso-comment-continuation",Au="mso-element",yu="comment-list",bu="mso-comment-done";var Eu="NodeId";function Cu(e,t,n,r){if(1==t.nodeType){var o=Su(e,t);""!=o&&(e.dict[o]||(e.dict[o]={}),e.dict[o][n]=r)}}function wu(e,t,n){if(1==t.nodeType){var r=Su(e,t);if(""!=r)return e.dict[r]&&e.dict[r][n]}return null}function Su(e,t){var n=t.getAttribute(Eu);return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute(Eu,n)),n}var Tu=5,Du="UniqueListId",ku="mso-list",xu=/[\n|\r]/gi;function Iu(e,t,n,r){var o,i=Lu(t,n.level,r),a=wu(e.wordCustomData,i,Du);if(a&&a!=n.uniqueListId||!a&&i.firstChild){var l=t.ownerDocument.createElement(r.tagName);null===(o=i.parentNode)||void 0===o||o.insertBefore(l,i.nextSibling),i=l}return Cu(e.wordCustomData,i,Du,n.uniqueListId),function(e,t,n){var r,o,i;if(n.tagName!=j(t)){var a=null===(r=t.ownerDocument)||void 0===r?void 0:r.createElement(n.tagName);a&&(Cu(e.wordCustomData,a,Du,wu(e.wordCustomData,t,Du)),xt(a,t),null===(o=t.parentNode)||void 0===o||o.insertBefore(a,t),null===(i=t.parentNode)||void 0===i||i.removeChild(t),t=a)}return t}(e,i,r)}function Lu(e,t,n){var r,o,i=null,a=null;if(1==t?a=Ou(e):(i=Lu(e,t-1,null)).lastChild&&(a=i.lastChild),a&&1==a.nodeType){var l=j(a);if("UL"==l||"OL"==l)return a}var s=null===(r=e.ownerDocument)||void 0===r?void 0:r.createElement(n?n.tagName:"UL");return 1==t?null===(o=e.parentNode)||void 0===o||o.insertBefore(s,e):null==i||i.appendChild(s),s}function Nu(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)r&&(r&&1==r.nodeType&&t>1&&Nu(r,t-1),(Hu(r=Pu(r,!0))||Fu(r))&&n.push(r));n.forEach((function(t){return e.removeChild(t)}))}function Ru(e){if(1==e.nodeType){var t=Uu(e,ku);if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr(5)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function Bu(e){return["o","·","§","-"].indexOf(e)>=0}function Mu(e,t){for(var n,r,o="",i=e.firstChild;!o&&i;)Fu(i=Pu(i,!0))?0==(o=null!==(r=null===(n=i.textContent)||void 0===n?void 0:n.trim())&&void 0!==r?r:"").length&&(o="o"):1==i.nodeType&&t>1&&(o=Mu(i,t-1)),i=i.nextSibling;return o}function Pu(e,t){var n,r,o,i;if(8==e.nodeType){var a=e.data;if(a&&"[if !supportlists]"==a.trim().toLowerCase()){for(var l=e,s=null,u=0;u<4&&(l=_u(l));u++)if(8==l.nodeType&&(a=l.data)&&"[endif]"==a.trim().toLowerCase()){s=l;break}if(s){var c=null===(n=e.ownerDocument)||void 0===n?void 0:n.createElement("span");for(null==c||c.setAttribute("style","mso-list: ignore"),l=_u(e);l!=s;)(l=null==l?void 0:l.nextSibling).previousSibling&&(null==c||c.appendChild(l.previousSibling));c&&(null===(r=s.parentNode)||void 0===r||r.insertBefore(c,s)),t&&(null===(o=e.parentNode)||void 0===o||o.removeChild(e),null===(i=s.parentNode)||void 0===i||i.removeChild(s)),c&&(e=c)}}}return e}function Ou(e){var t=e;do{t=t.previousSibling}while(t&&zu(t));return t}function _u(e){var t=e;do{t=t.nextSibling}while(t&&zu(t));return t}function Fu(e){if(1==e.nodeType){var t=Uu(e,ku);if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function Hu(e){return"SPAN"==j(e)&&!e.firstChild}function Uu(e,t){return Rt(e)[t]||null}function zu(e){var t;if(!e)return!0;if(3==e.nodeType){var n=e.nodeValue;return 0==(null==(n=null!==(t=null==n?void 0:n.replace(xu,""))&&void 0!==t?t:"")?void 0:n.trim().length)}var r=j(e);return!(!e.firstChild||e.firstChild!=e.lastChild||"SPAN"!=r&&"FONT"!=r)&&zu(e.firstChild)}function ju(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}var Qu=/%/;function Ku(e){var t=e.sanitizingOption,n=e.fragment;lo(t.elementCallbacks,"O:P",(function(e){return xt(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}));var r,o,i={nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:{dict:{},nextNodeId:1}},a=n.querySelectorAll("p,h1,h2,h3,h4,h5,h6");a.length>0&&(i.wordConverterArgs={nodes:a,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[{listsMetadata:{},currentUniqueListId:-1}],lastProcessedItem:null},function(e){var t,n,r=e.wordConverterArgs;if(!r)return!1;for(;r.currentIndex<r.nodes.length;){var o=r.nodes.item(r.currentIndex),i=Ru(o);if(i){var a=r.currentListIdsByLevels[i.level-1]||{listsMetadata:{},currentUniqueListId:-1};r.currentListIdsByLevels[i.level-1]=a,r.lastProcessedItem&&Ou(o)!=r.lastProcessedItem&&ju(r);var l=a.listsMetadata[i.wordListId];if(l){if(!l.ignore&&1==l.numberOfItems){var s=Mu(o,Tu);l.tagName=l.firstFakeBullet==s?"UL":"OL"}}else{var u=Mu(o,Tu);l={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:u,ignore:!u||0==u.length,tagName:(n=u,Bu(n)?"UL":"OL")},a.listsMetadata[i.wordListId]=l,r.lists[l.uniqueListId.toString()]=l}i.uniqueListId=l.uniqueListId,l.ignore||"OL"==l.tagName&&l.numberOfItems>0&&a.currentUniqueListId!=i.uniqueListId?(l.ignore=!0,r.currentListIdsByLevels[0].currentUniqueListId=-1,r.currentListIdsByLevels=r.currentListIdsByLevels.slice(0,1)):(r.currentListIdsByLevels.length>i.level&&(r.currentListIdsByLevels=r.currentListIdsByLevels.slice(0,i.level)),a.currentUniqueListId=i.uniqueListId,r.listItems.push(i),l.numberOfItems++),r.lastProcessedItem=o}else{var c=r.lastProcessedItem;c&&Ou(o)==c&&o.tagName==c.tagName&&o.className==c.className&&(c.appendChild(c.ownerDocument.createElement("br")),c.appendChild(c.ownerDocument.createElement("br")),xt(c,o,!0),null===(t=o.parentNode)||void 0===t||t.removeChild(o))}r.currentIndex++}return r.listItems.length>0}(i)&&function(e){var t,n=e.wordConverterArgs;if(n)for(n.currentIndex=0;n.currentIndex<n.listItems.length;){var r=n.listItems[n.currentIndex],o=r.originalNode,i=n.lists[r.uniqueListId.toString()];if(!i.ignore){var a=Iu(e,o,r,i);if(a){Nu(o,Tu);var l=o.ownerDocument.createElement("LI");if(j(o).startsWith("H")){var s=o.cloneNode(!0);s.style.textIndent="",s.style.marginLeft="",s.style.marginRight="",l.appendChild(s)}else xt(l,o);a.appendChild(l),null===(t=o.parentNode)||void 0===t||t.removeChild(o),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}n.currentIndex++}e.numBulletsConverted>0||e.numNumberedConverted}(i)),["OL","UL"].forEach((function(e){lo(t.elementCallbacks,e,(function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0}))})),lo(t.cssStyleCallbacks,"line-height",(function(e){var t;return!(Qu.test(e)&&!isNaN(t=parseInt(e))&&t<120)})),r=t.elementCallbacks,o=t.cssStyleCallbacks,lo(r,"SPAN",(function(e){var t;return Rt(e)[vu]==gu&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),lo(r,"A",(function(e){var t;return M(e,"HTMLAnchorElement")&&hu.test(e.href)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),lo(r,"DIV",(function(e){return Rt(e)[Au]==yu&&xt(e),!0})),[fu,pu,du,mu,bu].forEach((function(e){return lo(o,e,(function(){return!1}))}))}function Vu(e){var t,n,r,o=e.start,i=e.end;if(o==i&&"DIV"==j(o)){var a=It(o,"SPAN");e.start=a,e.end=a,a&&a.lastChild&&"BR"==j(a.lastChild)&&a.removeChild(a.lastChild)}else if("BR"==j(i)){(a=null===(t=i.ownerDocument)||void 0===t?void 0:t.createTextNode(""))&&(null===(n=i.parentNode)||void 0===n||n.insertBefore(a,i),e.end=a,null===(r=i.parentNode)||void 0===r||r.removeChild(i))}}function Wu(e,t,n,r){var o,i,a,l,s=Te(e,t.start),u=n?Oe(e,t.end):_e(e,t.start);if(u)if(null==s?void 0:s.contains(u))(c=null===(o=t.start.ownerDocument)||void 0===o?void 0:o.createElement("br"))&&(null===(i=(n?t.end:t.start).parentNode)||void 0===i||i.insertBefore(c,n?t.end.nextSibling:t.start));else if(r&&r.end==r.start&&"SPAN"==j(r.end)){var c,d=_e(e,t.start);if(r.end.contains(d)&&!J(t.start,e,"li"))(c=null===(a=t.start.ownerDocument)||void 0===a?void 0:a.createElement("br"))&&(null===(l=t.start.parentNode)||void 0===l||l.insertBefore(c,t.start))}}var qu=["activeborder","activecaption","appworkspace","background","buttonhighlight","buttonshadow","captiontext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","window","windowframe","windowtext"];var Gu=["http:","https:","notes:","mailto:","onenote:"];function Yu(e){lo(e.attributeCallbacks,"href",(function(e,t){return function(e,t){var n;try{n=new URL(e)}catch(e){n=void 0}if(n&&Gu.indexOf(n.protocol)>-1)return e;return t.removeAttribute("href"),""}(e,t)}))}var Ju,Xu=function(){function e(e,t){void 0===e&&(e="SPAN"),void 0===t&&(t=!1),this.unknownTagReplacement=e,this.convertSingleImageBody=t,this.editor=null}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&10==e.eventType){var t=e.fragment,n=e.sanitizingOption,r=this.editor.getTrustedHTMLHandler();switch(function(e,t){var n=e.htmlAttributes,r=e.clipboardData,o=e.fragment,i=null,a={htmlAttributes:n,fragment:o,shouldConvertSingleImage:t,clipboardData:r};return Po.forEach((function(e,t){!i&&e(a)&&(i=t)})),null!=i?i:6}(e,this.convertSingleImageBody)){case 0:Ku(e);break;case 1:case 2:0!==e.pasteType&&2!==e.pasteType||eu(e,r);break;case 3:!function(e,t){var n=e.fragment,r=e.clipboardData;if(r.html&&!r.text&&r.image){var o=(new DOMParser).parseFromString(t(r.html),"text/html");xt(n,null==o?void 0:o.body)}}(e,r);break;case 5:cu(t,n);break;case 4:n.additionalTagReplacements["google-sheets-html-origin"]="*";break;case 7:!function(e,t){var n=e.fragment,r=e.clipboardData,o=r.html,i=r.image;if(o&&i){var a=(new DOMParser).parseFromString(t(o),"text/html");xt(n,null==a?void 0:a.body)}}(e,r);break;case 6:!function(e){Ys(e)?Ce(H(e.childNodes),"UL"):M(e.firstChild,"HTMLElement")&&Ys(e.firstChild)&&It(e.firstChild,"UL")}(t),function(e){for(var t=nt.createBodyTraverser(e),n=[],r=null==t?void 0:t.currentBlockElement;r;r=t.getNextBlockElement())n.push({start:r.getStartNode(),end:r.getEndNode()});if(n.length>0){var o=n.length-1;Vu(n[0]),Vu(n[o]),Wu(e,n[0],!0),Wu(e,n[o],!1,n[0])}}(t)}Yu(n),function(e){["color","background-color"].forEach((function(t){lo(e.cssStyleCallbacks,t,(function(e){return qu.indexOf(e)<0}))}))}(n),function(e){lo(e.cssStyleCallbacks,"display",(function(e){return"flex"!=e}))}(n),n.unknownTagReplacement=this.unknownTagReplacement}},e}();!function(e){function t(t,n,r,o,i,a,l,s){var u=e.call(this,t,n,r,o,i,l)||this;return u.div=t,u.onMouseOut=a(t),t.addEventListener("mouseout",u.onMouseOut),u}n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onMouseOut&&this.div.removeEventListener("mouseout",this.onMouseOut),this.onMouseOut=null}}(fs),function(e){e[e.top=0]="top",e[e.side=1]="side"}(Ju||(Ju={}));var Zu=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){var n,r=null;if(t.editor){var o=t.editor;At(e,(function(e){o&&!o.isDisposed()&&o.paste(e)}),{allowedCustomPasteType:t.state.allowedCustomPasteType,getTempDiv:function(){var e;return r=null!==(e=o.getSelectionRange())&&void 0!==e?e:null,t.getTempDiv(o)},removeTempDiv:function(e){r&&t.cleanUpAndRestoreSelection(e,r,!1)}},null!==(n=t.editor.getSelectionRange())&&void 0!==n?n:void 0)}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this;if(this.editor){var r=this.editor.getSelectionRangeEx();if(r&&!r.areAllCollapsed){var o=this.editor.getContent(2),i=this.getTempDiv(this.editor,!0),a=function(e,t,n){if(e)return t=t||"",e.innerHTML=(null==n?void 0:n(t))||t,eo(e)}(i,o,this.editor.getTrustedHTMLHandler()),l=null;if(1===r.type&&r.coordinates){var s=i.querySelector("#"+r.table.id);l=this.createTableRange(s,r.coordinates),t&&this.deleteTableContent(this.editor,r.table,r.coordinates)}else if(2===r.type){var u=i.querySelector("#"+r.image.id);u&&(l=ee(u),t&&this.deleteImage(this.editor,r.image.id))}else l=0===(null==a?void 0:a.type)?ee(i,a.start,a.end):null;if(l)this.editor.triggerPluginEvent(9,{clonedRoot:i,range:l,rawEvent:e,isCut:t}).range&&to(l),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(i,r,!t),t&&e.addUndoSnapshot((function(){var t=e.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")}))}}},e.prototype.getTempDiv=function(e,t){var n=e.getCustomData("CopyPasteTempDiv",(function(){var t=Ee(3,e.getDocument());return e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t,n){var r,o,i;if((null===(r=t)||void 0===r?void 0:r.type)||0==t.type){var a=t;switch(a.type){case 1:case 2:null===(o=this.editor)||void 0===o||o.select(a);break;case 0:var l=null===(i=a.ranges)||void 0===i?void 0:i[0];this.restoreRange(l,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",xt(e)},e.prototype.restoreRange=function(e,t){e&&this.editor&&(t&&ye.isAndroid&&e.collapse(),this.editor.select(e))},e.prototype.createTableRange=function(e,t){var n=new Vn(e);return n.selection=t,function(e){if(e.selection){if(Yn(e,e.selection))return;e.table.style.removeProperty("width"),e.table.style.removeProperty("height");var t=e.selection,n=t.firstCell,r=t.lastCell,o=[],i=n.x,a=n.y,l=r.x,s=r.y;e.cells&&(e.cells.forEach((function(e,t){(e=e.filter((function(e,n){return t>=a&&t<=s&&n>=i&&n<=l}))).length>0&&o.push(e)})),e.cells=o)}}(n),n.writeBack(),ee(n.table)},e.prototype.deleteTableContent=function(e,t,n){var r=new Vn(t);r.selection=n,function(e,t){var n;if(e.selection)for(var r=e.selection,o=r.lastCell,i=r.firstCell,a=i.y;a<=o.y;a++)for(var l=i.x;l<=o.x;l++)e.cells&&(null===(n=e.cells[a][l])||void 0===n?void 0:n.td)&&t(e.cells[a][l])}(r,(function(t){(null==t?void 0:t.td)&&(t.td.innerHTML=e.getTrustedHTMLHandler()("<br>"))}));var o=Yn(r,n),i=t.rows.length-1===n.lastCell.y&&0===n.firstCell.y;o?(r.edit(4),r.writeBack()):i&&(r.edit(5),r.writeBack()),(o||i)&&(t.style.removeProperty("width"),t.style.removeProperty("height"))},e.prototype.deleteImage=function(e,t){e.queryElements("#"+t,(function(t){e.deleteNode(t)}))},e}(),$u=function(){function e(e,t){var n,r=this;this.editor=null,this.disposer=null,this.onDragStart=function(e){var t,n=e,o=null===(t=r.editor)||void 0===t?void 0:t.getElementAtCursor("*",n.target);o&&!o.isContentEditable&&n.preventDefault()},this.onDrop=function(){var e;null===(e=r.editor)||void 0===e||e.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){var e,t,n;if(!r.state.skipReselectOnFocus){var o=r.state.tableSelectionRange||{},i=o.table,a=o.coordinates,l=(r.state.imageSelectionRange||{}).image;i&&a?null===(e=r.editor)||void 0===e||e.select(i,a):l?null===(t=r.editor)||void 0===t||t.select(l):r.state.selectionRange&&(null===(n=r.editor)||void 0===n||n.select(r.state.selectionRange))}r.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||r.cacheSelection()},this.onMouseDownDocument=function(e){!r.editor||r.state.selectionRange||r.editor.contains(e.target)||r.cacheSelection()},this.cacheSelection=function(){!r.state.selectionRange&&r.editor&&(r.state.selectionRange=r.editor.getSelectionRange(!1))},this.onScroll=function(e){var t;null===(t=r.editor)||void 0===t||t.triggerPluginEvent(14,{rawEvent:e,scrollContainer:r.state.scrollContainer})},this.onKeyboardEvent=function(e){(bo(e)||e.which>=33&&e.which<=40)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t,n,o=[],i=null===(t=r.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(),a=null==i?void 0:i.getInlineElementBefore(),l=e.target;2!=e.button&&a&&(l=a.getContainerNode()),r.state.contextMenuProviders.forEach((function(e){var t,n=null!==(t=e.getContextMenuItems(l))&&void 0!==t?t:[];(null==n?void 0:n.length)>0&&(o.length>0&&o.push(null),kr(o,n))})),null===(n=r.editor)||void 0===n||n.triggerPluginEvent(16,{rawEvent:e,items:o})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(ec))||[],tableSelectionRange:null,imageSelectionRange:null}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n,r,o,i=this;this.editor=e;var a=this.editor.getDocument(),l=((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return i.state.isInIME=!0},compositionend:function(t){i.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},dragstart:this.onDragStart,drop:this.onDrop,focus:this.onFocus})[ye.isIE?"textinput":"input"]=this.getEventHandler(3),t);ye.isSafari?(a.addEventListener("mousedown",this.onMouseDownDocument,!0),a.addEventListener("keydown",this.onKeyDownDocument),null===(n=a.defaultView)||void 0===n||n.addEventListener("blur",this.cacheSelection)):ye.isIEOrEdge?l.beforedeactivate=this.cacheSelection:l.blur=this.cacheSelection,this.disposer=e.addDomEventHandler(l),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(r=a.defaultView)||void 0===r||r.addEventListener("scroll",this.onScroll),null===(o=a.defaultView)||void 0===o||o.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,n,r,o,i=null===(e=this.editor)||void 0===e?void 0:e.getDocument();i&&ye.isSafari&&(i.removeEventListener("mousedown",this.onMouseDownDocument,!0),i.removeEventListener("keydown",this.onKeyDownDocument),null===(t=i.defaultView)||void 0===t||t.removeEventListener("blur",this.cacheSelection)),null===(n=null==i?void 0:i.defaultView)||void 0===n||n.removeEventListener("resize",this.onScroll),null===(r=null==i?void 0:i.defaultView)||void 0===r||r.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(o=this.disposer)||void 0===o||o.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){var t=this;return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:function(n){return 3==e?t.onInputEvent(n):t.onKeyboardEvent(n)}}:e},e}();function ec(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}var tc=function(){function e(){this.editor=null,this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,r=null,o=!1,i=0==e.eventType;if(i){var a=e.rawEvent,l=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n=(o=Co(a))||a.altKey,r=this.state.features[a.which]||l&&!l.collapsed&&this.state.features[258]}else 7==e.eventType&&(r=this.state.features[257]);for(var s=0;r&&s<(null==r?void 0:r.length);s++){var u=r[s];if((u.allowFunctionKeys||!n)&&this.editor&&u.shouldHandleEvent(e,this.editor,o)){u.handleEvent(e,this.editor),i&&(e.handledByEditFeature=!0);break}}},e}(),nc=".entityDelimiterAfter,.entityDelimiterBefore",rc="​",oc="span"+co();function ic(e,t){switch(e.eventType){case 7:"SetContent"===e.source&&lc(t);break;case 11:lc(t);break;case 10:var n=e.fragment,r=e.sanitizingOption;sc(n.querySelectorAll(oc)),r.additionalAllowedCssClasses&&kr(r.additionalAllowedCssClasses,["entityDelimiterAfter","entityDelimiterBefore"]);break;case 8:case 9:e.clonedRoot.querySelectorAll(nc).forEach((function(e){at(e)?cc(e):dc(e)}));break;case 0:!function(e,t){var n,r,o=e.getSelectionRangeEx(),i=t.rawEvent;if(0!=o.type)return;if(o.areAllCollapsed&&(bo(i)||13===i.which)){var a=null===(n=e.getFocusedPosition())||void 0===n?void 0:n.normalize();if(!a)return;var l=a.element,s=l==a.node?l.childNodes.item(a.offset):l,u=e.getElementAtCursor(nc,s);if(!u)return;13===i.which?function(e,t){var n=t.classList.contains("entityDelimiterAfter"),r=n?t.previousSibling:t.nextSibling,o=function(e,t){var n;if(!t)return;var r=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();for(;r&&!V(r);)r=e.contains(r.parentElement)?r.parentElement:void 0;return r}(e,t);e.runAsync((function(){if(o){var e=n?o.nextSibling:o.previousSibling;if(e&&M(e,"HTMLElement")){var t=e.querySelectorAll(nc);dc(t.item(n?0:t.length-1))}if(uc(r))[r.nextElementSibling,r.previousElementSibling].forEach((function(e){e&&Y(e,nc)&&!at(e)&&dc(e,!1)})),ut(r)}}))}(e,u):3==(null===(r=u.firstChild)||void 0===r?void 0:r.nodeType)&&e.runAsync((function(){return ac(u)}))}else if(!o.areAllCollapsed&&!i.shiftKey&&16!=i.which){var c=o.ranges[0];if(!c)return;!function(e,t,n){var r=t.startContainer,o=t.endContainer,i=t.startOffset,a=t.endOffset,l=e.getElementAtCursor(nc,r),s=e.getElementAtCursor(nc,o),u=fc(l),c=fc(s);(u||c)&&e.select(null!=u?u:new X(r,i),null!=c?c:new X(o,a));e.runAsync((function(e){var t=e.getElementAtCursor(nc);t&&(ac(t),13===n.which&&dc(t))}))}(e,c,i)}}(t,e)}}function ac(e){var t,n,r,o;e.normalize();var i,a=e.firstChild,l=null!==(n=null===(t=a.nodeValue)||void 0===t?void 0:t.indexOf(rc))&&void 0!==n?n:-1;if(l>=0&&(xe(a,0==l?1:l,!1),e.childNodes.forEach((function(e){e.nodeValue!==rc&&(i=e)})),i)){null===(r=e.parentElement)||void 0===r||r.insertBefore(i,"entityDelimiterBefore"==e.className?e:e.nextSibling);var s=null===(o=i.ownerDocument)||void 0===o?void 0:o.getSelection();s&&s.setPosition(i,new X(i,-1).offset)}}function lc(e){e.queryElements(nc).forEach((function(e){if(at(e)){var t=e.classList.contains("entityDelimiterBefore")?e.nextElementSibling:e.previousElementSibling;M(t,"HTMLElement")&&uo(t)||cc(e)}else dc(e)})),sc(e.queryElements(oc))}function sc(e){e.forEach((function(e){uc(e)&&ut(e)}))}function uc(e){return!!(e&&M(e,"HTMLElement")&&(t=uo(e),(null==t?void 0:t.isReadonly)&&!V(t.wrapper)&&M(t.wrapper,"HTMLElement")));var t}function cc(e){var t;null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e)}function dc(e,t){if(void 0===t&&(t=!0),e){var n=e.classList.contains("entityDelimiterAfter")?e.previousElementSibling:e.nextElementSibling;t&&n&&uc(n)||(e.classList.remove("entityDelimiterAfter","entityDelimiterBefore"),e.normalize(),e.childNodes.forEach((function(e){var t,n,r,o=null!==(n=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(rc))&&void 0!==n?n:-1;o>=0&&(null===(r=ee(e,o,e,o+1))||void 0===r||r.deleteContents())})))}}var fc=function(e){if(e&&at(e)){var t=e.classList.contains("entityDelimiterAfter");return new X(e,t?-3:-2)}};var pc=/_(\d{1,8})$/,hc=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],vc=[6,7,4,5],gc=function(){function e(){var e=this;this.editor=null,this.handleCutEvent=function(t){var n,r=null===(n=e.editor)||void 0===n?void 0:n.getSelectionRange();r&&!r.collapsed&&e.checkRemoveEntityForRange(t)},this.state={entityMap:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 15:this.handleEntityOperationEvent(e)}this.editor&&ic(e,this.editor)},e.prototype.handleContextMenuEvent=function(e){var t,n=e.target,r=n&&(null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor(co(),n));r&&(e.preventDefault(),this.triggerEvent(r,2,e))},e.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,r=e.isClicking,o=n.target;this.editor&&r&&o&&(t=this.editor.getElementAtCursor(co(),o))&&(this.triggerEvent(t,1,n),mc(this.editor))},e.prototype.handleKeyDownEvent=function(e){var t;if(bo(e)||8==e.which||46==e.which||13==e.which){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(null),e.additionalAllowedCssClasses&&kr(e.additionalAllowedCssClasses,hc)},e.prototype.handleContentChangedEvent=function(e){var t=this,n=!1;oe(this.state.entityMap).forEach((function(e){var r=t.state.entityMap[e],o=r.element;!t.editor||r.isDeleted||t.editor.contains(o)||(r.isDeleted=!0,t.triggerEvent(o,6),n||o.isContentEditable||V(o)||(n=!0))})),("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var n=t.state.entityMap[e.id];return!n||n.element!=e.wrapper||n.isDeleted}))).forEach((function(e){var n=e.wrapper,r=e.type,o=e.id,i=e.isReadonly;e.id=t.ensureUniqueId(r,o,n),function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute(so)&&e.removeAttribute(so))}(n,r,i,e.id),t.handleNewEntity(e)})),n&&this.editor&&lc(this.editor)},e.prototype.handleEntityOperationEvent=function(e){if(this.editor&&vc.indexOf(e.operation)>=0){var t=this.state.entityMap[e.entity.id];t&&(t.isDeleted=!0)}},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;H(e.querySelectorAll(co())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t,n=this,r=[],o=co();if(null===(t=this.editor)||void 0===t||t.queryElements(o,1,(function(t){t.isContentEditable?r.push(t):n.triggerEvent(t,6,e)})),this.editor&&r.length>0){var i=this.editor.queryElements(o,2);r.forEach((function(t){var r=i.indexOf(t)>=0;n.triggerEvent(t,r?6:7,e)}))}},e.prototype.triggerEvent=function(e,t,n){var r,o=e&&uo(e);return o?null===(r=this.editor)||void 0===r?void 0:r.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:o}):null},e.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.triggerEvent(t,0),r={element:e.wrapper};(null==n?void 0:n.shouldPersist)&&(r.canPersist=!0),this.state.entityMap[e.id]=r},e.prototype.getExistingEntities=function(){var e,t;return null!==(t=null===(e=this.editor)||void 0===e?void 0:e.queryElements(co()).map(uo).filter((function(e){return!!e})))&&void 0!==t?t:[]},e.prototype.ensureUniqueId=function(e,t,n){for(var r=pc.exec(t),o=(r?t.substr(0,t.length-r[0].length):t)||e,i="",a=r&&parseInt(r[1])||0;;a++){i=a>0?o+"_"+a:o;var l=this.state.entityMap[i];if(!l||l.element==n)break}return i},e}(),mc=ye.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=Ee({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="",to(ee(t,0))}))}:function(){},Ac=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ImageSelection"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.select(null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n;if(this.editor)switch(e.eventType){case 6:var r=e.rawEvent.target;M(r,"HTMLImageElement")&&r.isContentEditable&&1!=e.rawEvent.button&&this.editor.select(r);break;case 5:var o=e.rawEvent.target,i=this.editor.getSelectionRangeEx();i&&2===i.type&&i.image!==o&&this.editor.select(null);break;case 0:var a=e.rawEvent,l=a.key,s=this.editor.getSelectionRangeEx();if(!(a.ctrlKey||a.altKey||a.shiftKey||a.metaKey||2!==s.type)){var u=null===(t=s.image)||void 0===t?void 0:t.parentNode;"Escape"===l&&u?(this.editor.select(s.image,-2),null===(n=this.editor.getSelectionRange())||void 0===n||n.collapse(),e.rawEvent.stopPropagation()):"Delete"===l?(this.editor.deleteNode(s.image),e.rawEvent.preventDefault()):u&&this.editor.select(s.image,-2)}break;case 16:var c=e.rawEvent.target,d=this.editor.getSelectionRangeEx();!M(c,"HTMLImageElement")||2===d.type&&d.image===c||this.editor.select(c)}},e}(),yc="contenteditable",bc={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},Ec={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},Cc=function(){function e(e,t){var n,o,i=this;this.editor=null,this.initializer=null,this.disposer=null,this.initialContent=e.initialContent||t.innerHTML||"",null===t.getAttribute(yc)&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text"},this.disposer=function(){t.style.userSelect="",t.removeAttribute(yc)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e,n=Ec,r=bc,o=i.state.isDarkMode,a=null===(e=i.editor)||void 0===e?void 0:e.getDarkColorHandler();nn(t,n,!1,o,!1,a),nn(t,r,!0,o,!1,a)};var a=null!==(n=e.getDarkColor)&&void 0!==n?n:function(e){return e},l=e.defaultFormat?r({},e.defaultFormat):null;l&&(l.textColor&&!l.textColors&&(l.textColors={lightModeColor:l.textColor,darkModeColor:a(l.textColor)},delete l.textColor),l.backgroundColor&&!l.backgroundColors&&(l.backgroundColors={lightModeColor:l.backgroundColor,darkModeColor:a(l.backgroundColor)},delete l.backgroundColor)),this.state={customData:{},defaultFormat:l,isDarkMode:!!e.inDarkMode,getDarkColor:a,onExternalContentTransform:null!==(o=e.onExternalContentTransform)&&void 0!==o?o:null,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditEntities:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null,shadowEditImageSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e,t=this;null===(e=this.editor)||void 0===e||e.triggerPluginEvent(12,{},!0),oe(this.state.customData).forEach((function(e){var n=t.state.customData[e];n&&n.disposer&&n.disposer(n.value),delete t.state.customData[e]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.adjustColor())},e}(),wc=function(){function e(){var e=this;this.editor=null,this.mouseUpEventListerAdded=!1,this.mouseDownX=null,this.mouseDownY=null,this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t,isClicking:e.mouseDownX==t.pageX&&e.mouseDownY==t.pageY}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&5==e.eventType&&!this.mouseUpEventListerAdded&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}(),Sc=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"NormalizeTable"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.editor&&this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables(H(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent);break;case 8:H(e.clonedRoot.querySelectorAll("li")).forEach((function(e){var t=e.previousSibling;"block"==e.style.display&&M(t,"HTMLLIElement")&&(e.style.removeProperty("display"),t.appendChild(It(e,"div")))}))}},e.prototype.normalizeTableFromEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("table",e.target);n&&this.normalizeTables([n])},e.prototype.normalizeTables=function(e){if(this.editor&&e.length>0){var t=this.editor.getSelectionRangeEx(),n=0==(null==t?void 0:t.type)&&t.ranges[0]||{},r=n.startContainer,o=n.endContainer,i=n.startOffset,a=n.endOffset,l=function(e){var t=!1;return e.forEach((function(e){for(var n,r=null,o=e.firstChild;o;o=o.nextSibling){switch(j(o)){case"TR":r||(r=e.ownerDocument.createElement("tbody"),e.insertBefore(r,o)),r.appendChild(o),o=r,t=!0;break;case"TBODY":r?(xt(r,o,!0),null===(n=o.parentNode)||void 0===n||n.removeChild(o),o=r,t=!0):r=o;break;default:r=null}}var i=e.querySelectorAll("colgroup"),a=e.querySelector("thead");a&&i.forEach((function(e){a.contains(e)||a.appendChild(e)}))})),t}(e);l&&(r&&o&&"number"==typeof i&&"number"==typeof a?this.editor.select(r,i,o,a):1==(null==t?void 0:t.type)&&t.coordinates&&this.editor.select(t.table,t.coordinates))}},e}();var Tc,Dc,kc=function(){function e(){this.editor=null,this.state={pendableFormatPosition:null,pendableFormatState:null,pendableFormatSpan:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:e.formatState?(this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState,this.state.pendableFormatSpan=e.formatCallback?this.createPendingFormatSpan(e.formatCallback):null):this.clear();break;case 0:case 5:case 7:var t=null;this.editor&&0==e.eventType&&bo(e.rawEvent)&&this.state.pendableFormatSpan?(this.state.pendableFormatSpan.removeAttribute("contentEditable"),this.editor.insertNode(this.state.pendableFormatSpan),this.editor.select(this.state.pendableFormatSpan,0,this.state.pendableFormatSpan,-1),this.clear()):(0==e.eventType&&e.rawEvent.which>=33&&e.rawEvent.which<=40||this.state.pendableFormatPosition&&(t=this.getCurrentPosition())&&!this.state.pendableFormatPosition.equalTo(t)||7==e.eventType&&("SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source))&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null,this.state.pendableFormatSpan=null},e.prototype.getCurrentPosition=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getSelectionRange();return null!==(t=n&&X.getStart(n).normalize())&&void 0!==t?t:null},e.prototype.createPendingFormatSpan=function(e){var t,n,r=this.state.pendableFormatSpan;if(!r&&this.editor){var o=this.editor.getStyleBasedFormatState(),i=this.editor.getDocument(),a=this.editor.isDarkMode();(r=i.createElement("span")).contentEditable="true",r.appendChild(i.createTextNode("​")),r.style.setProperty("font-family",null!==(t=o.fontName)&&void 0!==t?t:null),r.style.setProperty("font-size",null!==(n=o.fontSize)&&void 0!==n?n:null);var l=this.editor.getDarkColorHandler();(o.textColors||o.textColor)&&nn(r,o.textColors||o.textColor,!1,a,!1,l),(o.backgroundColors||o.backgroundColor)&&nn(r,o.backgroundColors||o.backgroundColor,!0,a,!1,l)}return r&&e(r),r},e}(),xc=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.isRangeEmpty=function(e){return!(!e.collapsed||e.startContainer.nodeType!==Node.ELEMENT_NODE||"DIV"!=j(e.startContainer)||e.startContainer.firstChild)},e.prototype.onPluginEvent=function(e){var t,n=this;if(1==e.eventType&&this.editor&&(!e.rawEvent||!Co(e.rawEvent))){var r=this.editor.getSelectionRange(),o=r&&J(r.startContainer,void 0,"[style]");if(!r||!this.isRangeEmpty(r)&&this.editor.contains(o))return;if(r.collapsed)this.editor.ensureTypeInContainer(X.getStart(r),e.rawEvent);else{var i=function(){var t,r,o=null===(t=n.editor)||void 0===t?void 0:t.getFocusedPosition();o&&(null===(r=n.editor)||void 0===r||r.ensureTypeInContainer(o,e.rawEvent))};ye.isMobileOrTablet?null===(t=this.editor.getDocument().defaultView)||void 0===t||t.setTimeout(i,100):this.editor.runAsync(i)}}},e}(),Ic=function(){function e(e){var t,n,r,o;this.editor=null,this.lastKeyPress=null,this.state={snapshotsService:e.undoMetadataSnapshotService||(r=e.undoSnapshotService,r?{canMove:function(e){return r.canMove(e)},move:function(e){return(o=r.move(e))?{html:o,metadata:null,knownColors:[]}:null},addSnapshot:function(e,t){return r.addSnapshot(e.html+(e.metadata?"\x3c!--"+JSON.stringify(e.metadata)+"--\x3e":""),t)},clearRedo:function(){return r.clearRedo()},canUndoAutoComplete:function(){return r.canUndoAutoComplete()}}:void 0)||(t=1e7,n={snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:t},{canMove:function(e){return no(n,e)},move:function(e){return function(e,t){return no(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}(n,e)},addSnapshot:function(e,t){return oo(n,e,t)},clearRedo:function(){return function(e){ro(e,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}))}(n)},canUndoAutoComplete:function(){return function(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}(n)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.onContentChanged(e);break;case 23:this.onBeforeKeyboardEditing(e.rawEvent)}},e.prototype.onKeyDown=function(e){var t,n;if(8==e.which&&!e.altKey||46==e.which){if(8==e.which&&!e.ctrlKey&&this.canUndoAutoComplete())e.preventDefault(),null===(t=this.editor)||void 0===t||t.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else if(!e.defaultPrevented){var r=null===(n=this.editor)||void 0===n?void 0:n.getSelectionRange();!r||r.collapsed&&this.lastKeyPress==e.which&&!Co(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}}else e.which>=33&&e.which<=40?(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0):8!=this.lastKeyPress&&46!=this.lastKeyPress||this.state.hasNewContent&&this.addUndoSnapshot()},e.prototype.onKeyPress=function(e){var t;if(!e.metaKey){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.onBeforeKeyboardEditing=function(e){e.which!=this.lastKeyPress&&this.addUndoSnapshot(),this.lastKeyPress=e.which,this.state.hasNewContent=!0},e.prototype.onContentChanged=function(e){this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||"Keyboard"==e.source||this.clearRedoForInput()},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getFocusedPosition();return this.state.snapshotsService.canUndoAutoComplete()&&!!n&&!!(null===(t=this.state.autoCompletePosition)||void 0===t?void 0:t.equalTo(n))},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();var Lc,Nc=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/;!function(e){e[e.CssColor=0]="CssColor",e[e.HtmlColor=1]="HtmlColor"}(Lc||(Lc={}));var Rc=[(Tc={},Tc[0]="color",Tc[1]="color",Tc),(Dc={},Dc[0]="background-color",Dc[1]="bgcolor",Dc)],Bc=function(){function e(e,t){this.contentDiv=e,this.getDarkColor=t,this.knownColors={}}return e.prototype.getKnownColorsCopy=function(){return Object.values(this.knownColors)},e.prototype.registerColor=function(e,t,n){var r,o=this.parseColorValue(e);return o&&(e=o.lightModeColor,n=o.darkModeColor||n,r=o.key),t&&e?(r=r||"--darkColor_"+e.replace(/[^\d\w]/g,"_"),this.knownColors[r]||(n=n||this.getDarkColor(e),this.knownColors[r]={lightModeColor:e,darkModeColor:n},this.contentDiv.style.setProperty(r,n)),"var("+r+", "+e+")"):e},e.prototype.reset=function(){var e=this;oe(this.knownColors).forEach((function(t){return e.contentDiv.style.removeProperty(t)})),this.knownColors={}},e.prototype.parseColorValue=function(e,t){var n,r,o,i="";if(e){var a=e.startsWith("var(")?Nc.exec(e):null;a?a[2]?(r=a[1],i=a[2],o=null===(n=this.knownColors[r])||void 0===n?void 0:n.darkModeColor):i="":t?(i=this.findLightColorFromDarkColor(e)||"")&&(o=e):i=e}return{key:r,lightModeColor:i,darkModeColor:o}},e.prototype.findLightColorFromDarkColor=function(e){var t=this,n=Gt(e);if(n){var r=oe(this.knownColors).find((function(e){var r=Gt(t.knownColors[e].darkModeColor);return r&&r[0]==n[0]&&r[1]==n[1]&&r[2]==n[2]}));if(r)return this.knownColors[r].lightModeColor}return null},e.prototype.transformElementColor=function(e,t,n){var r=this;Rc.forEach((function(o,i){var a=r.parseColorValue(e.style.getPropertyValue(o[0])||e.getAttribute(o[1]),!!t).lightModeColor;e.style.setProperty(o[0],null),e.removeAttribute(o[1]),a&&"inherit"!=a&&nn(e,a,0!=i,n,!1,r)}))},e}();function Mc(e,t,n){var o;if(!e.lifecycle.shadowEditFragment){var i=e.api.getSelectionRangeEx(e),a=e.lifecycle.isDarkMode,l=function(e,t,n){switch(null==t?void 0:t.type){case 1:return r({type:1,tableId:t.table.id,isDarkMode:!!n},t.coordinates);case 2:return{type:2,imageId:t.image.id,isDarkMode:!!n};case 0:return r({type:0,isDarkMode:!!n,start:[],end:[]},Ur(e,t.ranges[0])||{})}}(e.contentDiv,i,a)||null;e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:l,knownColors:(null===(o=e.darkColorHandler)||void 0===o?void 0:o.getKnownColorsCopy())||[],entityStates:n},t),e.undo.hasNewContent=!1}}var Pc={isBold:function(e,t){return"B"==e||"STRONG"==e||"H1"==e||"H2"==e||"H3"==e||"H4"==e||"H5"==e||"H6"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},Oc={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}};function _c(e){return{type:0,ranges:e,areAllCollapsed:Fc(e)}}function Fc(e){return e.filter((function(e){return null==e?void 0:e.collapsed})).length==e.length}var Hc=function(e){var t=e.contentDiv.ownerDocument.activeElement;return!(!t||!P(e.contentDiv,t,!0))};function Uc(e,t){var n=e.ownerDocument;e.id?n.querySelectorAll("#"+e.id).length>1&&(e.removeAttribute("id"),zc(e,t,n)):zc(e,t,n)}function zc(e,t,n){for(var r=0,o=function(){return n.getElementById(t+r)},i=o();i;)r++,i=o();e.id=t+r}var jc="imageStyle",Qc=function(e,t){wo(t,["border","margin"]);var n=Kc(e,t.id);So(e.contentDiv.ownerDocument,n,jc+e.contentDiv.id)},Kc=function(e,t){return"#"+e.contentDiv.id+" #"+t+" {outline-style: auto!important;outline-color: "+(e.imageSelectionBorderColor||"#DB626C")+"!important;caret-color: transparent!important;}"},Vc=function(e){To(e.contentDiv.ownerDocument,jc+e.contentDiv.id)};var Wc="tableStyle",qc="{background-color: rgb(198,198,198) !important; caret-color: transparent}",Gc=9e3;function Yc(e,t,n){var r,o=[],i=[],a=new Vn(e),l=Yn(a,t);l?function(e,t,n,r){var o=t.table,i=e+" #"+o.id;n.push(i,i+" *");var a=new Range;a.selectNode(o),r.push(a)}(n,a,i,o):function(e,t,n,r,o){var i,a=e.firstCell.y,l=e.firstCell.x,s=e.lastCell.y,u=e.lastCell.x,c=t.table,d=null,f=null,p=H(c.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf(j(e))>-1})),h=0,v=p.map((function(e){var t={el:j(e),start:h,end:e.childNodes.length+h};return h=t.end,t}));null===(i=t.cells)||void 0===i||i.forEach((function(e,t){var i=0;d=null,f=null;for(var p=v.filter((function(e){return e.start<=t&&e.end>t}))[0],h=p?">"+p.el+">":">",g=p&&t+1>=p.start?t+1-p.start:t+1,m=0;m<e.length;m++){var A=e[m].td;if(A&&(i++,t>=a&&t<=s&&m>=l&&m<=u)){Zc(A);var y=Xc(n,c.id,h,g,j(A),i),b=y+" *";r.push(y,b),d=d||c.querySelector(y),f=c.querySelector(y)}}if(d&&f){var E=new Range;E.setStartBefore(d),E.setEndAfter(f),o.push(E)}}))}(t,a,n,i,o);for(var s=[],u="";i.length>0;)((u+=(u.length>0?",":"")+i.shift()||"").length+((null===(r=i[0])||void 0===r?void 0:r.length)||0)>Gc||0==i.length)&&(s.push(u+" "+qc),u="");return{cssRules:s,ranges:o,isWholeTableSelected:l}}var Jc=function(e){To(e.contentDiv.ownerDocument,Wc+e.contentDiv.id)};function Xc(e,t,n,r,o,i){return e+" #"+t+n+" tr:nth-child("+r+")>"+o+":nth-child("+i+")"}function Zc(e){e&&wo(e,["background-color","background"])}function $c(e){return(!!e||0==e)&&e>-1}function ed(e,t,n){n&&td(e)&&t(e);for(var r=e.firstChild;r;r=r.nextSibling)td(r)&&t(r),ed(r,t)}function td(e){var t=e;return e.nodeType==Node.ELEMENT_NODE&&!!t.style}var nd=[11,12,8,21];var rd={attachDomEvent:function(e,t){var n=oe(t||{}).map((function(n){var r=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"==typeof e?t.pluginEventType=e:"function"==typeof e?t.beforeDispatch=e:"object"==typeof e&&(t=e);return t}(t[n]),o=r.pluginEventType,i=r.beforeDispatch,a=n,l=function(t){i&&i(t),null!=o&&e.api.triggerEvent(e,{eventType:o,rawEvent:t},!1)};return e.contentDiv.addEventListener(a,l),function(){e.contentDiv.removeEventListener(a,l)}}));return function(){return n.forEach((function(e){return e()}))}},addUndoSnapshot:function(e,t,n,r,o){var i,a,l,s=e.undo,u=s.isNested;u||(s.isNested=!0,!e.undo.hasNewContent&&(null==o?void 0:o.getEntityState)&&t||Mc(e,r,null===(i=null==o?void 0:o.getEntityState)||void 0===i?void 0:i.call(o)));try{var c;if(t)if(l=t((c=e.api.getSelectionRange(e,!0))&&X.getStart(c).normalize(),c&&X.getEnd(c).normalize()),!u)Mc(e,!1,null===(a=null==o?void 0:o.getEntityState)||void 0===a?void 0:a.call(o))}finally{u||(s.isNested=!1)}if(t&&n){var d={eventType:7,source:n,data:l,additionalData:o};e.api.triggerEvent(e,d,!0)}r&&((c=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=X.getStart(c)))},createPasteFragment:function(e,t,n,r,o,i){if(void 0===i&&(i=!1),!t)return null;var a=function(e,t,n){return e?1:t?2:n?3:0}(r,o,i),l=function(e,t,n){var r={elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null};return r.cssStyleCallbacks["caret-color"]=function(){return!1},{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:r,htmlBefore:"",htmlAfter:"",htmlAttributes:{},pasteType:n}}(e,t,a);return function(e,t,n,r,o,i,a){var l=a.fragment,s=t.rawHtml,u=t.text,c=t.imageDataUri,d=s?(new DOMParser).parseFromString(e.trustedHTMLHandler(s),"text/html"):void 0;if(function(e,t,n){var r,o,i=t.clipboardData,a=t.sanitizingOption,l=i.rawHtml;if(l&&(null==e?void 0:e.body)){var s=null===(r=e.querySelector("html"))||void 0===r?void 0:r.attributes;(s?H(s):[]).reduce((function(e,t){return e[t.name]=t.value,e}),t.htmlAttributes),H(e.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),t.htmlAttributes),i.htmlFirstLevelChildTags=[],null==e||e.body.normalize();for(var u=0;u<(null==e?void 0:e.body.childNodes.length);u++){var c=null==e?void 0:e.body.childNodes.item(u);if(c.nodeType!=Node.TEXT_NODE||(null===(o=c.nodeValue)||void 0===o?void 0:o.replace(/(\r\n|\r|\n)/gm,"").trim())){var d=j(c);c.nodeType!=Node.COMMENT_NODE&&i.htmlFirstLevelChildTags.push(d)}}Tt(e,(function(t){null==e||e.head.appendChild(t),a.additionalGlobalStyleNodes.push(t)}));var f=l.indexOf(wt),p=l.lastIndexOf(St);f>=0&&p>=f+wt.length&&(t.htmlBefore=l.substr(0,f),t.htmlAfter=l.substr(p+St.length),i.html=l.substring(f+wt.length,p),e.body.innerHTML=n(i.html),Tt(e.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})))}}(d,a,e.trustedHTMLHandler),i&&c||!r&&!u&&c)!function(e,t){var n=t.ownerDocument.createElement("img");n.style.maxWidth="100%",n.src=e,t.appendChild(n)}(c,l);else if(!r&&s&&d&&d.body){if(xt(l,null==d?void 0:d.body),o&&n){var f=function(e,t){var n=e.api.getPendableFormatState(e,!0),r=e.api.getStyleBasedFormatState(e,t);return{fontFamily:r.fontName,fontSize:r.fontSize,textColor:r.textColor,backgroundColor:r.backgroundColor,textColors:r.textColors,backgroundColors:r.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);He(l,(function(e){return rn(e,f)}))}}else u&&Ct(u,n,l);1!==a.pasteType&&e.api.triggerEvent(e,a,!0);return function(e,t){var n=e.fragment,r=new Qt(e.sanitizingOption);r.convertGlobalCssToInlineCss(n),r.sanitize(n,t?kt(t.element):void 0)}(a,n),l}(e,t,n,r,o,i,l)},ensureTypeInContainer:function(e,t,n){var r,o=J(t.node,e.contentDiv,"table");o&&(r=o.querySelector("td,th"))&&(t=new X(r,0)),t=t.normalize();var i,a=Te(e.contentDiv,t.node);if(a){if(un(i=a.collapseToSingleElement(),!1,!0)){var l=i.ownerDocument.createElement("br");i.append(l)}var s=un(i)||n&&function(e,t){return M(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,i);i=i&&s?i:null}else i=Ee(1,e.contentDiv.ownerDocument),e.api.insertNode(e,i,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new X(i,0);i&&e.lifecycle.defaultFormat&&rn(i,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode,e.darkColorHandler),n&&e.api.selectRange(e,ee(new X(t)))},focus:function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=We(e.contentDiv)||e.contentDiv;e.api.selectRange(e,ee(t,0),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},getContent:function(e,t){var n="",r=0==t,o=2==t,i=e.lifecycle.shadowEditFragment||e.contentDiv;if(4==t)n=i.textContent;else if(3==t)n=function(e){for(var t=nt.createBodyTraverser(e),n=t&&t.currentBlockElement,r=[];n;)r.push(n.getTextContent()),n=t.getNextBlockElement();return r.join("\n")}(i);else{var a=function(e){var t;M(e,"DocumentFragment")?(t=e.ownerDocument.createElement("div")).appendChild(e.cloneNode(!0)):t=e.cloneNode(!0);return t}(i);a.normalize();var l=e.api.getSelectionRange(e,!0),s=o?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:l?Ur(e.contentDiv,l):null:null,u=s&&ee(a,s.start,s.end);e.api.transformColor(e,a,!1,null,1,!0,e.lifecycle.isDarkMode),r?(e.api.triggerEvent(e,{eventType:8,clonedRoot:a},!0),n=a.innerHTML):n=u?jr(a,u):a.innerHTML}return null!=n?n:""},getSelectionRange:function(e,t){var n,r=null;if(e.lifecycle.shadowEditFragment)return r=e.lifecycle.shadowEditSelectionPath&&ee(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var o=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(o&&o.rangeCount>0){var i=o.getRangeAt(0);P(e.contentDiv,i)&&(r=i)}}return!r&&t&&(r=e.domEvent.selectionRange),r},getSelectionRangeEx:function(e){var t,n,r;if(e.lifecycle.shadowEditFragment){var o,i=e.lifecycle,a=i.shadowEditTableSelectionPath,l=i.shadowEditSelectionPath,s=i.shadowEditImageSelectionPath;if(((null==a?void 0:a.length)||0)>0)return{type:1,ranges:o=e.lifecycle.shadowEditTableSelectionPath.map((function(t){return ee(e.contentDiv,t.start,t.end)})),areAllCollapsed:Fc(o),table:J(o[0].startContainer,e.contentDiv,"table"),coordinates:void 0};if(((null==s?void 0:s.length)||0)>0)return{type:2,ranges:o=e.lifecycle.shadowEditImageSelectionPath.map((function(t){return ee(e.contentDiv,t.start,t.end)})),areAllCollapsed:Fc(o),image:J(o[0].startContainer,e.contentDiv,"img"),imageId:void 0};var u=l&&ee(e.contentDiv,l.start,l.end);return _c(u?[u]:[])}if(e.api.hasFocus(e)){if(e.domEvent.tableSelectionRange)return e.domEvent.tableSelectionRange;if(e.domEvent.imageSelectionRange)return e.domEvent.imageSelectionRange;var c=null===(t=e.contentDiv.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection();if(c&&c.rangeCount>0){var d=c.getRangeAt(0);if(P(e.contentDiv,d))return _c([d])}}return null!==(r=null!==(n=e.domEvent.tableSelectionRange)&&void 0!==n?n:e.domEvent.imageSelectionRange)&&void 0!==r?r:_c(e.domEvent.selectionRange?[e.domEvent.selectionRange]:[])},getStyleBasedFormatState:function(e,t){if(!t)return{};var n=[],r=e.pendingFormatState.pendableFormatSpan;r&&(n=[r.style.fontFamily,r.style.fontSize,r.style.color,r.style.backgroundColor]);for(var o,i,a=t?Ie(t,["font-family","font-size","color","background-color","line-height","margin-top","margin-bottom","text-align","direction","font-weight"]):[],l=e.contentDiv,s=e.darkColorHandler;t&&P(l,t,!0)&&(!o||!i);){if(1==t.nodeType){var u=t;o=o||u.style.getPropertyValue("color"),i=i||u.style.getPropertyValue("background-color")}t=t.parentNode}e.lifecycle.isDarkMode||t!=e.contentDiv||(o=o||a[2],i=i||a[3]);var c=s.parseColorValue(n[2]||o),d=s.parseColorValue(n[3]||i);return{fontName:n[0]||a[0],fontSize:n[1]||a[1],textColor:c.lightModeColor,backgroundColor:d.lightModeColor,textColors:c.darkModeColor?{lightModeColor:c.lightModeColor,darkModeColor:c.darkModeColor}:void 0,backgroundColors:d.darkModeColor?{lightModeColor:d.lightModeColor,darkModeColor:d.darkModeColor}:void 0,lineHeight:a[4],marginTop:a[5],marginBottom:a[6],textAlign:a[7],direction:a[8],fontWeight:a[9]}},getPendableFormatState:function(e,t){var n,r=e.api.getSelectionRange(e,!0),o=e.pendingFormatState.pendableFormatState,i=null===(n=e.pendingFormatState.pendableFormatPosition)||void 0===n?void 0:n.normalize(),a=r&&X.getStart(r).normalize(),l=a&&i&&r.collapsed&&a.equalTo(i);return r&&o&&l&&!t?o:a?function(e,t){var n=t.node,r={},o=[],i=function(){var e=j(n),t=1==n.nodeType&&n.style;e&&t&&oe(Pc).forEach((function(n){o.indexOf(n)>=0||(r[n]=r[n]||Pc[n](e,t),Oc[n](t)&&o.push(n))})),n=n.parentNode};for(;n&&P(e.contentDiv,n);)i();return r}(e,a):{}},hasFocus:Hc,insertNode:function(e,t,n){var r;n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0,insertToRegionRoot:!1};var o=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(null===(r=o.parentNode)||void 0===r||r.insertBefore(t,o.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){var r,i;if(n)switch(n.position){case 0:case 1:var a,l=0==n.position,s=ke(o,l);if(s){var u=l?s.getStartNode():s.getEndNode();n.insertOnNewLine||3==u.nodeType||G(u)?M(t,"DocumentFragment")?(a=H(t.childNodes),null===(r=u.parentNode)||void 0===r||r.insertBefore(t,l?u:u.nextSibling)):a=null===(i=u.parentNode)||void 0===i?void 0:i.insertBefore(t,l?u:u.nextSibling):a=u.insertBefore(t,l?u.firstChild:null)}else a=o.appendChild(t);if(a&&n.insertOnNewLine){var c=Array.isArray(a)?a:[a];V(c[0])&&V(c[c.length-1])||Ce(c)}break;case 2:var d=o.appendChild(t);d&&n.insertOnNewLine&&!V(d)&&Ce(d);break;case 5:case 3:var f=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),p=f.range,h=f.rangeToRestore;if(!p)return;n.replaceSelection&&!p.collapsed&&p.deleteContents();var v=X.getStart(p),g=void 0;v=n.insertOnNewLine&&n.insertToRegionRoot?function(e,t,n){var r=Pr(e.contentDiv,t,0)[0],o=n.node;if(r){if(3!=o.nodeType||n.isAtEnd||(o=xe(o,n.offset,!0)),o!=r.rootNode)for(;o&&o.parentNode!=r.rootNode;)_(o,!1),o=o.parentNode;o&&(n=new X(o,-3))}return n}(e,p,v):n.insertOnNewLine&&(g=Te(o,v.normalize().node))?function(e,t,n){var r=new X(e.getEndNode(),-3);if(M(r.node,"HTMLTableRowElement")){var o=t.contentDiv.ownerDocument.createElement("div");ee(n).insertNode(o),r=new X(o,0)}return r}(g,e,v):function(e,t,n,r){return xo.forEach((function(o){n=o(e,t,n,r)})),n}(o,t,v,p);var m=11==t.nodeType?t.lastChild:t;(p=ee(v)).insertNode(t),n.updateCursor&&m&&(h=ee(new X(m,-3).normalize())),h&&e.api.selectRange(e,h)}}),0),!0)},restoreUndoSnapshot:function(e,t){var n,r;e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var o=e.undo.snapshotsService.move(t);if(o&&null!=o.html)try{e.undo.isRestoring=!0,e.api.setContent(e,o.html,!0,null!==(n=o.metadata)&&void 0!==n?n:void 0);var i=e.darkColorHandler,a=e.lifecycle.isDarkMode;o.knownColors.forEach((function(e){i.registerColor(e.lightModeColor,a,e.darkModeColor)})),null===(r=o.entityStates)||void 0===r||r.forEach((function(t){var n=t.type,r=t.id,o=t.state,i=gn(e.contentDiv,co(n,r))[0],a=i&&uo(i);a&&e.api.triggerEvent(e,{eventType:15,operation:11,entity:a,state:o},!1)}))}finally{e.undo.isRestoring=!1}},select:function(e,t,n,r,o){var i=function(e,t,n,r,o){var i=null;if(function(e){var t=e;return t&&"object"==typeof t&&"number"==typeof t.type&&Array.isArray(t.ranges)}(t))i=t;else if(M(t,"HTMLTableElement")&&(l=n,s=l,null===s||s&&"object"==typeof s&&"object"==typeof s.firstCell&&"object"==typeof s.lastCell))i={type:1,ranges:[],areAllCollapsed:!1,table:t,coordinates:null!=n?n:void 0};else if(M(t,"HTMLImageElement")&&void 0===n)i={type:2,ranges:[],areAllCollapsed:!1,image:t};else{var a=t?M(t,"Range")?t:function(e){var t=e;return t&&"object"==typeof t&&Array.isArray(t.start)&&Array.isArray(t.end)}(t)?ee(e.contentDiv,t.start,t.end):function(e){var t=e;return t&&"object"==typeof t&&"object"==typeof t.node&&"number"==typeof t.offset}(t)||M(t,"Node")?ee(t,n,r,o):null:null;i=a?{type:0,ranges:[a],areAllCollapsed:a.collapsed}:null}var l,s;return i}(e,t,n,r,o);if(i){var a=e.domEvent.skipReselectOnFocus;e.domEvent.skipReselectOnFocus=!0;try{!function(e,t){switch(null==t?void 0:t.type){case 1:P(e.contentDiv,t.table)&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,null),e.domEvent.tableSelectionRange=e.api.selectTable(e,t.table,t.coordinates),t=e.domEvent.tableSelectionRange);break;case 2:P(e.contentDiv,t.image)&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,t.image),t=e.domEvent.imageSelectionRange);break;case 0:e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null),P(e.contentDiv,t.ranges[0])?e.api.selectRange(e,t.ranges[0]):t=null}e.api.triggerEvent(e,{eventType:22,selectionRangeEx:t},!0)}(e,i)}finally{e.domEvent.skipReselectOnFocus=a}}else e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null);return!!i},selectRange:function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!P(e.contentDiv,t))&&(to(t,n),Hc(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,r=e.api.getSelectionRange;if(n.pendableFormatState){var o=t.ownerDocument,i=function(e){return oe(on).reduce((function(t,n){return t[n]=e.queryCommandState(on[n]),t}),{})}(o);oe(on).forEach((function(e){var t;!!(null===(t=n.pendableFormatState)||void 0===t?void 0:t[e])!=i[e]&&o.execCommand(on[e],!1,void 0)}));var a=r(e,!0),l=a&&X.getStart(a);l&&(n.pendableFormatPosition=l)}}(e),!0)},setContent:function(e,t,n,r){var o,i,a=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var l=e.entity.entityMap,s=t||"";fo((new DOMParser).parseFromString(null!==(i=null===(o=e.trustedHTMLHandler)||void 0===o?void 0:o.call(e,s))&&void 0!==i?i:s,"text/html").body,e.contentDiv,l);var u=eo(e.contentDiv);(function(e,t){if(!e.lifecycle.shadowEditSelectionPath&&t)switch(e.domEvent.tableSelectionRange=null,e.domEvent.imageSelectionRange=null,e.domEvent.selectionRange=null,t.type){case 0:e.api.selectTable(e,null),e.api.selectImage(e,null);var n=ee(e.contentDiv,t.start,t.end);e.api.selectRange(e,n);break;case 1:var r=gn(e.contentDiv,"#"+t.tableId)[0];r&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,r,t));break;case 2:var o=gn(e.contentDiv,"#"+t.imageId)[0];o&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,o))}})(e,r=r||u),a=!0}var c=e.lifecycle.isDarkMode;(!r&&c||r&&!!r.isDarkMode!=!!c)&&(e.api.transformColor(e,e.contentDiv,!1,null,c?0:1,!0,null==r?void 0:r.isDarkMode),a=!0),n&&a&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)},switchShadowEdit:function(e,t){var n=e.lifecycle,r=e.contentDiv,o=n.shadowEditEntities,i=n.shadowEditFragment,a=n.shadowEditSelectionPath,l=n.shadowEditTableSelectionPath,s=n.shadowEditImageSelectionPath,u=!!i,c=function(e,t){return(null==t?void 0:t.type)==e&&t.ranges.map((function(e){return Ur(r,e)})).map((function(e){return e}))||null};if(t){if(!u){var d=e.api.getSelectionRangeEx(e),f=e.api.getSelectionRange(e,!0);a=f&&Ur(r,f),l=c(1,d),s=c(2,d),i=function(e,t){for(var n=co(),r=e.ownerDocument.createDocumentFragment(),o=null,i=function(e){var i,a=e;o=e.nextSibling,M(e,"HTMLElement")&&((i=uo(e))?a=vo(i,t):e.querySelectorAll(n).forEach((function(e){var n;if(i=uo(e)){var r=vo(i,t);null===(n=e.parentNode)||void 0===n||n.replaceChild(r,e)}}))),r.appendChild(a)},a=e.firstChild;a;a=o)i(a);return r.normalize(),r}(r,o={}),e.api.triggerEvent(e,{eventType:17,fragment:i,selectionPath:a},!1),n.shadowEditFragment=i,n.shadowEditSelectionPath=a,n.shadowEditTableSelectionPath=l,n.shadowEditImageSelectionPath=s,n.shadowEditEntities=o}n.shadowEditFragment&&fo(n.shadowEditFragment,r,n.shadowEditEntities,!0)}else n.shadowEditFragment=null,n.shadowEditSelectionPath=null,n.shadowEditEntities=null,u&&(e.api.triggerEvent(e,{eventType:18},!1),i&&fo(i,r,o),a&&(e.domEvent.selectionRange=ee(r,a.start,a.end)))},transformColor:function(e,t,n,r,o,i,a){void 0===a&&(a=!1);var l=e.darkColorHandler,s=e.lifecycle.onExternalContentTransform,u=0==o;t&&(i||e.lifecycle.isDarkMode)&&ed(t,s?function(e){s(e,a,u,l)}:function(e){l.transformElementColor(e,a,u)},n);null==r||r()},triggerEvent:function(e,t,n){e.lifecycle.shadowEditFragment&&!(nd.indexOf(t.eventType)>=0)||!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))},selectTable:function(e,t,n){var r;if(Jc(e),function(e){if(e){var t=e||{},n=t.firstCell,r=t.lastCell;if(n&&r){var o=function(e){return $c(e.x)&&$c(e.y)};return o(n)&&o(r)}}return!1}(n)&&t){Uc(t,"tableSelected"),Uc(e.contentDiv,"contentDiv_");var o=function(e,t,n){var r="#"+e.contentDiv.id,o=Yc(t,n,r),i=o.cssRules,a=o.ranges,l=o.isWholeTableSelected;return i.forEach((function(t){return So(e.contentDiv.ownerDocument,t,Wc+e.contentDiv.id)})),{ranges:a,isWholeTableSelected:l}}(e,t,n),i=o.ranges,a=o.isWholeTableSelected;if(!function(e,t){var n,r=t.firstCell;return!(e.rows.item(r.y)&&(null===(n=e.rows.item(r.y))||void 0===n?void 0:n.cells.item(r.x)))}(t,n)){var l=null===(r=t.rows.item(n.firstCell.y))||void 0===r?void 0:r.cells.item(n.firstCell.x);l&&e.api.selectRange(e,ee(new X(l,0)))}return{type:1,ranges:i,table:t,areAllCollapsed:i.filter((function(e){return null==e?void 0:e.collapsed})).length==i.length,coordinates:n,isWholeTableSelected:a}}return null},selectImage:function(e,t){Vc(e);var n=null;if(t){var r=ee(t);Uc(t,"imageSelected"),Uc(e.contentDiv,"contentDiv_"),e.api.selectRange(e,ee(new X(t,-3))),Qc(e,t),n={type:2,ranges:[r],image:t,areAllCollapsed:r.collapsed}}return n}},od=function(e,t){var n,o=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new xc,edit:n.edit||new tc,pendingFormatState:n.pendingFormatState||new kc,_placeholder:null,typeAfterLink:null,undo:n.undo||new Ic(t),domEvent:n.domEvent||new $u(t,e),mouseUp:n.mouseUp||new wc,copyPaste:n.copyPaste||new Zu(t),entity:n.entity||new gc,imageSelection:n.imageSelection||new Ac,normalizeTable:n.normalizeTable||new Sc,lifecycle:n.lifecycle||new Cc(t,e)}}(e,t),i=[];oe(o).forEach((function(e){"_placeholder"==e?t.plugins&&kr(i,t.plugins):i.push(o[e])}));var a=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}(o),l=(null!==(n=t.zoomScale)&&void 0!==n?n:-1)>0?t.zoomScale:1,s=t.getVisibleViewport||function(){var e=a.domEvent.scrollContainer;return function(e,t){void 0===t&&(t=[]);var n=e.map((function(e){return yn(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),r={top:Math.max.apply(Math,g([],p(n.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,g([],p(n.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,g([],p(n.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,g([],p(n.map((function(e){return e.right}))),!1))};return r.top<r.bottom&&r.left<r.right?r:null}(e==u.contentDiv?[e]:[e,u.contentDiv])},u=r(r({contentDiv:e,api:r(r({},rd),t.coreApiOverride||{}),originalApi:rd,plugins:i.filter((function(e){return!!e}))},a),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:l,sizeTransformer:t.sizeTransformer||function(e){return e/l},getVisibleViewport:s,imageSelectionBorderColor:t.imageSelectionBorderColor,darkColorHandler:new Bc(e,a.lifecycle.getDarkColor),disposeErrorHandler:t.disposeErrorHandler});return u};var id=function(){function e(e,t,n){var r=this;if(this.core=null,"DIV"!=j(e))throw new Error("contentDiv must be an HTML DIV element");this.core=n(e,t),this.core.plugins.forEach((function(e){return e.initialize(r)})),this.ensureTypeInContainer(new X(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){for(var e,t=this.getCore(),n=t.plugins.length-1;n>=0;n--){var r=t.plugins[n];try{r.dispose()}catch(n){null===(e=t.disposeErrorHandler)||void 0===e||e.call(t,r,n)}}t.darkColorHandler.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getCore();return!!e&&n.api.insertNode(n,e,null!=t?t:null)},e.prototype.deleteNode=function(e){return!!(e&&this.contains(e)&&e.parentNode)&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){var r=this.getCore();return!(!this.contains(e)||!t)&&(r.api.transformColor(r,n?t:null,!0,(function(){var n;return null===(n=e.parentNode)||void 0===n?void 0:n.replaceChild(t,e)}),0),!0)},e.prototype.getBlockElementAtNode=function(e){return Te(this.getCore().contentDiv,e)},e.prototype.contains=function(e){return!!e&&P(this.getCore().contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=this.getCore(),o=[],i=t instanceof Function?0:t;n=t instanceof Function?t:n;var a=0==i?null:this.getSelectionRangeEx();return a?(a.ranges.forEach((function(t){o.push.apply(o,g([],p(gn(r.contentDiv,e,n,i,t)),!1))})),o):gn(r.contentDiv,e,n,i,void 0)},e.prototype.collapseNodes=function(e,t,n){return U(this.getCore().contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return un(this.getCore().contentDiv,e)},e.prototype.getContent=function(e){void 0===e&&(e=0);var t=this.getCore();return t.api.getContent(t,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.getCore();n.api.setContent(n,e,t)},e.prototype.insertContent=function(e,t){var n;if(e){var r=this.getDocument(),o=null===(n=(new DOMParser).parseFromString(this.getCore().trustedHTMLHandler(e),"text/html"))||void 0===n?void 0:n.body,i=(null==o?void 0:o.childNodes)?H(o.childNodes):[];t&&t.insertOnNewLine&&i.length>1&&(i=[Ce(i)]);var a=r.createDocumentFragment();i.forEach((function(e){return a.appendChild(e)})),this.insertNode(a,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed?Lo(this.getCore().contentDiv,e):null},e.prototype.paste=function(e,t,n,r){var o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.getCore();if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var a=this.getSelectionRange(),l=a&&X.getStart(a),s=i.api.createPasteFragment(i,e,l,t,n,r);s&&this.addUndoSnapshot((function(){return o.insertNode(s),e}),"Paste")}},e.prototype.getSelectionRange=function(e){void 0===e&&(e=!0);var t=this.getCore();return t.api.getSelectionRange(t,e)},e.prototype.getSelectionRangeEx=function(){var e=this.getCore();return e.api.getSelectionRangeEx(e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&Ur(this.getCore().contentDiv,e)},e.prototype.hasFocus=function(){var e=this.getCore();return e.api.hasFocus(e)},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.select=function(e,t,n,r){var o=this.getCore();return o.api.select(o,e,t,n,r)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if((null==t?void 0:t.focusNode)&&this.contains(t.focusNode))return new X(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?X.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var r,o=this;return null!==(r=go(null!=(n=t?void 0:n)?n:null,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=o.getFocusedPosition();t=null==n?void 0:n.node}return t&&J(t,o.getCore().contentDiv,e)})))&&void 0!==r?r:null},e.prototype.isPositionAtBeginning=function(e){return Fr(e,this.getCore().contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRangeEx(),n=[],r=this.getCore().contentDiv;return t.ranges.forEach((function(t){n.push.apply(n,g([],p(t?Pr(r,t,e):[]),!1))})),n.filter((function(e,t,n){return n.indexOf(e)===t}))},e.prototype.addDomEventHandler=function(e,t){var n,r="string"==typeof e?((n={})[e]=t,n):e,o=this.getCore();return o.api.attachDomEvent(o,r)},e.prototype.triggerPluginEvent=function(e,t,n){void 0===n&&(n=!1);var o=this.getCore(),i=r({eventType:e},t);return o.api.triggerEvent(o,i,n),i},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,-1)},e.prototype.redo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,1)},e.prototype.addUndoSnapshot=function(e,t,n,r){var o=this.getCore();o.api.addUndoSnapshot(o,null!=e?e:null,null!=t?t:null,null!=n&&n,r)},e.prototype.getUndoState=function(){var e=this.getCore().undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.getCore().contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){var r=this.getCore();return(r.lifecycle.customData[e]=r.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.getCore().domEvent.isInIME},e.prototype.getDefaultFormat=function(){var e;return null!==(e=this.getCore().lifecycle.defaultFormat)&&void 0!==e?e:{}},e.prototype.getBodyTraverser=function(e){return nt.createBodyTraverser(this.getCore().contentDiv,e)},e.prototype.getSelectionTraverser=function(e){var t;return(e=null!==(t=null!=e?e:this.getSelectionRange())&&void 0!==t?t:void 0)?nt.createSelectionTraverser(this.getCore().contentDiv,e):null},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t?nt.createBlockTraverser(this.getCore().contentDiv,t,e):null},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return go(null!=e?e:null,"ContentSearcher",(function(){var e=t.getSelectionRange();return e&&new ot(t.getCore().contentDiv,X.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,n=this.getCore().contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){n.cancelAnimationFrame(r)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.getCore().contentDiv.removeAttribute(e):this.getCore().contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.getCore().contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n=this.getCore().contentDiv,r=n.getBoundingClientRect(),o=e.getBoundingClientRect();if(r&&o){var i=o.left-(null==r?void 0:r.left),a=o.top-(null==r?void 0:r.top);return t&&(i+=n.scrollLeft,a+=n.scrollTop),[i,a]}}return null},e.prototype.addContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(n){var r=t.edit.features[n]||[];r.push(e),t.edit.features[n]=r}))},e.prototype.removeContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(n){var r,o=t.edit.features[n],i=null!==(r=null==o?void 0:o.indexOf(e))&&void 0!==r?r:-1;i>=0&&(t.edit.features[n].splice(i,1),t.edit.features[n].length<1&&delete t.edit.features[n])}))},e.prototype.getStyleBasedFormatState=function(e){var t;if(!e){var n=this.getSelectionRange();e=null!==(t=n&&X.getStart(n).normalize().node)&&void 0!==t?t:void 0}var r=this.getCore();return r.api.getStyleBasedFormatState(r,null!=e?e:null)},e.prototype.getPendableFormatState=function(e){void 0===e&&(e=!1);var t=this.getCore();return t.api.getPendableFormatState(t,e)},e.prototype.ensureTypeInContainer=function(e,t){var n=this.getCore();n.api.ensureTypeInContainer(n,e,t)},e.prototype.setDarkModeState=function(e){var t=this.isDarkMode();if(t!=!!e){var n=this.getCore();n.api.transformColor(n,n.contentDiv,!1,null,e?0:1,!0,t),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode")}},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.transformToDarkColor=function(e,t){void 0===t&&(t=0);var n=this.getCore();n.api.transformColor(n,e,!0,null,t)},e.prototype.getDarkColorHandler=function(){return this.getCore().darkColorHandler},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return function(e,t){return(e||[]).indexOf(t)>=0}(this.getCore().lifecycle.experimentalFeatures,e)},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getSizeTransformer=function(){return this.getCore().sizeTransformer},e.prototype.getZoomScale=function(){return this.getCore().zoomScale},e.prototype.setZoomScale=function(e){var t=this.getCore();if(e>0&&e<=10){var n=t.zoomScale;t.zoomScale=e,n!=e&&this.triggerPluginEvent(21,{oldZoomScale:n,newZoomScale:e},!0)}},e.prototype.getVisibleViewport=function(){return this.getCore().getVisibleViewport()},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}(),ad=function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n,od)||this}return n(t,e),t}(id);function ld(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var sd={},ud={exports:{}},cd={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},dd={exports:{}},fd=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))},pd=Array.prototype.concat,hd=Array.prototype.slice,vd=dd.exports=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];fd(o)?t=pd.call(t,hd.call(o)):t.push(o)}return t};vd.wrap=function(e){return function(){return e(vd(arguments))}};var gd=dd.exports,md=cd,Ad=gd,yd=Object.hasOwnProperty,bd=Object.create(null);for(var Ed in md)yd.call(md,Ed)&&(bd[md[Ed]]=Ed);var Cd=ud.exports={to:{},get:{}};function wd(e,t,n){return Math.min(Math.max(t,e),n)}function Sd(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}Cd.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=Cd.get.hsl(e),n="hsl";break;case"hwb":t=Cd.get.hwb(e),n="hwb";break;default:t=Cd.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},Cd.get.rgb=function(e){if(!e)return null;var t,n,r,o=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=t[2],t=t[1],n=0;n<3;n++){var i=2*n;o[n]=parseInt(t.slice(i,i+2),16)}r&&(o[3]=parseInt(r,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(r=(t=t[1])[3],n=0;n<3;n++)o[n]=parseInt(t[n]+t[n],16);r&&(o[3]=parseInt(r+r,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)o[n]=parseInt(t[n+1],0);t[4]&&(t[5]?o[3]=.01*parseFloat(t[4]):o[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:yd.call(md,t[1])?((o=md[t[1]])[3]=1,o):null:null;for(n=0;n<3;n++)o[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(t[5]?o[3]=.01*parseFloat(t[4]):o[3]=parseFloat(t[4]))}for(n=0;n<3;n++)o[n]=wd(o[n],0,255);return o[3]=wd(o[3],0,1),o},Cd.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,wd(parseFloat(t[2]),0,100),wd(parseFloat(t[3]),0,100),wd(isNaN(n)?1:n,0,1)]}return null},Cd.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,wd(parseFloat(t[2]),0,100),wd(parseFloat(t[3]),0,100),wd(isNaN(n)?1:n,0,1)]}return null},Cd.to.hex=function(){var e=Ad(arguments);return"#"+Sd(e[0])+Sd(e[1])+Sd(e[2])+(e[3]<1?Sd(Math.round(255*e[3])):"")},Cd.to.rgb=function(){var e=Ad(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},Cd.to.rgb.percent=function(){var e=Ad(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},Cd.to.hsl=function(){var e=Ad(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},Cd.to.hwb=function(){var e=Ad(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},Cd.to.keyword=function(e){return bd[e.slice(0,3)]};var Td=ud.exports,Dd={exports:{}},kd=cd,xd={};for(var Id in kd)kd.hasOwnProperty(Id)&&(xd[kd[Id]]=Id);var Ld=Dd.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var Nd in Ld)if(Ld.hasOwnProperty(Nd)){if(!("channels"in Ld[Nd]))throw new Error("missing channels property: "+Nd);if(!("labels"in Ld[Nd]))throw new Error("missing channel labels property: "+Nd);if(Ld[Nd].labels.length!==Ld[Nd].channels)throw new Error("channel and label counts mismatch: "+Nd);var Rd=Ld[Nd].channels,Bd=Ld[Nd].labels;delete Ld[Nd].channels,delete Ld[Nd].labels,Object.defineProperty(Ld[Nd],"channels",{value:Rd}),Object.defineProperty(Ld[Nd],"labels",{value:Bd})}Ld.rgb.hsl=function(e){var t,n,r=e[0]/255,o=e[1]/255,i=e[2]/255,a=Math.min(r,o,i),l=Math.max(r,o,i),s=l-a;return l===a?t=0:r===l?t=(o-i)/s:o===l?t=2+(i-r)/s:i===l&&(t=4+(r-o)/s),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+l)/2,[t,100*(l===a?0:n<=.5?s/(l+a):s/(2-l-a)),100*n]},Ld.rgb.hsv=function(e){var t,n,r,o,i,a=e[0]/255,l=e[1]/255,s=e[2]/255,u=Math.max(a,l,s),c=u-Math.min(a,l,s),d=function(e){return(u-e)/6/c+.5};return 0===c?o=i=0:(i=c/u,t=d(a),n=d(l),r=d(s),a===u?o=r-n:l===u?o=1/3+t-r:s===u&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*i,100*u]},Ld.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[Ld.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},Ld.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-o)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},Ld.rgb.keyword=function(e){var t=xd[e];if(t)return t;var n,r,o,i=1/0;for(var a in kd)if(kd.hasOwnProperty(a)){var l=kd[a],s=(r=e,o=l,Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2)+Math.pow(r[2]-o[2],2));s<i&&(i=s,n=a)}return n},Ld.keyword.rgb=function(e){return kd[e]},Ld.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},Ld.rgb.lab=function(e){var t=Ld.rgb.xyz(e),n=t[0],r=t[1],o=t[2];return r/=100,o/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},Ld.hsl.rgb=function(e){var t,n,r,o,i,a=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[i=255*s,i,i];t=2*s-(n=s<.5?s*(1+l):s+l-s*l),o=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[u]=255*i;return o},Ld.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,o=n,i=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,o*=i<=1?i:2-i,[t,100*(0===r?2*o/(i+o):2*n/(r+n)),100*((r+n)/2)]},Ld.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=Math.floor(t)%6,i=t-Math.floor(t),a=255*r*(1-n),l=255*r*(1-n*i),s=255*r*(1-n*(1-i));switch(r*=255,o){case 0:return[r,s,a];case 1:return[l,r,a];case 2:return[a,r,s];case 3:return[a,l,r];case 4:return[s,a,r];case 5:return[r,a,l]}},Ld.hsv.hsl=function(e){var t,n,r,o=e[0],i=e[1]/100,a=e[2]/100,l=Math.max(a,.01);return r=(2-i)*a,n=i*l,[o,100*(n=(n/=(t=(2-i)*l)<=1?t:2-t)||0),100*(r/=2)]},Ld.hwb.rgb=function(e){var t,n,r,o,i,a,l,s=e[0]/360,u=e[1]/100,c=e[2]/100,d=u+c;switch(d>1&&(u/=d,c/=d),r=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(r=1-r),o=u+r*((n=1-c)-u),t){default:case 6:case 0:i=n,a=o,l=u;break;case 1:i=o,a=n,l=u;break;case 2:i=u,a=n,l=o;break;case 3:i=u,a=o,l=n;break;case 4:i=o,a=u,l=n;break;case 5:i=n,a=u,l=o}return[255*i,255*a,255*l]},Ld.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},Ld.xyz.rgb=function(e){var t,n,r,o=e[0]/100,i=e[1]/100,a=e[2]/100;return n=-.9689*o+1.8758*i+.0415*a,r=.0557*o+-.204*i+1.057*a,t=(t=3.2406*o+-1.5372*i+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},Ld.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},Ld.lab.xyz=function(e){var t,n,r,o=e[0];t=e[1]/500+(n=(o+16)/116),r=n-e[2]/200;var i=Math.pow(n,3),a=Math.pow(t,3),l=Math.pow(r,3);return n=i>.008856?i:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},Ld.lab.lch=function(e){var t,n=e[0],r=e[1],o=e[2];return(t=360*Math.atan2(o,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+o*o),t]},Ld.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},Ld.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],o=1 in arguments?arguments[1]:Ld.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var i=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===o&&(i+=60),i},Ld.hsv.ansi16=function(e){return Ld.rgb.ansi16(Ld.hsv.rgb(e),e[2])},Ld.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},Ld.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},Ld.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},Ld.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},Ld.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},Ld.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255,i=Math.max(Math.max(n,r),o),a=Math.min(Math.min(n,r),o),l=i-a;return t=l<=0?0:i===n?(r-o)/l%6:i===r?2+(o-n)/l:4+(n-r)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?a/(1-l):0)]},Ld.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,o=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},Ld.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},Ld.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var o,i=[0,0,0],a=t%1*6,l=a%1,s=1-l;switch(Math.floor(a)){case 0:i[0]=1,i[1]=l,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=l;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=l,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return o=(1-n)*r,[255*(n*i[0]+o),255*(n*i[1]+o),255*(n*i[2]+o)]},Ld.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},Ld.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},Ld.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},Ld.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},Ld.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},Ld.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},Ld.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},Ld.gray.hsl=Ld.gray.hsv=function(e){return[0,0,e[0]]},Ld.gray.hwb=function(e){return[0,100,e[0]]},Ld.gray.cmyk=function(e){return[0,0,0,e[0]]},Ld.gray.lab=function(e){return[e[0],0,0]},Ld.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},Ld.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};var Md=Dd.exports,Pd=Md;function Od(e){var t=function(){for(var e={},t=Object.keys(Pd),n=t.length,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var r=n.pop(),o=Object.keys(Pd[r]),i=o.length,a=0;a<i;a++){var l=o[a],s=t[l];-1===s.distance&&(s.distance=t[r].distance+1,s.parent=r,n.unshift(l))}return t}function _d(e,t){return function(n){return t(e(n))}}function Fd(e,t){for(var n=[t[e].parent,e],r=Pd[t[e].parent][e],o=t[e].parent;t[o].parent;)n.unshift(t[o].parent),r=_d(Pd[t[o].parent][o],r),o=t[o].parent;return r.conversion=n,r}var Hd=Md,Ud=function(e){for(var t=Od(e),n={},r=Object.keys(t),o=r.length,i=0;i<o;i++){var a=r[i];null!==t[a].parent&&(n[a]=Fd(a,t))}return n},zd={};Object.keys(Hd).forEach((function(e){zd[e]={},Object.defineProperty(zd[e],"channels",{value:Hd[e].channels}),Object.defineProperty(zd[e],"labels",{value:Hd[e].labels});var t=Ud(e);Object.keys(t).forEach((function(n){var r=t[n];zd[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,o=0;o<r;o++)n[o]=Math.round(n[o]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),zd[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))}));var jd=Td,Qd=zd,Kd=[].slice,Vd=["keyword","gray","hex"],Wd={};Object.keys(Qd).forEach((function(e){Wd[Kd.call(Qd[e].labels).sort().join("")]=e}));var qd={};function Gd(e,t){if(!(this instanceof Gd))return new Gd(e,t);if(t&&t in Vd&&(t=null),t&&!(t in Qd))throw new Error("Unknown model: "+t);var n,r;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof Gd)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var o=jd.get(e);if(null===o)throw new Error("Unable to parse color from string: "+e);this.model=o.model,r=Qd[this.model].channels,this.color=o.value.slice(0,r),this.valpha="number"==typeof o.value[r]?o.value[r]:1}else if(e.length){this.model=t||"rgb",r=Qd[this.model].channels;var i=Kd.call(e,0,r);this.color=Xd(i,r),this.valpha="number"==typeof e[r]?e[r]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var a=Object.keys(e);"alpha"in e&&(a.splice(a.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var l=a.sort().join("");if(!(l in Wd))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Wd[l];var s=Qd[this.model].labels,u=[];for(n=0;n<s.length;n++)u.push(e[s[n]]);this.color=Xd(u)}if(qd[this.model])for(r=Qd[this.model].channels,n=0;n<r;n++){var c=qd[this.model][n];c&&(this.color[n]=c(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function Yd(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(qd[e]||(qd[e]=[]))[t]=n})),e=e[0],function(r){var o;return arguments.length?(n&&(r=n(r)),(o=this[e]()).color[t]=r,o):(o=this[e]().color[t],n&&(o=n(o)),o)}}function Jd(e){return function(t){return Math.max(0,Math.min(e,t))}}function Xd(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}Gd.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in jd.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return jd.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return jd.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=Qd[this.model].channels,n=Qd[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new Gd(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new Gd(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:Yd("rgb",0,Jd(255)),green:Yd("rgb",1,Jd(255)),blue:Yd("rgb",2,Jd(255)),hue:Yd(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:Yd("hsl",1,Jd(100)),lightness:Yd("hsl",2,Jd(100)),saturationv:Yd("hsv",1,Jd(100)),value:Yd("hsv",2,Jd(100)),chroma:Yd("hcg",1,Jd(100)),gray:Yd("hcg",2,Jd(100)),white:Yd("hwb",1,Jd(100)),wblack:Yd("hwb",2,Jd(100)),cyan:Yd("cmyk",0,Jd(100)),magenta:Yd("cmyk",1,Jd(100)),yellow:Yd("cmyk",2,Jd(100)),black:Yd("cmyk",3,Jd(100)),x:Yd("xyz",0,Jd(100)),y:Yd("xyz",1,Jd(100)),z:Yd("xyz",2,Jd(100)),l:Yd("lab",0,Jd(100)),a:Yd("lab",1),b:Yd("lab",2),keyword:function(e){return arguments.length?new Gd(e):Qd[this.model].keyword(this.color)},hex:function(e){return arguments.length?new Gd(e):jd.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return Gd.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),o=void 0===t?.5:t,i=2*o-1,a=n.alpha()-r.alpha(),l=((i*a==-1?i:(i+a)/(1+i*a))+1)/2,s=1-l;return Gd.rgb(l*n.red()+s*r.red(),l*n.green()+s*r.green(),l*n.blue()+s*r.blue(),n.alpha()*o+r.alpha()*(1-o))}},Object.keys(Qd).forEach((function(e){if(-1===Vd.indexOf(e)){var t=Qd[e].channels;Gd.prototype[e]=function(){if(this.model===e)return new Gd(this);if(arguments.length)return new Gd(arguments,e);var n,r="number"==typeof arguments[t]?t:this.valpha;return new Gd((n=Qd[this.model][e].raw(this.color),Array.isArray(n)?n:[n]).concat(r),e)},Gd[e]=function(n){return"number"==typeof n&&(n=Xd(Kd.call(arguments),t)),new Gd(n,e)}}}));var Zd=Gd;Object.defineProperty(sd,"__esModule",{value:!0});var $d,ef,tf,nf,rf,of,af,lf,sf,uf,cf,df,ff,pf,hf,vf,gf,mf,Af,yf,bf,Ef,Cf,wf,Sf,Tf,Df,kf,xf,If,Lf,Nf,Rf,Bf,Mf,Pf,Of,_f=Zd;sd.default=function(e,t){void 0===t&&(t=21.247);try{var n=_f(e||void 0),r=n.lab().array(),o=(100-r[0])*((100-t)/100)+t;e=_f.lab(o,r[1],r[2]).rgb().alpha(n.alpha()).toString()}catch(e){}return e},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getDarkColor=void 0;var t=sd;Object.defineProperty(e,"getDarkColor",{enumerable:!0,get:function(){return t.default}})}({}),function(e){e[e.AnnounceListItemNumbering=1]="AnnounceListItemNumbering",e[e.AnnounceListItemBullet=2]="AnnounceListItemBullet",e[e.AnnounceOnFocusLastCell=3]="AnnounceOnFocusLastCell"}($d||($d={})),function(e){e.AutoUrlDetect="AutoUrlDetect",e.BackColor="backColor",e.Bold="bold",e.ClearAuthenticationCache="ClearAuthenticationCache",e.ContentReadOnly="contentReadOnly",e.Copy="copy",e.CreateLink="createLink",e.Cut="cut",e.DecreaseFontSize="decreaseFontSize",e.DefaultParagraphSeparator="defaultParagraphSeparator",e.Delete="delete",e.EnableInlineTableEditing="enableInlineTableEditing",e.EnableObjectResizing="enableObjectResizing",e.FontName="fontName",e.FontSize="fontSize",e.ForeColor="foreColor",e.FormatBlock="formatBlock",e.ForwardDelete="forwardDelete",e.Heading="heading",e.HiliteColor="hiliteColor",e.IncreaseFontSize="increaseFontSize",e.Indent="indent",e.InsertBrOnReturn="insertBrOnReturn",e.InsertHorizontalRule="insertHorizontalRule",e.InsertHTML="insertHTML",e.InsertImage="insertImage",e.InsertOrderedList="insertOrderedList",e.InsertUnorderedList="insertUnorderedList",e.InsertParagraph="insertParagraph",e.InsertText="insertText",e.Italic="italic",e.JustifyCenter="justifyCenter",e.JustifyFull="justifyFull",e.JustifyLeft="justifyLeft",e.JustifyRight="justifyRight",e.Outdent="outdent",e.Paste="paste",e.Redo="redo",e.RemoveFormat="removeFormat",e.SelectAll="selectAll",e.StrikeThrough="strikeThrough",e.Subscript="subscript",e.Superscript="superscript",e.Underline="underline",e.Undo="undo",e.Unlink="unlink",e.StyleWithCSS="styleWithCSS"}(ef||(ef={})),function(e){e[e.Same=0]="Same",e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy"}(tf||(tf={})),function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL_LEFT=17]="CTRL_LEFT",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGEUP=33]="PAGEUP",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.DELETE=46]="DELETE",e[e.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",e[e.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META_LEFT=91]="META_LEFT",e[e.COMMA=188]="COMMA",e[e.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_TILDE=192]="GRAVE_TILDE",e[e.CONTENTCHANGED=257]="CONTENTCHANGED",e[e.RANGE=258]="RANGE",e[e.Ctrl=4096]="Ctrl",e[e.Meta=8192]="Meta",e[e.Shift=16384]="Shift"}(nf||(nf={})),function(e){e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=3]="Text",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment"}(rf||(rf={})),function(e){e.Text="text/",e.Image="image/"}(of||(of={})),function(e){e.PlainText="text/plain",e.HTML="text/html"}(af||(af={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(lf||(lf={})),function(e){e.AutoLink="AutoLink",e.CreateLink="CreateLink",e.Format="Format",e.ImageResize="ImageResize",e.Paste="Paste",e.SetContent="SetContent",e.Cut="Cut",e.Drop="Drop",e.InsertEntity="InsertEntity",e.SwitchToDarkMode="SwitchToDarkMode",e.SwitchToLightMode="SwitchToLightMode",e.ListChain="ListChain",e.Keyboard="Keyboard"}(sf||(sf={})),function(e){e[e.LightToDark=0]="LightToDark",e[e.DarkToLight=1]="DarkToLight"}(uf||(uf={})),function(e){e[e.Begin=0]="Begin",e[e.End=1]="End",e[e.DomEnd=2]="DomEnd",e[e.SelectionStart=3]="SelectionStart",e[e.Outside=4]="Outside",e[e.Range=5]="Range"}(cf||(cf={})),function(e){e.OriginalStyleColor="ogsc",e.OriginalStyleBackgroundColor="ogsb",e.OriginalAttributeColor="ogac",e.OriginalAttributeBackgroundColor="ogab"}(df||(df={})),function(e){e.DELIMITER_BEFORE="entityDelimiterBefore",e.DELIMITER_AFTER="entityDelimiterAfter"}(ff||(ff={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(pf||(pf={})),function(e){e.ENTITY_INFO_NAME="_Entity",e.ENTITY_TYPE_PREFIX="_EType_",e.ENTITY_ID_PREFIX="_EId_",e.ENTITY_READONLY_PREFIX="_EReadonly_"}(hf||(hf={})),function(e){e[e.NewEntity=0]="NewEntity",e[e.Click=1]="Click",e[e.ContextMenu=2]="ContextMenu",e[e.Escape=3]="Escape",e[e.RemoveFromStart=4]="RemoveFromStart",e[e.RemoveFromEnd=5]="RemoveFromEnd",e[e.Overwrite=6]="Overwrite",e[e.PartialOverwrite=7]="PartialOverwrite",e[e.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",e[e.AddShadowRoot=9]="AddShadowRoot",e[e.RemoveShadowRoot=10]="RemoveShadowRoot",e[e.UpdateEntityState=11]="UpdateEntityState"}(vf||(vf={})),function(e){e.NewIndentation="NewIndentation",e.NewBullet="NewBullet",e.NewNumbering="NewNumbering",e.ListChain="ListChain",e.MergePastedLine="MergePastedLine",e.SingleDirectionResize="SingleDirectionResize",e.PasteWithLinkPreview="PasteWithLinkPreview",e.ImageRotate="ImageRotate",e.ImageCrop="ImageCrop",e.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",e.ConvertSingleImageBody="ConvertSingleImageBody",e.TableAlignment="TableAlignment",e.AdaptiveHandlesResizer="AdaptiveHandlesResizer",e.AutoHyphen="AutoHyphen",e.PendingStyleBasedFormat="PendingStyleBasedFormat",e.NormalizeList="NormalizeList",e.ImageSelection="ImageSelection",e.VariableBasedDarkColor="VariableBasedDarkColor",e.ListItemAlignment="ListItemAlignment",e.DefaultFormatInSpan="DefaultFormatInSpan",e.DefaultFormatOnContainer="DefaultFormatOnContainer",e.ReusableContentModel="ReusableContentModel",e.EditWithContentModel="EditWithContentModel",e.AutoFormatList="AutoFormatList",e.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters",e.ContentModelPaste="ContentModelPaste",e.TabKeyTextFeatures="TabKeyTextFeatures",e.ReuseAllAncestorListElements="ReuseAllAncestorListElements",e.DeleteTableWithBackspace="DeleteTableWithBackspace",e.DisableListChain="DisableListChain"}(gf||(gf={})),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(mf||(mf={})),function(e){e[e.CleanHTML=0]="CleanHTML",e[e.RawHTMLOnly=1]="RawHTMLOnly",e[e.RawHTMLWithSelection=2]="RawHTMLWithSelection",e[e.PlainText=3]="PlainText",e[e.PlainTextFast=4]="PlainTextFast"}(Af||(Af={})),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(yf||(yf={})),function(e){e.Sentence="sentence",e.Lowercase="lowercase",e.Uppercase="uppercase",e.CapitalizeEachWord="capitalize"}(bf||(bf={})),function(e){e[e.None=0]="None",e[e.Ordered=1]="Ordered",e[e.Unordered=2]="Unordered"}(Ef||(Ef={})),function(e){e[e.Begin=0]="Begin",e[e.End=-1]="End",e[e.Before=-2]="Before",e[e.After=-3]="After"}(Cf||(Cf={})),function(e){e[e.Body=0]="Body",e[e.OnSelection=1]="OnSelection",e[e.InSelection=2]="InSelection"}(wf||(wf={})),function(e){e[e.Table=0]="Table"}(Sf||(Sf={})),function(e){e[e.InsertAbove=0]="InsertAbove",e[e.InsertBelow=1]="InsertBelow",e[e.InsertLeft=2]="InsertLeft",e[e.InsertRight=3]="InsertRight",e[e.DeleteTable=4]="DeleteTable",e[e.DeleteColumn=5]="DeleteColumn",e[e.DeleteRow=6]="DeleteRow",e[e.MergeAbove=7]="MergeAbove",e[e.MergeBelow=8]="MergeBelow",e[e.MergeLeft=9]="MergeLeft",e[e.MergeRight=10]="MergeRight",e[e.MergeCells=11]="MergeCells",e[e.SplitHorizontally=12]="SplitHorizontally",e[e.SplitVertically=13]="SplitVertically",e[e.AlignCenter=14]="AlignCenter",e[e.AlignLeft=15]="AlignLeft",e[e.AlignRight=16]="AlignRight",e[e.AlignCellLeft=17]="AlignCellLeft",e[e.AlignCellCenter=18]="AlignCellCenter",e[e.AlignCellRight=19]="AlignCellRight",e[e.AlignCellTop=20]="AlignCellTop",e[e.AlignCellMiddle=21]="AlignCellMiddle",e[e.AlignCellBottom=22]="AlignCellBottom"}(Tf||(Tf={})),function(e){e[e.None=0]="None",e[e.CornerResize=1]="CornerResize",e[e.SideResize=2]="SideResize",e[e.Resize=3]="Resize",e[e.Rotate=4]="Rotate",e[e.ResizeAndRotate=7]="ResizeAndRotate",e[e.Crop=8]="Crop",e[e.All=15]="All"}(Df||(Df={})),function(e){e[e.Inline=0]="Inline",e[e.Block=1]="Block",e[e.AutoDetect=2]="AutoDetect"}(kf||(kf={})),function(e){e[e.None=0]="None",e[e.EmptyLine=1]="EmptyLine",e[e.BlockquoteWrapper=2]="BlockquoteWrapper",e[e.CopyPasteTempDiv=3]="CopyPasteTempDiv",e[e.BlockListItem=4]="BlockListItem",e[e.ContextMenuWrapper=5]="ContextMenuWrapper",e[e.ImageEditWrapper=6]="ImageEditWrapper",e[e.TableHorizontalResizer=7]="TableHorizontalResizer",e[e.TableVerticalResizer=8]="TableVerticalResizer",e[e.TableResizerLTR=9]="TableResizerLTR",e[e.TableResizerRTL=10]="TableResizerRTL",e[e.TableSelector=11]="TableSelector",e[e.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"}(xf||(xf={})),function(e){e[e.WordDesktop=0]="WordDesktop",e[e.ExcelDesktop=1]="ExcelDesktop",e[e.ExcelOnline=2]="ExcelOnline",e[e.PowerPointDesktop=3]="PowerPointDesktop",e[e.GoogleSheets=4]="GoogleSheets",e[e.WacComponents=5]="WacComponents",e[e.Default=6]="Default",e[e.SingleImage=7]="SingleImage"}(If||(If={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",e[e.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",e[e.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",e[e.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",e[e.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",e[e.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",e[e.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",e[e.CLEAR=8]="CLEAR"}(Lf||(Lf={})),function(e){e[e.KeyDown=0]="KeyDown",e[e.KeyPress=1]="KeyPress",e[e.KeyUp=2]="KeyUp",e[e.Input=3]="Input",e[e.CompositionEnd=4]="CompositionEnd",e[e.MouseDown=5]="MouseDown",e[e.MouseUp=6]="MouseUp",e[e.ContentChanged=7]="ContentChanged",e[e.ExtractContentWithDom=8]="ExtractContentWithDom",e[e.BeforeCutCopy=9]="BeforeCutCopy",e[e.BeforePaste=10]="BeforePaste",e[e.EditorReady=11]="EditorReady",e[e.BeforeDispose=12]="BeforeDispose",e[e.PendingFormatStateChanged=13]="PendingFormatStateChanged",e[e.Scroll=14]="Scroll",e[e.EntityOperation=15]="EntityOperation",e[e.ContextMenu=16]="ContextMenu",e[e.EnteredShadowEdit=17]="EnteredShadowEdit",e[e.LeavingShadowEdit=18]="LeavingShadowEdit",e[e.EditImage=19]="EditImage",e[e.BeforeSetContent=20]="BeforeSetContent",e[e.ZoomChanged=21]="ZoomChanged",e[e.SelectionChanged=22]="SelectionChanged",e[e.BeforeKeyboardEditing=23]="BeforeKeyboardEditing"}(Nf||(Nf={})),function(e){e[e.Normal=0]="Normal",e[e.TableSelection=1]="TableSelection",e[e.ImageSelection=2]="ImageSelection"}(Rf||(Rf={})),function(e){e[e.Min=1]="Min",e[e.Decimal=1]="Decimal",e[e.DecimalDash=2]="DecimalDash",e[e.DecimalParenthesis=3]="DecimalParenthesis",e[e.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",e[e.LowerAlpha=5]="LowerAlpha",e[e.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",e[e.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",e[e.LowerAlphaDash=8]="LowerAlphaDash",e[e.UpperAlpha=9]="UpperAlpha",e[e.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",e[e.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",e[e.UpperAlphaDash=12]="UpperAlphaDash",e[e.LowerRoman=13]="LowerRoman",e[e.LowerRomanParenthesis=14]="LowerRomanParenthesis",e[e.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",e[e.LowerRomanDash=16]="LowerRomanDash",e[e.UpperRoman=17]="UpperRoman",e[e.UpperRomanParenthesis=18]="UpperRomanParenthesis",e[e.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",e[e.UpperRomanDash=20]="UpperRomanDash",e[e.Max=20]="Max"}(Bf||(Bf={})),function(e){e[e.Min=1]="Min",e[e.Disc=1]="Disc",e[e.Dash=2]="Dash",e[e.Square=3]="Square",e[e.ShortArrow=4]="ShortArrow",e[e.LongArrow=5]="LongArrow",e[e.UnfilledArrow=6]="UnfilledArrow",e[e.Hyphen=7]="Hyphen",e[e.DoubleLongArrow=8]="DoubleLongArrow",e[e.Circle=9]="Circle",e[e.Max=9]="Max"}(Mf||(Mf={})),function(e){e[e.Boolean=0]="Boolean",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Array=3]="Array",e[e.Object=4]="Object",e[e.Customize=5]="Customize"}(Pf||(Pf={})),function(e){e[e.Normal=0]="Normal",e[e.AsPlainText=1]="AsPlainText",e[e.MergeFormat=2]="MergeFormat",e[e.AsImage=3]="AsImage"}(Of||(Of={}));var Ff=ld(R),Hf={};Object.defineProperty(Hf,"__esModule",{value:!0});var Uf={};Object.defineProperty(Uf,"__esModule",{value:!0});var zf={},jf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleAlignment=void 0,(t=e.CompatibleAlignment||(e.CompatibleAlignment={}))[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(jf);var Qf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleBulletListType=void 0,(t=e.CompatibleBulletListType||(e.CompatibleBulletListType={}))[t.Min=1]="Min",t[t.Disc=1]="Disc",t[t.Dash=2]="Dash",t[t.Square=3]="Square",t[t.ShortArrow=4]="ShortArrow",t[t.LongArrow=5]="LongArrow",t[t.UnfilledArrow=6]="UnfilledArrow",t[t.Hyphen=7]="Hyphen",t[t.DoubleLongArrow=8]="DoubleLongArrow",t[t.Circle=9]="Circle",t[t.Max=9]="Max"}(Qf);var Kf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleCapitalization=void 0,(t=e.CompatibleCapitalization||(e.CompatibleCapitalization={})).Sentence="sentence",t.Lowercase="lowercase",t.Uppercase="uppercase",t.CapitalizeEachWord="capitalize"}(Kf);var Vf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleChangeSource=void 0,(t=e.CompatibleChangeSource||(e.CompatibleChangeSource={})).AutoLink="AutoLink",t.CreateLink="CreateLink",t.Format="Format",t.ImageResize="ImageResize",t.Paste="Paste",t.SetContent="SetContent",t.Cut="Cut",t.Drop="Drop",t.InsertEntity="InsertEntity",t.SwitchToDarkMode="SwitchToDarkMode",t.SwitchToLightMode="SwitchToLightMode",t.ListChain="ListChain",t.Keyboard="Keyboard"}(Vf);var Wf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleClearFormatMode=void 0,(t=e.CompatibleClearFormatMode||(e.CompatibleClearFormatMode={}))[t.Inline=0]="Inline",t[t.Block=1]="Block",t[t.AutoDetect=2]="AutoDetect"}(Wf);var qf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleColorTransformDirection=void 0,(t=e.CompatibleColorTransformDirection||(e.CompatibleColorTransformDirection={}))[t.LightToDark=0]="LightToDark",t[t.DarkToLight=1]="DarkToLight"}(qf);var Gf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleContentPosition=void 0,(t=e.CompatibleContentPosition||(e.CompatibleContentPosition={}))[t.Begin=0]="Begin",t[t.End=1]="End",t[t.DomEnd=2]="DomEnd",t[t.SelectionStart=3]="SelectionStart",t[t.Outside=4]="Outside",t[t.Range=5]="Range"}(Gf);var Yf={};!function(e){var t,n;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleContentType=e.CompatibleContentTypePrefix=void 0,(t=e.CompatibleContentTypePrefix||(e.CompatibleContentTypePrefix={})).Text="text/",t.Image="image/",(n=e.CompatibleContentType||(e.CompatibleContentType={})).PlainText="text/plain",n.HTML="text/html"}(Yf);var Jf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleDarkModeDatasetNames=void 0,(t=e.CompatibleDarkModeDatasetNames||(e.CompatibleDarkModeDatasetNames={})).OriginalStyleColor="ogsc",t.OriginalStyleBackgroundColor="ogsb",t.OriginalAttributeColor="ogac",t.OriginalAttributeBackgroundColor="ogab"}(Jf);var Xf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleDefinitionType=void 0,(t=e.CompatibleDefinitionType||(e.CompatibleDefinitionType={}))[t.Boolean=0]="Boolean",t[t.Number=1]="Number",t[t.String=2]="String",t[t.Array=3]="Array",t[t.Object=4]="Object",t[t.Customize=5]="Customize"}(Xf);var Zf={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleDelimiterClasses=void 0,(t=e.CompatibleDelimiterClasses||(e.CompatibleDelimiterClasses={})).DELIMITER_BEFORE="entityDelimiterBefore",t.DELIMITER_AFTER="entityDelimiterAfter"}(Zf);var $f={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleDirection=void 0,(t=e.CompatibleDirection||(e.CompatibleDirection={}))[t.LeftToRight=0]="LeftToRight",t[t.RightToLeft=1]="RightToLeft"}($f);var ep={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleDocumentCommand=void 0,(t=e.CompatibleDocumentCommand||(e.CompatibleDocumentCommand={})).AutoUrlDetect="AutoUrlDetect",t.BackColor="backColor",t.Bold="bold",t.ClearAuthenticationCache="ClearAuthenticationCache",t.ContentReadOnly="contentReadOnly",t.Copy="copy",t.CreateLink="createLink",t.Cut="cut",t.DecreaseFontSize="decreaseFontSize",t.DefaultParagraphSeparator="defaultParagraphSeparator",t.Delete="delete",t.EnableInlineTableEditing="enableInlineTableEditing",t.EnableObjectResizing="enableObjectResizing",t.FontName="fontName",t.FontSize="fontSize",t.ForeColor="foreColor",t.FormatBlock="formatBlock",t.ForwardDelete="forwardDelete",t.Heading="heading",t.HiliteColor="hiliteColor",t.IncreaseFontSize="increaseFontSize",t.Indent="indent",t.InsertBrOnReturn="insertBrOnReturn",t.InsertHorizontalRule="insertHorizontalRule",t.InsertHTML="insertHTML",t.InsertImage="insertImage",t.InsertOrderedList="insertOrderedList",t.InsertUnorderedList="insertUnorderedList",t.InsertParagraph="insertParagraph",t.InsertText="insertText",t.Italic="italic",t.JustifyCenter="justifyCenter",t.JustifyFull="justifyFull",t.JustifyLeft="justifyLeft",t.JustifyRight="justifyRight",t.Outdent="outdent",t.Paste="paste",t.Redo="redo",t.RemoveFormat="removeFormat",t.SelectAll="selectAll",t.StrikeThrough="strikeThrough",t.Subscript="subscript",t.Superscript="superscript",t.Underline="underline",t.Undo="undo",t.Unlink="unlink",t.StyleWithCSS="styleWithCSS"}(ep);var tp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleDocumentPosition=void 0,(t=e.CompatibleDocumentPosition||(e.CompatibleDocumentPosition={}))[t.Same=0]="Same",t[t.Disconnected=1]="Disconnected",t[t.Preceding=2]="Preceding",t[t.Following=4]="Following",t[t.Contains=8]="Contains",t[t.ContainedBy=16]="ContainedBy"}(tp);var np={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleEntityClasses=void 0,(t=e.CompatibleEntityClasses||(e.CompatibleEntityClasses={})).ENTITY_INFO_NAME="_Entity",t.ENTITY_TYPE_PREFIX="_EType_",t.ENTITY_ID_PREFIX="_EId_",t.ENTITY_READONLY_PREFIX="_EReadonly_"}(np);var rp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleEntityOperation=void 0,(t=e.CompatibleEntityOperation||(e.CompatibleEntityOperation={}))[t.NewEntity=0]="NewEntity",t[t.Click=1]="Click",t[t.ContextMenu=2]="ContextMenu",t[t.Escape=3]="Escape",t[t.RemoveFromStart=4]="RemoveFromStart",t[t.RemoveFromEnd=5]="RemoveFromEnd",t[t.Overwrite=6]="Overwrite",t[t.PartialOverwrite=7]="PartialOverwrite",t[t.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",t[t.AddShadowRoot=9]="AddShadowRoot",t[t.RemoveShadowRoot=10]="RemoveShadowRoot",t[t.UpdateEntityState=11]="UpdateEntityState"}(rp);var op={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleExperimentalFeatures=void 0,(t=e.CompatibleExperimentalFeatures||(e.CompatibleExperimentalFeatures={})).NewIndentation="NewIndentation",t.NewBullet="NewBullet",t.NewNumbering="NewNumbering",t.ListChain="ListChain",t.MergePastedLine="MergePastedLine",t.SingleDirectionResize="SingleDirectionResize",t.PasteWithLinkPreview="PasteWithLinkPreview",t.ImageRotate="ImageRotate",t.ImageCrop="ImageCrop",t.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",t.ConvertSingleImageBody="ConvertSingleImageBody",t.TableAlignment="TableAlignment",t.AdaptiveHandlesResizer="AdaptiveHandlesResizer",t.AutoHyphen="AutoHyphen",t.PendingStyleBasedFormat="PendingStyleBasedFormat",t.NormalizeList="NormalizeList",t.ImageSelection="ImageSelection",t.VariableBasedDarkColor="VariableBasedDarkColor",t.ListItemAlignment="ListItemAlignment",t.DefaultFormatInSpan="DefaultFormatInSpan",t.DefaultFormatOnContainer="DefaultFormatOnContainer",t.ReusableContentModel="ReusableContentModel",t.EditWithContentModel="EditWithContentModel",t.AutoFormatList="AutoFormatList",t.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters",t.ContentModelPaste="ContentModelPaste",t.TabKeyTextFeatures="TabKeyTextFeatures",t.ReuseAllAncestorListElements="ReuseAllAncestorListElements",t.DeleteTableWithBackspace="DeleteTableWithBackspace",t.DisableListChain="DisableListChain"}(op);var ip={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleFontSizeChange=void 0,(t=e.CompatibleFontSizeChange||(e.CompatibleFontSizeChange={}))[t.Increase=0]="Increase",t[t.Decrease=1]="Decrease"}(ip);var ap={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleGetContentMode=void 0,(t=e.CompatibleGetContentMode||(e.CompatibleGetContentMode={}))[t.CleanHTML=0]="CleanHTML",t[t.RawHTMLOnly=1]="RawHTMLOnly",t[t.RawHTMLWithSelection=2]="RawHTMLWithSelection",t[t.PlainText=3]="PlainText",t[t.PlainTextFast=4]="PlainTextFast"}(ap);var lp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleImageEditOperation=void 0,(t=e.CompatibleImageEditOperation||(e.CompatibleImageEditOperation={}))[t.None=0]="None",t[t.CornerResize=1]="CornerResize",t[t.SideResize=2]="SideResize",t[t.Resize=3]="Resize",t[t.Rotate=4]="Rotate",t[t.ResizeAndRotate=7]="ResizeAndRotate",t[t.Crop=8]="Crop",t[t.All=15]="All"}(lp);var sp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleIndentation=void 0,(t=e.CompatibleIndentation||(e.CompatibleIndentation={}))[t.Increase=0]="Increase",t[t.Decrease=1]="Decrease"}(sp);var up={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleKeys=void 0,(t=e.CompatibleKeys||(e.CompatibleKeys={}))[t.NULL=0]="NULL",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL_LEFT=17]="CTRL_LEFT",t[t.ALT=18]="ALT",t[t.ESCAPE=27]="ESCAPE",t[t.SPACE=32]="SPACE",t[t.PAGEUP=33]="PAGEUP",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PRINT_SCREEN=44]="PRINT_SCREEN",t[t.DELETE=46]="DELETE",t[t.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",t[t.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",t[t.B=66]="B",t[t.I=73]="I",t[t.U=85]="U",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META_LEFT=91]="META_LEFT",t[t.COMMA=188]="COMMA",t[t.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",t[t.PERIOD=190]="PERIOD",t[t.FORWARDSLASH=191]="FORWARDSLASH",t[t.FORWARD_SLASH=191]="FORWARD_SLASH",t[t.GRAVE_TILDE=192]="GRAVE_TILDE",t[t.CONTENTCHANGED=257]="CONTENTCHANGED",t[t.RANGE=258]="RANGE",t[t.Ctrl=4096]="Ctrl",t[t.Meta=8192]="Meta",t[t.Shift=16384]="Shift"}(up);var cp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleKnownAnnounceStrings=void 0,(t=e.CompatibleKnownAnnounceStrings||(e.CompatibleKnownAnnounceStrings={}))[t.AnnounceListItemNumbering=1]="AnnounceListItemNumbering",t[t.AnnounceListItemBullet=2]="AnnounceListItemBullet",t[t.AnnounceOnFocusLastCell=3]="AnnounceOnFocusLastCell"}(cp);var dp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleKnownCreateElementDataIndex=void 0,(t=e.CompatibleKnownCreateElementDataIndex||(e.CompatibleKnownCreateElementDataIndex={}))[t.None=0]="None",t[t.EmptyLine=1]="EmptyLine",t[t.BlockquoteWrapper=2]="BlockquoteWrapper",t[t.CopyPasteTempDiv=3]="CopyPasteTempDiv",t[t.BlockListItem=4]="BlockListItem",t[t.ContextMenuWrapper=5]="ContextMenuWrapper",t[t.ImageEditWrapper=6]="ImageEditWrapper",t[t.TableHorizontalResizer=7]="TableHorizontalResizer",t[t.TableVerticalResizer=8]="TableVerticalResizer",t[t.TableResizerLTR=9]="TableResizerLTR",t[t.TableResizerRTL=10]="TableResizerRTL",t[t.TableSelector=11]="TableSelector",t[t.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"}(dp);var fp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleKnownPasteSourceType=void 0,(t=e.CompatibleKnownPasteSourceType||(e.CompatibleKnownPasteSourceType={}))[t.WordDesktop=0]="WordDesktop",t[t.ExcelDesktop=1]="ExcelDesktop",t[t.ExcelOnline=2]="ExcelOnline",t[t.PowerPointDesktop=3]="PowerPointDesktop",t[t.GoogleSheets=4]="GoogleSheets",t[t.WacComponents=5]="WacComponents",t[t.Default=6]="Default",t[t.SingleImage=7]="SingleImage"}(fp);var pp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleListType=void 0,(t=e.CompatibleListType||(e.CompatibleListType={}))[t.None=0]="None",t[t.Ordered=1]="Ordered",t[t.Unordered=2]="Unordered"}(pp);var hp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleNodeType=void 0,(t=e.CompatibleNodeType||(e.CompatibleNodeType={}))[t.Element=1]="Element",t[t.Attribute=2]="Attribute",t[t.Text=3]="Text",t[t.ProcessingInstruction=7]="ProcessingInstruction",t[t.Comment=8]="Comment",t[t.Document=9]="Document",t[t.DocumentType=10]="DocumentType",t[t.DocumentFragment=11]="DocumentFragment"}(hp);var vp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleNumberingListType=void 0,(t=e.CompatibleNumberingListType||(e.CompatibleNumberingListType={}))[t.Min=1]="Min",t[t.Decimal=1]="Decimal",t[t.DecimalDash=2]="DecimalDash",t[t.DecimalParenthesis=3]="DecimalParenthesis",t[t.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",t[t.LowerAlpha=5]="LowerAlpha",t[t.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",t[t.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",t[t.LowerAlphaDash=8]="LowerAlphaDash",t[t.UpperAlpha=9]="UpperAlpha",t[t.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",t[t.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",t[t.UpperAlphaDash=12]="UpperAlphaDash",t[t.LowerRoman=13]="LowerRoman",t[t.LowerRomanParenthesis=14]="LowerRomanParenthesis",t[t.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",t[t.LowerRomanDash=16]="LowerRomanDash",t[t.UpperRoman=17]="UpperRoman",t[t.UpperRomanParenthesis=18]="UpperRomanParenthesis",t[t.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",t[t.UpperRomanDash=20]="UpperRomanDash",t[t.Max=20]="Max"}(vp);var gp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatiblePasteType=void 0,(t=e.CompatiblePasteType||(e.CompatiblePasteType={}))[t.Normal=0]="Normal",t[t.AsPlainText=1]="AsPlainText",t[t.MergeFormat=2]="MergeFormat",t[t.AsImage=3]="AsImage"}(gp);var mp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatiblePluginEventType=void 0,(t=e.CompatiblePluginEventType||(e.CompatiblePluginEventType={}))[t.KeyDown=0]="KeyDown",t[t.KeyPress=1]="KeyPress",t[t.KeyUp=2]="KeyUp",t[t.Input=3]="Input",t[t.CompositionEnd=4]="CompositionEnd",t[t.MouseDown=5]="MouseDown",t[t.MouseUp=6]="MouseUp",t[t.ContentChanged=7]="ContentChanged",t[t.ExtractContentWithDom=8]="ExtractContentWithDom",t[t.BeforeCutCopy=9]="BeforeCutCopy",t[t.BeforePaste=10]="BeforePaste",t[t.EditorReady=11]="EditorReady",t[t.BeforeDispose=12]="BeforeDispose",t[t.PendingFormatStateChanged=13]="PendingFormatStateChanged",t[t.Scroll=14]="Scroll",t[t.EntityOperation=15]="EntityOperation",t[t.ContextMenu=16]="ContextMenu",t[t.EnteredShadowEdit=17]="EnteredShadowEdit",t[t.LeavingShadowEdit=18]="LeavingShadowEdit",t[t.EditImage=19]="EditImage",t[t.BeforeSetContent=20]="BeforeSetContent",t[t.ZoomChanged=21]="ZoomChanged",t[t.SelectionChanged=22]="SelectionChanged",t[t.BeforeKeyboardEditing=23]="BeforeKeyboardEditing"}(mp);var Ap={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatiblePositionType=void 0,(t=e.CompatiblePositionType||(e.CompatiblePositionType={}))[t.Begin=0]="Begin",t[t.End=-1]="End",t[t.Before=-2]="Before",t[t.After=-3]="After"}(Ap);var yp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleQueryScope=void 0,(t=e.CompatibleQueryScope||(e.CompatibleQueryScope={}))[t.Body=0]="Body",t[t.OnSelection=1]="OnSelection",t[t.InSelection=2]="InSelection"}(yp);var bp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleRegionType=void 0,(t=e.CompatibleRegionType||(e.CompatibleRegionType={}))[t.Table=0]="Table"}(bp);var Ep={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleSelectionRangeTypes=void 0,(t=e.CompatibleSelectionRangeTypes||(e.CompatibleSelectionRangeTypes={}))[t.Normal=0]="Normal",t[t.TableSelection=1]="TableSelection",t[t.ImageSelection=2]="ImageSelection"}(Ep);var Cp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleTableBorderFormat=void 0,(t=e.CompatibleTableBorderFormat||(e.CompatibleTableBorderFormat={}))[t.DEFAULT=0]="DEFAULT",t[t.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",t[t.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",t[t.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",t[t.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",t[t.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",t[t.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",t[t.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",t[t.CLEAR=8]="CLEAR"}(Cp);var wp={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleTableOperation=void 0,(t=e.CompatibleTableOperation||(e.CompatibleTableOperation={}))[t.InsertAbove=0]="InsertAbove",t[t.InsertBelow=1]="InsertBelow",t[t.InsertLeft=2]="InsertLeft",t[t.InsertRight=3]="InsertRight",t[t.DeleteTable=4]="DeleteTable",t[t.DeleteColumn=5]="DeleteColumn",t[t.DeleteRow=6]="DeleteRow",t[t.MergeAbove=7]="MergeAbove",t[t.MergeBelow=8]="MergeBelow",t[t.MergeLeft=9]="MergeLeft",t[t.MergeRight=10]="MergeRight",t[t.MergeCells=11]="MergeCells",t[t.SplitHorizontally=12]="SplitHorizontally",t[t.SplitVertically=13]="SplitVertically",t[t.AlignCenter=14]="AlignCenter",t[t.AlignLeft=15]="AlignLeft",t[t.AlignRight=16]="AlignRight",t[t.AlignCellLeft=17]="AlignCellLeft",t[t.AlignCellCenter=18]="AlignCellCenter",t[t.AlignCellRight=19]="AlignCellRight",t[t.AlignCellTop=20]="AlignCellTop",t[t.AlignCellMiddle=21]="AlignCellMiddle",t[t.AlignCellBottom=22]="AlignCellBottom"}(wp),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CompatibleTableOperation=e.CompatibleTableBorderFormat=e.CompatibleSelectionRangeTypes=e.CompatibleRegionType=e.CompatibleQueryScope=e.CompatiblePositionType=e.CompatiblePluginEventType=e.CompatiblePasteType=e.CompatibleNumberingListType=e.CompatibleNodeType=e.CompatibleListType=e.CompatibleKnownPasteSourceType=e.CompatibleKnownCreateElementDataIndex=e.CompatibleKnownAnnounceStrings=e.CompatibleKeys=e.CompatibleIndentation=e.CompatibleImageEditOperation=e.CompatibleGetContentMode=e.CompatibleFontSizeChange=e.CompatibleExperimentalFeatures=e.CompatibleEntityOperation=e.CompatibleEntityClasses=e.CompatibleDocumentPosition=e.CompatibleDocumentCommand=e.CompatibleDirection=e.CompatibleDelimiterClasses=e.CompatibleDefinitionType=e.CompatibleDarkModeDatasetNames=e.CompatibleContentType=e.CompatibleContentTypePrefix=e.CompatibleContentPosition=e.CompatibleColorTransformDirection=e.CompatibleClearFormatMode=e.CompatibleChangeSource=e.CompatibleCapitalization=e.CompatibleBulletListType=e.CompatibleAlignment=void 0;var t=jf;Object.defineProperty(e,"CompatibleAlignment",{enumerable:!0,get:function(){return t.CompatibleAlignment}});var n=Qf;Object.defineProperty(e,"CompatibleBulletListType",{enumerable:!0,get:function(){return n.CompatibleBulletListType}});var r=Kf;Object.defineProperty(e,"CompatibleCapitalization",{enumerable:!0,get:function(){return r.CompatibleCapitalization}});var o=Vf;Object.defineProperty(e,"CompatibleChangeSource",{enumerable:!0,get:function(){return o.CompatibleChangeSource}});var i=Wf;Object.defineProperty(e,"CompatibleClearFormatMode",{enumerable:!0,get:function(){return i.CompatibleClearFormatMode}});var a=qf;Object.defineProperty(e,"CompatibleColorTransformDirection",{enumerable:!0,get:function(){return a.CompatibleColorTransformDirection}});var l=Gf;Object.defineProperty(e,"CompatibleContentPosition",{enumerable:!0,get:function(){return l.CompatibleContentPosition}});var s=Yf;Object.defineProperty(e,"CompatibleContentTypePrefix",{enumerable:!0,get:function(){return s.CompatibleContentTypePrefix}}),Object.defineProperty(e,"CompatibleContentType",{enumerable:!0,get:function(){return s.CompatibleContentType}});var u=Jf;Object.defineProperty(e,"CompatibleDarkModeDatasetNames",{enumerable:!0,get:function(){return u.CompatibleDarkModeDatasetNames}});var c=Xf;Object.defineProperty(e,"CompatibleDefinitionType",{enumerable:!0,get:function(){return c.CompatibleDefinitionType}});var d=Zf;Object.defineProperty(e,"CompatibleDelimiterClasses",{enumerable:!0,get:function(){return d.CompatibleDelimiterClasses}});var f=$f;Object.defineProperty(e,"CompatibleDirection",{enumerable:!0,get:function(){return f.CompatibleDirection}});var p=ep;Object.defineProperty(e,"CompatibleDocumentCommand",{enumerable:!0,get:function(){return p.CompatibleDocumentCommand}});var h=tp;Object.defineProperty(e,"CompatibleDocumentPosition",{enumerable:!0,get:function(){return h.CompatibleDocumentPosition}});var v=np;Object.defineProperty(e,"CompatibleEntityClasses",{enumerable:!0,get:function(){return v.CompatibleEntityClasses}});var g=rp;Object.defineProperty(e,"CompatibleEntityOperation",{enumerable:!0,get:function(){return g.CompatibleEntityOperation}});var m=op;Object.defineProperty(e,"CompatibleExperimentalFeatures",{enumerable:!0,get:function(){return m.CompatibleExperimentalFeatures}});var A=ip;Object.defineProperty(e,"CompatibleFontSizeChange",{enumerable:!0,get:function(){return A.CompatibleFontSizeChange}});var y=ap;Object.defineProperty(e,"CompatibleGetContentMode",{enumerable:!0,get:function(){return y.CompatibleGetContentMode}});var b=lp;Object.defineProperty(e,"CompatibleImageEditOperation",{enumerable:!0,get:function(){return b.CompatibleImageEditOperation}});var E=sp;Object.defineProperty(e,"CompatibleIndentation",{enumerable:!0,get:function(){return E.CompatibleIndentation}});var C=up;Object.defineProperty(e,"CompatibleKeys",{enumerable:!0,get:function(){return C.CompatibleKeys}});var w=cp;Object.defineProperty(e,"CompatibleKnownAnnounceStrings",{enumerable:!0,get:function(){return w.CompatibleKnownAnnounceStrings}});var S=dp;Object.defineProperty(e,"CompatibleKnownCreateElementDataIndex",{enumerable:!0,get:function(){return S.CompatibleKnownCreateElementDataIndex}});var T=fp;Object.defineProperty(e,"CompatibleKnownPasteSourceType",{enumerable:!0,get:function(){return T.CompatibleKnownPasteSourceType}});var D=pp;Object.defineProperty(e,"CompatibleListType",{enumerable:!0,get:function(){return D.CompatibleListType}});var k=hp;Object.defineProperty(e,"CompatibleNodeType",{enumerable:!0,get:function(){return k.CompatibleNodeType}});var x=vp;Object.defineProperty(e,"CompatibleNumberingListType",{enumerable:!0,get:function(){return x.CompatibleNumberingListType}});var I=gp;Object.defineProperty(e,"CompatiblePasteType",{enumerable:!0,get:function(){return I.CompatiblePasteType}});var L=mp;Object.defineProperty(e,"CompatiblePluginEventType",{enumerable:!0,get:function(){return L.CompatiblePluginEventType}});var N=Ap;Object.defineProperty(e,"CompatiblePositionType",{enumerable:!0,get:function(){return N.CompatiblePositionType}});var R=yp;Object.defineProperty(e,"CompatibleQueryScope",{enumerable:!0,get:function(){return R.CompatibleQueryScope}});var B=bp;Object.defineProperty(e,"CompatibleRegionType",{enumerable:!0,get:function(){return B.CompatibleRegionType}});var M=Ep;Object.defineProperty(e,"CompatibleSelectionRangeTypes",{enumerable:!0,get:function(){return M.CompatibleSelectionRangeTypes}});var P=Cp;Object.defineProperty(e,"CompatibleTableBorderFormat",{enumerable:!0,get:function(){return P.CompatibleTableBorderFormat}});var O=wp;Object.defineProperty(e,"CompatibleTableOperation",{enumerable:!0,get:function(){return O.CompatibleTableOperation}})}(zf);var Sp={};Object.defineProperty(Sp,"__esModule",{value:!0});var Tp={};Object.defineProperty(Tp,"__esModule",{value:!0});var Dp={};function kp(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}Object.defineProperty(Dp,"__esModule",{value:!0}),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Ff;(0,t.__exportStar)(Hf,e),(0,t.__exportStar)(Uf,e),(0,t.__exportStar)(zf,e),(0,t.__exportStar)(Sp,e),(0,t.__exportStar)(Tp,e),(0,t.__exportStar)(Dp,e)}({});kp("[enei]{border:1px dashed transparent}.enei_editor_mode [enei]{outline:1px dashed #468cff}.enei__overlay{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background:rgba(0,0,0,.4);bottom:0;justify-content:center;left:0;right:0;top:0;z-index:100000}.enei__editor,.enei__overlay{display:-webkit-box;display:-ms-flexbox;display:flex;position:fixed}.enei__editor{-webkit-box-orient:vertical;-webkit-box-direction:normal;background:#fff;border-radius:4px;-webkit-box-shadow:4px 4px 10px rgba(0,0,0,.4);box-shadow:4px 4px 10px rgba(0,0,0,.4);-ms-flex-flow:column;flex-flow:column}.enei__editor .enei__text{margin:4px;max-height:400px;overflow:auto;padding:4px}.enei__editor .enei__text[contenteditable=true]{border:1px solid #d9d9d9;outline:1px solid #d9d9d9}.enei__editor .enei__actions{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;justify-content:start;padding:0 4px 4px 2px}.enei__editor .enei__actions *{margin-left:2px}.enei__button,.enei__tool-button{-webkit-box-align:center;-ms-flex-align:center;-webkit-box-pack:center;-ms-flex-pack:center;align-items:center;background-color:#eaeaea;border:1px solid transparent;color:#000;cursor:pointer;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:12px;font-weight:400;height:28px;justify-content:center;margin:1px;outline:none;overflow:visible;padding:0 8px;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap}.enei__button .caption+.icon,.enei__button .icon+.caption,.enei__tool-button .caption+.icon,.enei__tool-button .icon+.caption{margin-left:8px}.enei__button.primary-color,.enei__tool-button.primary-color{background-color:#468cff;color:#fff}.enei__toolbar{-webkit-box-orient:horizontal;-webkit-box-direction:normal;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap;margin:4px 2px 2px;padding-left:2px}.enei__toolbar .enei__tool-button{background:#eaeaea;color:#000;height:24px;margin-left:2px;width:24px}.enei__toolbar .enei__tool-button.active{background-color:#acacac;color:#fff}.enei__toolbar .enei__tool-divider{display:block;height:24px;width:4px}.enei-dialog input,.enei-dialog label{font-size:14px;width:100%}.enei-dialog input{border:1px solid #efefef;padding:4px 8px}.enei-dialog input:focus{border-color:#b7b7b7;outline:none}.enei-dialog menu{margin-top:10px}");kp('@font-face{font-display:swap;font-family:enei-icons;font-style:normal;font-weight:400;src:url(data:application/font-woff;base64,d09GRgABAAAAABYsAAsAAAAAFeAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgDxIH0mNtYXAAAAFoAAAA3AAAANw6Bjo3Z2FzcAAAAkQAAAAIAAAACAAAABBnbHlmAAACTAAAELwAABC8jkDzUGhlYWQAABMIAAAANgAAADYm/E3jaGhlYQAAE0AAAAAkAAAAJAijBORobXR4AAATZAAAAJAAAACQhwAAAGxvY2EAABP0AAAASgAAAEpMREf0bWF4cAAAFEAAAAAgAAAAIAArAGduYW1lAAAUYAAAAaoAAAGqnrGyyHBvc3QAABYMAAAAIAAAACAAAwAAAAMD+AGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA6rADwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEAMAAAAAsACAABAAMAAEAIOkA6Q3pYulm6XjphOmS6bbpuem76cvqEOpl6mrqdep86oDqsP/9//8AAAAAACDpAOkM6WLpZel46YTpkum26bjpu+nL6g/qYupp6nTqd+qA6rD//f//AAH/4xcEFvkWpRajFpIWhxZ6FlcWVhZVFkYWAxWyFa8VphWlFaIVcwADAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAH//wAPAAEAAP/AAAADwAACAAA3OQEAAAAAAQAA/8AAAAPAAAIAADc5AQAAAAABAAD/wAAAA8AAAgAANzkBAAAAAAIAAP/ABAADwAAFAA4AAAkCNQkBBxEhESERIREBBAD+AP4AAgACAID/AP8A/wABgAFyAY3+c6IBjf5zlP6AAQD/AAGAASAAAAIAAP/ABAADwAApAC0AAAERIzU0JiMhIgYdARQWMyEyNj0BMxEhFSMiBhURFBY7ATI2NRE0JisBNQEhNSEEAMAmGv1AGiYmGgLAGiaA/cAgDRMTDYANExMNIAFA/UACwAGAAYBAGiYmGsAaJiYaQP8AgBMN/sANExMNAUANE0ABgEAAAAQAAP/ABAADwAAQACEALQA0AAABOAExETgBMSE4ATEROAExITUhIgYVERQWMyEyNjURNCYjBxQGIyImNTQ2MzIWEyE1EwEzNwPA/IADgPyAGiYmGgOAGiYmGoA4KCg4OCgoOED9AOABAEDgA0D9AAMAQCYa/QAaJiYaAwAaJuAoODgoKDg4/biAAYD+wMAAAAMAAP/ABAADwAAEAAgAEQAAASERIREhMxEjASERMxEhETMXA4D8gAQA/gCAgAGA/QBAAkBLNQPA/AADgP8A/gADAP7AAUA1AAEAAP/ABAADwAArAAABIgcOAQcGBycRISc+ATMyFx4BFxYVFAcOAQcGBxc2Nz4BNzY1NCcuAScmIwIANTIyXCkpI5YBgJA1i1BQRUZpHh4JCSIYGB5VKCAgLQwMKCiLXl1qA4AKCycbHCOW/oCQNDweHmlGRVArKClJICEaYCMrK2I2NjlqXV6LKCgAAQAA/8AEAAPAACoAABMUFx4BFxYXNyYnLgEnJjU0Nz4BNzYzMhYXByERByYnLgEnJiMiBw4BBwYADAwtICAoVR4YGCIJCR4eaUZFUFCLNZABgJYjKSlcMjI1al1eiygoAYA5NjZiKysjYBohIEkpKCtQRUZpHh48NJABgJYjHBsnCwooKIteXQAAAAACAAD/wAQBA8AAJgBNAAABIicuAScmNTQ3PgE3NjMyFx4BFxYVFxQHDgEHBiM1MjY3PgE3DgEhIicuAScmNTQ3PgE3NjMyFx4BFxYVFxQHDgEHBiM1MjY3PgE3DgEDIC4pKT0REhIRPSkpLi4pKT0REgEjI3pSUV1AdS0JEAcIEv23LikpPRESEhE9KSkuLikpPRESASMjelJRXUB1LQkQBwgSAUASET0pKS4uKSk9ERISET0pKS4gXVFSeiMjgDAuCBMKAgESET0pKS4uKSk9ERISET0pKS4gXVFSeiMjgDAuCBMKAgEAAQAA/8AEAAPAADUAAAEhNy4BIyIGBw4BFRQWFx4BMzI2Nz4BNxcGBw4BBwYjIicuAScmNTQ3PgE3NjMyFx4BFxYXNwQA/oCQN4xNTYw3Njo6NjeMTU2MNwQJBGAjKytiNjY6al1eiygoKCiLXl1qNTIyXCkpI5YCQJA2Ojo2N4xNTYw3Njo6NgUJBVQoISAtDQwoKIteXWpqXV6LKCgKCycbHCOWAAAABgAA/8AEAAPAABcAGwAzADcATwBTAAABNTQmKwEiBh0BIxUzFRQWOwEyNj0BITUFNTMVBTQmKwEiBh0BIRUhFRQWOwEyNj0BMzUjBzUzFQU0JisBIgYdASMVMxUUFjsBMjY9ASE1IQc1MxUBwBwUoBQcwMAcFKAUHAJA/QCAAcAcFKAUHP3AAkAcFKAUHMDAwID+wBwUoBQcwMAcFKAUHAJA/cDAgANAEBQcHBQQgBAUHBwUEICAgICwFBwcFBCAEBQcHBQQgICAgLAUHBwUEIAQFBwcFBCAgICAAAIAAP/AA8ADwAA1ADkAAAEVHgEXHgEVFAYHDgEjIiYnLgE1NDY3PgE3NQYHDgEHBhUUFx4BFxYzMjc+ATc2NTQnLgEnJiUzESMCgBsyFS4wMC4tdUBAdS0uMDAuFTIbRTs7VRgYIyN6UlFdXVFSeiMjGBhVOzv++4CAAy2ICyIWLXVAQHUtLjAwLi11QEB1LRYiC4gUKSpwRUVMXVFSeiMjIyN6UlFdTEVFcCopp/4AAAAAAAQAAP/AA8ADwAAWACIAMAA2AAABITQmIyIGFSEiBhURFBYzITI2NRE0JiUyFhUUBiMiJjU0NgEhETMVFBYzITI2PQEzASc3FyUXA6D+4Es1NUv+4A0TEw0DQA0TE/5TGyUlGxslJQGb/QCAEw0BwA0TgP5AzTqTARM6A0A1S0s1Ew38wA0TEw0DQA0TQCUbGyUlGxsl/IADAGANExMNYP1l7jpy8joAAAYAAP/ABAADwAADAAcACwARAB0AKQAAJSEVIREhFSERIRUhJxEjNSM1ExUzFSM1NzUjNTMVFREjNTM1IzUzNSM1AYACgP2AAoD9gAKA/YDAQEBAgMCAgMDAgICAgICAAgCAAgCAwP8AwED98jJAkjwyQJLu/sBAQEBAQAAGAAD/wAQAA8AAAwAHAAsAFwAjAC8AAAEhFSERIRUhESEVIQE0NjMyFhUUBiMiJhE0NjMyFhUUBiMiJhE0NjMyFhUUBiMiJgGAAoD9gAKA/YACgP2A/oBLNTVLSzU1S0s1NUtLNTVLSzU1S0s1NUsDgID/AID/AIADQDVLSzU1S0v+tTVLSzU1S0v+tTVLSzU1S0sAAgAA/8AD4gPAADMAZAAAASImJyYnJjQ3Nj8BPgEzMhYXFhcWFAcGDwEGIicmND8BNjQnLgEjIgYPAQYUFxYUBw4BIwMiJicmJyY0NzY/ATYyFxYUDwEGFBceATMyNj8BNjQnJjQ3NjIXFhcWFAcGDwEOASMBuAoTCCMSEhISI8AjWTExWSMjEhISEiNYDywPDw9YKSkUMxwcMxTAKSkPDwgTCrgxWSMjEhISEiNYDywPDw9YKSkUMxwcMxTAKSkPDw8rECMSEhISI8AjWTEBRAgHJC0tXi0tJMAiJSUiJC0tXi0tJFcQEA8rD1gpdCkUFRUUwCl0KQ8rEAcI/oglIiQtLV4tLSRXEBAPKw9YKXQpFBUVFMApdCkPKxAPDyQtLV4tLSTAIiUAAAAAAQAA/8AD/gPAAFMAACU4ATEJATgBMT4BNzYmLwEuAQcOAQc4ATEJATgBMS4BJyYGDwEOARceARc4ATEJATgBMQ4BBwYWHwEeATc+ATc4ATEJATgBMR4BFxY2PwE+AScuAQP3/skBNwIEAQMDB5MHEgkDBgL+yf7JAgYDCRIHkwcDAwEEAgE3/skCBAEDAweTBxIJAwYCATcBNwIGAwkSB5MHAwMBBIkBNwE3AgYDCRIHkwcDAwEEAv7JATcCBAEDAweTBxIJAwYC/sn+yQIGAwkSB5MHAwMBBAIBN/7JAgQBAwMHkwcSCQMGAAABAAD/wAQAA8AABQAACQEnBwkBA2D+IOCgAYACgANA/iDgoP6AAoAAAwAA/8ADQAPAABYAHwAoAAABPgE1NCcuAScmIyERITI3PgE3NjU0JgEzMhYVFAYrARMjETMyFhUUBgLEHCAUFEYuLzX+wAGANS8uRhQURP6EZSo8PClmn5+fLD4+AdsiVC81Ly5GFBT8gBQURi4vNUZ0AUZLNTVL/oABAEs1NUsAAAAAAgAA/8ADQAPAAB8AIwAAATMRFAcOAQcGIyInLgEnJjURMxEUFhceATMyNjc+ATUBIRUhAsCAGRlXOjtCQjs6VxkZgBsYHEkoKEkcGBv+AAKA/YADgP5gPDQ1ThYXFxZONTQ8AaD+YB44FxgbGxgXOB7+oIAAAAAAAQAA/8ADgAPAAAsAAAEVIwEzFSE1MwEjNQOAgP7AgP5AgAFAgAOAQP0AQEADAEAAAQAA/8AEAAPAAD0AAAEVIx4BFRQGBw4BIyImJy4BNTMUFjMyNjU0JiMhNSEuAScuATU0Njc+ATMyFhceARUjNCYjIgYVFBYzMhYXBADrFRY1MCxxPj5xLDA1gHJOTnJyTv4AASwCBAEwNTUwLHE+PnEsMDWAck5OcnJOO24rAcBAHUEiNWIkISQkISRiNTRMTDQ0TEABAwEkYjU1YiQhJCQhJGI1NExMNDRMIR8AAAACAAD/wAOAA8AACwAXAAABFTMVIzU3NSM1MxUHIwcnIwkBMzcXMwEDAIDAgIDA3Ii8vIgBAP8AiLy8iP8AAvIyQJI8MkCSbry8/wD/ALy8AQAAAAACAAD/wAOAA8AACwAXAAAlFTMVIzU3NSM1MxUDIwcnIwkBMzcXMwEDAIDAgIDA3Ii8vIgBAP8AiLy8iP8AMjJAkjwyQJICUry8/wD/ALy8AQAAAAACAAD/wAQAA8AAFwAaAAABIgcOAQcGFRQXHgEXFjMRMxEzETMRMzUJAgIANS8uRhQUFBRGLi81gICAgPwAAQD/AAPAFBRGLi81NS8uRhQU/gADgPyAA4CA/UABAAEAAAACAAD/wAQAA8AAFwAaAAABIgcOAQcGFRQXHgEXFjMRMxEzETMRMzUFCQEBADUvLkYUFBQURi4vNYCAgIABAP8AAQADwBQURi4vNTUvLkYUFP4AA4D8gAOAgMD/AP8AAAAFAAD/wAQAA8AAAwAHAAsADwATAAATIRUhFSEVIREhFSERIRUhESEVIQAEAPwAAoD9gAKA/YAEAPwABAD8AAOAgECA/wCAAUCA/wCAAAAAAAUAAP/ABAADwAADAAcACwAPABMAABMhFSEXIRUhESEVIQMhFSERIRUhAAQA/ADAAoD9gAKA/YDABAD8AAQA/AADgIBAgP8AgAFAgP8AgAAABQAA/8AEAAPAAAMABwALAA8AEwAAEyEVIQUhFSERIRUhASEVIREhFSEABAD8AAGAAoD9gAKA/YD+gAQA/AAEAPwAA4CAQID/AIABQID/AIAAAAAABQAA/8AEAAPAAAMABwALAA8AEwAAEyEVIRUhFSEVIRUhFSEVIRUhFSEABAD8AAQA/AAEAPwABAD8AAQA/AADgIBAgECAQIBAgAAAAAYAAP/ABAADwAADAAcACwAPABMAFgAAEyEVIQUhFSEVIRUhFSEVIQUhFSEZAQUABAD8AAGAAoD9gAKA/YACgP2A/oAEAPwAAQADgIBAgECAQIBAgAEAAYDAAAAABgAA/8AEAAPAAAMABwALAA8AEwAWAAATIRUhBSEVIRUhFSEVIRUhBSEVIQERJQAEAPwAAYACgP2AAoD9gAKA/YD+gAQA/AABAP8AA4CAQIBAgECAQIACgP6AwAADAAD/wATgA8AABQALAA8AACUXCQEHFyUnCQE3JwEXAycDQGABQP7AYOD9oGD+wAFAYOAB3UbARuBgAUABQGDg4GD+wP7AYOABaRL9QBIAAAEAAP/ABAADwABjAAABIgcOAQcGFRQXHgEXFhcWNjU8AScGJjEuATEmNjEeATEWNjc+ATcmJy4BJyY1NDY3LgE3MBYXPgEzMhYXPgExFgYHHgEVFAcOAQcGBx4BFRQGFRQWNzY3PgE3NjU0Jy4BJyYjAgBqXV6LKCgaGl1BQEwTEAFqQhInIycmKCJdFgQSCysqKkIUFRwZBAwVQ0oeQSEhQR5KQxUMBBkcFRRDKikrDhUBEBNMQUBdGhooKIteXWoDsygoi11ealRNTYAvLxkEEgoJNiAXVCwfGAcDMjsHChgiCgUMDTgvL0kqRRsJSTUDMQgJCQgxAzVJCRtFKkovLjgMDQULMCM0TA0KEgQZLzB/TU1Ual5diygoAAAAAAEAAAABAABL/I3fXw889QALBAAAAAAA4X6EswAAAADhfoSzAAD/wATgA8AAAAAIAAIAAAAAAAAAAQAAA8D/wAAABQAAAP//BOAAAQAAAAAAAAAAAAAAAAAAACQEAAAAAAAAAAAAAAACAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABQAAAAQAAAAAAAAAAAoAFAAeAEIAhADMAPABNgF8AfACRAKyAwwDYAOeA+gEfgT0BQgFSgWGBZ4F9gYgBkoGegaqBtIG+gckB0oHeAemB84IXgAAAAEAAAAkAGUABgAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAOAK4AAQAAAAAAAQAKAAAAAQAAAAAAAgAHAHsAAQAAAAAAAwAKAD8AAQAAAAAABAAKAJAAAQAAAAAABQALAB4AAQAAAAAABgAKAF0AAQAAAAAACgAaAK4AAwABBAkAAQAUAAoAAwABBAkAAgAOAIIAAwABBAkAAwAUAEkAAwABBAkABAAUAJoAAwABBAkABQAWACkAAwABBAkABgAUAGcAAwABBAkACgA0AMhlbmVpLWljb25zAGUAbgBlAGkALQBpAGMAbwBuAHNWZXJzaW9uIDEuMABWAGUAcgBzAGkAbwBuACAAMQAuADBlbmVpLWljb25zAGUAbgBlAGkALQBpAGMAbwBuAHNlbmVpLWljb25zAGUAbgBlAGkALQBpAGMAbwBuAHNSZWd1bGFyAFIAZQBnAHUAbABhAHJlbmVpLWljb25zAGUAbgBlAGkALQBpAGMAbwBuAHNGb250IGdlbmVyYXRlZCBieSBJY29Nb29uLgBGAG8AbgB0ACAAZwBlAG4AZQByAGEAdABlAGQAIABiAHkAIABJAGMAbwBNAG8AbwBuAC4AAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA)}[class*=" ei-"],[class^=ei-]{speak:never;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:enei-icons!important;font-style:normal;font-variant:normal;font-weight:400;line-height:1;text-transform:none}.ei-home:before{content:"\\e900"}.ei-paint-format:before{content:"\\e90c"}.ei-image:before{content:"\\e90d"}.ei-floppy-disk:before{content:"\\e962"}.ei-undo:before{content:"\\e965"}.ei-redo:before{content:"\\e966"}.ei-quotes-right:before{content:"\\e978"}.ei-revert:before{content:"\\e984"}.ei-equalizer:before{content:"\\e992"}.ei-switch:before{content:"\\e9b6"}.ei-clipboard:before{content:"\\e9b8"}.ei-list1:before{content:"\\e9b9"}.ei-list2:before{content:"\\e9bb"}.ei-link:before{content:"\\e9cb"}.ei-cross:before{content:"\\ea0f"}.ei-checkmark:before{content:"\\ea10"}.ei-bold:before{content:"\\ea62"}.ei-underline:before{content:"\\ea63"}.ei-italic:before{content:"\\ea64"}.ei-strike:before{content:"\\ea65"}.ei-superscript:before{content:"\\ea69"}.ei-subscript:before{content:"\\ea6a"}.ei-ltr:before{content:"\\ea74"}.ei-rtl:before{content:"\\ea75"}.ei-paragraph-left:before{content:"\\ea77"}.ei-paragraph-center:before{content:"\\ea78"}.ei-paragraph-right:before{content:"\\ea79"}.ei-paragraph-justify:before{content:"\\ea7a"}.ei-indent-increase:before{content:"\\ea7b"}.ei-indent-decrease:before{content:"\\ea7c"}.ei-embed:before{content:"\\ea80"}.ei-github:before{content:"\\eab0"}');const xp=e=>e&&"object"==typeof e&&!Array.isArray(e),Ip=(e,...t)=>{if(!t.length)return e;const n=t.shift();if(xp(e)&&xp(n))for(const t in n)xp(n[t])?(e[t]||Object.assign(e,{[t]:{}}),Ip(e[t],n[t])):Object.assign(e,{[t]:n[t]});return Ip(e,...t)},Lp={shortcut:"alt+ctrl+k",serverEndpoint:"localhost",maxHeight:300},Np="enei_editor_mode",Rp="[enei]",Bp=sessionStorage;class Mp{body=null;editorContainer=null;editor=null;overlay=null;content=null;current=null;toolbar=null;options={};originalContent=null;constructor(e){this.options=Ip({},Lp,e),this.addEvents(),this.body=document.querySelector("body"),this.restoreBlocks()}createEditor(){this.editorContainer=document.createElement("div"),this.editorContainer.className="enei__editor",this.editorContainer.innerHTML='\n\n<dialog id="enei-dialog-link" class="enei-dialog js-enei-dialog-link">\n    <form method="dialog">\n        <header>\n            <h3>Create Link</h3>        \n        </header>\n        <main>    \n            <div>\n                <label>Web Address (URL)</label>\n                <input type="url" name="enei-dialog-link__url">\n            </div>\n            <div>\n                <label>Display as</label>\n                <input type="text" name="enei-dialog-link__display">\n            </div>\n        </main>\n        <menu>\n            <button class="enei__button js-enei-dialog-link__button-ok" type="submit" value="ok">OK</button>\n            <button class="enei__button js-enei-dialog-link__button-cancel" type="reset" value="cancel">Cancel</button>\n        </menu>\n    </form>\n</dialog>\n\n<div class="enei__toolbar">\n    <button class="enei__tool-button js-enei-bold" title="Bold"><span class="ei-bold"></span></button>\n    <button class="enei__tool-button js-enei-italic" title="Italic"><span class="ei-italic"></span></button>\n    <button class="enei__tool-button js-enei-underline" title="Underline"><span class="ei-underline"></span></button>\n    <button class="enei__tool-button js-enei-strike" title="Strike"><span class="ei-strike"></span></button>\n\n    <button class="enei__tool-button js-enei-superscript" title="Superscript"><span class="ei-superscript"></span></button>\n    <button class="enei__tool-button js-enei-subscript" title="Subscript"><span class="ei-subscript"></span></button>\n\n    <button class="enei__tool-button js-enei-list-num" title="Numbered List"><span class="ei-list1"></span></button>\n    <button class="enei__tool-button js-enei-list-bull" title="Bulleted List"><span class="ei-list2"></span></button>\n\n    <button class="enei__tool-button js-enei-p-left" title="Align Left"><span class="ei-paragraph-left"></span></button>\n    <button class="enei__tool-button js-enei-p-center" title="Align Center"><span class="ei-paragraph-center"></span></button>\n    <button class="enei__tool-button js-enei-p-right" title="Align Right"><span class="ei-paragraph-right"></span></button>\n\n    <button class="enei__tool-button js-enei-link" title="Insert Link"><span class="ei-link"></span></button>\n    <button class="enei__tool-button js-enei-unlink" title="Remove Link"><span class="ei-switch"></span></button>\n    <button class="enei__tool-button js-enei-image" title="Insert Image"><span class="ei-image"></span></button>\n    <button class="enei__tool-button js-enei-quote" title="Quoted text"><span class="ei-quotes-right"></span></button>\n    <button class="enei__tool-button js-enei-code" title="Code"><span class="ei-embed"></span></button>\n\n    <button class="enei__tool-button js-enei-indent-increase" title="Increase Indent"><span class="ei-indent-increase"></span></button>\n    <button class="enei__tool-button js-enei-indent-decrease" title="Decrease Indent"><span class="ei-indent-decrease"></span></button>\n\n    <button class="enei__tool-button js-enei-ltr" title="LTR Text"><span class="ei-ltr"></span></button>\n    <button class="enei__tool-button js-enei-rtl" title="RTL Text"><span class="ei-rtl"></span></button>\n\n    <button class="enei__tool-button js-enei-clear-format" title="Clear Format"><span class="ei-paint-format"></span></button>\n\n    <button class="enei__tool-button js-enei-undo" title="Undo Operation"><span class="ei-undo"></span></button>\n    <button class="enei__tool-button js-enei-redo" title="Redo Operation"><span class="ei-redo"></span></button>\n    <button class="enei__tool-button js-enei-revert" title="Revert Content"><span class="ei-revert"></span></button>\n\n</div>\n<div class="enei__text"></div>\n<div class="enei__actions">\n    <button class="enei__button js-enei-ok">Save</button>\n    <button class="enei__button js-enei-cancel">Cancel</button>\n    <div style="margin-left: auto;">\n        <span style="font-size: 10px;">v0.1.2</span>\n        <a href="https://github.com/olton/enei-editor" target="_blank" class="enei__button js-enei-github" style="background-color: transparent;"><span class="ei-github"></span></a>\n    </div>\n</div>\n',this.overlay.append(this.editorContainer)}createOverlay(){this.overlay=document.createElement("div"),this.overlay.classList.add("enei__overlay"),this.body.append(this.overlay),this.overlay.addEventListener("wheel",(e=>{e.preventDefault(),e.stopPropagation()}))}openEditor(){const e=this,t=this.options,n=this.current;let{top:r,left:o,width:i}=n.getBoundingClientRect();r<0&&(r=112),this.createOverlay(),this.createEditor(),this.originalContent=n.innerHTML,this.linkDialog=document.querySelector("#enei-dialog-link"),this.content=this.editorContainer.querySelector(".enei__text"),this.toolbar=this.editorContainer.querySelector(".enei__toolbar"),this.editorContainer.style.top=r-56+"px",this.editorContainer.style.left=`${o}px`,this.editorContainer.style.width=`${i}px`,this.editorContainer.style.maxHeight=`${t.maxHeight}px`,this.editor=new ad(this.content,{plugins:[new Gl,new Xu(!0),new Yl((e=>"Ctrl+click to open link "+e)),new Us],initialContent:this.originalContent});const a=()=>{e.editorContainer.style.height=`${this.content.height+this.toolbar.scrollHeight+70}px`},l=e=>{const t=e=>this.toolbar.querySelector(`.js-enei-${e}`),n=(e,n)=>t(e).classList[n?"add":"remove"]("active"),{isBold:r,isItalic:o,isUnderline:i,isStrikeThrough:a,isSubscript:l,isSuperscript:s,isBlockQuote:u,isCodeInline:c,isCodeBlock:d,direction:f,canUndo:p,canRedo:h,textAlign:v,isBullet:g,isNumbering:m,canUnlink:A}=e;n("bold",r),n("italic",o),n("underline",i),n("strike",a),n("subscript",l),n("superscript",s),n("quote",u),n("code",d||c),n("ltr","ltr"===f),n("rtl","rtl"===f),n("undo",p),n("redo",h),n("p-left",["start","left"].includes(v)),n("p-center","center"===v),n("p-right",["end","right"].includes(v)),n("list-num",m),n("list-bull",g),t("unlink").disabled=!A};["keyup","mouseup","input","click","contentchanged"].forEach((e=>{this.content.addEventListener(e,(()=>{l(vi(this.editor))}))})),this.content.focus(),a(),l(vi(this.editor));const s=()=>{this.content.focus(),a(),l(vi(this.editor))};this.content.addEventListener("input",(()=>{a()}));const u=(e,t)=>{this.editorContainer.querySelector(`.js-enei-${e}`).addEventListener("click",t)};u("cancel",(()=>{this.closeEditor()})),u("ok",(async()=>{await this.saveEditor()})),u("bold",(()=>{qo(this.editor),s()})),u("italic",(()=>{Go(this.editor),s()})),u("underline",(()=>{Yo(this.editor),s()})),u("strike",(()=>{Ko(this.editor,"strikeThrough","toggleStrikethrough"),s()})),u("superscript",(()=>{Ko(this.editor,"superscript","toggleSuperscript"),s()})),u("subscript",(()=>{Ko(this.editor,"subscript","toggleSubscript"),s()})),u("list-num",(()=>{Li(this.editor,1),s()})),u("list-bull",(()=>{Li(this.editor,2),s()})),u("p-left",(()=>{wi(this.editor,0),s()})),u("p-center",(()=>{wi(this.editor,1),s()})),u("p-right",(()=>{wi(this.editor,2),s()})),u("quote",(()=>{var e,t;Bi(e=this.editor,(function(e){var n=Ce(e,"blockquote");(t||Mi)(n)}),(function(){return 0==e.queryElements("blockquote",1,An).length}),"toggleBlockQuote"),s()})),u("code",(()=>{var e,t;Bi(e=this.editor,(function(e){var n=Ce(e,Pi),r=Ce(n,"pre");null==t||t(r)}),(function(){return 0==e.queryElements(Oi,1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;An(e),t&&An(t)}})).length}),"toggleCodeBlock"),s()})),u("indent-increase",(()=>{Di(this.editor,0),s()})),u("indent-decrease",(()=>{Di(this.editor,1),s()})),u("undo",(()=>{this.editor.undo(),s()})),u("redo",(()=>{this.editor.redo(),s()})),u("ltr",(()=>{Ti(this.editor,0),s()})),u("rtl",(()=>{Ti(this.editor,1),s()})),u("clear-format",(()=>{si(this.editor,0),s()})),u("unlink",(()=>{Ei(this.editor),s()})),u("link",(()=>{this.linkDialog.querySelector("[name=enei-dialog-link__display]").value=this.editor.getSelectionRange(),this.linkDialog.showModal(),s()})),this.linkDialog.querySelector(".js-enei-dialog-link__button-cancel").addEventListener("click",(()=>{this.linkDialog.close()})),this.linkDialog.addEventListener("close",(()=>{if("ok"!==this.linkDialog.returnValue)return;let e=this.linkDialog.querySelector("[name=enei-dialog-link__url]").value.trim(),t=this.linkDialog.querySelector("[name=enei-dialog-link__display]").value.trim();e&&(t||(t=e),fi(this.editor,e,t,t,"_blank"))})),u("image",(()=>{const e=this.editor.getDocument(),t=Ee({tag:"input",attributes:{type:"file",accept:"image/*",display:"none"}},this.editor.getDocument());e.body.appendChild(t),t.addEventListener("change",(()=>{if(t.files)for(let e=0;e<t.files.length;e++)mi(this.editor,t.files[e])}));try{t.click()}finally{e.body.removeChild(t)}s()})),u("revert",(()=>{this.editor.setContent(this.originalContent)}))}async saveEditor(){const e=this.content.innerHTML,t=this.current;t.innerHTML=e;await this.commitBlock(t.getAttribute("enei"),e)||(this.current.innerHTML=this.originalContent),this.closeEditor()}closeEditor(){this.editor.dispose(),this.overlay.remove()}addEvents(){const e=this,t=this.options;window.addEventListener("keydown",(async function(n){if(n.repeat)return;const r=[];n.altKey&&r.push("alt"),(n.ctrlKey||n.metaKey)&&r.push("ctrl"),n.shiftKey&&r.push("shift"),n.key&&r.push(n.key);const o=r.join("+");"ctrl+Enter"===o&&e.editor&&await e.saveEditor(),"Escape"===o&&e.editor&&e.closeEditor(),t.shortcut===o&&e.switchMode()}))}switchMode(){const e=this;this.body.classList.toggle(Np);const t=function(){e.inEditMode()&&(e.current=this,e.openEditor())},n=document.querySelectorAll(Rp);this.inEditMode()?n.forEach((e=>{e.addEventListener("click",t)})):n.forEach((e=>{e.removeEventListener("click",t)}))}inEditMode(){return this.body.classList.contains(Np)}async commitBlock(e,t){const{serverEndpoint:n}=this.options,r=await fetch(`${n}/commit-blocks`,{method:"POST",body:JSON.stringify([{id:e,content:t}]),headers:{"Content-Type":"application/json"}});if(!r.ok)return alert("Block not committed!"),null;return(await r.json()).includes(e)?(this.saveBlock(e,t),e):null}saveBlocks(){const e={};document.querySelectorAll(Rp).forEach((t=>{const n=t.getAttribute("enei");e[n]=t.innerHTML.trim()})),Bp.setItem("ENEI",JSON.stringify(e))}restoreBlocks(){let e=Bp.getItem("ENEI");if(e){e=JSON.parse(e);for(let t in e){document.querySelector(`[enei=${t}]`).innerHTML=e[t]}}}restoreBlock(e){let t=Bp.getItem("ENEI");if(!t)return;document.querySelector(`[enei=${e}]`).innerHTML=JSON.parse(t)[e]}saveBlock(e,t){let n=Bp.getItem("ENEI");n=n?JSON.parse(n):{},n[e]=t.trim(),Bp.setItem("ENEI",JSON.stringify(n))}}return e.EneiEditor=Mp,e.createEneiEditor=e=>new Mp(e),e}({});
