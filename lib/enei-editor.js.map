{"version":3,"file":"enei-editor.js","sources":["../node_modules/tslib/tslib.es6.mjs","../node_modules/roosterjs-editor-api/lib-mjs/utils/formatUndoSnapshot.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/safeInstanceOf.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/contains.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/isNodeAfter.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/splitParentNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/jsUtils/toArray.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/collapseNodes.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getTagOfNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/isBlockElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/blockElements/NodeBlockElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/isVoidHtmlElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/matchesSelector.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/findClosestElementAncestor.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/Position.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/createRange.js","../node_modules/roosterjs-editor-dom/lib-mjs/jsUtils/getObjectKeys.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/Browser.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/createElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/wrap.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/fromHtml.js","../node_modules/roosterjs-editor-dom/lib-mjs/blockElements/StartEndBlockElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/blockElements/getBlockElementAtNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/blockElements/getFirstLastBlockElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/splitTextNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getComputedStyles.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/shouldSkipNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getLeafSibling.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/applyTextStyle.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/NodeInlineElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/ImageInlineElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/LinkInlineElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/getInlineElementAtNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getLeafNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/getFirstLastInlineElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/contentTraverser/BodyScoper.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/EmptyInlineElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/PartialInlineElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/inlineElements/getInlineElementBeforeAfter.js","../node_modules/roosterjs-editor-dom/lib-mjs/contentTraverser/SelectionBlockScoper.js","../node_modules/roosterjs-editor-dom/lib-mjs/contentTraverser/SelectionScoper.js","../node_modules/roosterjs-editor-dom/lib-mjs/contentTraverser/ContentTraverser.js","../node_modules/roosterjs-editor-dom/lib-mjs/contentTraverser/PositionContentSearcher.js","../node_modules/roosterjs-editor-dom/lib-mjs/delimiter/getDelimiterFromElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/delimiter/addDelimiters.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/extractClipboardItems.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/readFile.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/extractClipboardEvent.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/extractClipboardItemsForIE.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/handleTextPaste.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/retrieveMetadataFromClipboard.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/getInheritableStyles.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/moveChildNodes.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/changeElementTag.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/getPredefinedCssForElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/style/getStyles.js","../node_modules/roosterjs-editor-dom/lib-mjs/style/setStyles.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/cloneObject.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/processCssVariable.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/getAllowedValues.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/HtmlSanitizer.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/parseColor.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/setColor.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/applyFormat.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getPendableFormatState.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/isNodeEmpty.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/matchLink.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/queryElements.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/unwrap.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/normalizeRect.js","../node_modules/roosterjs-editor-dom/lib-mjs/metadata/definitionCreators.js","../node_modules/roosterjs-editor-dom/lib-mjs/metadata/validate.js","../node_modules/roosterjs-editor-dom/lib-mjs/metadata/metadata.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/tableCellInfo.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/applyTableFormat.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/tableFormatInfo.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/VTable.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/setBulletListMarkers.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/isWholeTableSelected.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/getListTypeFromNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/setListItemStyle.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/convertDecimalsToAlpha.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/convertDecimalsToRomans.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/setNumberingListMarkers.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/VListItem.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/VList.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/getRootListNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/region/getSelectionRangeInRegion.js","../node_modules/roosterjs-editor-dom/lib-mjs/region/getSelectedBlockElementsInRegion.js","../node_modules/roosterjs-editor-dom/lib-mjs/region/isNodeInRegion.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/createVListFromRegion.js","../node_modules/roosterjs-editor-dom/lib-mjs/jsUtils/arrayPush.js","../node_modules/roosterjs-editor-dom/lib-mjs/list/VListChain.js","../node_modules/roosterjs-editor-dom/lib-mjs/region/getRegionsFromRange.js","../node_modules/roosterjs-editor-dom/lib-mjs/region/collapseNodesInRegion.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/isPositionAtBeginningOf.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/getSelectionPath.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/getHtmlWithSelectionPath.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getInnerHTML.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/setHtmlWithSelectionPath.js","../node_modules/roosterjs-editor-dom/lib-mjs/selection/addRangeToSelection.js","../node_modules/roosterjs-editor-dom/lib-mjs/snapshots/canMoveCurrentSnapshot.js","../node_modules/roosterjs-editor-dom/lib-mjs/snapshots/clearProceedingSnapshots.js","../node_modules/roosterjs-editor-dom/lib-mjs/snapshots/addSnapshot.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/chainSanitizerCallback.js","../node_modules/roosterjs-editor-dom/lib-mjs/entity/commitEntity.js","../node_modules/roosterjs-editor-dom/lib-mjs/entity/getEntityFromElement.js","../node_modules/roosterjs-editor-dom/lib-mjs/entity/getEntitySelector.js","../node_modules/roosterjs-editor-dom/lib-mjs/entity/entityPlaceholderUtils.js","../node_modules/roosterjs-editor-dom/lib-mjs/event/cacheGetEventData.js","../node_modules/roosterjs-editor-dom/lib-mjs/event/isModifierKey.js","../node_modules/roosterjs-editor-dom/lib-mjs/event/isCharacterValue.js","../node_modules/roosterjs-editor-dom/lib-mjs/event/isCtrlOrMetaPressed.js","../node_modules/roosterjs-editor-dom/lib-mjs/style/removeImportantStyleRule.js","../node_modules/roosterjs-editor-dom/lib-mjs/style/setGlobalCssStyles.js","../node_modules/roosterjs-editor-dom/lib-mjs/style/removeGlobalCssStyle.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/cloneCellStyles.js","../node_modules/roosterjs-editor-dom/lib-mjs/edit/adjustInsertPosition.js","../node_modules/roosterjs-editor-dom/lib-mjs/table/pasteTable.js","../node_modules/roosterjs-editor-dom/lib-mjs/edit/deleteSelectedContent.js","../node_modules/roosterjs-editor-dom/lib-mjs/region/mergeBlocksInRegion.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/documentContainWacElements.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/constants.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/getPasteSource.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/isWordDesktopDocument.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/isExcelDesktopDocument.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/isExcelOnlineDocument.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/isPowerPointDesktopDocument.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/isGoogleSheetDocument.js","../node_modules/roosterjs-editor-dom/lib-mjs/pasteSourceValidations/shouldConvertToSingleImage.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/applyInlineStyle.js","../node_modules/roosterjs-editor-api/lib-mjs/format/changeFontSize.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/applyListItemWrap.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/commitListChains.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/blockFormat.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/execCommand.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setBackgroundColor.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setTextColor.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleBold.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleItalic.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleUnderline.js","../node_modules/roosterjs-editor-api/lib-mjs/format/clearFormat.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setFontName.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setFontSize.js","../node_modules/roosterjs-editor-api/lib-mjs/format/createLink.js","../node_modules/roosterjs-editor-api/lib-mjs/format/getFormatState.js","../node_modules/roosterjs-editor-api/lib-mjs/format/insertImage.js","../node_modules/roosterjs-editor-api/lib-mjs/table/editTable.js","../node_modules/roosterjs-editor-api/lib-mjs/format/removeLink.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/normalizeBlockquote.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setAlignment.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/collapseSelectedBlocks.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setDirection.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setIndentation.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/toggleListType.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleBullet.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleNumbering.js","../node_modules/roosterjs-editor-api/lib-mjs/utils/blockWrap.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleBlockQuote.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleCodeBlock.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/autoLinkFeatures.js","../node_modules/roosterjs-editor-api/lib-mjs/format/replaceWithNode.js","../node_modules/roosterjs-editor-dom/lib-mjs/event/clearEventDataCache.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/codeFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/cursorFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/entityFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/utils/getAutoBulletListStyle.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/utils/getAutoNumberingListStyle.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/utils/convertAlphaToDecimals.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/listFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/pluginUtils/announceData/getAnnounceDataForList.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/markdownFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/quoteFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/shortcutFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/structuredNodeFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/tableFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/features/textFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/getAllFeatures.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ContentEdit/ContentEdit.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/editInfoUtils/checkEditInfoState.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/HyperLink/HyperLink.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/editInfoUtils/getGeneratedImageSize.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/editInfoUtils/generateDataURL.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/editInfoUtils/editInfo.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/editInfoUtils/applyChange.js","../node_modules/roosterjs-editor-plugins/lib-mjs/pluginUtils/DragAndDropHelper.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/imageEditors/Resizer.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/constants/constants.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/imageEditors/Cropper.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/imageEditors/Rotator.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/ImageEdit.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/editInfoUtils/tryToConvertGifToPng.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageEdit/api/canRegenerateImage.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/commonConverter/convertPastedContentForLI.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/ImageResize/ImageResize.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/excelConverter/convertPastedContentFromExcel.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/officeOnlineConverter/ListItemBlock.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/officeOnlineConverter/convertPastedContentFromWordOnline.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/officeOnlineConverter/convertPastedContentFromOfficeOnline.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/commentsRemoval.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/WordCustomData.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/converterUtils.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/convertPastedContentFromWord.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/wordConverter.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/WordConverterArguments.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/wordConverter/LevelLists.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/lineMerge/handleLineMerge.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/sanitizeHtmlColorsFromPastedContent/deprecatedColorList.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/sanitizeLinks/sanitizeLinks.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/Paste.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/TableResize/editors/TableEditor.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/pptConverter/convertPastedContentFromPowerPoint.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/imageConverter/convertPasteContentForSingleImage.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/Paste/sanitizeHtmlColorsFromPastedContent/sanitizeHtmlColorsFromPastedContent.js","../node_modules/roosterjs-editor-plugins/lib-mjs/plugins/TableResize/editors/TableSelector.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/utils/forEachSelectedCell.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/CopyPastePlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/utils/removeCellsOutsideSelection.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/DOMEventPlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/EditPlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/utils/inlineEntityOnPluginEvent.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/EntityPlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/ImageSelection.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/LifecyclePlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/MouseUpPlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/NormalizeTablePlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/PendingFormatStatePlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/editor/DarkColorHandlerImpl.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/TypeInContainerPlugin.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/UndoPlugin.js","../node_modules/roosterjs-editor-dom/lib-mjs/snapshots/createSnapshots.js","../node_modules/roosterjs-editor-dom/lib-mjs/snapshots/moveCurrentSnapshot.js","../node_modules/roosterjs-editor-dom/lib-mjs/snapshots/canUndoAutoComplete.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/addUndoSnapshot.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/getPendableFormatState.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/getSelectionRangeEx.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/getStyleBasedFormatState.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/hasFocus.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/utils/addUniqueId.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/selectImage.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/selectTable.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/transformColor.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/triggerEvent.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/coreApiMap.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/attachDomEvent.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/createPasteFragment.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/getPasteType.js","../node_modules/roosterjs-editor-dom/lib-mjs/htmlSanitizer/createDefaultHtmlSanitizerOptions.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/handleImagePaste.js","../node_modules/roosterjs-editor-dom/lib-mjs/clipboard/sanitizePasteContent.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/ensureTypeInContainer.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/focus.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/getContent.js","../node_modules/roosterjs-editor-dom/lib-mjs/edit/getTextContent.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/getSelectionRange.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/insertNode.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/restoreUndoSnapshot.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/select.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/selectRange.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/setContent.js","../node_modules/roosterjs-editor-core/lib-mjs/coreApi/switchShadowEdit.js","../node_modules/roosterjs-editor-core/lib-mjs/editor/createEditorCore.js","../node_modules/roosterjs-editor-core/lib-mjs/corePlugins/createCorePlugins.js","../node_modules/roosterjs-editor-dom/lib-mjs/utils/getIntersectedRect.js","../node_modules/roosterjs-editor-core/lib-mjs/editor/EditorBase.js","../node_modules/roosterjs-editor-core/lib-mjs/editor/isFeatureEnabled.js","../node_modules/roosterjs-editor-core/lib-mjs/editor/Editor.js","../node_modules/color-name/index.js","../node_modules/simple-swizzle/index.js","../node_modules/is-arrayish/index.js","../node_modules/color-string/index.js","../node_modules/color-convert/conversions.js","../node_modules/color-convert/route.js","../node_modules/color-convert/index.js","../node_modules/color/index.js","../node_modules/roosterjs-color-utils/lib/utils/getDarkColor.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/KnownAnnounceStrings.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/DocumentCommand.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/DocumentPosition.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/Keys.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/NodeType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ContentType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/Alignment.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ChangeSource.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ColorTransformDirection.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ContentPosition.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/DarkModeDatasetNames.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/DelimiterClasses.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/Direction.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/EntityClasses.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/EntityOperation.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ExperimentalFeatures.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/FontSizeChange.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/GetContentMode.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/Indentation.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/Capitalization.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ListType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/PositionType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/QueryScope.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/RegionType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/TableOperation.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ImageEditOperation.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/ClearFormatMode.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/KnownCreateElementDataIndex.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/KnownPasteSourceType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/TableBorderFormat.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/PluginEventType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/SelectionRangeTypes.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/NumberingListType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/BulletListType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/DefinitionType.js","../node_modules/roosterjs-editor-types/lib-mjs/enum/PasteType.js","../node_modules/roosterjs-color-utils/lib/index.js","../node_modules/roosterjs-editor-types/lib/browser/index.js","../node_modules/roosterjs-editor-types/lib/corePluginState/index.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/Alignment.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/BulletListType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/Capitalization.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ChangeSource.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ClearFormatMode.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ColorTransformDirection.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ContentPosition.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ContentType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/DarkModeDatasetNames.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/DefinitionType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/DelimiterClasses.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/Direction.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/DocumentCommand.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/DocumentPosition.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/EntityClasses.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/EntityOperation.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ExperimentalFeatures.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/FontSizeChange.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/GetContentMode.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ImageEditOperation.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/Indentation.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/Keys.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/KnownAnnounceStrings.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/KnownCreateElementDataIndex.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/KnownPasteSourceType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/ListType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/NodeType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/NumberingListType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/PasteType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/PluginEventType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/PositionType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/QueryScope.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/RegionType.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/SelectionRangeTypes.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/TableBorderFormat.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/TableOperation.js","../node_modules/roosterjs-editor-types/lib/compatibleEnum/index.js","../node_modules/roosterjs-editor-types/lib/event/index.js","../node_modules/roosterjs-editor-types/lib/interface/index.js","../node_modules/style-inject/dist/style-inject.es.js","../node_modules/roosterjs-editor-types/lib/type/index.js","../node_modules/roosterjs-editor-types/lib/compatibleTypes.js","../src/index.js","../node_modules/roosterjs-editor-api/lib-mjs/format/setHeadingLevel.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleStrikethrough.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleSuperscript.js","../node_modules/roosterjs-editor-api/lib-mjs/format/toggleSubscript.js"],"sourcesContent":["/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n        if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n        dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n        if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n        dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","/**\n * @internal\n * Execute add undo snapshot for the Format APIs\n * @param editor The editor instance\n * @param command Optional, The callback function to perform formatting, returns a data object which will be used as the data field in ContentChangedEvent if changeSource is not null.\n * @param apiName Optional, name of the API that was is going to be executed.\n * Default value is false.\n */\nexport default function formatUndoSnapshot(editor, callback, apiName) {\n    editor.addUndoSnapshot(callback, \"Format\" /* Format */, undefined /* canUndoByBackspace */, apiName && apiName != ''\n        ? {\n            formatApiName: apiName,\n        }\n        : undefined);\n}\n//# sourceMappingURL=formatUndoSnapshot.js.map","// NOTE: Type TargetWindow is an auto-generated type.\n// Run node ./tools/generateTargetWindow.js to generate it.\n/**\n * @internal Export for test only\n * Try get window from the given node or range\n * @param node Source node to get window from\n */\nexport function getTargetWindow(node) {\n    var document = node &&\n        (node.ownerDocument ||\n            (Object.prototype.toString.apply(node) == '[object HTMLDocument]'\n                ? node\n                : null));\n    // If document exists but document.defaultView doesn't exist, it is a detached object, just use current window instead\n    var targetWindow = document && (document.defaultView || window);\n    return targetWindow;\n}\n/**\n * Check if the given object is instance of the target type\n * @param obj Object to check\n * @param typeName Target type name\n */\nexport default function safeInstanceOf(obj, typeName) {\n    var _a;\n    if (typeName == 'Range') {\n        return (Object.prototype.toString.apply(obj) == '[object Range]' &&\n            !!((_a = obj) === null || _a === void 0 ? void 0 : _a.commonAncestorContainer));\n    }\n    var targetWindow = getTargetWindow(obj);\n    var targetType = targetWindow && targetWindow[typeName];\n    var mainWindow = window;\n    var mainWindowType = mainWindow && mainWindow[typeName];\n    return ((mainWindowType && obj instanceof mainWindowType) ||\n        (targetType && obj instanceof targetType));\n}\n//# sourceMappingURL=safeInstanceOf.js.map","import safeInstanceOf from './safeInstanceOf';\nexport default function contains(container, contained, treatSameNodeAsContain) {\n    if (!container || !contained) {\n        return false;\n    }\n    if (treatSameNodeAsContain && container == contained) {\n        return true;\n    }\n    if (safeInstanceOf(contained, 'Range')) {\n        contained = contained && contained.commonAncestorContainer;\n        treatSameNodeAsContain = true;\n    }\n    if (contained && contained.nodeType == 3 /* Text */) {\n        contained = contained.parentNode;\n        treatSameNodeAsContain = true;\n    }\n    if (container.nodeType != 1 /* Element */ && container.nodeType != 11 /* DocumentFragment */) {\n        return !!treatSameNodeAsContain && container == contained;\n    }\n    return (!!(treatSameNodeAsContain || container != contained) &&\n        internalContains(container, contained));\n}\nfunction internalContains(container, contained) {\n    if (container.contains) {\n        return container.contains(contained);\n    }\n    else {\n        while (contained) {\n            if (contained == container) {\n                return true;\n            }\n            contained = contained.parentNode;\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=contains.js.map","/**\n * Checks if node1 is after node2\n * @param node1 The node to check if it is after another node\n * @param node2 The node to check if another node is after this one\n * @returns True if node1 is after node2, otherwise false\n */\nexport default function isNodeAfter(node1, node2) {\n    return !!(node1 &&\n        node2 &&\n        (node2.compareDocumentPosition(node1) & 4 /* Following */) ==\n            4 /* Following */);\n}\n//# sourceMappingURL=isNodeAfter.js.map","import isNodeAfter from './isNodeAfter';\n/**\n * Split parent node of the given node before/after the given node.\n * When a parent node contains [A,B,C] and pass B as the given node,\n * If split before, the new nodes will be [A][B,C] and returns [A];\n * otherwise, it will be [A,B][C] and returns [C].\n * @param node The node to split before/after\n * @param splitBefore Whether split before or after\n * @param removeEmptyNewNode If the new node is empty (even then only child is space or ZER_WIDTH_SPACE),\n * we remove it. @default false\n * @returns The new parent node\n */\nexport default function splitParentNode(node, splitBefore) {\n    var _a;\n    if (!node || !node.parentNode) {\n        return null;\n    }\n    var parentNode = node.parentNode;\n    var newParent = parentNode.cloneNode(false /*deep*/);\n    newParent.removeAttribute('id');\n    if (splitBefore) {\n        while (parentNode.firstChild && parentNode.firstChild != node) {\n            newParent.appendChild(parentNode.firstChild);\n        }\n    }\n    else {\n        while (node.nextSibling) {\n            newParent.appendChild(node.nextSibling);\n        }\n    }\n    // When the only child of new parent is ZERO_WIDTH_SPACE, we can still prevent keeping it by set removeEmptyNewNode to true\n    if (newParent.firstChild && newParent.innerHTML != '') {\n        (_a = parentNode.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(newParent, splitBefore ? parentNode : parentNode.nextSibling);\n    }\n    else {\n        newParent = null;\n    }\n    return newParent;\n}\n/**\n * Split parent node by a balanced node range\n * @param nodes The nodes to split from. If only one node is passed, split it from all its siblings.\n * If two or nodes are passed, will split before the first one and after the last one, all other nodes will be ignored\n * @returns The parent node of the given node range if the given nodes are balanced, otherwise null\n */\nexport function splitBalancedNodeRange(nodes) {\n    var start = Array.isArray(nodes) ? nodes[0] : nodes;\n    var end = Array.isArray(nodes) ? nodes[nodes.length - 1] : nodes;\n    var parentNode = start && end && start.parentNode == end.parentNode ? start.parentNode : null;\n    if (parentNode) {\n        if (isNodeAfter(start, end)) {\n            var temp = end;\n            end = start;\n            start = temp;\n        }\n        splitParentNode(start, true /*splitBefore*/);\n        splitParentNode(end, false /*splitBefore*/);\n    }\n    return parentNode;\n}\n//# sourceMappingURL=splitParentNode.js.map","export default function toArray(collection) {\n    return [].slice.call(collection);\n}\n//# sourceMappingURL=toArray.js.map","import contains from './contains';\nimport splitParentNode from './splitParentNode';\nimport toArray from '../jsUtils/toArray';\n/**\n * Collapse nodes within the given start and end nodes to their common ancestor node,\n * split parent nodes if necessary\n * @param root The root node of the scope\n * @param start The start node\n * @param end The end node\n * @param canSplitParent True to allow split parent node there are nodes before start or after end under the same parent\n * and the returned nodes will be all nodes from start through end after splitting\n * False to disallow split parent\n * @returns When canSplitParent is true, returns all node from start through end after splitting,\n * otherwise just return start and end\n */\nexport default function collapseNodes(root, start, end, canSplitParent) {\n    var _a;\n    if (!contains(root, start) || !contains(root, end)) {\n        return [];\n    }\n    start = collapse(root, start, end, true /*isStart*/, canSplitParent);\n    end = collapse(root, end, start, false /*isStart*/, canSplitParent);\n    if (contains(start, end, true /*treatSameNodeAsContain*/)) {\n        return [start];\n    }\n    else if (contains(end, start)) {\n        return [end];\n    }\n    else if (start.parentNode == end.parentNode) {\n        var nodes = start.parentNode ? toArray((_a = start.parentNode) === null || _a === void 0 ? void 0 : _a.childNodes) : [];\n        var startIndex = nodes.indexOf(start);\n        var endIndex = nodes.indexOf(end);\n        return nodes.slice(startIndex, endIndex + 1);\n    }\n    else {\n        return [start, end];\n    }\n}\n/**\n * @internal\n * Collapse a node by traversing its parent nodes until we get the common ancestor node of node and ref node\n * @param root Root node, traversing will be limited under this scope\n * @param node The node to collapse\n * @param ref Ref node. The result will be the nearest common ancestor node of the given node and this ref node\n * @param isStart Whether the given node is start of the sequence of nodes to collapse\n * @param canSplitParent Whether splitting parent node is allowed\n * @returns The common ancestor node of the given node ref node\n */\nexport function collapse(root, node, ref, isStart, canSplitParent) {\n    while (node.parentNode != root && !contains(node.parentNode, ref)) {\n        if ((isStart && node.previousSibling) || (!isStart && node.nextSibling)) {\n            if (!canSplitParent) {\n                break;\n            }\n            splitParentNode(node, isStart);\n        }\n        if (!node.parentNode) {\n            break;\n        }\n        node = node.parentNode;\n    }\n    return node;\n}\n//# sourceMappingURL=collapseNodes.js.map","/**\n * Get the html tag of a node, or empty if it is not an element\n * @param node The node to get tag of\n * @returns Tag name in upper case if the given node is an Element, or empty string otherwise\n */\nexport default function getTagOfNode(node) {\n    return node && node.nodeType == 1 /* Element */ ? node.tagName.toUpperCase() : '';\n}\n//# sourceMappingURL=getTagOfNode.js.map","import getTagOfNode from './getTagOfNode';\nvar BLOCK_ELEMENT_TAGS = 'ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO'.split(',');\nvar BLOCK_DISPLAY_STYLES = ['block', 'list-item', 'table-cell'];\n/**\n * Checks if the node is a block like element. Block like element are usually those P, DIV, LI, TD etc.\n * @param node The node to check\n * @returns True if the node is a block element, otherwise false\n */\nexport default function isBlockElement(node) {\n    var tag = getTagOfNode(node);\n    return !!(tag &&\n        (BLOCK_DISPLAY_STYLES.indexOf(node.style.display) >= 0 ||\n            BLOCK_ELEMENT_TAGS.indexOf(tag) >= 0));\n}\n//# sourceMappingURL=isBlockElement.js.map","import contains from '../utils/contains';\nimport isNodeAfter from '../utils/isNodeAfter';\n/**\n * @internal\n * This presents a content block that can be represented by a single html block type element.\n * In most cases, it corresponds to an HTML block level element, i.e. P, DIV, LI, TD etc.\n */\nvar NodeBlockElement = /** @class */ (function () {\n    function NodeBlockElement(element) {\n        this.element = element;\n    }\n    /**\n     * Collapse this element to a single DOM element.\n     * If the content nodes are separated in different root nodes, wrap them to a single node\n     * If the content nodes are included in root node with other nodes, split root node\n     */\n    NodeBlockElement.prototype.collapseToSingleElement = function () {\n        return this.element;\n    };\n    /**\n     * Get the start node of the block\n     * For NodeBlockElement, start and end essentially refers to same node\n     */\n    NodeBlockElement.prototype.getStartNode = function () {\n        return this.element;\n    };\n    /**\n     * Get the end node of the block\n     * For NodeBlockElement, start and end essentially refers to same node\n     */\n    NodeBlockElement.prototype.getEndNode = function () {\n        return this.element;\n    };\n    /**\n     * Checks if it refers to same block\n     */\n    NodeBlockElement.prototype.equals = function (blockElement) {\n        // Ideally there is only one unique way to generate a block so we only need to compare the startNode\n        return this.element == blockElement.getStartNode();\n    };\n    /**\n     * Checks if a block is after the current block\n     */\n    NodeBlockElement.prototype.isAfter = function (blockElement) {\n        // if the block's startNode is after current node endEnd, we say it is after\n        return isNodeAfter(this.element, blockElement.getEndNode());\n    };\n    /**\n     * Checks if a certain html node is within the block\n     */\n    NodeBlockElement.prototype.contains = function (node) {\n        return contains(this.element, node, true /*treatSameNodeAsContain*/);\n    };\n    /**\n     * Get the text content of this block element\n     */\n    NodeBlockElement.prototype.getTextContent = function () {\n        var _a;\n        return ((_a = this.element) === null || _a === void 0 ? void 0 : _a.textContent) || '';\n    };\n    return NodeBlockElement;\n}());\nexport default NodeBlockElement;\n//# sourceMappingURL=NodeBlockElement.js.map","import getTagOfNode from './getTagOfNode';\n/**\n * HTML void elements\n * Per https://www.w3.org/TR/html/syntax.html#syntax-elements, cannot have child nodes\n * This regex is used when we move focus to very begin of editor. We should avoid putting focus inside\n * void elements so users don't accidentally create child nodes in them\n */\nvar HTML_VOID_ELEMENTS = 'AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR'.split(',');\n/**\n * Check if the given node is html void element. Void element cannot have children\n * @param node The node to check\n */\nexport default function isVoidHtmlElement(node) {\n    return !!node && HTML_VOID_ELEMENTS.indexOf(getTagOfNode(node)) >= 0;\n}\n//# sourceMappingURL=isVoidHtmlElement.js.map","import safeInstanceOf from './safeInstanceOf';\n/**\n * A wrapper function of Element.matches\n * @param element The element to match\n * @param selector The selector to match\n */\nexport default function matchesSelector(element, selector) {\n    return (safeInstanceOf(element, 'HTMLElement') &&\n        (element.matches || element.msMatchesSelector).call(element, selector));\n}\n//# sourceMappingURL=matchesSelector.js.map","import contains from './contains';\nimport matchesSelector from './matchesSelector';\n/**\n * Find closest element ancestor start from the given node which matches the given selector\n * @param node Find ancestor start from this node\n * @param root Root node where the search should stop at. The return value can never be this node\n * @param selector The expected selector. If null, return the first HTML Element found from start node\n * @returns An HTML element which matches the given selector. If the given start node matches the selector,\n * returns the given node\n */\nexport default function findClosestElementAncestor(node, root, selector) {\n    node = !node ? null : node.nodeType == 1 /* Element */ ? node : node.parentNode;\n    var element = node && node.nodeType == 1 /* Element */ ? node : null;\n    if (element && selector) {\n        if (element.closest) {\n            element = element.closest(selector);\n        }\n        else {\n            while (element && element != root && !matchesSelector(element, selector)) {\n                element = element.parentElement;\n            }\n        }\n    }\n    return !root || contains(root, element) ? element : null;\n}\n//# sourceMappingURL=findClosestElementAncestor.js.map","import findClosestElementAncestor from '../utils/findClosestElementAncestor';\nimport isNodeAfter from '../utils/isNodeAfter';\n/**\n * Represent a position in DOM tree by the node and its offset index\n */\nvar Position = /** @class */ (function () {\n    function Position(nodeOrPosition, offsetOrPosType, isFromEndOfRange) {\n        if (offsetOrPosType === void 0) { offsetOrPosType = 0; }\n        this.isFromEndOfRange = isFromEndOfRange;\n        if (nodeOrPosition.node) {\n            this.node = nodeOrPosition.node;\n            offsetOrPosType = nodeOrPosition.offset;\n        }\n        else {\n            this.node = nodeOrPosition;\n        }\n        switch (offsetOrPosType) {\n            case -2 /* Before */:\n                this.offset = getIndexOfNode(this.node);\n                this.node = this.node.parentNode; // TODO: how to handle parentNode is null?\n                this.isAtEnd = false;\n                break;\n            case -3 /* After */:\n                this.offset = getIndexOfNode(this.node) + 1;\n                this.isAtEnd = !this.node.nextSibling;\n                this.node = this.node.parentNode; // TODO: how to handle parentNode is null?\n                break;\n            case -1 /* End */:\n                this.offset = getEndOffset(this.node);\n                this.isAtEnd = true;\n                break;\n            default:\n                var endOffset = getEndOffset(this.node);\n                this.offset = Math.max(0, Math.min(offsetOrPosType, endOffset));\n                this.isAtEnd = offsetOrPosType > 0 && offsetOrPosType >= endOffset;\n                break;\n        }\n        this.element = findClosestElementAncestor(this.node); // TODO: how to handle parent element is null?\n    }\n    /**\n     * Normalize this position to the leaf node, return the normalize result.\n     * If current position is already using leaf node, return this position object itself\n     */\n    Position.prototype.normalize = function () {\n        if (this.node.nodeType == 3 /* Text */ || !this.node.firstChild) {\n            return this;\n        }\n        var node = this.node;\n        var newOffset = this.isAtEnd\n            ? -1 /* End */\n            : this.offset;\n        while (node.nodeType == 1 /* Element */ || node.nodeType == 11 /* DocumentFragment */) {\n            var nextNode = this.isFromEndOfRange\n                ? newOffset == -1 /* End */\n                    ? node.lastChild\n                    : node.childNodes[newOffset - 1]\n                : newOffset == 0 /* Begin */\n                    ? node.firstChild\n                    : newOffset == -1 /* End */\n                        ? node.lastChild\n                        : node.childNodes[newOffset];\n            if (nextNode) {\n                node = nextNode;\n                newOffset =\n                    this.isAtEnd || this.isFromEndOfRange ? -1 /* End */ : 0 /* Begin */;\n            }\n            else {\n                break;\n            }\n        }\n        return new Position(node, newOffset, this.isFromEndOfRange);\n    };\n    /**\n     * Check if this position is equal to the given position\n     * @param position The position to check\n     */\n    Position.prototype.equalTo = function (position) {\n        return (position &&\n            (this == position ||\n                (this.node == position.node &&\n                    this.offset == position.offset &&\n                    this.isAtEnd == position.isAtEnd)));\n    };\n    /**\n     * Checks if this position is after the given position\n     */\n    Position.prototype.isAfter = function (position) {\n        return this.node == position.node\n            ? (this.isAtEnd && !position.isAtEnd) || this.offset > position.offset\n            : isNodeAfter(this.node, position.node);\n    };\n    /**\n     * Move this position with offset, returns a new position with a valid offset in the same node\n     * @param offset Offset to move with\n     */\n    Position.prototype.move = function (offset) {\n        return new Position(this.node, Math.max(this.offset + offset, 0));\n    };\n    /**\n     * Get start position of the given Range\n     * @param range The range to get position from\n     */\n    Position.getStart = function (range) {\n        return new Position(range.startContainer, range.startOffset);\n    };\n    /**\n     * Get end position of the given Range\n     * @param range The range to get position from\n     */\n    Position.getEnd = function (range) {\n        // For collapsed range, always return the same value of start container to make sure\n        // end position is not before start position\n        return range.collapsed\n            ? Position.getStart(range)\n            : new Position(range.endContainer, range.endOffset, true /*isFromEndOfRange*/);\n    };\n    return Position;\n}());\nexport default Position;\nfunction getIndexOfNode(node) {\n    var i = 0;\n    while ((node = (node === null || node === void 0 ? void 0 : node.previousSibling) || null)) {\n        i++;\n    }\n    return i;\n}\nfunction getEndOffset(node) {\n    var _a;\n    if (node.nodeType == 3 /* Text */) {\n        return ((_a = node.nodeValue) === null || _a === void 0 ? void 0 : _a.length) || 0;\n    }\n    else if (node.nodeType == 1 /* Element */ || node.nodeType == 11 /* DocumentFragment */) {\n        return node.childNodes.length;\n    }\n    else {\n        return 1;\n    }\n}\n//# sourceMappingURL=Position.js.map","import isVoidHtmlElement from '../utils/isVoidHtmlElement';\nimport Position from './Position';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nexport default function createRange(arg1, arg2, arg3, arg4) {\n    var _a;\n    var start = null;\n    var end = null;\n    if (isNodePosition(arg1)) {\n        // function createRange(startPosition: NodePosition, endPosition?: NodePosition): Range;\n        start = arg1;\n        end = isNodePosition(arg2) ? arg2 : null;\n    }\n    else if (safeInstanceOf(arg1, 'Node')) {\n        if (Array.isArray(arg2)) {\n            // function createRange(rootNode: Node, startPath: number[], endPath?: number[]): Range;\n            start = getPositionFromPath(arg1, arg2);\n            end = Array.isArray(arg3) ? getPositionFromPath(arg1, arg3) : null;\n        }\n        else if (typeof arg2 == 'number') {\n            // function createRange(node: Node, offset: number | PositionType): Range;\n            // function createRange(startNode: Node, startOffset: number | PositionType, endNode: Node, endOffset: number | PositionType): Range;\n            start = new Position(arg1, arg2);\n            end = safeInstanceOf(arg3, 'Node') ? new Position(arg3, arg4) : null;\n        }\n        else if (safeInstanceOf(arg2, 'Node') || !arg2) {\n            // function createRange(startNode: Node, endNode?: Node): Range;\n            start = new Position(arg1, -2 /* Before */);\n            end = new Position(arg2 || arg1, -3 /* After */);\n        }\n    }\n    if ((_a = start === null || start === void 0 ? void 0 : start.node) === null || _a === void 0 ? void 0 : _a.ownerDocument) {\n        var range = start.node.ownerDocument.createRange();\n        start = getFocusablePosition(start);\n        end = getFocusablePosition(end || start);\n        range.setStart(start.node, start.offset);\n        range.setEnd(end.node, end.offset);\n        return range;\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Convert to focusable position\n * If current node is a void element, we need to move up one level to put cursor outside void element\n */\nfunction getFocusablePosition(position) {\n    return position.node.nodeType == 1 /* Element */ && isVoidHtmlElement(position.node)\n        ? new Position(position.node, position.isAtEnd ? -3 /* After */ : -2 /* Before */)\n        : position;\n}\nfunction isNodePosition(arg) {\n    return arg && arg.node;\n}\nfunction getPositionFromPath(node, path) {\n    if (!node || !path) {\n        return null;\n    }\n    // Iterate with a for loop to avoid mutating the passed in element path stack\n    // or needing to copy it.\n    var offset = 0;\n    for (var i = 0; i < path.length; i++) {\n        offset = path[i];\n        if (i < path.length - 1 &&\n            node &&\n            node.nodeType == 1 /* Element */ &&\n            node.childNodes.length > offset) {\n            node = node.childNodes[offset];\n        }\n        else {\n            break;\n        }\n    }\n    return new Position(node, offset);\n}\n//# sourceMappingURL=createRange.js.map","/**\n * Provide a strong-typed version of Object.keys()\n * @param obj The source object\n * @returns Array of keys\n */\nexport default function getObjectKeys(obj) {\n    return Object.keys(obj);\n}\n//# sourceMappingURL=getObjectKeys.js.map","var isAndroidRegex = /android/i;\n/**\n * Get current browser information from user agent string\n * @param userAgent The userAgent string of a browser\n * @param appVersion The appVersion string of a browser\n * @param vendor The vendor string of a browser\n * @returns The BrowserInfo object calculated from the given userAgent and appVersion\n */\nexport function getBrowserInfo(userAgent, appVersion, vendor) {\n    // checks whether the browser is running in IE\n    // IE11 will use rv in UA instead of MSIE. Unfortunately Firefox also uses this. We should also look for \"Trident\" to confirm this.\n    // There have been cases where companies using older version of IE and custom UserAgents have broken this logic (e.g. IE 10 and KellyServices)\n    // therefore we should check that the Trident/rv combo is not just from an older IE browser\n    var isIE11OrGreater = userAgent.indexOf('rv:') != -1 && userAgent.indexOf('Trident') != -1;\n    var isIE = userAgent.indexOf('MSIE') != -1 || isIE11OrGreater;\n    // IE11+ may also have 'Chrome', 'Firefox' and 'Safari' in user agent. But it will have 'trident' as well\n    var isChrome = false;\n    var isFirefox = false;\n    var isSafari = false;\n    var isEdge = false;\n    var isWebKit = userAgent.indexOf('WebKit') != -1;\n    var isMobileOrTablet = false;\n    // Reference: http://detectmobilebrowsers.com/\n    // The default regex on the website doesn't consider tablet.\n    // To support tablet, add |android|ipad|playbook|silk to the first regex according to the info in /about page\n    (function (userAgentOrVendor) {\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(userAgentOrVendor) ||\n            /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(userAgentOrVendor.substr(0, 4))) {\n            isMobileOrTablet = true;\n        }\n    })(userAgent || vendor || '');\n    if (!isIE) {\n        isChrome = userAgent.indexOf('Chrome') != -1;\n        isFirefox = userAgent.indexOf('Firefox') != -1;\n        if (userAgent.indexOf('Safari') != -1) {\n            // Android and Chrome have Safari in the user string\n            isSafari = userAgent.indexOf('Chrome') == -1 && userAgent.indexOf('Android') == -1;\n        }\n        // Sample Edge UA: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10121\n        isEdge = userAgent.indexOf('Edge') != -1;\n        // When it is edge, it should not be chrome or firefox. and it is also not webkit\n        if (isEdge) {\n            isWebKit = isChrome = isFirefox = false;\n        }\n    }\n    var isMac = appVersion.indexOf('Mac') != -1;\n    var isWin = appVersion.indexOf('Win') != -1 || appVersion.indexOf('NT') != -1;\n    var isAndroid = isAndroidRegex.test(userAgent);\n    return {\n        isMac: isMac,\n        isWin: isWin,\n        isWebKit: isWebKit,\n        isIE: isIE,\n        isIE11OrGreater: isIE11OrGreater,\n        isSafari: isSafari,\n        isChrome: isChrome,\n        isFirefox: isFirefox,\n        isEdge: isEdge,\n        isIEOrEdge: isIE || isEdge,\n        isAndroid: isAndroid,\n        isMobileOrTablet: isMobileOrTablet,\n    };\n}\n/**\n * Browser object contains browser and operating system information of current environment\n */\nexport var Browser = typeof window !== 'undefined' && window\n    ? getBrowserInfo(window.navigator.userAgent, window.navigator.appVersion, window.navigator.vendor)\n    : {};\n//# sourceMappingURL=Browser.js.map","var _a;\nimport getObjectKeys from '../jsUtils/getObjectKeys';\nimport safeInstanceOf from './safeInstanceOf';\nimport { Browser } from './Browser';\n/**\n * All known CreateElementData used by roosterjs to create elements\n */\nexport var KnownCreateElementData = (_a = {},\n    _a[0 /* None */] = { tag: '' },\n    // Edge can sometimes lose current format when Enter to new line.\n    // So here we add an extra SPAN for Edge to workaround this bug\n    _a[1 /* EmptyLine */] = Browser.isEdge\n        ? { tag: 'div', children: [{ tag: 'span', children: [{ tag: 'br' }] }] }\n        : { tag: 'div', children: [{ tag: 'br' }] },\n    _a[2 /* BlockquoteWrapper */] = {\n        tag: 'blockquote',\n        style: 'margin-top:0;margin-bottom:0',\n    },\n    _a[3 /* CopyPasteTempDiv */] = {\n        tag: 'div',\n        style: 'width: 600px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text',\n        attributes: {\n            contenteditable: 'true',\n        },\n    },\n    _a[4 /* BlockListItem */] = { tag: 'li', style: 'display:block' },\n    _a[5 /* ContextMenuWrapper */] = {\n        tag: 'div',\n        style: 'position: fixed; width: 0; height: 0',\n    },\n    _a[6 /* ImageEditWrapper */] = {\n        tag: 'span',\n        style: 'max-width:100%;position:relative',\n        children: [\n            {\n                tag: 'div',\n                style: 'width:100%;height:100%;position:relative;overflow:hidden',\n            },\n        ],\n    },\n    _a[7 /* TableHorizontalResizer */] = {\n        tag: 'div',\n        style: 'position: fixed; cursor: row-resize; user-select: none',\n    },\n    _a[8 /* TableVerticalResizer */] = {\n        tag: 'div',\n        style: 'position: fixed; cursor: col-resize; user-select: none',\n    },\n    _a[9 /* TableResizerLTR */] = {\n        tag: 'div',\n        style: 'position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080',\n    },\n    _a[10 /* TableResizerRTL */] = {\n        tag: 'div',\n        style: 'position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080',\n    },\n    _a[11 /* TableSelector */] = {\n        tag: 'div',\n        style: 'position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080',\n    },\n    _a[12 /* EmptyLineFormatInSpan */] = {\n        tag: 'div',\n        children: [{ tag: 'span', children: [{ tag: 'br' }] }],\n    },\n    _a);\n/**\n * Create DOM element from the given CreateElementData\n * @param elementData The CreateElementData or an index of a known CreateElementData used for creating this element\n * @param document The document to create the element from\n * @returns The root DOM element just created\n */\nexport default function createElement(elementData, document) {\n    if (typeof elementData == 'number') {\n        elementData = KnownCreateElementData[elementData];\n    }\n    if (!elementData || !elementData.tag) {\n        return null;\n    }\n    var tag = elementData.tag, namespace = elementData.namespace, className = elementData.className, style = elementData.style, dataset = elementData.dataset, attributes = elementData.attributes, children = elementData.children;\n    var result = namespace\n        ? document.createElementNS(namespace, tag)\n        : document.createElement(tag);\n    if (style) {\n        result.setAttribute('style', style);\n    }\n    if (className) {\n        result.className = className;\n    }\n    if (dataset && safeInstanceOf(result, 'HTMLElement')) {\n        getObjectKeys(dataset).forEach(function (datasetName) {\n            result.dataset[datasetName] = dataset[datasetName];\n        });\n    }\n    if (attributes) {\n        getObjectKeys(attributes).forEach(function (attrName) {\n            result.setAttribute(attrName, attributes[attrName]);\n        });\n    }\n    if (children) {\n        children.forEach(function (child) {\n            if (typeof child === 'string') {\n                result.appendChild(document.createTextNode(child));\n            }\n            else if (child) {\n                var childElement = createElement(child, document);\n                if (childElement) {\n                    result.appendChild(childElement);\n                }\n            }\n        });\n    }\n    return result;\n}\n//# sourceMappingURL=createElement.js.map","import { __values } from \"tslib\";\nimport createElement from './createElement';\nimport fromHtml from './fromHtml';\nimport safeInstanceOf from './safeInstanceOf';\nexport default function wrap(nodes, wrapper) {\n    var e_1, _a;\n    nodes = !nodes ? [] : safeInstanceOf(nodes, 'Node') ? [nodes] : nodes;\n    if (nodes.length == 0 || !nodes[0] || !nodes[0].ownerDocument) {\n        return null;\n    }\n    if (!wrapper) {\n        wrapper = 'div';\n    }\n    if (!safeInstanceOf(wrapper, 'HTMLElement')) {\n        var document_1 = nodes[0].ownerDocument;\n        if (typeof wrapper === 'string') {\n            wrapper = /^\\w+$/.test(wrapper)\n                ? document_1.createElement(wrapper)\n                : fromHtml(wrapper, document_1)[0]; // This will be removed in next major release\n        }\n        else {\n            wrapper = createElement(wrapper, document_1);\n        }\n    }\n    var parentNode = nodes[0].parentNode;\n    if (parentNode) {\n        parentNode.insertBefore(wrapper, nodes[0]);\n    }\n    try {\n        for (var nodes_1 = __values(nodes), nodes_1_1 = nodes_1.next(); !nodes_1_1.done; nodes_1_1 = nodes_1.next()) {\n            var node = nodes_1_1.value;\n            wrapper.appendChild(node);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (nodes_1_1 && !nodes_1_1.done && (_a = nodes_1.return)) _a.call(nodes_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return wrapper;\n}\n//# sourceMappingURL=wrap.js.map","import toArray from '../jsUtils/toArray';\n/**\n * @deprecated\n * Creates an HTML node array from html\n * @param html the html string to create HTML elements from\n * @param ownerDocument Owner document of the result HTML elements\n * @returns An HTML node array to represent the given html string\n */\nexport default function fromHtml(html, ownerDocument) {\n    var element = ownerDocument.createElement('DIV');\n    element.innerHTML = html;\n    return toArray(element.childNodes);\n}\n//# sourceMappingURL=fromHtml.js.map","import collapseNodes from '../utils/collapseNodes';\nimport contains from '../utils/contains';\nimport createRange from '../selection/createRange';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport isBlockElement from '../utils/isBlockElement';\nimport isNodeAfter from '../utils/isNodeAfter';\nimport wrap from '../utils/wrap';\nimport { splitBalancedNodeRange } from '../utils/splitParentNode';\nvar STRUCTURE_NODE_TAGS = ['TD', 'TH', 'LI', 'BLOCKQUOTE'];\n/**\n * @internal\n * This represents a block that is identified by a start and end node\n * This is for cases like &lt;root&gt;Hello&lt;BR&gt;World&lt;/root&gt;\n * in that case, Hello&lt;BR&gt; is a block, World is another block\n * Such block cannot be represented by a NodeBlockElement since they don't chained up\n * to a single parent node, instead they have a start and end\n * This start and end must be in same sibling level and have same parent in DOM tree\n */\nvar StartEndBlockElement = /** @class */ (function () {\n    function StartEndBlockElement(rootNode, startNode, endNode) {\n        this.rootNode = rootNode;\n        this.startNode = startNode;\n        this.endNode = endNode;\n    }\n    StartEndBlockElement.getBlockContext = function (node) {\n        var currentNode = node;\n        while (currentNode && !isBlockElement(currentNode)) {\n            currentNode = currentNode.parentNode;\n        }\n        return currentNode;\n    };\n    /**\n     * Collapse this element to a single DOM element.\n     * If the content nodes are separated in different root nodes, wrap them to a single node\n     * If the content nodes are included in root node with other nodes, split root node\n     */\n    StartEndBlockElement.prototype.collapseToSingleElement = function () {\n        var nodeContext = StartEndBlockElement.getBlockContext(this.startNode);\n        var nodes = nodeContext\n            ? collapseNodes(nodeContext, this.startNode, this.endNode, true /*canSplitParent*/)\n            : [];\n        var blockContext = StartEndBlockElement.getBlockContext(this.startNode);\n        while (nodes[0] &&\n            nodes[0] != blockContext &&\n            nodes[0].parentNode != this.rootNode &&\n            STRUCTURE_NODE_TAGS.indexOf(getTagOfNode(nodes[0].parentNode)) < 0) {\n            var newNode = splitBalancedNodeRange(nodes);\n            if (newNode) {\n                nodes = [newNode];\n            }\n            else {\n                break;\n            }\n        }\n        return nodes.length == 1 && isBlockElement(nodes[0])\n            ? nodes[0]\n            : wrap(nodes);\n    };\n    /**\n     * Gets the start node\n     */\n    StartEndBlockElement.prototype.getStartNode = function () {\n        return this.startNode;\n    };\n    /**\n     * Gets the end node\n     */\n    StartEndBlockElement.prototype.getEndNode = function () {\n        return this.endNode;\n    };\n    /**\n     * Checks equals of two blocks\n     */\n    StartEndBlockElement.prototype.equals = function (blockElement) {\n        return (this.startNode == blockElement.getStartNode() &&\n            this.endNode == blockElement.getEndNode());\n    };\n    /**\n     * Checks if another block is after this current\n     */\n    StartEndBlockElement.prototype.isAfter = function (blockElement) {\n        return isNodeAfter(this.getStartNode(), blockElement.getEndNode());\n    };\n    /**\n     * Checks if an Html node is contained within the block\n     */\n    StartEndBlockElement.prototype.contains = function (node) {\n        return (contains(this.startNode, node, true /*treatSameNodeAsContain*/) ||\n            contains(this.endNode, node, true /*treatSameNodeAsContain*/) ||\n            (isNodeAfter(node, this.startNode) && isNodeAfter(this.endNode, node)));\n    };\n    /**\n     * Get the text content of this block element\n     */\n    StartEndBlockElement.prototype.getTextContent = function () {\n        var range = createRange(this.getStartNode(), this.getEndNode());\n        return range ? range.toString() : '';\n    };\n    return StartEndBlockElement;\n}());\nexport default StartEndBlockElement;\n//# sourceMappingURL=StartEndBlockElement.js.map","import collapseNodes from '../utils/collapseNodes';\nimport contains from '../utils/contains';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport isBlockElement from '../utils/isBlockElement';\nimport NodeBlockElement from './NodeBlockElement';\nimport StartEndBlockElement from './StartEndBlockElement';\n/**\n * This produces a block element from a a node\n * It needs to account for various HTML structure. Examples:\n * 1) &lt;root&gt;&lt;div&gt;abc&lt;/div&gt;&lt;/root&gt;\n *   This is most common the case, user passes in a node pointing to abc, and get back a block representing &lt;div&gt;abc&lt;/div&gt;\n * 2) &lt;root&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;/root&gt;\n *   Common content for empty block, user passes node pointing to &lt;br&gt;, and get back a block representing &lt;p&gt;&lt;br&gt;&lt;/p&gt;\n * 3) &lt;root&gt;abc&lt;/root&gt;\n *   Not common, but does happen. It is still a block in user's view. User passes in abc, and get back a start-end block representing abc\n *   NOTE: abc could be just one node. However, since it is not a html block, it is more appropriate to use start-end block although they point to same node\n * 4) &lt;root&gt;&lt;div&gt;abc&lt;br&gt;123&lt;/div&gt;&lt;/root&gt;\n *   A bit tricky, but can happen when user use Ctrl+Enter which simply inserts a &lt;BR&gt; to create a link break. There're two blocks:\n *   block1: 1) abc&lt;br&gt; block2: 123\n * 5) &lt;root&gt;&lt;div&gt;abc&lt;div&gt;123&lt;/div&gt;&lt;/div&gt;&lt;/root&gt;\n *   Nesting div and there is text node in same level as a DIV. Two blocks: 1) abc 2) &lt;div&gt;123&lt;/div&gt;\n * 6) &lt;root&gt;&lt;div&gt;abc&lt;span&gt;123&lt;br&gt;456&lt;/span&gt;&lt;/div&gt;&lt;/root&gt;\n *   This is really tricky. Essentially there is a &lt;BR&gt; in middle of a span breaking the span into two blocks;\n *   block1: abc&lt;span&gt;123&lt;br&gt; block2: 456\n * In summary, given any arbitrary node (leaf), to identify the head and tail of the block, following rules need to be followed:\n * 1) to identify the head, it needs to crawl DOM tre left/up till a block node or BR is encountered\n * 2) same for identifying tail\n * 3) should also apply a block ceiling, meaning as it crawls up, it should stop at a block node\n * @param rootNode Root node of the scope, the block element will be inside of this node\n * @param node The node to get BlockElement start from\n */\nexport default function getBlockElementAtNode(rootNode, node) {\n    if (!contains(rootNode, node)) {\n        return null;\n    }\n    // Identify the containing block. This serves as ceiling for traversing down below\n    // NOTE: this container block could be just the rootNode,\n    // which cannot be used to create block element. We will special case handle it later on\n    var containerBlockNode = StartEndBlockElement.getBlockContext(node);\n    if (!containerBlockNode) {\n        return null;\n    }\n    else if (containerBlockNode == node) {\n        return new NodeBlockElement(containerBlockNode);\n    }\n    // Find the head and leaf node in the block\n    var headNode = findHeadTailLeafNode(node, containerBlockNode, false /*isTail*/);\n    var tailNode = findHeadTailLeafNode(node, containerBlockNode, true /*isTail*/);\n    if (!headNode || !tailNode) {\n        return null;\n    }\n    // At this point, we have the head and tail of a block, here are some examples and where head and tail point to\n    // 1) &lt;root&gt;&lt;div&gt;hello&lt;br&gt;&lt;/div&gt;&lt;/root&gt;, head: hello, tail: &lt;br&gt;\n    // 2) &lt;root&gt;&lt;div&gt;hello&lt;span style=\"font-family: Arial\"&gt;world&lt;/span&gt;&lt;/div&gt;&lt;/root&gt;, head: hello, tail: world\n    // Both are actually completely and exclusively wrapped in a parent div, and can be represented with a Node block\n    // So we shall try to collapse as much as we can to the nearest common ancestor\n    var nodes = collapseNodes(rootNode, headNode, tailNode, false /*canSplitParent*/);\n    if (nodes.length === 0) {\n        return null;\n    }\n    headNode = nodes[0];\n    tailNode = nodes[nodes.length - 1];\n    if (headNode.parentNode != tailNode.parentNode) {\n        // Un-Balanced start and end, create a start-end block\n        return new StartEndBlockElement(rootNode, headNode, tailNode);\n    }\n    else {\n        // Balanced start and end (point to same parent), need to see if further collapsing can be done\n        while (!headNode.previousSibling && !tailNode.nextSibling) {\n            var parentNode = headNode.parentNode;\n            if (parentNode == containerBlockNode) {\n                // Has reached the container block\n                if (containerBlockNode != rootNode) {\n                    // If the container block is not the root, use the container block\n                    headNode = tailNode = parentNode;\n                }\n                break;\n            }\n            else if (parentNode && parentNode != rootNode) {\n                // Continue collapsing to parent\n                headNode = tailNode = parentNode;\n            }\n            else {\n                break;\n            }\n        }\n        // If head and tail are same and it is a block element, create NodeBlock, otherwise start-end block\n        return headNode == tailNode && isBlockElement(headNode)\n            ? new NodeBlockElement(headNode)\n            : new StartEndBlockElement(rootNode, headNode, tailNode);\n    }\n}\n/**\n * Given a node and container block, identify the first/last leaf node\n * A leaf node is defined as deepest first/last node in a block\n * i.e. &lt;div&gt;&lt;span style=\"font-family: Arial\"&gt;abc&lt;/span&gt;&lt;/div&gt;, abc is the head leaf of the block\n * Often &lt;br&gt; or a child &lt;div&gt; is used to create a block. In that case, the leaf after the sibling div or br should be the head leaf\n * i.e. &lt;div&gt;123&lt;br&gt;abc&lt;/div&gt;, abc is the head of a block because of a previous sibling &lt;br&gt;\n * i.e. &lt;div&gt;&lt;div&gt;123&lt;/div&gt;abc&lt;/div&gt;, abc is also the head of a block because of a previous sibling &lt;div&gt;\n */\nfunction findHeadTailLeafNode(node, containerBlockNode, isTail) {\n    var result = node;\n    if (getTagOfNode(result) == 'BR' && isTail) {\n        return result;\n    }\n    while (result) {\n        var sibling = node;\n        while (node.parentNode && !(sibling = isTail ? node.nextSibling : node.previousSibling)) {\n            node = node.parentNode;\n            if (node == containerBlockNode) {\n                return result;\n            }\n        }\n        while (sibling) {\n            if (isBlockElement(sibling)) {\n                return result;\n            }\n            else if (getTagOfNode(sibling) == 'BR') {\n                return isTail ? sibling : result;\n            }\n            node = sibling;\n            sibling = isTail ? node.firstChild : node.lastChild;\n        }\n        result = node;\n    }\n    return result;\n}\n//# sourceMappingURL=getBlockElementAtNode.js.map","import getBlockElementAtNode from './getBlockElementAtNode';\n/**\n * Get the first/last BlockElement of under the root node.\n * If no suitable BlockElement found, returns null\n * @param rootNode The root node to get BlockElement from\n * @param isFirst True to get first BlockElement, false to get last BlockElement\n */\nexport default function getFirstLastBlockElement(rootNode, isFirst) {\n    var node = rootNode;\n    do {\n        node = node && (isFirst ? node.firstChild : node.lastChild);\n    } while (node && node.firstChild);\n    return (node && getBlockElementAtNode(rootNode, node)) || null;\n}\n//# sourceMappingURL=getFirstLastBlockElement.js.map","/**\n * Split a text node into two parts by an offset number, and return one of them\n * @param textNode The text node to split\n * @param offset The offset number to split at\n * @param returnFirstPart True to return the first part, then the passed in textNode will become the second part.\n * Otherwise return the second part, and the passed in textNode will become the first part\n */\nexport default function splitTextNode(textNode, offset, returnFirstPart) {\n    var _a, _b, _c;\n    var firstPart = ((_a = textNode.nodeValue) === null || _a === void 0 ? void 0 : _a.substring(0, offset)) || '';\n    var secondPart = ((_b = textNode.nodeValue) === null || _b === void 0 ? void 0 : _b.substring(offset)) || '';\n    var newNode = textNode.ownerDocument.createTextNode(returnFirstPart ? firstPart : secondPart);\n    textNode.nodeValue = returnFirstPart ? secondPart : firstPart;\n    (_c = textNode.parentNode) === null || _c === void 0 ? void 0 : _c.insertBefore(newNode, returnFirstPart ? textNode : textNode.nextSibling);\n    return newNode;\n}\n//# sourceMappingURL=splitTextNode.js.map","import { __values } from \"tslib\";\nimport findClosestElementAncestor from './findClosestElementAncestor';\n/**\n * Get computed styles of a node\n * @param node The node to get computed styles from\n * @param styleNames Names of style to get, can be a single name or an array.\n * Default value is font-family, font-size, color, background-color\n * @returns An array of the computed styles\n */\nexport default function getComputedStyles(node, styleNames) {\n    var e_1, _a;\n    if (styleNames === void 0) { styleNames = ['font-family', 'font-size', 'color', 'background-color']; }\n    var element = findClosestElementAncestor(node);\n    var result = [];\n    styleNames = Array.isArray(styleNames) ? styleNames : [styleNames];\n    if (element) {\n        var win = element.ownerDocument.defaultView || window;\n        var styles = win.getComputedStyle(element);\n        if (styles) {\n            try {\n                for (var styleNames_1 = __values(styleNames), styleNames_1_1 = styleNames_1.next(); !styleNames_1_1.done; styleNames_1_1 = styleNames_1.next()) {\n                    var style = styleNames_1_1.value;\n                    var value = styles.getPropertyValue(style) || '';\n                    value = style != 'font-family' ? value.toLowerCase() : value;\n                    value = style == 'font-size' ? px2Pt(value) : value;\n                    result.push(value);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (styleNames_1_1 && !styleNames_1_1.done && (_a = styleNames_1.return)) _a.call(styleNames_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }\n    }\n    return result;\n}\n/**\n * A shortcut for getComputedStyles() when only one style is to be retrieved\n * @param node The node to get style from\n * @param styleName The style name\n * @returns The style value\n */\nexport function getComputedStyle(node, styleName) {\n    return getComputedStyles(node, styleName)[0] || '';\n}\nfunction px2Pt(px) {\n    if (px && px.indexOf('px') == px.length - 2) {\n        // Edge may not handle the floating computing well which causes the calculated value is a little less than actual value\n        // So add 0.05 to fix it\n        return Math.round(parseFloat(px) * 75 + 0.05) / 100 + 'pt';\n    }\n    return px;\n}\n//# sourceMappingURL=getComputedStyles.js.map","import getTagOfNode from './getTagOfNode';\nimport { getComputedStyle } from './getComputedStyles';\nvar CRLF = /^[\\r\\n]+$/g;\nvar CRLF_SPACE = /[\\t\\r\\n\\u0020\\u200B]/gm; // We should only find new line, real space or ZeroWidthSpace (TAB, %20, but not &nbsp;)\n/**\n * @internal\n * Skip a node when any of following conditions are true\n * - it is neither Element nor Text\n * - it is a text node but is empty\n * - it is a text node but contains just CRLF (noisy text node that often comes in-between elements)\n * - has a display:none\n * - it is just <div></div>\n * @param node The node to check\n * @param ignoreSpace (Optional) True to ignore pure space text node of the node when check.\n * If the value of a node value is only space, set this to true will treat this node can be skipped.\n * Default value is false\n */\nexport default function shouldSkipNode(node, ignoreSpace) {\n    if (node.nodeType == 3 /* Text */) {\n        if (!node.nodeValue || node.textContent == '' || CRLF.test(node.nodeValue)) {\n            return true;\n        }\n        else if (ignoreSpace && node.nodeValue.replace(CRLF_SPACE, '') == '') {\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    else if (node.nodeType == 1 /* Element */) {\n        if (getComputedStyle(node, 'display') == 'none') {\n            return true;\n        }\n        var tag = getTagOfNode(node);\n        if (tag == 'DIV' || tag == 'SPAN') {\n            // Empty SPAN/DIV or SPAN/DIV with only meaningless children is meaningless,\n            // because it can render nothing. If we keep them here, there may be unexpected\n            // LI elements added for those meaningless nodes.\n            for (var child = node.firstChild; !!child; child = child.nextSibling) {\n                if (!shouldSkipNode(child, ignoreSpace)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        else {\n            // There may still be other cases that the node is not meaningful.\n            // We can add those cases here once we hit them.\n            return false;\n        }\n    }\n    else {\n        return true;\n    }\n}\n//# sourceMappingURL=shouldSkipNode.js.map","import contains from './contains';\nimport getTagOfNode from './getTagOfNode';\nimport shouldSkipNode from './shouldSkipNode';\n/**\n * @internal\n * This walks forwards/backwards DOM tree to get next meaningful node\n * @param rootNode Root node to scope the leaf sibling node\n * @param startNode current node to get sibling node from\n * @param isNext True to get next leaf sibling node, false to get previous leaf sibling node\n * @param skipTags (Optional) tags that child elements will be skipped\n * @param ignoreSpace (Optional) Ignore pure space text node when check if the node should be skipped\n */\nexport function getLeafSibling(rootNode, startNode, isNext, skipTags, ignoreSpace) {\n    var result = null;\n    var getSibling = isNext\n        ? function (node) { return (node === null || node === void 0 ? void 0 : node.nextSibling) || null; }\n        : function (node) { return (node === null || node === void 0 ? void 0 : node.previousSibling) || null; };\n    var getChild = isNext ? function (node) { return node.firstChild; } : function (node) { return node.lastChild; };\n    if (contains(rootNode, startNode)) {\n        var curNode = startNode;\n        var shouldContinue = true;\n        while (shouldContinue) {\n            // Find next/previous node, starting from next/previous sibling, then one level up to find next/previous sibling from parent\n            // till a non-null nextSibling/previousSibling is found or the ceiling is encountered (rootNode)\n            var parentNode = (curNode === null || curNode === void 0 ? void 0 : curNode.parentNode) || null;\n            curNode = getSibling(curNode);\n            while (!curNode && parentNode != rootNode) {\n                curNode = getSibling(parentNode);\n                parentNode = (parentNode === null || parentNode === void 0 ? void 0 : parentNode.parentNode) || null;\n            }\n            // Now traverse down to get first/last child\n            while (curNode &&\n                (!skipTags || skipTags.indexOf(getTagOfNode(curNode)) < 0) &&\n                getChild(curNode)) {\n                curNode = getChild(curNode);\n            }\n            // Check special nodes (i.e. node that has a display:none etc.) and continue looping if so\n            shouldContinue = !!curNode && shouldSkipNode(curNode, ignoreSpace);\n            if (!shouldContinue) {\n                // Found a good leaf node, assign and exit\n                result = curNode;\n                break;\n            }\n        }\n    }\n    return result;\n}\n/**\n * This walks forwards DOM tree to get next meaningful node\n * @param rootNode Root node to scope the leaf sibling node\n * @param startNode current node to get sibling node from\n * @param skipTags (Optional) tags that child elements will be skipped\n */\nexport function getNextLeafSibling(rootNode, startNode, skipTags) {\n    return getLeafSibling(rootNode, startNode, true /*isNext*/, skipTags);\n}\n/**\n * This walks backwards DOM tree to get next meaningful node\n * @param rootNode Root node to scope the leaf sibling node\n * @param startNode current node to get sibling node from\n * @param skipTags (Optional) tags that child elements will be skipped\n */\nexport function getPreviousLeafSibling(rootNode, startNode, skipTags) {\n    return getLeafSibling(rootNode, startNode, false /*isNext*/, skipTags);\n}\n//# sourceMappingURL=getLeafSibling.js.map","import getTagOfNode from '../utils/getTagOfNode';\nimport Position from '../selection/Position';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport splitTextNode from '../utils/splitTextNode';\nimport wrap from '../utils/wrap';\nimport { getNextLeafSibling } from '../utils/getLeafSibling';\nimport { splitBalancedNodeRange } from '../utils/splitParentNode';\nvar STYLET_AGS = 'SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL,SUP,SUB'.split(',');\n/**\n * Apply style using a styler function to the given container node in the given range\n * @param container The container node to apply style to\n * @param styler The styler function\n * @param fromPosition From position\n * @param toPosition To position\n */\nexport default function applyTextStyle(container, styler, from, to) {\n    if (from === void 0) { from = new Position(container, 0 /* Begin */).normalize(); }\n    if (to === void 0) { to = new Position(container, -1 /* End */).normalize(); }\n    var formatNodes = [];\n    var fromPosition = from;\n    var toPosition = to;\n    while (fromPosition && toPosition && toPosition.isAfter(fromPosition)) {\n        var formatNode = fromPosition.node;\n        var parentTag = getTagOfNode(formatNode.parentNode);\n        // The code below modifies DOM. Need to get the next sibling first otherwise you won't be able to reliably get a good next sibling node\n        var nextNode = getNextLeafSibling(container, formatNode);\n        if (formatNode.nodeType == 3 /* Text */ && ['TR', 'TABLE'].indexOf(parentTag) < 0) {\n            if (formatNode == toPosition.node && !toPosition.isAtEnd) {\n                formatNode = splitTextNode(formatNode, toPosition.offset, true /*returnFirstPart*/);\n            }\n            if (fromPosition.offset > 0) {\n                formatNode = splitTextNode(formatNode, fromPosition.offset, false /*returnFirstPart*/);\n            }\n            formatNodes.push(formatNode);\n        }\n        fromPosition = nextNode && new Position(nextNode, 0 /* Begin */);\n    }\n    if (formatNodes.length > 0) {\n        if (formatNodes.every(function (node) { return node.parentNode == formatNodes[0].parentNode; })) {\n            var newNode_1 = formatNodes.shift();\n            formatNodes.forEach(function (node) {\n                var _a;\n                var newNodeValue = (newNode_1.nodeValue || '') + (node.nodeValue || '');\n                newNode_1.nodeValue = newNodeValue;\n                (_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(node);\n            });\n            formatNodes = [newNode_1];\n        }\n        formatNodes.forEach(function (startingNode) {\n            // When apply style within style tags like B/I/U/..., we split the tag and apply outside them\n            // So that the inner style tag such as U, STRIKE can inherit the style we added\n            var node = startingNode;\n            while (node &&\n                getTagOfNode(node) != 'SPAN' &&\n                STYLET_AGS.indexOf(getTagOfNode(node.parentNode)) >= 0) {\n                callStylerWithInnerNode(node, styler);\n                node = splitBalancedNodeRange(node);\n            }\n            if (node && getTagOfNode(node) != 'SPAN') {\n                callStylerWithInnerNode(node, styler);\n                node = wrap(node, 'SPAN');\n            }\n            if (safeInstanceOf(node, 'HTMLElement')) {\n                styler(node);\n            }\n        });\n    }\n}\nfunction callStylerWithInnerNode(node, styler) {\n    if (node && node.nodeType == 1 /* Element */) {\n        styler(node, true /*isInnerNode*/);\n    }\n}\n//# sourceMappingURL=applyTextStyle.js.map","import applyTextStyle from './applyTextStyle';\nimport isNodeAfter from '../utils/isNodeAfter';\nimport Position from '../selection/Position';\n/**\n * This presents an inline element that can be represented by a single html node.\n * This serves as base for most inline element as it contains most implementation\n * of all operations that can happen on an inline element. Other sub inline elements mostly\n * just identify themselves for a certain type\n */\nvar NodeInlineElement = /** @class */ (function () {\n    function NodeInlineElement(containerNode, parentBlock) {\n        this.containerNode = containerNode;\n        this.parentBlock = parentBlock;\n    }\n    /**\n     * The text content for this inline element\n     */\n    NodeInlineElement.prototype.getTextContent = function () {\n        // nodeValue is better way to retrieve content for a text. Others, just use textContent\n        return ((this.containerNode.nodeType == 3 /* Text */\n            ? this.containerNode.nodeValue\n            : this.containerNode.textContent) || '');\n    };\n    /**\n     * Get the container node\n     */\n    NodeInlineElement.prototype.getContainerNode = function () {\n        return this.containerNode;\n    };\n    // Get the parent block\n    NodeInlineElement.prototype.getParentBlock = function () {\n        return this.parentBlock;\n    };\n    /**\n     * Get the start position of the inline element\n     */\n    NodeInlineElement.prototype.getStartPosition = function () {\n        // For a position, we always want it to point to a leaf node\n        // We should try to go get the lowest first child node from the container\n        return new Position(this.containerNode, 0).normalize();\n    };\n    /**\n     * Get the end position of the inline element\n     */\n    NodeInlineElement.prototype.getEndPosition = function () {\n        // For a position, we always want it to point to a leaf node\n        // We should try to go get the lowest last child node from the container\n        return new Position(this.containerNode, -1 /* End */).normalize();\n    };\n    /**\n     * Checks if this inline element is a textual inline element\n     */\n    NodeInlineElement.prototype.isTextualInlineElement = function () {\n        return this.containerNode && this.containerNode.nodeType == 3 /* Text */;\n    };\n    /**\n     * Checks if an inline element is after the current inline element\n     */\n    NodeInlineElement.prototype.isAfter = function (inlineElement) {\n        return inlineElement && isNodeAfter(this.containerNode, inlineElement.getContainerNode());\n    };\n    /**\n     * Checks if the given position is contained in the inline element\n     */\n    NodeInlineElement.prototype.contains = function (pos) {\n        var start = this.getStartPosition();\n        var end = this.getEndPosition();\n        return pos && pos.isAfter(start) && end.isAfter(pos);\n    };\n    /**\n     * Apply inline style to an inline element\n     */\n    NodeInlineElement.prototype.applyStyle = function (styler) {\n        applyTextStyle(this.containerNode, styler);\n    };\n    return NodeInlineElement;\n}());\nexport default NodeInlineElement;\n//# sourceMappingURL=NodeInlineElement.js.map","import { __extends } from \"tslib\";\nimport NodeInlineElement from './NodeInlineElement';\n/**\n * This is an inline element representing an Html image\n */\nvar ImageInlineElement = /** @class */ (function (_super) {\n    __extends(ImageInlineElement, _super);\n    function ImageInlineElement(containerNode, parentBlock) {\n        return _super.call(this, containerNode, parentBlock) || this;\n    }\n    return ImageInlineElement;\n}(NodeInlineElement));\nexport default ImageInlineElement;\n//# sourceMappingURL=ImageInlineElement.js.map","import { __extends } from \"tslib\";\nimport NodeInlineElement from './NodeInlineElement';\n/**\n * This is inline element presenting an html hyperlink\n */\nvar LinkInlineElement = /** @class */ (function (_super) {\n    __extends(LinkInlineElement, _super);\n    function LinkInlineElement(containerNode, parentBlock) {\n        return _super.call(this, containerNode, parentBlock) || this;\n    }\n    return LinkInlineElement;\n}(NodeInlineElement));\nexport default LinkInlineElement;\n//# sourceMappingURL=LinkInlineElement.js.map","import getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport ImageInlineElement from './ImageInlineElement';\nimport LinkInlineElement from './LinkInlineElement';\nimport NodeInlineElement from './NodeInlineElement';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nexport default function getInlineElementAtNode(parent, node) {\n    // An inline element has to be in a block element, get the block first and then resolve through the factory\n    var parentBlock = safeInstanceOf(parent, 'Node')\n        ? getBlockElementAtNode(parent, node)\n        : parent;\n    return node && parentBlock && resolveInlineElement(node, parentBlock);\n}\n/**\n * Resolve an inline element by a leaf node\n * @param node The node to resolve from\n * @param parentBlock The parent block element\n */\nfunction resolveInlineElement(node, parentBlock) {\n    var nodeChain = [node];\n    for (var parent_1 = node.parentNode; parent_1 && parentBlock.contains(parent_1); parent_1 = parent_1.parentNode) {\n        nodeChain.push(parent_1);\n    }\n    var inlineElement;\n    for (var i = nodeChain.length - 1; i >= 0 && !inlineElement; i--) {\n        var currentNode = nodeChain[i];\n        var tag = getTagOfNode(currentNode);\n        if (tag == 'A') {\n            inlineElement = new LinkInlineElement(currentNode, parentBlock);\n        }\n        else if (tag == 'IMG') {\n            inlineElement = new ImageInlineElement(currentNode, parentBlock);\n        }\n    }\n    return inlineElement || new NodeInlineElement(node, parentBlock);\n}\n//# sourceMappingURL=getInlineElementAtNode.js.map","import shouldSkipNode from './shouldSkipNode';\nimport { getLeafSibling } from './getLeafSibling';\n/**\n * Get first/last leaf node of the given root node.\n * @param rootNode Root node to get leaf node from\n * @param isFirst True to get first leaf node, false to get last leaf node\n */\nfunction getLeafNode(rootNode, isFirst) {\n    var getChild = function (node) { return (isFirst ? node.firstChild : node.lastChild); };\n    var result = getChild(rootNode);\n    while (result && getChild(result)) {\n        result = getChild(result);\n    }\n    if (result && shouldSkipNode(result)) {\n        result = getLeafSibling(rootNode, result, isFirst);\n    }\n    return result;\n}\n/**\n * Get the first meaningful leaf node\n * @param rootNode Root node to get leaf node from\n */\nexport function getFirstLeafNode(rootNode) {\n    return getLeafNode(rootNode, true /*isFirst*/);\n}\n/**\n * Get the last meaningful leaf node\n * @param rootNode Root node to get leaf node from\n */\nexport function getLastLeafNode(rootNode) {\n    return getLeafNode(rootNode, false /*isFirst*/);\n}\n//# sourceMappingURL=getLeafNode.js.map","import getInlineElementAtNode from './getInlineElementAtNode';\nimport { getFirstLeafNode, getLastLeafNode } from '../utils/getLeafNode';\n/**\n * @internal\n * Get the first inline element inside the given node\n */\nexport function getFirstInlineElement(rootNode) {\n    // getFirstLeafNode can return null for empty container\n    // do check null before passing on to get inline from the node\n    var node = getFirstLeafNode(rootNode);\n    return node ? getInlineElementAtNode(rootNode, node) : null;\n}\n/**\n * @internal\n * Get the last inline element inside the given node\n */\nexport function getLastInlineElement(rootNode) {\n    // getLastLeafNode can return null for empty container\n    // do check null before passing on to get inline from the node\n    var node = getLastLeafNode(rootNode);\n    return node ? getInlineElementAtNode(rootNode, node) : null;\n}\n//# sourceMappingURL=getFirstLastInlineElement.js.map","import contains from '../utils/contains';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getFirstLastBlockElement from '../blockElements/getFirstLastBlockElement';\nimport getInlineElementAtNode from '../inlineElements/getInlineElementAtNode';\nimport { getFirstInlineElement } from '../inlineElements/getFirstLastInlineElement';\n/**\n * @internal\n * provides a scope object for traversing the entire editor body starting from the beginning\n */\nvar BodyScoper = /** @class */ (function () {\n    /**\n     * Construct a new instance of BodyScoper class\n     * @param rootNode Root node of the body\n     * @param startNode The node to start from. If not passed, it will start from the beginning of the body\n     */\n    function BodyScoper(rootNode, startNode) {\n        this.rootNode = rootNode;\n        this.startNode = contains(rootNode, startNode) ? startNode : null;\n    }\n    /**\n     * Get the start block element\n     */\n    BodyScoper.prototype.getStartBlockElement = function () {\n        return this.startNode\n            ? getBlockElementAtNode(this.rootNode, this.startNode)\n            : getFirstLastBlockElement(this.rootNode, true /*isFirst*/);\n    };\n    /**\n     * Get the start inline element\n     */\n    BodyScoper.prototype.getStartInlineElement = function () {\n        return this.startNode\n            ? getInlineElementAtNode(this.rootNode, this.startNode)\n            : getFirstInlineElement(this.rootNode);\n    };\n    /**\n     * Since the scope is global, all blocks under the root node are in scope\n     */\n    BodyScoper.prototype.isBlockInScope = function (blockElement) {\n        return contains(this.rootNode, blockElement.getStartNode());\n    };\n    /**\n     * Since we're at body scope, inline elements never need to be trimmed\n     */\n    BodyScoper.prototype.trimInlineElement = function (inlineElement) {\n        return inlineElement;\n    };\n    return BodyScoper;\n}());\nexport default BodyScoper;\n//# sourceMappingURL=BodyScoper.js.map","/**\n * @internal\n * Represents an empty InlineElement.\n * This is used for ContentTraverser internally only.\n * An empty InlineElement means current position is at the end of a tag so nothing is included inside this element\n */\nvar EmptyInlineElement = /** @class */ (function () {\n    function EmptyInlineElement(position, parentBlock) {\n        this.position = position;\n        this.parentBlock = parentBlock;\n    }\n    /**\n     * Get the text content of this inline element\n     */\n    EmptyInlineElement.prototype.getTextContent = function () {\n        return '';\n    };\n    /**\n     * Get the container node of this inline element\n     */\n    EmptyInlineElement.prototype.getContainerNode = function () {\n        return this.position.node;\n    };\n    /**\n     * Get the parent block element of this inline element\n     */\n    EmptyInlineElement.prototype.getParentBlock = function () {\n        return this.parentBlock;\n    };\n    /**\n     * Get the start position of this inline element\n     */\n    EmptyInlineElement.prototype.getStartPosition = function () {\n        return this.position;\n    };\n    /**\n     * Get the end position of this inline element\n     */\n    EmptyInlineElement.prototype.getEndPosition = function () {\n        return this.position;\n    };\n    /**\n     * Checks if the given inline element is after this inline element\n     */\n    EmptyInlineElement.prototype.isAfter = function (inlineElement) {\n        return inlineElement && this.position.isAfter(inlineElement.getEndPosition());\n    };\n    /**\n     * Checks if this inline element is a textual inline element\n     */\n    EmptyInlineElement.prototype.isTextualInlineElement = function () {\n        return false;\n    };\n    /**\n     * Checks if the given editor position is contained in this inline element\n     */\n    EmptyInlineElement.prototype.contains = function (position) {\n        return false;\n    };\n    /**\n     * Apply inline style to a region of an inline element.\n     */\n    EmptyInlineElement.prototype.applyStyle = function (styler) { };\n    return EmptyInlineElement;\n}());\nexport default EmptyInlineElement;\n//# sourceMappingURL=EmptyInlineElement.js.map","import applyTextStyle from './applyTextStyle';\nimport createRange from '../selection/createRange';\nimport Position from '../selection/Position';\nimport { getNextLeafSibling, getPreviousLeafSibling } from '../utils/getLeafSibling';\n/**\n * This is a special version of inline element that identifies a section of an inline element\n * We often have the need to cut an inline element in half and perform some operation only on half of an inline element\n * i.e. users select only some text of a text node and apply format, in that case, format has to happen on partial of an inline element\n * PartialInlineElement is implemented in a way that decorate another full inline element with its own override on methods like isAfter\n * It also offers some special methods that others don't have, i.e. nextInlineElement etc.\n */\nvar PartialInlineElement = /** @class */ (function () {\n    function PartialInlineElement(inlineElement, start, end) {\n        if (start === void 0) { start = null; }\n        if (end === void 0) { end = null; }\n        this.inlineElement = inlineElement;\n        this.start = start;\n        this.end = end;\n    }\n    /**\n     * Get the full inline element that this partial inline decorates\n     */\n    PartialInlineElement.prototype.getDecoratedInline = function () {\n        return this.inlineElement;\n    };\n    /**\n     * Gets the container node\n     */\n    PartialInlineElement.prototype.getContainerNode = function () {\n        return this.inlineElement.getContainerNode();\n    };\n    /**\n     * Gets the parent block\n     */\n    PartialInlineElement.prototype.getParentBlock = function () {\n        return this.inlineElement.getParentBlock();\n    };\n    /**\n     * Gets the text content\n     */\n    PartialInlineElement.prototype.getTextContent = function () {\n        var range = createRange(this.getStartPosition(), this.getEndPosition());\n        return range.toString();\n    };\n    /**\n     * Get start position of this inline element.\n     */\n    PartialInlineElement.prototype.getStartPosition = function () {\n        return this.start || this.inlineElement.getStartPosition();\n    };\n    /**\n     * Get end position of this inline element.\n     */\n    PartialInlineElement.prototype.getEndPosition = function () {\n        return this.end || this.inlineElement.getEndPosition();\n    };\n    Object.defineProperty(PartialInlineElement.prototype, \"nextInlineElement\", {\n        /**\n         * Get next partial inline element if it is not at the end boundary yet\n         */\n        get: function () {\n            return this.end ? new PartialInlineElement(this.inlineElement, this.end) : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(PartialInlineElement.prototype, \"previousInlineElement\", {\n        /**\n         * Get previous partial inline element if it is not at the begin boundary yet\n         */\n        get: function () {\n            return this.start\n                ? new PartialInlineElement(this.inlineElement, undefined, this.start)\n                : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Checks if it contains a position\n     */\n    PartialInlineElement.prototype.contains = function (pos) {\n        return pos && pos.isAfter(this.getStartPosition()) && this.getEndPosition().isAfter(pos);\n    };\n    /**\n     * Checks if this inline element is a textual inline element\n     */\n    PartialInlineElement.prototype.isTextualInlineElement = function () {\n        return this.inlineElement && this.inlineElement.isTextualInlineElement();\n    };\n    /**\n     * Check if this inline element is after the other inline element\n     */\n    PartialInlineElement.prototype.isAfter = function (inlineElement) {\n        var thisStart = this.getStartPosition();\n        var otherEnd = inlineElement && inlineElement.getEndPosition();\n        return otherEnd && (thisStart.isAfter(otherEnd) || thisStart.equalTo(otherEnd));\n    };\n    /**\n     * apply style\n     */\n    PartialInlineElement.prototype.applyStyle = function (styler) {\n        var from = this.getStartPosition().normalize();\n        var to = this.getEndPosition().normalize();\n        var container = this.getContainerNode();\n        if (from.isAtEnd) {\n            var nextNode = getNextLeafSibling(container, from.node);\n            from = nextNode ? new Position(nextNode, 0 /* Begin */) : null;\n        }\n        if (to.offset == 0) {\n            var previousNode = getPreviousLeafSibling(container, to.node);\n            to = previousNode ? new Position(previousNode, -1 /* End */) : null;\n        }\n        applyTextStyle(container, styler, from || undefined, to || undefined);\n    };\n    return PartialInlineElement;\n}());\nexport default PartialInlineElement;\n//# sourceMappingURL=PartialInlineElement.js.map","import getInlineElementAtNode from './getInlineElementAtNode';\nimport PartialInlineElement from './PartialInlineElement';\nimport shouldSkipNode from '../utils/shouldSkipNode';\nimport { getLeafSibling } from '../utils/getLeafSibling';\n/**\n * @internal\n * Get inline element before a position\n * This is mostly used when we want to get the inline element before selection/cursor\n * There is a possible that the cursor is in middle of an inline element (i.e. mid of a text node)\n * in this case, we only want to return what is before cursor (a partial of an inline) to indicate\n * that we're in middle.\n * @param root Root node of current scope, use for create InlineElement\n * @param position The position to get InlineElement before\n */\nexport function getInlineElementBefore(root, position) {\n    return getInlineElementBeforeAfter(root, position, false /*isAfter*/);\n}\n/**\n * @internal\n * Get inline element after a position\n * This is mostly used when we want to get the inline element after selection/cursor\n * There is a possible that the cursor is in middle of an inline element (i.e. mid of a text node)\n * in this case, we only want to return what is before cursor (a partial of an inline) to indicate\n * that we're in middle.\n * @param root Root node of current scope, use for create InlineElement\n * @param position The position to get InlineElement after\n */\nexport function getInlineElementAfter(root, position) {\n    return getInlineElementBeforeAfter(root, position, true /*isAfter*/);\n}\n/**\n * @internal\n */\nexport function getInlineElementBeforeAfter(root, position, isAfter) {\n    if (!root || !position || !position.node) {\n        return null;\n    }\n    position = position.normalize();\n    var offset = position.offset, isAtEnd = position.isAtEnd;\n    var node = position.node;\n    var isPartial = false;\n    if ((!isAfter && offset == 0 && !isAtEnd) || (isAfter && isAtEnd)) {\n        node = getLeafSibling(root, node, isAfter);\n    }\n    else if (node.nodeType == 3 /* Text */ &&\n        ((!isAfter && !isAtEnd) || (isAfter && offset > 0))) {\n        isPartial = true;\n    }\n    if (node && shouldSkipNode(node)) {\n        node = getLeafSibling(root, node, isAfter);\n    }\n    var inlineElement = getInlineElementAtNode(root, node);\n    if (inlineElement && (isPartial || inlineElement.contains(position))) {\n        inlineElement = isAfter\n            ? new PartialInlineElement(inlineElement, position, undefined)\n            : new PartialInlineElement(inlineElement, undefined, position);\n    }\n    return inlineElement;\n}\n//# sourceMappingURL=getInlineElementBeforeAfter.js.map","import EmptyInlineElement from '../inlineElements/EmptyInlineElement';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getInlineElementAtNode from '../inlineElements/getInlineElementAtNode';\nimport NodeBlockElement from '../blockElements/NodeBlockElement';\nimport Position from '../selection/Position';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport { getInlineElementAfter } from '../inlineElements/getInlineElementBeforeAfter';\nimport { getFirstInlineElement, getLastInlineElement, } from '../inlineElements/getFirstLastInlineElement';\n/**\n * @internal\n * This provides traversing content in a selection start block\n * This is commonly used for those cursor context sensitive plugin,\n * they want to know text being typed at cursor\n * This provides a scope for parsing from cursor position up to begin of the selection block\n */\nvar SelectionBlockScoper = /** @class */ (function () {\n    /**\n     * Create a new instance of SelectionBlockScoper class\n     * @param rootNode The root node of the whole scope\n     * @param position Position of the selection start\n     * @param startFrom Where to start, can be Begin, End, SelectionStart\n     */\n    function SelectionBlockScoper(rootNode, position, startFrom) {\n        this.rootNode = rootNode;\n        this.startFrom = startFrom;\n        if (safeInstanceOf(position, 'Range')) {\n            position = Position.getStart(position);\n        }\n        this.position = position.normalize();\n        this.block = getBlockElementAtNode(this.rootNode, this.position.node);\n    }\n    /**\n     * Get the start block element\n     */\n    SelectionBlockScoper.prototype.getStartBlockElement = function () {\n        return this.block;\n    };\n    /**\n     * Get the start inline element\n     * The start inline refers to inline before the selection start\n     *  The reason why we choose the one before rather after is, when cursor is at the end of a paragraph,\n     * the one after likely will point to inline in next paragraph which may be null if the cursor is at bottom of editor\n     */\n    SelectionBlockScoper.prototype.getStartInlineElement = function () {\n        if (this.block) {\n            switch (this.startFrom) {\n                case 0 /* Begin */:\n                case 1 /* End */:\n                case 2 /* DomEnd */:\n                    return getFirstLastInlineElementFromBlockElement(this.block, this.startFrom == 0 /* Begin */);\n                case 3 /* SelectionStart */:\n                    // Get the inline before selection start point, and ensure it falls in the selection block\n                    var startInline = getInlineElementAfter(this.rootNode, this.position);\n                    return startInline && this.block.contains(startInline.getContainerNode())\n                        ? startInline\n                        : new EmptyInlineElement(this.position, this.block);\n            }\n        }\n        return null;\n    };\n    /**\n     * Check if the given block element is in current scope\n     * @param blockElement The block element to check\n     */\n    SelectionBlockScoper.prototype.isBlockInScope = function (blockElement) {\n        return this.block && blockElement ? this.block.equals(blockElement) : false;\n    };\n    /**\n     * Trim the incoming inline element, and return an inline element\n     * This just tests and return the inline element if it is in block\n     * This is a block scoper, which is not like selection scoper where it may cut an inline element in half\n     * A block scoper does not cut an inline in half\n     */\n    SelectionBlockScoper.prototype.trimInlineElement = function (inlineElement) {\n        return this.block && inlineElement && this.block.contains(inlineElement.getContainerNode())\n            ? inlineElement\n            : null;\n    };\n    return SelectionBlockScoper;\n}());\nexport default SelectionBlockScoper;\n/**\n * Get first/last InlineElement of the given BlockElement\n * @param block The BlockElement to get InlineElement from\n * @param isFirst True to get first InlineElement, false to get last InlineElement\n */\nfunction getFirstLastInlineElementFromBlockElement(block, isFirst) {\n    if (block instanceof NodeBlockElement) {\n        var blockNode = block.getStartNode();\n        return isFirst ? getFirstInlineElement(blockNode) : getLastInlineElement(blockNode);\n    }\n    else {\n        return getInlineElementAtNode(block, isFirst ? block.getStartNode() : block.getEndNode());\n    }\n}\n//# sourceMappingURL=SelectionBlockScoper.js.map","import getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport PartialInlineElement from '../inlineElements/PartialInlineElement';\nimport Position from '../selection/Position';\nimport { getInlineElementAfter } from '../inlineElements/getInlineElementBeforeAfter';\n/**\n * @internal\n * This is selection scoper that provide a start inline as the start of the selection\n * and checks if a block falls in the selection (isBlockInScope)\n * last trimInlineElement to trim any inline element to return a partial that falls in the selection\n */\nvar SelectionScoper = /** @class */ (function () {\n    /**\n     * Create a new instance of SelectionScoper class\n     * @param rootNode The root node of the content\n     * @param range The selection range to scope to\n     */\n    function SelectionScoper(rootNode, range) {\n        this.rootNode = rootNode;\n        this.startBlock = null;\n        this.startInline = null;\n        this.start = Position.getStart(range).normalize();\n        this.end = Position.getEnd(range).normalize();\n    }\n    /**\n     * Provide a start block as the first block after the cursor\n     */\n    SelectionScoper.prototype.getStartBlockElement = function () {\n        if (!this.startBlock) {\n            this.startBlock = getBlockElementAtNode(this.rootNode, this.start.node);\n        }\n        return this.startBlock;\n    };\n    /**\n     * Provide a start inline as the first inline after the cursor\n     */\n    SelectionScoper.prototype.getStartInlineElement = function () {\n        if (!this.startInline) {\n            this.startInline = this.trimInlineElement(getInlineElementAfter(this.rootNode, this.start));\n        }\n        return this.startInline;\n    };\n    /**\n     * Checks if a block completely falls in the selection\n     * @param block The BlockElement to check\n     */\n    SelectionScoper.prototype.isBlockInScope = function (block) {\n        if (!block) {\n            return false;\n        }\n        var inScope = false;\n        var selStartBlock = this.getStartBlockElement();\n        if (this.start.equalTo(this.end)) {\n            inScope = !!selStartBlock && selStartBlock.equals(block);\n        }\n        else {\n            var selEndBlock = getBlockElementAtNode(this.rootNode, this.end.node);\n            // There are three cases that are considered as \"block in scope\"\n            // 1) The start of selection falls on the block\n            // 2) The end of selection falls on the block\n            // 3) the block falls in-between selection start and end\n            inScope =\n                !!selStartBlock &&\n                    !!selEndBlock &&\n                    (block.equals(selStartBlock) ||\n                        block.equals(selEndBlock) ||\n                        (block.isAfter(selStartBlock) && selEndBlock.isAfter(block)));\n        }\n        return inScope;\n    };\n    /**\n     * Trim an incoming inline. If it falls completely outside selection, return null\n     * otherwise return a partial that represents the portion that falls in the selection\n     * @param inline The InlineElement to check\n     */\n    SelectionScoper.prototype.trimInlineElement = function (inline) {\n        if (!inline || this.start.equalTo(this.end)) {\n            return null;\n        }\n        // Temp code. Will be changed to using InlineElement.getStart/EndPosition() soon\n        var start = inline.getStartPosition();\n        var end = inline.getEndPosition();\n        if (start.isAfter(this.end) || this.start.isAfter(end)) {\n            return null;\n        }\n        var startPartial = false;\n        var endPartial = false;\n        if (this.start.isAfter(start)) {\n            start = this.start;\n            startPartial = true;\n        }\n        if (end.isAfter(this.end)) {\n            end = this.end;\n            endPartial = true;\n        }\n        return start.isAfter(end) || start.equalTo(end)\n            ? null\n            : startPartial || endPartial\n                ? new PartialInlineElement(inline, startPartial ? start : undefined, endPartial ? end : undefined)\n                : inline;\n    };\n    return SelectionScoper;\n}());\nexport default SelectionScoper;\n//# sourceMappingURL=SelectionScoper.js.map","import BodyScoper from './BodyScoper';\nimport EmptyInlineElement from '../inlineElements/EmptyInlineElement';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getInlineElementAtNode from '../inlineElements/getInlineElementAtNode';\nimport PartialInlineElement from '../inlineElements/PartialInlineElement';\nimport SelectionBlockScoper from './SelectionBlockScoper';\nimport SelectionScoper from './SelectionScoper';\nimport { getInlineElementBeforeAfter } from '../inlineElements/getInlineElementBeforeAfter';\nimport { getLeafSibling } from '../utils/getLeafSibling';\n/**\n * The provides traversing of content inside editor.\n * There are two ways to traverse, block by block, or inline element by inline element\n * Block and inline traversing is independent from each other, meaning if you traverse block by block, it does not change\n * the current inline element position\n */\nvar ContentTraverser = /** @class */ (function () {\n    /**\n     * Create a content traverser for the whole body of given root node\n     * @param scoper Traversing scoper object to help scope the traversing\n     * @param skipTags (Optional) tags that child elements will be skipped\n     */\n    function ContentTraverser(scoper, skipTags) {\n        this.scoper = scoper;\n        this.skipTags = skipTags;\n        this.currentInline = null;\n        this.currentBlock = null;\n    }\n    /**\n     * Create a content traverser for the whole body of given root node\n     * @param rootNode The root node to traverse in\n     * @param startNode The node to start from. If not passed, it will start from the beginning of the body\n     * @param skipTags (Optional) tags that child elements will be skipped\n     */\n    ContentTraverser.createBodyTraverser = function (rootNode, startNode, skipTags) {\n        return new ContentTraverser(new BodyScoper(rootNode, startNode));\n    };\n    /**\n     * Create a content traverser for the given selection\n     * @param rootNode The root node to traverse in\n     * @param range The selection range to scope the traversing\n     * @param skipTags (Optional) tags that child elements will be skipped\n     */\n    ContentTraverser.createSelectionTraverser = function (rootNode, range, skipTags) {\n        return new ContentTraverser(new SelectionScoper(rootNode, range), skipTags);\n    };\n    /**\n     * Create a content traverser for a block element which contains the given position\n     * @param rootNode The root node to traverse in\n     * @param position A position inside a block, traversing will be scoped within this block.\n     * If passing a range, the start position of this range will be used\n     * @param startFrom Start position of traversing. The value can be Begin, End, SelectionStart\n     * @param skipTags (Optional) tags that child elements will be skipped\n     */\n    ContentTraverser.createBlockTraverser = function (rootNode, position, start, skipTags) {\n        if (start === void 0) { start = 3 /* SelectionStart */; }\n        return new ContentTraverser(new SelectionBlockScoper(rootNode, position, start));\n    };\n    Object.defineProperty(ContentTraverser.prototype, \"currentBlockElement\", {\n        /**\n         * Get current block\n         */\n        get: function () {\n            // Prepare currentBlock from the scoper\n            if (!this.currentBlock) {\n                this.currentBlock = this.scoper.getStartBlockElement();\n            }\n            return this.currentBlock;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Get next block element\n     */\n    ContentTraverser.prototype.getNextBlockElement = function () {\n        return this.getPreviousNextBlockElement(true /*isNext*/);\n    };\n    /**\n     * Get previous block element\n     */\n    ContentTraverser.prototype.getPreviousBlockElement = function () {\n        return this.getPreviousNextBlockElement(false /*isNext*/);\n    };\n    ContentTraverser.prototype.getPreviousNextBlockElement = function (isNext) {\n        var current = this.currentBlockElement;\n        if (!current) {\n            return null;\n        }\n        var leaf = getLeafSibling(this.scoper.rootNode, isNext ? current.getEndNode() : current.getStartNode(), isNext, this.skipTags);\n        var newBlock = leaf ? getBlockElementAtNode(this.scoper.rootNode, leaf) : null;\n        // Make sure this is right block:\n        // 1) the block is in scope per scoper\n        // 2) the block is after (for next) or before (for previous) the current block\n        // Then:\n        // 1) Re-position current block to newly found block\n        if (newBlock &&\n            this.scoper.isBlockInScope(newBlock) &&\n            ((isNext && newBlock.isAfter(current)) || (!isNext && current.isAfter(newBlock)))) {\n            this.currentBlock = newBlock;\n            return this.currentBlock;\n        }\n        return null;\n    };\n    Object.defineProperty(ContentTraverser.prototype, \"currentInlineElement\", {\n        /**\n         * Current inline element getter\n         */\n        get: function () {\n            // Retrieve a start inline from scoper\n            if (!this.currentInline) {\n                this.currentInline = this.scoper.getStartInlineElement();\n            }\n            return this.currentInline instanceof EmptyInlineElement ? null : this.currentInline;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Get next inline element\n     */\n    ContentTraverser.prototype.getNextInlineElement = function () {\n        return this.getPreviousNextInlineElement(true /*isNext*/);\n    };\n    /**\n     * Get previous inline element\n     */\n    ContentTraverser.prototype.getPreviousInlineElement = function () {\n        return this.getPreviousNextInlineElement(false /*isNext*/);\n    };\n    ContentTraverser.prototype.getPreviousNextInlineElement = function (isNext) {\n        var current = this.currentInlineElement || this.currentInline;\n        var newInline;\n        if (!current) {\n            return null;\n        }\n        if (current instanceof EmptyInlineElement) {\n            newInline = getInlineElementBeforeAfter(this.scoper.rootNode, current.getStartPosition(), isNext);\n            if (newInline && !current.getParentBlock().contains(newInline.getContainerNode())) {\n                newInline = null;\n            }\n        }\n        else {\n            newInline = getNextPreviousInlineElement(this.scoper.rootNode, current, isNext);\n            newInline =\n                newInline &&\n                    current &&\n                    ((isNext && newInline.isAfter(current)) || (!isNext && current.isAfter(newInline)))\n                    ? newInline\n                    : null;\n        }\n        // For inline, we need to make sure:\n        // 1) it is really next/previous to current\n        // 2) pass on the new inline to this.scoper to do the trimming and we still get back an inline\n        // Then\n        // 1) re-position current inline\n        if (newInline && (newInline = this.scoper.trimInlineElement(newInline))) {\n            this.currentInline = newInline;\n            return this.currentInline;\n        }\n        return null;\n    };\n    return ContentTraverser;\n}());\nexport default ContentTraverser;\nfunction getNextPreviousInlineElement(rootNode, current, isNext) {\n    if (!current) {\n        return null;\n    }\n    if (current instanceof PartialInlineElement) {\n        // if current is partial, get the other half of the inline unless it is no more\n        var result = isNext ? current.nextInlineElement : current.previousInlineElement;\n        if (result) {\n            return result;\n        }\n    }\n    // Get a leaf node after startNode and use that base to find next inline\n    var startNode = current.getContainerNode();\n    startNode = getLeafSibling(rootNode, startNode, isNext);\n    return getInlineElementAtNode(rootNode, startNode);\n}\n//# sourceMappingURL=ContentTraverser.js.map","import ContentTraverser from './ContentTraverser';\nimport createRange from '../selection/createRange';\n// White space matching regex. It matches following chars:\n// \\s: white space\n// \\u00A0: no-breaking white space\n// \\u200B: zero width space\n// \\u3000: full width space (which can come from JPN IME)\nvar WHITESPACE_REGEX = /[\\s\\u00A0\\u200B\\u3000]+([^\\s\\u00A0\\u200B\\u3000]*)$/i;\n/**\n * The class that helps search content around a position\n */\nvar PositionContentSearcher = /** @class */ (function () {\n    /**\n     * Create a new CursorData instance\n     * @param rootNode Root node of the whole scope\n     * @param position Start position\n     */\n    function PositionContentSearcher(rootNode, position) {\n        this.rootNode = rootNode;\n        this.position = position;\n        // The cached text before position that has been read so far\n        this.text = '';\n        // The cached word before position\n        this.word = '';\n        // The inline element before position\n        this.inlineBefore = null;\n        // The inline element after position\n        this.inlineAfter = null;\n        // The content traverser used to traverse backwards\n        this.traverser = null;\n        // Backward parsing has completed\n        this.traversingComplete = false;\n        // All inline elements before position that have been read so far\n        this.inlineElements = [];\n        // First non-text inline before position\n        this.nearestNonTextInlineElement = null;\n    }\n    /**\n     * Get the word before position. The word is determined by scanning backwards till the first white space, the portion\n     * between position and the white space is the word before position\n     * @returns The word before position\n     */\n    PositionContentSearcher.prototype.getWordBefore = function () {\n        var _this = this;\n        if (!this.word) {\n            this.traverse(function () { return _this.word; });\n        }\n        return this.word || '';\n    };\n    /**\n     * Get the inline element before position\n     * @returns The inlineElement before position\n     */\n    PositionContentSearcher.prototype.getInlineElementBefore = function () {\n        if (!this.inlineBefore) {\n            this.traverse(null);\n        }\n        return this.inlineBefore;\n    };\n    /**\n     * Get the inline element after position\n     * @returns The inline element after position\n     */\n    PositionContentSearcher.prototype.getInlineElementAfter = function () {\n        if (!this.inlineAfter) {\n            this.inlineAfter = ContentTraverser.createBlockTraverser(this.rootNode, this.position).currentInlineElement;\n        }\n        return this.inlineAfter;\n    };\n    /**\n     * Get X number of chars before position\n     * The actual returned chars may be less than what is requested.\n     * @param length The length of string user want to get, the string always ends at the position,\n     * so this length determines the start position of the string\n     * @returns The actual string we get as a sub string, or the whole string before position when\n     * there is not enough chars in the string\n     */\n    PositionContentSearcher.prototype.getSubStringBefore = function (length) {\n        var _this = this;\n        if (this.text.length < length) {\n            this.traverse(function () { return _this.text.length >= length; });\n        }\n        return this.text.substr(Math.max(0, this.text.length - length));\n    };\n    /**\n     * Try to get a range matches the given text before the position\n     * @param text The text to match against\n     * @param exactMatch Whether it is an exact match\n     * @returns The range for the matched text, null if unable to find a match\n     */\n    PositionContentSearcher.prototype.getRangeFromText = function (text, exactMatch) {\n        if (!text) {\n            return null;\n        }\n        var startPosition = null;\n        var endPosition = null;\n        var textIndex = text.length - 1;\n        this.forEachTextInlineElement(function (textInline) {\n            var nodeContent = textInline.getTextContent() || '';\n            var nodeIndex = nodeContent.length - 1;\n            for (; nodeIndex >= 0 && textIndex >= 0; nodeIndex--) {\n                if (text.charCodeAt(textIndex) == nodeContent.charCodeAt(nodeIndex)) {\n                    textIndex--;\n                    // on first time when end is matched, set the end of range\n                    if (!endPosition) {\n                        endPosition = textInline.getStartPosition().move(nodeIndex + 1);\n                    }\n                }\n                else if (exactMatch || endPosition) {\n                    // Mismatch found when exact match or end already match, so return since matching failed\n                    return true;\n                }\n            }\n            // when textIndex == -1, we have a successful complete match\n            if (textIndex == -1) {\n                startPosition = textInline.getStartPosition().move(nodeIndex + 1);\n                return true;\n            }\n            return false;\n        });\n        return startPosition && endPosition && createRange(startPosition, endPosition);\n    };\n    /**\n     * Get text section before position till stop condition is met.\n     * This offers consumers to retrieve text section by section\n     * The section essentially is just an inline element which has Container element\n     * so that the consumer can remember it for anchoring popup or verification purpose\n     * when position moves out of context etc.\n     * @param stopFunc The callback stop function\n     */\n    PositionContentSearcher.prototype.forEachTextInlineElement = function (callback) {\n        // We cache all text sections read so far\n        // Every time when you ask for textSection, we start with the cached first\n        // and resort to further reading once we exhausted with the cache\n        if (!this.inlineElements.some(callback)) {\n            this.traverse(callback);\n        }\n    };\n    /**\n     * Get first non textual inline element before position\n     * @returns First non textual inline element before position or null if no such element exists\n     */\n    PositionContentSearcher.prototype.getNearestNonTextInlineElement = function () {\n        var _this = this;\n        if (!this.nearestNonTextInlineElement) {\n            this.traverse(function () { return _this.nearestNonTextInlineElement; });\n        }\n        return this.nearestNonTextInlineElement;\n    };\n    /**\n     * Continue traversing backward till stop condition is met or begin of block is reached\n     */\n    PositionContentSearcher.prototype.traverse = function (callback) {\n        this.traverser =\n            this.traverser || ContentTraverser.createBlockTraverser(this.rootNode, this.position);\n        if (!this.traverser || this.traversingComplete) {\n            return;\n        }\n        var previousInline = this.traverser.getPreviousInlineElement();\n        while (!this.traversingComplete) {\n            this.inlineBefore = this.inlineBefore || previousInline;\n            if (previousInline && previousInline.isTextualInlineElement()) {\n                var textContent = previousInline.getTextContent();\n                // build the word before position if it is not built yet\n                if (!this.word) {\n                    // Match on the white space, the portion after space is on the index of 1 of the matched result\n                    // (index at 0 is whole match result, index at 1 is the word)\n                    var matches = WHITESPACE_REGEX.exec(textContent);\n                    if (matches && matches.length == 2) {\n                        this.word = matches[1] + this.text;\n                    }\n                }\n                this.text = textContent + this.text;\n                this.inlineElements.push(previousInline);\n                // Check if stop condition is met\n                if (callback && callback(previousInline)) {\n                    break;\n                }\n            }\n            else {\n                this.nearestNonTextInlineElement = previousInline;\n                this.traversingComplete = true;\n                if (!this.word) {\n                    // if parsing is done, whatever we get so far in this.cachedText should also be in this.cachedWordBeforeCursor\n                    this.word = this.text;\n                }\n                // When a non-textual inline element, or null is seen, we consider parsing complete\n                // TODO: we may need to change this if there is a future need to parse beyond text, i.e.\n                // we have aaa @someone bbb<position>, and we want to read the text before @someone\n                break;\n            }\n            previousInline = this.traverser.getPreviousInlineElement();\n        }\n    };\n    return PositionContentSearcher;\n}());\nexport default PositionContentSearcher;\n//# sourceMappingURL=PositionContentSearcher.js.map","import safeInstanceOf from '../utils/safeInstanceOf';\nvar ZERO_WIDTH_SPACE = '\\u200B';\n/**\n * Retrieves Delimiter information from a provided element.\n * @param element element to try to retrieve a delimiter\n * @returns delimiter info if it is a Delimiter, else null\n */\nexport default function getDelimiterFromElement(element) {\n    if (!element) {\n        return null;\n    }\n    if (safeInstanceOf(element, 'HTMLSpanElement') &&\n        (element.classList.contains(\"entityDelimiterAfter\" /* DELIMITER_AFTER */) ||\n            element.classList.contains(\"entityDelimiterBefore\" /* DELIMITER_BEFORE */)) &&\n        element.textContent === ZERO_WIDTH_SPACE) {\n        return element;\n    }\n    return null;\n}\n//# sourceMappingURL=getDelimiterFromElement.js.map","import { __read } from \"tslib\";\nimport createElement from '../utils/createElement';\nimport getDelimiterFromElement from './getDelimiterFromElement';\nvar ZERO_WIDTH_SPACE = '\\u200B';\n/**\n * Adds delimiters to the element provided. If the delimiters already exists, will not be added\n * @param node the node to add the delimiters\n */\nexport default function addDelimiters(node) {\n    var _a = __read(getDelimiters(node), 2), delimiterAfter = _a[0], delimiterBefore = _a[1];\n    if (!delimiterAfter) {\n        delimiterAfter = addDelimiterAfter(node);\n    }\n    if (!delimiterBefore) {\n        delimiterBefore = addDelimiterBefore(node);\n    }\n    return [delimiterAfter, delimiterBefore];\n}\n/**\n * Adds delimiter after the element provided.\n * @param element element to use\n */\nexport function addDelimiterAfter(element) {\n    return insertDelimiter(element, \"entityDelimiterAfter\" /* DELIMITER_AFTER */);\n}\n/**\n * Adds delimiter before the element provided.\n * @param element element to use\n */\nexport function addDelimiterBefore(element) {\n    return insertDelimiter(element, \"entityDelimiterBefore\" /* DELIMITER_BEFORE */);\n}\nfunction getDelimiters(entityWrapper) {\n    var result = [];\n    var nextElementSibling = entityWrapper.nextElementSibling, previousElementSibling = entityWrapper.previousElementSibling;\n    result.push(isDelimiter(nextElementSibling, \"entityDelimiterAfter\" /* DELIMITER_AFTER */), isDelimiter(previousElementSibling, \"entityDelimiterBefore\" /* DELIMITER_BEFORE */));\n    return result;\n}\nfunction isDelimiter(el, className) {\n    return el && getDelimiterFromElement(el) && el.classList.contains(className) ? el : undefined;\n}\nfunction insertDelimiter(element, delimiterClass) {\n    var span = createElement({\n        tag: 'span',\n        className: delimiterClass,\n        children: [ZERO_WIDTH_SPACE],\n    }, element.ownerDocument);\n    if (span) {\n        var insertPosition = delimiterClass == \"entityDelimiterAfter\" /* DELIMITER_AFTER */ ? 'afterend' : 'beforebegin';\n        element.insertAdjacentElement(insertPosition, span);\n    }\n    return span;\n}\n//# sourceMappingURL=addDelimiters.js.map","var _a;\nimport readFile from '../utils/readFile';\nimport { Browser } from '../utils/Browser';\n// HTML header to indicate where is the HTML content started from.\n// Sample header:\n// Version:0.9\n// StartHTML:71\n// EndHTML:170\n// StartFragment:140\n// EndFragment:160\n// StartSelection:140\n// EndSelection:160\nvar CLIPBOARD_HTML_HEADER_REGEX = /^Version:[0-9\\.]+\\s+StartHTML:\\s*([0-9]+)\\s+EndHTML:\\s*([0-9]+)\\s+/i;\nvar OTHER_TEXT_TYPE = \"text/\" /* Text */ + '*';\nvar EDGE_LINK_PREVIEW = 'link-preview';\nvar ContentHandlers = (_a = {},\n    _a[\"text/html\" /* HTML */] = function (data, value) {\n        return (data.rawHtml = Browser.isEdge ? workaroundForEdge(value) : value);\n    },\n    _a[\"text/plain\" /* PlainText */] = function (data, value) { return (data.text = value); },\n    _a[OTHER_TEXT_TYPE] = function (data, value, type) { return !!type && (data.customValues[type] = value); },\n    _a[\"text/\" /* Text */ + EDGE_LINK_PREVIEW] = tryParseLinkPreview,\n    _a);\n/**\n * Extract clipboard items to be a ClipboardData object for IE\n * @param items The clipboard items retrieve from a DataTransfer object\n * @param callback Callback function when data is ready\n * @returns An object with the following properties:\n *  types: Available types from the clipboard event\n *  text: Plain text from the clipboard event\n *  image: Image file from the clipboard event\n *  html: Html string from the clipboard event. When set to null, it means there's no HTML found from the event.\n *   When set to undefined, it means can't retrieve HTML string, there may be HTML string but direct retrieving is\n *   not supported by browser.\n */\nexport default function extractClipboardItems(items, options, pasteNativeEvent) {\n    var data = {\n        types: [],\n        text: '',\n        image: null,\n        files: [],\n        rawHtml: null,\n        customValues: {},\n        pasteNativeEvent: pasteNativeEvent,\n    };\n    return Promise.all((items || []).map(function (item) {\n        var type = item.type;\n        if (type.indexOf(\"image/\" /* Image */) == 0 && !data.image && item.kind == 'file') {\n            data.types.push(type);\n            data.image = item.getAsFile();\n            return new Promise(function (resolve) {\n                if (data.image) {\n                    readFile(data.image, function (dataUrl) {\n                        data.imageDataUri = dataUrl;\n                        resolve();\n                    });\n                }\n                else {\n                    resolve();\n                }\n            });\n        }\n        else if (item.kind == 'file') {\n            return new Promise(function (resolve) {\n                var file = item.getAsFile();\n                if (!!file) {\n                    data.types.push(type);\n                    data.files.push(file);\n                }\n                resolve();\n            });\n        }\n        else {\n            var customType_1 = getAllowedCustomType(type, options === null || options === void 0 ? void 0 : options.allowedCustomPasteType);\n            var handler_1 = ContentHandlers[type] || (customType_1 ? ContentHandlers[OTHER_TEXT_TYPE] : null);\n            return new Promise(function (resolve) {\n                return handler_1\n                    ? item.getAsString(function (value) {\n                        data.types.push(type);\n                        handler_1(data, value, customType_1);\n                        resolve();\n                    })\n                    : resolve();\n            });\n        }\n    })).then(function () { return data; });\n}\n/**\n * Edge sometimes doesn't remove the headers, which cause we paste more things then expected.\n * So we need to remove it in our code\n * @param html The HTML string got from clipboard\n */\nfunction workaroundForEdge(html) {\n    var headerValues = CLIPBOARD_HTML_HEADER_REGEX.exec(html);\n    if ((headerValues === null || headerValues === void 0 ? void 0 : headerValues.length) == 3) {\n        var start = parseInt(headerValues[1]);\n        var end = parseInt(headerValues[2]);\n        if (start > 0 && end > start) {\n            html = html.substring(start, end);\n        }\n    }\n    return html;\n}\nfunction tryParseLinkPreview(data, value) {\n    try {\n        data.customValues[EDGE_LINK_PREVIEW] = value;\n        data.linkPreview = JSON.parse(value);\n    }\n    catch (_a) { }\n}\nfunction getAllowedCustomType(type, allowedCustomPasteType) {\n    var textType = type.indexOf(\"text/\" /* Text */) == 0\n        ? type.substring(\"text/\" /* Text */.length)\n        : null;\n    var index = allowedCustomPasteType && textType ? allowedCustomPasteType.indexOf(textType) : -1;\n    return textType && index >= 0 ? textType : undefined;\n}\n//# sourceMappingURL=extractClipboardItems.js.map","/**\n * Read a file object and invoke a callback function with the data url of this file\n * @param file The file to read\n * @param callback the callback to invoke with data url of the file.\n * If fail to read, dataUrl will be null\n */\nexport default function readFile(file, callback) {\n    if (file) {\n        var reader_1 = new FileReader();\n        reader_1.onload = function () {\n            callback(reader_1.result);\n        };\n        reader_1.onerror = function () {\n            callback(null);\n        };\n        reader_1.readAsDataURL(file);\n    }\n}\n//# sourceMappingURL=readFile.js.map","import extractClipboardItems from './extractClipboardItems';\nimport extractClipboardItemsForIE from './extractClipboardItemsForIE';\nimport toArray from '../jsUtils/toArray';\nimport { Browser } from '../utils/Browser';\n/**\n * @deprecated Use extractClipboardItems and extractClipboardItemsForIE instead\n * Extract a Clipboard event\n * @param event The paste event\n * @param callback Callback function when data is ready\n * @param options Options to retrieve more items from the event, including HTML string and other customized items\n * @param rangeBeforePaste Optional range to be removed when pasting in Android\n * @returns An object with the following properties:\n *  types: Available types from the clipboard event\n *  text: Plain text from the clipboard event\n *  image: Image file from the clipboard event\n *  html: Html string from the clipboard event. When set to null, it means there's no HTML found from the event.\n *   When set to undefined, it means can't retrieve HTML string, there may be HTML string but direct retrieving is\n *   not supported by browser.\n */\nexport default function extractClipboardEvent(event, callback, options, rangeBeforePaste) {\n    var _a;\n    var dataTransfer = event.clipboardData ||\n        ((_a = event.target.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView).clipboardData;\n    if (dataTransfer.items) {\n        event.preventDefault();\n        extractClipboardItems(toArray(dataTransfer.items), options, true /** pasteNativeEvent */).then(function (clipboardData) {\n            removeContents(rangeBeforePaste);\n            callback(clipboardData);\n        });\n    }\n    else {\n        extractClipboardItemsForIE(dataTransfer, callback, options);\n    }\n}\nfunction removeContents(range) {\n    if (Browser.isAndroid && range) {\n        range.deleteContents();\n    }\n}\n//# sourceMappingURL=extractClipboardEvent.js.map","import readFile from '../utils/readFile';\nimport toArray from '../jsUtils/toArray';\n/**\n * Extract clipboard items to be a ClipboardData object for IE\n * @param dataTransfer The clipboard items retrieve from a DataTransfer object\n * @param callback Callback function when data is ready\n * @returns An object with the following properties:\n *  types: Available types from the clipboard event\n *  text: Plain text from the clipboard event\n *  image: Image file from the clipboard event\n *  html: Html string from the clipboard event. When set to null, it means there's no HTML found from the event.\n *   When set to undefined, it means can't retrieve HTML string, there may be HTML string but direct retrieving is\n *   not supported by browser.\n */\nexport default function extractClipboardItemsForIE(dataTransfer, callback, options) {\n    var _a, _b, _c;\n    var clipboardData = {\n        types: dataTransfer.types ? toArray(dataTransfer.types) : [],\n        text: dataTransfer.getData('text'),\n        image: null,\n        files: [],\n        rawHtml: null,\n        customValues: {},\n        pasteNativeEvent: true,\n    };\n    for (var i = 0; i < (dataTransfer.files ? dataTransfer.files.length : 0); i++) {\n        var file = dataTransfer.files.item(i);\n        if (((_a = file === null || file === void 0 ? void 0 : file.type) === null || _a === void 0 ? void 0 : _a.indexOf(\"image/\" /* Image */)) == 0) {\n            clipboardData.image = file;\n            break;\n        }\n    }\n    var nextStep = function () {\n        if (clipboardData.image) {\n            readFile(clipboardData.image, function (dataUrl) {\n                clipboardData.imageDataUri = dataUrl;\n                callback(clipboardData);\n            });\n        }\n        else {\n            callback(clipboardData);\n        }\n    };\n    if ((options === null || options === void 0 ? void 0 : options.getTempDiv) && (options === null || options === void 0 ? void 0 : options.removeTempDiv)) {\n        var div_1 = options.getTempDiv();\n        div_1.contentEditable = 'true';\n        div_1.innerHTML = '';\n        div_1.focus();\n        (_c = (_b = div_1.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView) === null || _c === void 0 ? void 0 : _c.setTimeout(function () {\n            var _a;\n            clipboardData.rawHtml = div_1.innerHTML;\n            (_a = options.removeTempDiv) === null || _a === void 0 ? void 0 : _a.call(options, div_1);\n            nextStep();\n        }, 0);\n    }\n    else {\n        clipboardData.rawHtml = undefined;\n        nextStep();\n    }\n}\n//# sourceMappingURL=extractClipboardItemsForIE.js.map","import wrap from '../utils/wrap';\nvar NBSP_HTML = '\\u00A0';\nvar ENSP_HTML = '\\u2002';\nvar TAB_SPACES = 6;\n/**\n * handle the content when using the text only option\n * @param text Text from clipboard\n * @param position current position of the clipboard\n * @param fragment fragment that contains the paste content.\n */\nexport default function handleTextPaste(text, position, fragment) {\n    var document = fragment.ownerDocument;\n    text.split('\\n').forEach(function (line, index, lines) {\n        line = line\n            .replace(/^ /g, NBSP_HTML)\n            .replace(/\\r/g, '')\n            .replace(/ {2}/g, ' ' + NBSP_HTML);\n        if (line.includes('\\t')) {\n            line = transformTabCharacters(line, index === 0 ? position === null || position === void 0 ? void 0 : position.offset : 0);\n        }\n        var textNode = document.createTextNode(line);\n        // There are 3 scenarios:\n        // 1. Single line: Paste as it is\n        // 2. Two lines: Add <br> between the lines\n        // 3. 3 or More lines, For first and last line, paste as it is. For middle lines, wrap with DIV, and add BR if it is empty line\n        if (lines.length == 2 && index == 0) {\n            // 1 of 2 lines scenario, add BR\n            fragment.appendChild(textNode);\n            fragment.appendChild(document.createElement('br'));\n        }\n        else if (index > 0 && index < lines.length - 1) {\n            // Middle line of >=3 lines scenario, wrap with DIV\n            fragment.appendChild(wrap(line == '' ? document.createElement('br') : textNode));\n        }\n        else {\n            // All others, paste as it is\n            fragment.appendChild(textNode);\n        }\n    });\n}\n/**\n * @internal\n * Transform \\t characters into EN SPACE characters\n * @param input string NOT containing \\n characters\n * @example t(\"\\thello\", 2) => \"&ensp;&ensp;&ensp;&ensp;hello\"\n */\nexport function transformTabCharacters(input, initialOffset) {\n    if (initialOffset === void 0) { initialOffset = 0; }\n    var line = input;\n    var tIndex;\n    while ((tIndex = line.indexOf('\\t')) != -1) {\n        var lineBefore = line.slice(0, tIndex);\n        var lineAfter = line.slice(tIndex + 1);\n        var tabCount = TAB_SPACES - ((lineBefore.length + initialOffset) % TAB_SPACES);\n        var tabStr = Array(tabCount).fill(ENSP_HTML).join('');\n        line = lineBefore + tabStr + lineAfter;\n    }\n    return line;\n}\n//# sourceMappingURL=handleTextPaste.js.map","import getTagOfNode from '../utils/getTagOfNode';\nimport toArray from '../jsUtils/toArray';\nvar START_FRAGMENT = '<!--StartFragment-->';\nvar END_FRAGMENT = '<!--EndFragment-->';\n/**\n * Retrieves the metadata from the content inside of the clipboard\n * @param doc Document parsed from the clipboard\n * @param event Before Paste event\n * @param trustedHTMLHandler the trusted html handler to sanitize the content.\n */\nexport default function retrieveMetadataFromClipboard(doc, event, trustedHTMLHandler) {\n    var _a, _b;\n    var clipboardData = event.clipboardData, sanitizingOption = event.sanitizingOption;\n    var rawHtml = clipboardData.rawHtml;\n    if (rawHtml && (doc === null || doc === void 0 ? void 0 : doc.body)) {\n        var attributes = (_a = doc.querySelector('html')) === null || _a === void 0 ? void 0 : _a.attributes;\n        (attributes ? toArray(attributes) : []).reduce(function (attrs, attr) {\n            attrs[attr.name] = attr.value;\n            return attrs;\n        }, event.htmlAttributes);\n        toArray(doc.querySelectorAll('meta')).reduce(function (attrs, meta) {\n            attrs[meta.name] = meta.content;\n            return attrs;\n        }, event.htmlAttributes);\n        clipboardData.htmlFirstLevelChildTags = [];\n        doc === null || doc === void 0 ? void 0 : doc.body.normalize();\n        for (var i = 0; i < (doc === null || doc === void 0 ? void 0 : doc.body.childNodes.length); i++) {\n            var node = doc === null || doc === void 0 ? void 0 : doc.body.childNodes.item(i);\n            if (node.nodeType == Node.TEXT_NODE) {\n                var trimmedString = (_b = node.nodeValue) === null || _b === void 0 ? void 0 : _b.replace(/(\\r\\n|\\r|\\n)/gm, '').trim();\n                if (!trimmedString) {\n                    continue;\n                }\n            }\n            var nodeTag = getTagOfNode(node);\n            if (node.nodeType != Node.COMMENT_NODE) {\n                clipboardData.htmlFirstLevelChildTags.push(nodeTag);\n            }\n        }\n        // Move all STYLE nodes into header, and save them into sanitizing options.\n        // Because if we directly move them into a fragment, all sheets under STYLE will be lost.\n        processStyles(doc, function (style) {\n            doc === null || doc === void 0 ? void 0 : doc.head.appendChild(style);\n            sanitizingOption.additionalGlobalStyleNodes.push(style);\n        });\n        var startIndex = rawHtml.indexOf(START_FRAGMENT);\n        var endIndex = rawHtml.lastIndexOf(END_FRAGMENT);\n        if (startIndex >= 0 && endIndex >= startIndex + START_FRAGMENT.length) {\n            event.htmlBefore = rawHtml.substr(0, startIndex);\n            event.htmlAfter = rawHtml.substr(endIndex + END_FRAGMENT.length);\n            clipboardData.html = rawHtml.substring(startIndex + START_FRAGMENT.length, endIndex);\n            doc.body.innerHTML = trustedHTMLHandler(clipboardData.html);\n            // Remove style nodes just added by setting innerHTML of body since we already have all\n            // style nodes in header.\n            // Here we use doc.body instead of doc because we only want to remove STYLE nodes under BODY\n            // and the nodes under HEAD are still used when convert global CSS to inline\n            processStyles(doc.body, function (style) { var _a; return (_a = style.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(style); });\n        }\n    }\n}\nfunction processStyles(node, callback) {\n    toArray(node.querySelectorAll('style')).forEach(callback);\n}\n//# sourceMappingURL=retrieveMetadataFromClipboard.js.map","// Inheritable CSS properties\n// Ref: https://www.w3.org/TR/CSS21/propidx.html\nvar INHERITABLE_PROPERTIES = ('border-spacing,caption-side,color,' +\n    'cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,' +\n    'font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,' +\n    'list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,' +\n    'widows,word-spacing').split(',');\n/**\n * Get inheritable CSS style values from the given element\n * @param element The element to get style from\n */\nexport default function getInheritableStyles(element) {\n    var win = element && element.ownerDocument && element.ownerDocument.defaultView;\n    var styles = win && element && win.getComputedStyle(element);\n    var result = {};\n    INHERITABLE_PROPERTIES.forEach(function (name) { return (result[name] = (styles && styles.getPropertyValue(name)) || ''); });\n    return result;\n}\n//# sourceMappingURL=getInheritableStyles.js.map","/**\n * Replace all child nodes of the given target node to the child nodes of source node.\n * @param target Target node, all child nodes of this node will be removed if keepExistingChildren is not set to true\n * @param source (Optional) source node, all child nodes of this node will be move to target node\n * @param keepExistingChildren (Optional) When set to true, all existing child nodes of target will be kept\n */\nexport default function moveChildNodes(target, source, keepExistingChildren) {\n    if (!target) {\n        return;\n    }\n    while (!keepExistingChildren && target.firstChild) {\n        target.removeChild(target.firstChild);\n    }\n    while (source === null || source === void 0 ? void 0 : source.firstChild) {\n        target.appendChild(source.firstChild);\n    }\n}\n//# sourceMappingURL=moveChildNodes.js.map","import { __read } from \"tslib\";\nimport getComputedStyles from './getComputedStyles';\nimport getTagOfNode from './getTagOfNode';\nimport moveChildNodes from './moveChildNodes';\nexport default function changeElementTag(element, newTag) {\n    var _a;\n    if (!element || !newTag) {\n        return null;\n    }\n    var origianlTag = getTagOfNode(element);\n    if (origianlTag == newTag.toUpperCase()) {\n        // Already in the target tag, no need to change\n        return element;\n    }\n    var newElement = element.ownerDocument.createElement(newTag);\n    for (var i = 0; i < element.attributes.length; i++) {\n        var attr = element.attributes[i];\n        newElement.setAttribute(attr.name, attr.value);\n    }\n    moveChildNodes(newElement, element);\n    if (origianlTag == 'P' || getTagOfNode(newElement) == 'P') {\n        _a = __read(getComputedStyles(element, [\n            'margin-top',\n            'margin-bottom',\n        ]), 2), newElement.style.marginTop = _a[0], newElement.style.marginBottom = _a[1];\n    }\n    if (element.parentNode) {\n        element.parentNode.replaceChild(newElement, element);\n    }\n    return newElement;\n}\n//# sourceMappingURL=changeElementTag.js.map","import getTagOfNode from '../utils/getTagOfNode';\nvar PREDEFINED_CSS_FOR_ELEMENT = {\n    B: {\n        'font-weight': 'bold',\n    },\n    EM: {\n        'font-style': 'italic',\n    },\n    I: {\n        'font-style': 'italic',\n    },\n    U: {\n        'text-decoration': 'underline',\n    },\n    P: {\n        'margin-top': '1em',\n        'margin-bottom': '1em',\n    },\n    PRE: {\n        'white-space': 'pre',\n    },\n    S: {\n        'text-decoration': 'line-through',\n    },\n    STRIKE: {\n        'text-decoration': 'line-through',\n    },\n    SUB: {\n        'vertical-align': 'sub',\n        'font-size': 'smaller',\n    },\n    SUP: {\n        'vertical-align': 'super',\n        'font-size': 'smaller',\n    },\n};\n/**\n * @internal\n * Get a map for browser built-in CSS definitions of elements\n */\nexport default function getPredefinedCssForElement(element, additionalPredefinedCssForElement) {\n    var tag = getTagOfNode(element);\n    return PREDEFINED_CSS_FOR_ELEMENT[tag] || (additionalPredefinedCssForElement || {})[tag];\n}\n//# sourceMappingURL=getPredefinedCssForElement.js.map","/**\n * Get CSS styles of a given element in name-value pair format\n * @param element The element to get styles from\n */\nexport default function getStyles(element) {\n    var result = {};\n    var style = (element === null || element === void 0 ? void 0 : element.getAttribute('style')) || '';\n    style.split(';').forEach(function (pair) {\n        var valueIndex = pair.indexOf(':');\n        var name = pair.slice(0, valueIndex);\n        var value = pair.slice(valueIndex + 1);\n        if (name && value) {\n            result[name.trim()] = value.trim();\n        }\n    });\n    return result;\n}\n//# sourceMappingURL=getStyles.js.map","import getObjectKeys from '../jsUtils/getObjectKeys';\n/**\n * Set styles to an HTML element. If styles are empty, remove 'style' attribute\n * @param element The element to set styles\n * @param styles The styles to set, in name-value pair format\n */\nexport default function setStyles(element, styles) {\n    if (element) {\n        var style = getObjectKeys(styles || {})\n            .map(function (name) {\n            var value = styles[name];\n            var trimmedName = name ? name.trim() : null;\n            var trimmedValue = value ? value.trim() : null;\n            return trimmedName && trimmedValue ? trimmedName + \":\" + trimmedValue : null;\n        })\n            .filter(function (x) { return x; })\n            .join(';');\n        if (style) {\n            element.setAttribute('style', style);\n        }\n        else {\n            element.removeAttribute('style');\n        }\n    }\n}\n//# sourceMappingURL=setStyles.js.map","import { __values } from \"tslib\";\nimport getObjectKeys from '../jsUtils/getObjectKeys';\nfunction nativeClone(source, existingObj) {\n    return Object.assign(existingObj || {}, source);\n}\nfunction customClone(source, existingObj) {\n    var e_1, _a;\n    var result = existingObj || {};\n    if (source) {\n        try {\n            for (var _b = __values(getObjectKeys(source)), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var key = _c.value;\n                result[key] = source[key];\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    return result;\n}\n// @ts-ignore Ignore this error for IE compatibility\nvar cloneObjectImpl = Object.assign ? nativeClone : customClone;\n/**\n * @internal\n */\nexport function cloneObject(source, existingObj) {\n    return cloneObjectImpl(source, existingObj);\n}\n//# sourceMappingURL=cloneObject.js.map","var VARIABLE_REGEX = /^\\s*var\\(\\s*[a-zA-Z0-9-_]+\\s*(,\\s*(.*))?\\)\\s*$/;\nvar VARIABLE_PREFIX = 'var(';\n/**\n * @internal\n * Handle CSS variable format. e.g.: var(--name, fallbackValue)\n */\nexport function processCssVariable(value) {\n    var match = VARIABLE_REGEX.exec(value);\n    return (match === null || match === void 0 ? void 0 : match[2]) || ''; // Without fallback value, we don't know what does the original value mean, so ignore it\n}\n/**\n * @internal\n */\nexport function isCssVariable(value) {\n    return value.indexOf(VARIABLE_PREFIX) == 0;\n}\n//# sourceMappingURL=processCssVariable.js.map","import { __assign } from \"tslib\";\nimport getObjectKeys from '../jsUtils/getObjectKeys';\nimport { cloneObject } from './cloneObject';\nvar HTML_TAG_REPLACEMENT = {\n    // Allowed tags\n    a: '*',\n    abbr: '*',\n    address: '*',\n    area: '*',\n    article: '*',\n    aside: '*',\n    b: '*',\n    bdi: '*',\n    bdo: '*',\n    blockquote: '*',\n    body: '*',\n    br: '*',\n    button: '*',\n    canvas: '*',\n    caption: '*',\n    center: '*',\n    cite: '*',\n    code: '*',\n    col: '*',\n    colgroup: '*',\n    data: '*',\n    datalist: '*',\n    dd: '*',\n    del: '*',\n    details: '*',\n    dfn: '*',\n    dialog: '*',\n    dir: '*',\n    div: '*',\n    dl: '*',\n    dt: '*',\n    em: '*',\n    fieldset: '*',\n    figcaption: '*',\n    figure: '*',\n    font: '*',\n    footer: '*',\n    h1: '*',\n    h2: '*',\n    h3: '*',\n    h4: '*',\n    h5: '*',\n    h6: '*',\n    head: '*',\n    header: '*',\n    hgroup: '*',\n    hr: '*',\n    html: '*',\n    i: '*',\n    img: '*',\n    input: '*',\n    ins: '*',\n    kbd: '*',\n    label: '*',\n    legend: '*',\n    li: '*',\n    main: '*',\n    map: '*',\n    mark: '*',\n    menu: '*',\n    menuitem: '*',\n    meter: '*',\n    nav: '*',\n    ol: '*',\n    optgroup: '*',\n    option: '*',\n    output: '*',\n    p: '*',\n    picture: '*',\n    pre: '*',\n    progress: '*',\n    q: '*',\n    rp: '*',\n    rt: '*',\n    ruby: '*',\n    s: '*',\n    samp: '*',\n    section: '*',\n    select: '*',\n    small: '*',\n    span: '*',\n    strike: '*',\n    strong: '*',\n    sub: '*',\n    summary: '*',\n    sup: '*',\n    table: '*',\n    tbody: '*',\n    td: '*',\n    textarea: '*',\n    tfoot: '*',\n    th: '*',\n    thead: '*',\n    time: '*',\n    tr: '*',\n    tt: '*',\n    u: '*',\n    ul: '*',\n    var: '*',\n    wbr: '*',\n    xmp: '*',\n    // Replaced tags:\n    form: 'SPAN',\n    // Disallowed tags\n    applet: null,\n    audio: null,\n    base: null,\n    basefont: null,\n    embed: null,\n    frame: null,\n    frameset: null,\n    iframe: null,\n    link: null,\n    meta: null,\n    noscript: null,\n    object: null,\n    param: null,\n    script: null,\n    slot: null,\n    source: null,\n    style: null,\n    template: null,\n    title: null,\n    track: null,\n    video: null,\n};\nvar ALLOWED_HTML_ATTRIBUTES = ('accept,align,alt,checked,cite,color,cols,colspan,contextmenu,' +\n    'coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,' +\n    'hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,' +\n    'placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,' +\n    'spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,' +\n    'width,wrap,bgColor').split(',');\nvar DEFAULT_STYLE_VALUES = {\n    'background-color': 'transparent',\n    'border-bottom-color': 'rgb(0, 0, 0)',\n    'border-bottom-style': 'none',\n    'border-bottom-width': '0px',\n    'border-image-outset': '0',\n    'border-image-repeat': 'stretch',\n    'border-image-slice': '100%',\n    'border-image-source': 'none',\n    'border-image-width': '1',\n    'border-left-color': 'rgb(0, 0, 0)',\n    'border-left-style': 'none',\n    'border-left-width': '0px',\n    'border-right-color': 'rgb(0, 0, 0)',\n    'border-right-style': 'none',\n    'border-right-width': '0px',\n    'border-top-color': 'rgb(0, 0, 0)',\n    'border-top-style': 'none',\n    'border-top-width': '0px',\n    'outline-color': 'transparent',\n    'outline-style': 'none',\n    'outline-width': '0px',\n    overflow: 'visible',\n    '-webkit-text-stroke-width': '0px',\n    'word-wrap': 'break-word',\n    'margin-left': '0px',\n    'margin-right': '0px',\n    padding: '0px',\n    'padding-top': '0px',\n    'padding-left': '0px',\n    'padding-right': '0px',\n    'padding-bottom': '0px',\n    border: '0px',\n    'border-top': '0px',\n    'border-left': '0px',\n    'border-right': '0px',\n    'border-bottom': '0px',\n    'vertical-align': 'baseline',\n    float: 'none',\n};\n// This is to preserve entity related CSS classes when paste.\nvar ALLOWED_CSS_CLASSES = [];\n/**\n * @internal\n */\nexport function getTagReplacement(additionalReplacements) {\n    var result = __assign({}, HTML_TAG_REPLACEMENT);\n    var replacements = additionalReplacements || {};\n    getObjectKeys(replacements).forEach(function (key) {\n        if (key) {\n            result[key.toLowerCase()] = replacements[key];\n        }\n    });\n    return result;\n}\n/**\n * @internal\n */\nexport function getAllowedAttributes(additionalAttributes) {\n    return unique(ALLOWED_HTML_ATTRIBUTES.concat(additionalAttributes || [])).map(function (attr) {\n        return attr.toLocaleLowerCase();\n    });\n}\n/**\n * @internal\n */\nexport function getAllowedCssClassesRegex(additionalCssClasses) {\n    var patterns = ALLOWED_CSS_CLASSES.concat(additionalCssClasses || []);\n    return patterns.length > 0 ? new RegExp(patterns.join('|')) : null;\n}\n/**\n * @internal\n */\nexport function getDefaultStyleValues(additionalDefaultStyles) {\n    var result = cloneObject(DEFAULT_STYLE_VALUES);\n    if (additionalDefaultStyles) {\n        Object.keys(additionalDefaultStyles).forEach(function (name) {\n            var value = additionalDefaultStyles[name];\n            if (value !== null && value !== undefined) {\n                result[name] = value;\n            }\n            else {\n                delete result[name];\n            }\n        });\n    }\n    return result;\n}\n/**\n * @internal\n */\nexport function getStyleCallbacks(callbacks) {\n    var result = cloneObject(callbacks);\n    result.position = result.position || removeValue;\n    result.width = result.width || removeWidthForLiAndDiv;\n    return result;\n}\nfunction removeValue() {\n    return null;\n}\nfunction removeWidthForLiAndDiv(value, element) {\n    var tag = element.tagName;\n    return !(tag == 'LI' || tag == 'DIV');\n}\nfunction unique(array) {\n    return array.filter(function (value, index, self) { return self.indexOf(value) == index; });\n}\n//# sourceMappingURL=getAllowedValues.js.map","import { __values } from \"tslib\";\nimport changeElementTag from '../utils/changeElementTag';\nimport getInheritableStyles from './getInheritableStyles';\nimport getObjectKeys from '../jsUtils/getObjectKeys';\nimport getPredefinedCssForElement from './getPredefinedCssForElement';\nimport getStyles from '../style/getStyles';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport setStyles from '../style/setStyles';\nimport toArray from '../jsUtils/toArray';\nimport { cloneObject } from './cloneObject';\nimport { isCssVariable, processCssVariable } from './processCssVariable';\nimport { getAllowedAttributes, getAllowedCssClassesRegex, getTagReplacement, getDefaultStyleValues, getStyleCallbacks, } from './getAllowedValues';\n/**\n * HTML sanitizer class provides two features:\n * 1. Convert global CSS to inline CSS\n * 2. Sanitize an HTML document, remove unnecessary/dangerous attribute/nodes\n */\nvar HtmlSanitizer = /** @class */ (function () {\n    /**\n     * Construct a new instance of HtmlSanitizer\n     * @param options Options for HtmlSanitizer\n     */\n    function HtmlSanitizer(options) {\n        options = options || {};\n        this.elementCallbacks = cloneObject(options.elementCallbacks);\n        this.styleCallbacks = getStyleCallbacks(options.cssStyleCallbacks);\n        this.attributeCallbacks = cloneObject(options.attributeCallbacks);\n        this.tagReplacements = getTagReplacement(options.additionalTagReplacements);\n        this.allowedAttributes = getAllowedAttributes(options.additionalAllowedAttributes);\n        this.allowedCssClassesRegex = getAllowedCssClassesRegex(options.additionalAllowedCssClasses);\n        this.defaultStyleValues = getDefaultStyleValues(options.additionalDefaultStyleValues);\n        this.additionalPredefinedCssForElement = options.additionalPredefinedCssForElement || null;\n        this.additionalGlobalStyleNodes = options.additionalGlobalStyleNodes || [];\n        this.preserveHtmlComments = options.preserveHtmlComments || false;\n        this.unknownTagReplacement = options.unknownTagReplacement || null;\n    }\n    /**\n     * @deprecated Use new HtmlSanitizer().convertGlobalCssToInlineCss() instead\n     * Convert global CSS to inline CSS if any\n     * @param html HTML source\n     * @param additionalStyleNodes (Optional) additional HTML STYLE elements used as global CSS\n     */\n    HtmlSanitizer.convertInlineCss = function (html, additionalStyleNodes) {\n        var sanitizer = new HtmlSanitizer({\n            additionalGlobalStyleNodes: additionalStyleNodes,\n        });\n        return sanitizer.exec(html, true /*convertCssOnly*/);\n    };\n    /**\n     * @deprecated Use new HtmlSanitizer().sanitize() instead\n     * Sanitize HTML string, remove any unused HTML node/attribute/CSS.\n     * @param html HTML source string\n     * @param options Options used for this sanitizing process\n     */\n    HtmlSanitizer.sanitizeHtml = function (html, options) {\n        options = options || {};\n        var sanitizer = new HtmlSanitizer(options);\n        var currentStyles = safeInstanceOf(options.currentElementOrStyle, 'HTMLElement')\n            ? getInheritableStyles(options.currentElementOrStyle)\n            : options.currentElementOrStyle;\n        return sanitizer.exec(html, options.convertCssOnly, currentStyles);\n    };\n    /**\n     * @deprecated Use HtmlSanitizer.convertGlobalCssToInlineCss() and HtmlSanitizer.sanitize() instead\n     * Sanitize HTML string\n     * This function will do the following work:\n     * 1. Convert global CSS into inline CSS\n     * 2. Remove dangerous HTML tags and attributes\n     * 3. Remove useless CSS properties\n     * @param html The input HTML\n     * @param convertInlineCssOnly Whether only convert inline css and skip html content sanitizing\n     * @param currentStyles Current inheritable CSS styles\n     */\n    HtmlSanitizer.prototype.exec = function (html, convertCssOnly, currentStyles) {\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(html || '', 'text/html');\n        if (doc && doc.body && doc.body.firstChild) {\n            this.convertGlobalCssToInlineCss(doc);\n            if (!convertCssOnly) {\n                this.sanitize(doc.body, currentStyles);\n            }\n        }\n        return (doc && doc.body && doc.body.innerHTML) || '';\n    };\n    /**\n     * Sanitize an HTML element, remove unnecessary or dangerous elements/attribute/CSS rules\n     * @param rootNode Root node to sanitize\n     * @param currentStyles Current CSS styles. Inheritable styles in the given node which has\n     * the same value with current styles will be ignored.\n     */\n    HtmlSanitizer.prototype.sanitize = function (rootNode, currentStyles) {\n        if (!rootNode) {\n            return '';\n        }\n        currentStyles = cloneObject(currentStyles, getInheritableStyles(null));\n        this.processNode(rootNode, currentStyles, {});\n    };\n    /**\n     * Convert global CSS into inline CSS\n     * @param rootNode The HTML Document\n     */\n    HtmlSanitizer.prototype.convertGlobalCssToInlineCss = function (rootNode) {\n        var e_1, _a;\n        var styleNodes = toArray(rootNode.querySelectorAll('style'));\n        var styleSheets = this.additionalGlobalStyleNodes\n            .reverse()\n            .map(function (node) { return node.sheet; })\n            .concat(styleNodes.map(function (node) { return node.sheet; }).reverse())\n            .filter(function (sheet) { return sheet; });\n        try {\n            for (var styleSheets_1 = __values(styleSheets), styleSheets_1_1 = styleSheets_1.next(); !styleSheets_1_1.done; styleSheets_1_1 = styleSheets_1.next()) {\n                var styleSheet = styleSheets_1_1.value;\n                var _loop_1 = function (j) {\n                    var e_2, _b;\n                    // Skip any none-style rule, i.e. @page\n                    var styleRule = styleSheet.cssRules[j];\n                    var text = styleRule && styleRule.style ? styleRule.style.cssText : null;\n                    if (styleRule.type != CSSRule.STYLE_RULE || !text || !styleRule.selectorText) {\n                        return \"continue\";\n                    }\n                    try {\n                        // Make sure the selector is not empty\n                        for (var _c = (e_2 = void 0, __values(styleRule.selectorText.split(','))), _d = _c.next(); !_d.done; _d = _c.next()) {\n                            var selector = _d.value;\n                            if (!selector || !selector.trim() || selector.indexOf(':') >= 0) {\n                                continue;\n                            }\n                            var nodes = toArray(rootNode.querySelectorAll(selector));\n                            // Always put existing styles after so that they have higher priority\n                            // Which means if both global style and inline style apply to the same element,\n                            // inline style will have higher priority\n                            nodes.forEach(function (node) {\n                                return node.setAttribute('style', text + (node.getAttribute('style') || ''));\n                            });\n                        }\n                    }\n                    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                    finally {\n                        try {\n                            if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\n                        }\n                        finally { if (e_2) throw e_2.error; }\n                    }\n                };\n                for (var j = styleSheet.cssRules.length - 1; j >= 0; j--) {\n                    _loop_1(j);\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (styleSheets_1_1 && !styleSheets_1_1.done && (_a = styleSheets_1.return)) _a.call(styleSheets_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        styleNodes.forEach(function (node) {\n            if (node.parentNode) {\n                node.parentNode.removeChild(node);\n            }\n        });\n    };\n    HtmlSanitizer.prototype.processNode = function (node, currentStyle, context) {\n        var _a;\n        var nodeType = node.nodeType;\n        var isElement = nodeType == 1 /* Element */;\n        var isText = nodeType == 3 /* Text */;\n        var isFragment = nodeType == 11 /* DocumentFragment */;\n        var isComment = nodeType == 8 /* Comment */;\n        var shouldKeep = false;\n        if (isElement) {\n            var tag = getTagOfNode(node);\n            var callback = this.elementCallbacks[tag];\n            var replacement = this.tagReplacements[tag.toLowerCase()];\n            if (replacement === undefined) {\n                replacement = this.unknownTagReplacement;\n            }\n            if (callback) {\n                shouldKeep = callback(node, context);\n            }\n            else if (tag.indexOf(':') > 0) {\n                shouldKeep = true;\n            }\n            else if (tag == replacement || replacement == '*') {\n                shouldKeep = true;\n            }\n            else if (replacement && /^[a-zA-Z][\\w\\-]*$/.test(replacement)) {\n                node = changeElementTag(node, replacement);\n                shouldKeep = true;\n            }\n        }\n        else if (isText) {\n            var whiteSpace = currentStyle['white-space'];\n            shouldKeep =\n                whiteSpace == 'pre' ||\n                    whiteSpace == 'pre-line' ||\n                    whiteSpace == 'pre-wrap' ||\n                    !/^[\\r\\n]*$/g.test(node.nodeValue || '');\n        }\n        else if (isFragment) {\n            shouldKeep = true;\n        }\n        else if (isComment) {\n            shouldKeep = this.preserveHtmlComments;\n        }\n        else {\n            shouldKeep = false;\n        }\n        if (!shouldKeep) {\n            (_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(node);\n        }\n        else if (isText &&\n            (currentStyle['white-space'] == 'pre' || currentStyle['white-space'] == 'pre-wrap')) {\n            node.nodeValue = (node.nodeValue || '')\n                .replace(/^ /gm, '\\u00A0')\n                .replace(/ {2}/g, ' \\u00A0');\n        }\n        else if (isElement || isFragment) {\n            var thisStyle = cloneObject(currentStyle);\n            var element = node;\n            if (isElement) {\n                this.processAttributes(element, context);\n                this.preprocessCss(element, thisStyle);\n                this.processCss(element, thisStyle, context);\n            }\n            var child = element.firstChild;\n            var next = void 0;\n            for (; child; child = next) {\n                next = child.nextSibling;\n                this.processNode(child, thisStyle, context);\n            }\n        }\n    };\n    HtmlSanitizer.prototype.preprocessCss = function (element, thisStyle) {\n        var predefinedStyles = getPredefinedCssForElement(element, this.additionalPredefinedCssForElement);\n        if (predefinedStyles) {\n            getObjectKeys(predefinedStyles).forEach(function (name) {\n                thisStyle[name] = predefinedStyles[name];\n            });\n        }\n    };\n    HtmlSanitizer.prototype.processCss = function (element, thisStyle, context) {\n        var _this = this;\n        var styles = getStyles(element);\n        getObjectKeys(styles).forEach(function (name) {\n            var value = styles[name];\n            var callback = _this.styleCallbacks[name];\n            var isInheritable = thisStyle[name] != undefined;\n            var keep = true;\n            if (keep && !!callback) {\n                keep = callback(value, element, thisStyle, context);\n            }\n            if (keep && isCssVariable(value)) {\n                value = processCssVariable(value);\n                keep = !!value;\n            }\n            keep =\n                keep &&\n                    value != 'inherit' &&\n                    value.indexOf('expression') < 0 &&\n                    name.substr(0, 1) != '-' &&\n                    _this.defaultStyleValues[name] != value &&\n                    ((isInheritable && value != thisStyle[name]) ||\n                        (!isInheritable && value != 'initial' && value != 'normal'));\n            if (keep && isInheritable) {\n                thisStyle[name] = value;\n            }\n            if (keep) {\n                styles[name] = value;\n            }\n            else {\n                delete styles[name];\n            }\n        });\n        setStyles(element, styles);\n    };\n    HtmlSanitizer.prototype.processAttributes = function (element, context) {\n        for (var i = element.attributes.length - 1; i >= 0; i--) {\n            var attribute = element.attributes[i];\n            var name_1 = attribute.name.toLowerCase().trim();\n            var value = attribute.value;\n            var callback = this.attributeCallbacks[name_1];\n            var newValue = callback\n                ? callback(value, element, context)\n                : this.allowedAttributes.indexOf(name_1) >= 0 || name_1.indexOf('data-') == 0\n                    ? value\n                    : null;\n            if (name_1 == 'class' && this.allowedCssClassesRegex) {\n                newValue = this.processCssClass(value, newValue);\n            }\n            if (newValue === null ||\n                newValue === undefined ||\n                newValue.match(/s\\n*c\\n*r\\n*i\\n*p\\n*t\\n*:/i) // match script: with any NewLine inside. Browser will ignore those NewLine char and still treat it as script prefix\n            ) {\n                element.removeAttribute(name_1);\n            }\n            else {\n                attribute.value = newValue;\n            }\n        }\n    };\n    HtmlSanitizer.prototype.processCssClass = function (originalValue, calculatedValue) {\n        var _this = this;\n        var originalClasses = originalValue ? originalValue.split(' ') : [];\n        var calculatedClasses = calculatedValue ? calculatedValue.split(' ') : [];\n        originalClasses.forEach(function (className) {\n            var _a;\n            if (((_a = _this.allowedCssClassesRegex) === null || _a === void 0 ? void 0 : _a.test(className)) &&\n                calculatedClasses.indexOf(className) < 0) {\n                calculatedClasses.push(className);\n            }\n        });\n        return (calculatedClasses === null || calculatedClasses === void 0 ? void 0 : calculatedClasses.length) > 0 ? calculatedClasses.join(' ') : null;\n    };\n    return HtmlSanitizer;\n}());\nexport default HtmlSanitizer;\n//# sourceMappingURL=HtmlSanitizer.js.map","var HEX3_REGEX = /^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/;\nvar HEX6_REGEX = /^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/;\nvar RGB_REGEX = /^rgb\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*\\)$/;\nvar RGBA_REGEX = /^rgba\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*\\)$/;\n/**\n * Parse color string to r/g/b value.\n * If the given color is not in a recognized format, return null\n */\nexport default function parseColor(color) {\n    color = (color || '').trim();\n    var match;\n    if ((match = color.match(HEX3_REGEX))) {\n        return [\n            parseInt(match[1] + match[1], 16),\n            parseInt(match[2] + match[2], 16),\n            parseInt(match[3] + match[3], 16),\n        ];\n    }\n    else if ((match = color.match(HEX6_REGEX))) {\n        return [parseInt(match[1], 16), parseInt(match[2], 16), parseInt(match[3], 16)];\n    }\n    else if ((match = color.match(RGB_REGEX) || color.match(RGBA_REGEX))) {\n        return [parseInt(match[1]), parseInt(match[2]), parseInt(match[3])];\n    }\n    else {\n        // CSS color names such as red, green is not included for now.\n        // If need, we can add those colors from https://www.w3.org/wiki/CSS/Properties/color/keywords\n        return null;\n    }\n}\n//# sourceMappingURL=parseColor.js.map","import parseColor from './parseColor';\nvar WHITE = '#ffffff';\nvar GRAY = '#333333';\nvar BLACK = '#000000';\nvar TRANSPARENT = 'transparent';\nvar ColorTones;\n(function (ColorTones) {\n    ColorTones[ColorTones[\"BRIGHT\"] = 0] = \"BRIGHT\";\n    ColorTones[ColorTones[\"DARK\"] = 1] = \"DARK\";\n    ColorTones[ColorTones[\"NONE\"] = 2] = \"NONE\";\n})(ColorTones || (ColorTones = {}));\n//Using the HSL (hue, saturation and lightness) representation for RGB color values, if the value of the lightness is less than 20, the color is dark\nvar DARK_COLORS_LIGHTNESS = 20;\n//If the value of the lightness is more than 80, the color is bright\nvar BRIGHT_COLORS_LIGHTNESS = 80;\n/**\n * Set text color or background color to the given element\n * @param element The element to set color to\n * @param color The color to set, it can be a string of color name/value or a ModeIndependentColor object\n * @param isBackgroundColor Whether set background color or text color\n * @param isDarkMode Whether current mode is dark mode. @default false\n * @param shouldAdaptTheFontColor Whether the font color needs to be adapted to be visible in a dark or bright background color. @default false\n * @param darkColorHandler A dark color handler object. This is now required.\n * We keep it optional only for backward compatibility. If it is not passed, color will not be set.\n */\nexport default function setColor(element, color, isBackgroundColor, isDarkMode, shouldAdaptTheFontColor, darkColorHandler) {\n    var colorString = typeof color === 'string' ? color.trim() : '';\n    var modeIndependentColor = typeof color === 'string' ? null : color;\n    var cssName = isBackgroundColor ? 'background-color' : 'color';\n    if (colorString || modeIndependentColor) {\n        if (darkColorHandler) {\n            var colorValue = darkColorHandler.registerColor((modeIndependentColor === null || modeIndependentColor === void 0 ? void 0 : modeIndependentColor.lightModeColor) || colorString, !!isDarkMode, modeIndependentColor === null || modeIndependentColor === void 0 ? void 0 : modeIndependentColor.darkModeColor);\n            element.style.setProperty(cssName, colorValue);\n        }\n        if (isBackgroundColor && shouldAdaptTheFontColor) {\n            adaptFontColorToBackgroundColor(element, (modeIndependentColor === null || modeIndependentColor === void 0 ? void 0 : modeIndependentColor.lightModeColor) || colorString, isDarkMode, darkColorHandler);\n        }\n    }\n}\n/**\n * Change the font color to white or some other color, so the text can be visible with a darker background\n * @param element The element that contains text.\n * @param lightModeBackgroundColor Existing background color in light mode\n * @param isDarkMode Whether the content is in dark mode\n * @param darkColorHandler A dark color handler object.  This is now required.\n * We keep it optional only for backward compatibility. If it is not passed, color will not be set.\n */\nfunction adaptFontColorToBackgroundColor(element, lightModeBackgroundColor, isDarkMode, darkColorHandler) {\n    if (!lightModeBackgroundColor || lightModeBackgroundColor === TRANSPARENT) {\n        return;\n    }\n    var isADarkOrBrightOrNone = isADarkOrBrightColor(lightModeBackgroundColor);\n    switch (isADarkOrBrightOrNone) {\n        case 1 /* DARK */:\n            var fontForDark = {\n                lightModeColor: WHITE,\n                darkModeColor: GRAY,\n            };\n            setColor(element, fontForDark, false /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n            break;\n        case 0 /* BRIGHT */:\n            var fontForLight = {\n                lightModeColor: BLACK,\n                darkModeColor: WHITE,\n            };\n            setColor(element, fontForLight, false /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n            break;\n    }\n}\nfunction isADarkOrBrightColor(color) {\n    var lightness = calculateLightness(color);\n    if (lightness < DARK_COLORS_LIGHTNESS) {\n        return 1 /* DARK */;\n    }\n    else if (lightness > BRIGHT_COLORS_LIGHTNESS) {\n        return 0 /* BRIGHT */;\n    }\n    return 2 /* NONE */;\n}\n/**\n * Calculate the lightness of HSL (hue, saturation and lightness) representation\n * @param color a RBG or RGBA COLOR\n * @returns\n */\nfunction calculateLightness(color) {\n    var colorValues = parseColor(color);\n    // Use the values of r,g,b to calculate the lightness in the HSl representation\n    //First calculate the fraction of the light in each color, since in css the value of r,g,b is in the interval of [0,255], we have\n    if (colorValues) {\n        var red = colorValues[0] / 255;\n        var green = colorValues[1] / 255;\n        var blue = colorValues[2] / 255;\n        //Then the lightness in the HSL representation is the average between maximum fraction of r,g,b and the minimum fraction\n        return (Math.max(red, green, blue) + Math.min(red, green, blue)) * 50;\n    }\n    else {\n        return 255;\n    }\n}\n//# sourceMappingURL=setColor.js.map","import setColor from './setColor';\n/**\n * Apply format to an HTML element\n * @param element The HTML element to apply format to\n * @param format The format to apply\n * @param isDarkMode Whether the content should be formatted in dark mode\n * @param darkColorHandler An optional dark color handler object. When it is passed, we will use this handler to do variable-based dark color instead of original dataset base dark color\n */\nexport default function applyFormat(element, format, isDarkMode, darkColorHandler) {\n    if (format) {\n        var elementStyle = element.style;\n        var fontFamily = format.fontFamily, fontSize = format.fontSize, textColor = format.textColor, textColors = format.textColors, backgroundColor = format.backgroundColor, backgroundColors = format.backgroundColors, bold = format.bold, italic = format.italic, underline = format.underline;\n        if (fontFamily) {\n            elementStyle.fontFamily = fontFamily;\n        }\n        if (fontSize) {\n            elementStyle.fontSize = fontSize;\n        }\n        if (textColors) {\n            setColor(element, textColors, false /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n        }\n        else if (textColor) {\n            setColor(element, textColor, false /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n        }\n        if (backgroundColors) {\n            setColor(element, backgroundColors, true /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n        }\n        else if (backgroundColor) {\n            setColor(element, backgroundColor, true /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n        }\n        if (bold) {\n            elementStyle.fontWeight = 'bold';\n        }\n        if (italic) {\n            elementStyle.fontStyle = 'italic';\n        }\n        if (underline) {\n            elementStyle.textDecoration = 'underline';\n        }\n    }\n}\n//# sourceMappingURL=applyFormat.js.map","import getObjectKeys from '../jsUtils/getObjectKeys';\n/**\n * A map from pendable format name to document command\n */\nexport var PendableFormatCommandMap = {\n    /**\n     * Bold\n     */\n    isBold: \"bold\" /* Bold */,\n    /**\n     * Italic\n     */\n    isItalic: \"italic\" /* Italic */,\n    /**\n     * Underline\n     */\n    isUnderline: \"underline\" /* Underline */,\n    /**\n     * StrikeThrough\n     */\n    isStrikeThrough: \"strikeThrough\" /* StrikeThrough */,\n    /**\n     * Subscript\n     */\n    isSubscript: \"subscript\" /* Subscript */,\n    /**\n     * Superscript\n     */\n    isSuperscript: \"superscript\" /* Superscript */,\n};\n/**\n * Get Pendable Format State at cursor.\n * @param document The HTML Document to get format state from\n * @returns A PendableFormatState object which contains the values of pendable format states\n */\nexport default function getPendableFormatState(document) {\n    var keys = getObjectKeys(PendableFormatCommandMap);\n    return keys.reduce(function (state, key) {\n        state[key] = document.queryCommandState(PendableFormatCommandMap[key]);\n        return state;\n    }, {});\n}\n//# sourceMappingURL=getPendableFormatState.js.map","import getTagOfNode from './getTagOfNode';\nvar VISIBLE_ELEMENT_TAGS = ['IMG'];\nvar VISIBLE_CHILD_ELEMENT_SELECTOR = ['TABLE', 'IMG', 'LI'].join(',');\nvar ZERO_WIDTH_SPACE = /\\u200b/g;\n/**\n * Check if a given node has no visible content\n * @param node The node to check\n * @param trimContent Whether trim the text content so that spaces will be treated as empty.\n * Default value is false\n * @returns True if there isn't any visible element inside node, otherwise false\n */\nexport default function isNodeEmpty(node, trimContent, shouldCountBrAsVisible) {\n    if (!node) {\n        return false;\n    }\n    else if (node.nodeType == 3 /* Text */) {\n        return trim(node.nodeValue || '', trimContent) == '';\n    }\n    else if (node.nodeType == 1 /* Element */) {\n        var element = node;\n        var textContent = trim(element.textContent || '', trimContent);\n        var visibleSelector = shouldCountBrAsVisible\n            ? VISIBLE_CHILD_ELEMENT_SELECTOR + \",BR\"\n            : VISIBLE_CHILD_ELEMENT_SELECTOR;\n        if (textContent != '' ||\n            VISIBLE_ELEMENT_TAGS.indexOf(getTagOfNode(element)) >= 0 ||\n            element.querySelectorAll(visibleSelector)[0]) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction trim(s, trim) {\n    s = s.replace(ZERO_WIDTH_SPACE, '');\n    return trim ? s.trim() : s;\n}\n//# sourceMappingURL=isNodeEmpty.js.map","import { __values } from \"tslib\";\nimport getObjectKeys from '../jsUtils/getObjectKeys';\n// http exclude matching regex\n// invalid URL example (in particular on IE and Edge):\n// - http://www.bing.com%00, %00 before ? (question mark) is considered invalid. IE/Edge throws invalid argument exception\n// - http://www.bing.com%1, %1 is invalid\n// - http://www.bing.com%g, %g is invalid (IE and Edge expects a two hex value after a %)\n// - http://www.bing.com%, % as ending is invalid (IE and Edge expects a two hex value after a %)\n// All above % cases if they're after ? (question mark) is then considered valid again\n// Similar for @, it needs to be after / (forward slash), or ? (question mark). Otherwise IE/Edge will throw security exception\n// - http://www.bing.com@name, @name before ? (question mark) is considered invalid\n// - http://www.bing.com/@name, is valid sine it is after / (forward slash)\n// - http://www.bing.com?@name, is also valid since it is after ? (question mark)\n// The regex below is essentially a break down of:\n// ^[^?]+%[^0-9a-f]+ => to exclude URL like www.bing.com%%\n// ^[^?]+%[0-9a-f][^0-9a-f]+ => to exclude URL like www.bing.com%1\n// ^[^?]+%00 => to exclude URL like www.bing.com%00\n// ^[^?]+%$ => to exclude URL like www.bing.com%\n// ^https?:\\/\\/[^?\\/]+@ => to exclude URL like http://www.bing.com@name\n// ^www\\.[^?\\/]+@ => to exclude URL like www.bing.com@name\n// , => to exclude url like www.bing,,com\nvar httpExcludeRegEx = /^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\\/\\/[^?\\/]+@|^www\\.[^?\\/]+@/i;\n// via https://tools.ietf.org/html/rfc1035 Page 7\nvar labelRegEx = '[a-z0-9](?:[a-z0-9-]*[a-z0-9])?'; // We're using case insensitive regexps below so don't bother including A-Z\nvar domainNameRegEx = \"(?:\" + labelRegEx + \"\\\\.)*\" + labelRegEx;\nvar domainPortRegEx = domainNameRegEx + \"(?:\\\\:[0-9]+)?\";\nvar domainPortWithUrlRegEx = domainPortRegEx + \"(?:[\\\\/\\\\?]\\\\S*)?\";\nvar linkMatchRules = {\n    http: {\n        match: new RegExp(\"^(?:microsoft-edge:)?http:\\\\/\\\\/\" + domainPortWithUrlRegEx + \"|www\\\\.\" + domainPortWithUrlRegEx, 'i'),\n        except: httpExcludeRegEx,\n        normalizeUrl: function (url) {\n            return new RegExp('^(?:microsoft-edge:)?http:\\\\/\\\\/', 'i').test(url) ? url : 'http://' + url;\n        },\n    },\n    https: {\n        match: new RegExp(\"^(?:microsoft-edge:)?https:\\\\/\\\\/\" + domainPortWithUrlRegEx, 'i'),\n        except: httpExcludeRegEx,\n    },\n    mailto: { match: new RegExp('^mailto:\\\\S+@\\\\S+\\\\.\\\\S+', 'i') },\n    notes: { match: new RegExp('^notes:\\\\/\\\\/\\\\S+', 'i') },\n    file: { match: new RegExp('^file:\\\\/\\\\/\\\\/?\\\\S+', 'i') },\n    unc: { match: new RegExp('^\\\\\\\\\\\\\\\\\\\\S+', 'i') },\n    ftp: {\n        match: new RegExp(\"^ftp:\\\\/\\\\/\" + domainPortWithUrlRegEx + \"|ftp\\\\.\" + domainPortWithUrlRegEx, 'i'),\n        normalizeUrl: function (url) { return (new RegExp('^ftp:\\\\/\\\\/', 'i').test(url) ? url : 'ftp://' + url); },\n    },\n    news: { match: new RegExp(\"^news:(\\\\/\\\\/)?\" + domainPortWithUrlRegEx, 'i') },\n    telnet: { match: new RegExp(\"^telnet:(\\\\/\\\\/)?\" + domainPortWithUrlRegEx, 'i') },\n    gopher: { match: new RegExp(\"^gopher:\\\\/\\\\/\" + domainPortWithUrlRegEx, 'i') },\n    wais: { match: new RegExp(\"^wais:(\\\\/\\\\/)?\" + domainPortWithUrlRegEx, 'i') },\n};\n/**\n * Try to match a given string with link match rules, return matched link\n * @param url Input url to match\n * @param option Link match option, exact or partial. If it is exact match, we need\n * to check the length of matched link and url\n * @param rules Optional link match rules, if not passed, only the default link match\n * rules will be applied\n * @returns The matched link data, or null if no match found.\n * The link data includes an original url and a normalized url\n */\nexport default function matchLink(url) {\n    var e_1, _a;\n    if (url) {\n        try {\n            for (var _b = __values(getObjectKeys(linkMatchRules)), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var schema = _c.value;\n                var rule = linkMatchRules[schema];\n                var matches = url.match(rule.match);\n                if (matches && matches[0] == url && (!rule.except || !rule.except.test(url))) {\n                    return {\n                        scheme: schema,\n                        originalUrl: url,\n                        normalizedUrl: rule.normalizeUrl ? rule.normalizeUrl(url) : url,\n                    };\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    return null;\n}\n//# sourceMappingURL=matchLink.js.map","import toArray from '../jsUtils/toArray';\n/**\n * Query HTML elements in the container by a selector string\n * @param container Container element to query from\n * @param selector Selector string to query\n * @param forEachCallback An optional callback to be invoked on each node in query result\n * @param scope The scope of the query, default value is QueryScope.Body\n * @param range The selection range to query with. This is required when scope is not Body\n * @returns HTML Element array of the query result\n */\nexport default function queryElements(container, selector, forEachCallback, scope, range) {\n    if (scope === void 0) { scope = 0 /* Body */; }\n    if (!container || !selector) {\n        return [];\n    }\n    var elements = toArray(container.querySelectorAll(selector));\n    if (scope != 0 /* Body */ && range) {\n        var startOffset = range.startOffset, endOffset = range.endOffset;\n        var startContainer_1 = range.startContainer, endContainer_1 = range.endContainer;\n        if (startContainer_1.nodeType == 1 /* Element */ && startContainer_1.firstChild) {\n            var child = startContainer_1.childNodes[startOffset];\n            // range.startOffset can give a value of child.length+1 when selection is after the last child\n            // In that case we will use the last child instead\n            startContainer_1 = child || startContainer_1.lastChild;\n        }\n        endContainer_1 =\n            endContainer_1.nodeType == 1 /* Element */ && endContainer_1.firstChild && endOffset > 0\n                ? endContainer_1.childNodes[endOffset - 1]\n                : endContainer_1;\n        elements = elements.filter(function (element) {\n            return isIntersectWithNodeRange(element, startContainer_1, endContainer_1, scope == 2 /* InSelection */);\n        });\n    }\n    if (forEachCallback) {\n        elements.forEach(forEachCallback);\n    }\n    return elements;\n}\nfunction isIntersectWithNodeRange(node, startNode, endNode, nodeContainedByRangeOnly) {\n    var startPosition = node.compareDocumentPosition(startNode);\n    var endPosition = node.compareDocumentPosition(endNode);\n    var targetPositions = [0 /* Same */, 8 /* Contains */];\n    if (!nodeContainedByRangeOnly) {\n        targetPositions.push(16 /* ContainedBy */);\n    }\n    return (checkPosition(startPosition, targetPositions) || // intersectStart\n        checkPosition(endPosition, targetPositions) || // intersectEnd\n        (checkPosition(startPosition, [2 /* Preceding */]) && // Contains\n            checkPosition(endPosition, [4 /* Following */]) &&\n            !checkPosition(endPosition, [16 /* ContainedBy */])));\n}\nfunction checkPosition(position, targets) {\n    return targets.some(function (target) {\n        return target == 0 /* Same */\n            ? position == 0 /* Same */\n            : (position & target) == target;\n    });\n}\n//# sourceMappingURL=queryElements.js.map","/**\n * Removes the node and keep all children in place, return the parentNode where the children are attached\n * @param node the node to remove\n */\nexport default function unwrap(node) {\n    // Unwrap requires a parentNode\n    var parentNode = node ? node.parentNode : null;\n    if (!parentNode) {\n        return null;\n    }\n    while (node.firstChild) {\n        parentNode.insertBefore(node.firstChild, node);\n    }\n    parentNode.removeChild(node);\n    return parentNode;\n}\n//# sourceMappingURL=unwrap.js.map","/**\n * A ClientRect of all 0 is possible. i.e. chrome returns a ClientRect of 0 when the cursor is on an empty p\n * We validate that and only return a rect when the passed in ClientRect is valid\n */\nexport default function normalizeRect(clientRect) {\n    var _a = clientRect || { left: 0, right: 0, top: 0, bottom: 0 }, left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\n    return left === 0 && right === 0 && top === 0 && bottom === 0\n        ? null\n        : {\n            left: Math.round(left),\n            right: Math.round(right),\n            top: Math.round(top),\n            bottom: Math.round(bottom),\n        };\n}\n//# sourceMappingURL=normalizeRect.js.map","/**\n * Create a number definition\n * @param isOptional Whether this property is optional\n * @param value Optional value of the number\n * @param minValue Optional minimum value\n * @param maxValue Optional maximum value\n * @param allowNull Allow the property to be null\n * @returns The number definition object\n */\nexport function createNumberDefinition(isOptional, value, minValue, maxValue, allowNull) {\n    return {\n        type: 1 /* Number */,\n        isOptional: isOptional,\n        value: value,\n        maxValue: maxValue,\n        minValue: minValue,\n        allowNull: allowNull,\n    };\n}\n/**\n * Create a boolean definition\n * @param isOptional  Whether this property is optional\n * @param value Optional expected boolean value\n * @param allowNull Allow the property to be null\n * @returns  The boolean definition object\n */\nexport function createBooleanDefinition(isOptional, value, allowNull) {\n    return {\n        type: 0 /* Boolean */,\n        isOptional: isOptional,\n        value: value,\n        allowNull: allowNull,\n    };\n}\n/**\n * Create a string definition\n * @param isOptional  Whether this property is optional\n * @param value Optional expected string value\n * @param allowNull Allow the property to be null\n * @returns  The string definition object\n */\nexport function createStringDefinition(isOptional, value, allowNull) {\n    return {\n        type: 2 /* String */,\n        isOptional: isOptional,\n        value: value,\n        allowNull: allowNull,\n    };\n}\n/**\n * Create an array definition\n * @param itemDef Definition of each item of the related array\n * @param isOptional  Whether this property is optional\n * @param allowNull Allow the property to be null\n * @returns  The array definition object\n */\nexport function createArrayDefinition(itemDef, isOptional, minLength, maxLength, allowNull) {\n    return {\n        type: 3 /* Array */,\n        isOptional: isOptional,\n        itemDef: itemDef,\n        minLength: minLength,\n        maxLength: maxLength,\n        allowNull: allowNull,\n    };\n}\n/**\n * Create an object definition\n * @param propertyDef Definition of each property of the related object\n * @param isOptional  Whether this property is optional\n * @param allowNull Allow the property to be null\n * @returns  The object definition object\n */\nexport function createObjectDefinition(propertyDef, isOptional, allowNull) {\n    return {\n        type: 4 /* Object */,\n        isOptional: isOptional,\n        propertyDef: propertyDef,\n        allowNull: allowNull,\n    };\n}\n//# sourceMappingURL=definitionCreators.js.map","import getObjectKeys from '../jsUtils/getObjectKeys';\n/**\n * Validate the given object with a type definition object\n * @param input The object to validate\n * @param def The type definition object used for validation\n * @returns True if the object passed the validation, otherwise false\n */\nexport default function validate(input, def) {\n    var result = false;\n    if ((def.isOptional && typeof input === 'undefined') || (def.allowNull && input === null)) {\n        result = true;\n    }\n    else if ((!def.isOptional && typeof input === 'undefined') ||\n        (!def.allowNull && input === null)) {\n        return false;\n    }\n    else {\n        switch (def.type) {\n            case 2 /* String */:\n                result =\n                    typeof input === 'string' &&\n                        (typeof def.value === 'undefined' || input === def.value);\n                break;\n            case 1 /* Number */:\n                result =\n                    typeof input === 'number' &&\n                        (typeof def.value === 'undefined' || areSameNumbers(def.value, input)) &&\n                        (typeof def.minValue === 'undefined' || input >= def.minValue) &&\n                        (typeof def.maxValue === 'undefined' || input <= def.maxValue);\n                break;\n            case 0 /* Boolean */:\n                result =\n                    typeof input === 'boolean' &&\n                        (typeof def.value === 'undefined' || input === def.value);\n                break;\n            case 3 /* Array */:\n                result =\n                    Array.isArray(input) &&\n                        (typeof def.minLength === 'undefined' || input.length >= def.minLength) &&\n                        (typeof def.maxLength === 'undefined' || input.length <= def.maxLength) &&\n                        input.every(function (x) { return validate(x, def.itemDef); });\n                break;\n            case 4 /* Object */:\n                result =\n                    typeof input === 'object' &&\n                        getObjectKeys(def.propertyDef).every(function (x) {\n                            return validate(input[x], def.propertyDef[x]);\n                        });\n                break;\n            case 5 /* Customize */:\n                result = def.validator(input);\n                break;\n        }\n    }\n    return result;\n}\nfunction areSameNumbers(n1, n2) {\n    return Math.abs(n1 - n2) < 1e-3;\n}\n//# sourceMappingURL=validate.js.map","import validate from './validate';\nvar MetadataDataSetName = 'editingInfo';\n/**\n * Get metadata object from an HTML element\n * @param element The HTML element to get metadata object from\n * @param definition The type definition of this metadata used for validate this metadata object.\n * If not specified, no validation will be performed and always return whatever we get from the element\n * @param defaultValue The default value to return if the retrieved object cannot pass the validation,\n * or there is no metadata object at all\n * @returns The strong-type metadata object if it can be validated, or null\n */\nexport function getMetadata(element, definition, defaultValue) {\n    var str = element.dataset[MetadataDataSetName];\n    var obj;\n    try {\n        obj = str ? JSON.parse(str) : null;\n    }\n    catch (_a) { }\n    if (typeof obj !== 'undefined') {\n        if (!definition) {\n            return obj;\n        }\n        else if (validate(obj, definition)) {\n            return obj;\n        }\n    }\n    if (defaultValue) {\n        return defaultValue;\n    }\n    else {\n        return null;\n    }\n}\n/**\n * Set metadata object into an HTML element\n * @param element The HTML element to set metadata object to\n * @param metadata The metadata object to set\n * @param def An optional type definition object used for validate this metadata object.\n * If not specified, metadata will be set without validation\n * @returns True if metadata is set, otherwise false\n */\nexport function setMetadata(element, metadata, def) {\n    if (!def || validate(metadata, def)) {\n        element.dataset[MetadataDataSetName] = JSON.stringify(metadata);\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n/**\n * Remove metadata from the given element if any\n * @param element The element to remove metadata from\n * @param metadataKey The metadata key to remove, if none provided it will delete all metadata\n */\nexport function removeMetadata(element, metadataKey) {\n    if (metadataKey) {\n        var currentMetadata = getMetadata(element);\n        if (currentMetadata) {\n            delete currentMetadata[metadataKey];\n            element.dataset[MetadataDataSetName] = JSON.stringify(currentMetadata);\n        }\n    }\n    else {\n        delete element.dataset[MetadataDataSetName];\n    }\n}\n//# sourceMappingURL=metadata.js.map","import { createBooleanDefinition, createObjectDefinition } from '../metadata/definitionCreators';\nimport { getMetadata, setMetadata } from '../metadata/metadata';\nvar BooleanDefinition = createBooleanDefinition(true /** isOptional */, undefined /** value */, true /** allowNull */);\nvar TableCellFormatMetadata = createObjectDefinition({\n    bgColorOverride: BooleanDefinition,\n    vAlignOverride: BooleanDefinition,\n    borderOverride: BooleanDefinition,\n}, false /* isOptional */, true /** allowNull */);\n/**\n * @internal\n * Get the format info of a table cell\n * @param cell The table cell to use\n */\nexport function getTableCellMetadata(cell) {\n    return getMetadata(cell, TableCellFormatMetadata);\n}\n/**\n * Add metadata to a cell\n * @param cell The table cell to add the metadata\n * @param format The format of the table\n */\nexport function saveTableCellMetadata(cell, format) {\n    if (cell && format) {\n        setMetadata(cell, format, TableCellFormatMetadata);\n    }\n}\n//# sourceMappingURL=tableCellInfo.js.map","import changeElementTag from '../utils/changeElementTag';\nimport setColor from '../utils/setColor';\nimport { getTableCellMetadata } from './tableCellInfo';\nvar TRANSPARENT = 'transparent';\nvar TABLE_CELL_TAG_NAME = 'TD';\nvar TABLE_HEADER_TAG_NAME = 'TH';\n/**\n * @internal\n * Apply the given table format to this virtual table\n * @param format Table format to apply\n * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n */\nexport default function applyTableFormat(table, cells, format, darkColorHandler) {\n    if (!format) {\n        return;\n    }\n    table.style.borderCollapse = 'collapse';\n    setBordersType(cells, format);\n    setCellFormat(cells, format, darkColorHandler);\n    setFirstColumnFormat(cells, format);\n    setHeaderRowFormat(cells, format, darkColorHandler);\n}\n/**\n * Check if the cell has shade meta override\n * @param cell\n * @returns\n */\nfunction hasCellShadeOverride(cell) {\n    var _a;\n    if (!cell.td) {\n        return false;\n    }\n    return !!((_a = getTableCellMetadata(cell.td)) === null || _a === void 0 ? void 0 : _a.bgColorOverride);\n}\n/**\n * Check if the cell has vertical align meta override\n * @param cell\n * @returns\n */\nfunction hasValignOverride(cell) {\n    var _a;\n    if (!cell.td) {\n        return false;\n    }\n    return !!((_a = getTableCellMetadata(cell.td)) === null || _a === void 0 ? void 0 : _a.vAlignOverride);\n}\n/**\n * Check if the cell has any modified border meta override\n * @param cell\n * @returns\n */\nfunction hasBorderOverride(cell) {\n    var _a;\n    if (!cell.td) {\n        return false;\n    }\n    return !!((_a = getTableCellMetadata(cell.td)) === null || _a === void 0 ? void 0 : _a.borderOverride);\n}\n/**\n * Set color and vertical align to the table\n * @param format the format that must be applied\n * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n */\nfunction setCellFormat(cells, format, darkColorHandler) {\n    var color = function (index) { return (index % 2 === 0 ? format.bgColorEven : format.bgColorOdd); };\n    var hasBandedRows = format.hasBandedRows, hasBandedColumns = format.hasBandedColumns, bgColorOdd = format.bgColorOdd, bgColorEven = format.bgColorEven;\n    var shouldColorWholeTable = !hasBandedRows && bgColorOdd === bgColorEven ? true : false;\n    cells.forEach(function (row, index) {\n        row.forEach(function (cell) {\n            if (cell.td) {\n                // Set cell color\n                if (!hasCellShadeOverride(cell)) {\n                    if (hasBandedRows) {\n                        var backgroundColor = color(index);\n                        setColor(cell.td, backgroundColor || TRANSPARENT, true /** isBackgroundColor*/, undefined /** isDarkMode **/, true /** shouldAdaptFontColor */, darkColorHandler);\n                    }\n                    else if (shouldColorWholeTable) {\n                        setColor(cell.td, format.bgColorOdd || TRANSPARENT, true /** isBackgroundColor*/, undefined /** isDarkMode **/, true /** shouldAdaptFontColor */, darkColorHandler);\n                    }\n                    else {\n                        setColor(cell.td, TRANSPARENT, true /** isBackgroundColor*/, undefined /** isDarkMode **/, true /** shouldAdaptFontColor */, darkColorHandler);\n                    }\n                }\n                // Set cell vertical align\n                if (format.verticalAlign && !hasValignOverride(cell)) {\n                    cell.td.style.verticalAlign = format.verticalAlign;\n                }\n            }\n        });\n    });\n    if (hasBandedColumns) {\n        cells.forEach(function (row) {\n            row.forEach(function (cell, index) {\n                var backgroundColor = color(index);\n                if (cell.td && backgroundColor && !hasCellShadeOverride(cell)) {\n                    setColor(cell.td, backgroundColor, true /** isBackgroundColor*/, undefined /** isDarkMode **/, true /** shouldAdaptFontColor */, darkColorHandler);\n                }\n            });\n        });\n    }\n}\n/**\n * Set color to borders of an table\n * @param format\n * @returns\n */\nfunction setBorderColors(td, format) {\n    td.style.borderTop = getBorderStyle(format.topBorderColor);\n    td.style.borderLeft = getBorderStyle(format.verticalBorderColor);\n    td.style.borderRight = getBorderStyle(format.verticalBorderColor);\n    td.style.borderBottom = getBorderStyle(format.bottomBorderColor);\n}\n/**\n * Format the border type\n * @returns\n */\nfunction formatBorders(format, td, isFirstRow, isLastRow, isFirstColumn, isLastColumn) {\n    setBorderColors(td, format);\n    switch (format.tableBorderFormat) {\n        case 0 /* DEFAULT */:\n            return;\n        case 1 /* LIST_WITH_SIDE_BORDERS */:\n            if (!isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (!isLastColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case 4 /* FIRST_COLUMN_HEADER_EXTERNAL */:\n            if (!isFirstRow) {\n                td.style.borderTopColor = TRANSPARENT;\n            }\n            if (!isLastRow && !isFirstRow) {\n                td.style.borderBottomColor = TRANSPARENT;\n            }\n            if (!isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (!isLastColumn && !isFirstColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            if (isFirstColumn && isFirstRow) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case 2 /* NO_HEADER_BORDERS */:\n            if (isFirstRow) {\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isLastColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case 3 /* NO_SIDE_BORDERS */:\n            if (isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isLastColumn) {\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case 5 /* ESPECIAL_TYPE_1 */:\n            if (isFirstRow) {\n                td.style.borderRightColor = TRANSPARENT;\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n            }\n            if (isFirstRow && isFirstColumn) {\n                td.style.borderLeftColor = format.verticalBorderColor || TRANSPARENT;\n                td.style.borderBottomColor = format.bottomBorderColor || TRANSPARENT;\n                td.style.borderTopColor = format.topBorderColor || TRANSPARENT;\n            }\n            break;\n        case 6 /* ESPECIAL_TYPE_2 */:\n            if (isFirstRow) {\n                td.style.borderRightColor = TRANSPARENT;\n                td.style.borderLeftColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n            }\n            if (isFirstRow && isFirstColumn) {\n                td.style.borderLeftColor = format.verticalBorderColor || TRANSPARENT;\n                td.style.borderBottomColor = format.bottomBorderColor || TRANSPARENT;\n                td.style.borderTopColor = format.topBorderColor || TRANSPARENT;\n            }\n            if (!isFirstRow && !isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            break;\n        case 7 /* ESPECIAL_TYPE_3 */:\n            if (isFirstRow) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            if (isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderBottomColor = TRANSPARENT;\n            }\n            if (!isFirstRow && !isFirstColumn) {\n                td.style.borderLeftColor = TRANSPARENT;\n                td.style.borderBottomColor = TRANSPARENT;\n                td.style.borderTopColor = TRANSPARENT;\n                td.style.borderRightColor = TRANSPARENT;\n            }\n            if (isFirstRow && isFirstColumn) {\n                td.style.borderBottomColor = format.bottomBorderColor || TRANSPARENT;\n            }\n            break;\n    }\n}\n/**\n * Organize the borders of table according to a border type\n * @param format\n * @returns\n */\nfunction setBordersType(cells, format) {\n    cells.forEach(function (row, rowIndex) {\n        row.forEach(function (cell, cellIndex) {\n            if (cell.td && !hasBorderOverride(cell)) {\n                formatBorders(format, cell.td, rowIndex === 0, rowIndex === cells.length - 1, cellIndex === 0, cellIndex === row.length - 1);\n            }\n        });\n    });\n}\n/**\n * Apply custom design to the first table column\n * @param format\n * @returns\n */\nfunction setFirstColumnFormat(cells, format) {\n    if (!format.hasFirstColumn) {\n        cells.forEach(function (row) {\n            row.forEach(function (cell, cellIndex) {\n                if (cell.td && cellIndex === 0) {\n                    cell.td = changeElementTag(cell.td, TABLE_CELL_TAG_NAME);\n                    cell.td.scope = '';\n                }\n            });\n        });\n        return;\n    }\n    cells.forEach(function (row, rowIndex) {\n        row.forEach(function (cell, cellIndex) {\n            if (cell.td && cellIndex === 0) {\n                if (rowIndex !== 0 && !hasCellShadeOverride(cell)) {\n                    cell.td.style.borderTopColor = TRANSPARENT;\n                    setColor(cell.td, TRANSPARENT, true /** isBackgroundColor*/, undefined /** isDarkMode **/, true /** shouldAdaptFontColor */);\n                }\n                if (rowIndex !== cells.length - 1 && rowIndex !== 0) {\n                    cell.td.style.borderBottomColor = TRANSPARENT;\n                }\n                cell.td = changeElementTag(cell.td, TABLE_HEADER_TAG_NAME);\n                cell.td.scope = 'col';\n            }\n        });\n    });\n}\n/**\n * Apply custom design to the Header Row\n * @param format\n * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n * @returns\n */\nfunction setHeaderRowFormat(cells, format, darkColorHandler) {\n    var _a, _b;\n    if (!format.hasHeaderRow) {\n        (_a = cells[0]) === null || _a === void 0 ? void 0 : _a.forEach(function (cell) {\n            if (cell.td) {\n                cell.td = changeElementTag(cell.td, TABLE_CELL_TAG_NAME);\n                cell.td.scope = '';\n            }\n        });\n        return;\n    }\n    (_b = cells[0]) === null || _b === void 0 ? void 0 : _b.forEach(function (cell) {\n        if (cell.td && format.headerRowColor) {\n            if (!hasCellShadeOverride(cell)) {\n                setColor(cell.td, format.headerRowColor, true /** isBackgroundColor*/, undefined /** isDarkMode **/, true /** shouldAdaptFontColor */, darkColorHandler);\n            }\n            cell.td.style.borderRightColor = format.headerRowColor;\n            cell.td.style.borderLeftColor = format.headerRowColor;\n            cell.td.style.borderTopColor = format.headerRowColor;\n            cell.td = changeElementTag(cell.td, TABLE_HEADER_TAG_NAME);\n            cell.td.scope = 'row';\n        }\n    });\n}\nfunction getBorderStyle(style) {\n    var color = style ? style : 'transparent';\n    return 'solid 1px ' + color;\n}\n//# sourceMappingURL=applyTableFormat.js.map","import { getMetadata, setMetadata } from '../metadata/metadata';\nimport { createBooleanDefinition, createNumberDefinition, createObjectDefinition, createStringDefinition, } from '../metadata/definitionCreators';\nvar NullStringDefinition = createStringDefinition(false /** isOptional */, undefined /** value */, true /** allowNull */);\nvar BooleanDefinition = createBooleanDefinition(false /** isOptional */);\nvar TableFormatMetadata = createObjectDefinition({\n    topBorderColor: NullStringDefinition,\n    bottomBorderColor: NullStringDefinition,\n    verticalBorderColor: NullStringDefinition,\n    hasHeaderRow: BooleanDefinition,\n    headerRowColor: NullStringDefinition,\n    hasFirstColumn: BooleanDefinition,\n    hasBandedColumns: BooleanDefinition,\n    hasBandedRows: BooleanDefinition,\n    bgColorEven: NullStringDefinition,\n    bgColorOdd: NullStringDefinition,\n    tableBorderFormat: createNumberDefinition(false /** isOptional */, undefined /* value */, 0 /* DEFAULT */, 8 /* CLEAR */),\n    keepCellShade: createBooleanDefinition(true /** isOptional */),\n    verticalAlign: NullStringDefinition,\n}, false /* isOptional */, true /** allowNull */);\n/**\n * Get the format info of a table\n * If the table does not have a info saved, it will be retrieved from the css styles\n * @param table The table that has the info\n */\nexport function getTableFormatInfo(table) {\n    return getMetadata(table, TableFormatMetadata);\n}\n/**\n * @internal\n * Save the format info of a table\n * @param table The table the info will be saved\n * @param format The format of the table\n */\nexport function saveTableInfo(table, format) {\n    if (table && format) {\n        setMetadata(table, format, TableFormatMetadata);\n    }\n}\n//# sourceMappingURL=tableFormatInfo.js.map","import { __assign } from \"tslib\";\nimport applyTableFormat from './applyTableFormat';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport moveChildNodes from '../utils/moveChildNodes';\nimport normalizeRect from '../utils/normalizeRect';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport toArray from '../jsUtils/toArray';\nimport { getTableCellMetadata, saveTableCellMetadata } from './tableCellInfo';\nimport { getTableFormatInfo, saveTableInfo } from './tableFormatInfo';\nimport { removeMetadata } from '../metadata/metadata';\nvar DEFAULT_FORMAT = {\n    topBorderColor: '#ABABAB',\n    bottomBorderColor: '#ABABAB',\n    verticalBorderColor: '#ABABAB',\n    hasHeaderRow: false,\n    hasFirstColumn: false,\n    hasBandedRows: false,\n    hasBandedColumns: false,\n    bgColorEven: null,\n    bgColorOdd: '#ABABAB20',\n    headerRowColor: '#ABABAB',\n    tableBorderFormat: 0 /* DEFAULT */,\n    keepCellShade: false,\n    verticalAlign: null,\n};\n/**\n * A virtual table class, represent an HTML table, by expand all merged cells to each separated cells\n */\nvar VTable = /** @class */ (function () {\n    /**\n     * Create a new instance of VTable object using HTML TABLE or TD node\n     * @param node The HTML Table or TD node\n     * @param normalizeSize Whether table size needs to be normalized\n     * @param zoomScale When the table is under a zoomed container, pass in the zoom scale here\n     */\n    function VTable(node, normalizeSize, zoomScale) {\n        var _this = this;\n        /**\n         * Virtual cells\n         */\n        this.cells = null;\n        /**\n         * Current format of the table\n         */\n        this.formatInfo = null;\n        this.trs = [];\n        this.tableSelection = null;\n        this.table = safeInstanceOf(node, 'HTMLTableElement') ? node : getTableFromTd(node);\n        if (this.table) {\n            var currentTd_1 = safeInstanceOf(node, 'HTMLTableElement') ? null : node;\n            var trs = toArray(this.table.rows);\n            this.cells = trs.map(function (row) { return []; });\n            trs.forEach(function (tr, rowIndex) {\n                var _a;\n                _this.trs[rowIndex % 2] = tr;\n                for (var sourceCol = 0, targetCol = 0; sourceCol < tr.cells.length; sourceCol++) {\n                    // Skip the cells which already initialized\n                    for (; _this.cells[rowIndex][targetCol]; targetCol++) { }\n                    var td = tr.cells[sourceCol];\n                    if (td == currentTd_1) {\n                        _this.col = targetCol;\n                        _this.row = rowIndex;\n                    }\n                    for (var colSpan = 0; colSpan < td.colSpan; colSpan++, targetCol++) {\n                        for (var rowSpan = 0; rowSpan < td.rowSpan; rowSpan++) {\n                            var hasTd = colSpan + rowSpan == 0;\n                            var rect = td.getBoundingClientRect();\n                            if ((_a = _this.cells) === null || _a === void 0 ? void 0 : _a[rowIndex + rowSpan]) {\n                                _this.cells[rowIndex + rowSpan][targetCol] = {\n                                    td: hasTd ? td : null,\n                                    spanLeft: colSpan > 0,\n                                    spanAbove: rowSpan > 0,\n                                    width: hasTd ? rect.width : undefined,\n                                    height: hasTd ? rect.height : undefined,\n                                };\n                            }\n                        }\n                    }\n                }\n                for (var col = 0; col < _this.cells[rowIndex].length; col++) {\n                    if (!_this.cells[rowIndex][col]) {\n                        _this.cells[rowIndex][col] = {\n                            td: null,\n                            spanLeft: false,\n                            spanAbove: false,\n                            width: undefined,\n                            height: undefined,\n                        };\n                    }\n                }\n            });\n            this.formatInfo = getTableFormatInfo(this.table);\n            if (normalizeSize) {\n                this.normalizeSize(typeof zoomScale == 'number' ? function (n) { return n / zoomScale; } : zoomScale);\n            }\n        }\n    }\n    Object.defineProperty(VTable.prototype, \"selection\", {\n        /**\n         * Selected range of cells with the coordinates of the first and last cell selected.\n         */\n        get: function () {\n            return this.tableSelection || null;\n        },\n        set: function (value) {\n            if (value) {\n                var firstCell = value.firstCell;\n                this.row = firstCell === null || firstCell === void 0 ? void 0 : firstCell.y;\n                this.col = firstCell === null || firstCell === void 0 ? void 0 : firstCell.x;\n            }\n            this.tableSelection = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Write the virtual table back to DOM tree to represent the change of VTable\n     * @param skipApplyFormat Do not reapply table format when write back. Only use this parameter when you are pretty sure there is no format or table structure change during the process.\n     * @param darkColorHandler An object to handle dark background colors, if not passed the cell background color will not be set\n     */\n    VTable.prototype.writeBack = function (skipApplyFormat, darkColorHandler) {\n        var _this = this;\n        var _a;\n        if (this.cells) {\n            moveChildNodes(this.table);\n            this.cells.forEach(function (row, r) {\n                var tr = cloneNode(_this.trs[r % 2] || _this.trs[0]);\n                if (tr) {\n                    _this.table.appendChild(tr);\n                    row.forEach(function (cell, c) {\n                        if (cell.td) {\n                            _this.recalculateSpans(r, c);\n                            _this.recalculateCellHeight(cell.td);\n                            tr.appendChild(cell.td);\n                        }\n                    });\n                }\n            });\n            if (this.formatInfo && !skipApplyFormat) {\n                saveTableInfo(this.table, this.formatInfo);\n                applyTableFormat(this.table, this.cells, this.formatInfo, darkColorHandler);\n            }\n        }\n        else if (this.table) {\n            (_a = this.table.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(this.table);\n        }\n    };\n    VTable.prototype.recalculateCellHeight = function (td) {\n        if (this.isEmptyCell(td) && td.rowSpan > 1) {\n            for (var i = 1; i < td.rowSpan; i++) {\n                var br = document.createElement('br');\n                td.appendChild(br);\n            }\n        }\n    };\n    /**\n     * Apply the given table format to this virtual table\n     * @param format Table format to apply\n     */\n    VTable.prototype.applyFormat = function (format) {\n        if (!this.table) {\n            return;\n        }\n        this.formatInfo = __assign(__assign(__assign({}, DEFAULT_FORMAT), (this.formatInfo || {})), (format || {}));\n        if (!this.formatInfo.keepCellShade) {\n            this.deleteCellShadeDataset(this.cells);\n        }\n    };\n    /**\n     * Remove the cellShade dataset to apply a new style format at the cell.\n     * @param cells\n     */\n    VTable.prototype.deleteCellShadeDataset = function (cells) {\n        cells === null || cells === void 0 ? void 0 : cells.forEach(function (row) {\n            row.forEach(function (cell) {\n                if (cell.td) {\n                    removeMetadata(cell.td, 'bgColorOverride');\n                }\n            });\n        });\n    };\n    /**\n     * Edit table with given operation.\n     * @param operation Table operation\n     */\n    VTable.prototype.edit = function (operation) {\n        var _this = this;\n        var _a, _b;\n        if (!this.table || !this.cells || this.row === undefined || this.col == undefined) {\n            return;\n        }\n        var currentRow = this.cells[this.row];\n        var currentCell = currentRow[this.col];\n        var firstRow = this.selection ? this.selection.firstCell.y : this.row;\n        var lastRow = this.selection ? this.selection.lastCell.y : this.row;\n        var firstColumn = this.selection ? this.selection.firstCell.x : this.col;\n        var lastColumn = this.selection ? this.selection.lastCell.x : this.col;\n        switch (operation) {\n            case 0 /* InsertAbove */:\n                for (var i = firstRow; i <= lastRow; i++) {\n                    this.cells.splice(firstRow, 0, currentRow.map(cloneCell));\n                }\n                break;\n            case 1 /* InsertBelow */:\n                var _loop_1 = function (i) {\n                    var newRow = lastRow + this_1.countSpanAbove(lastRow, this_1.col);\n                    this_1.cells.splice(newRow, 0, this_1.cells[newRow - 1].map(function (cell, colIndex) {\n                        var nextCell = _this.getCell(newRow, colIndex);\n                        if (nextCell.spanAbove) {\n                            return cloneCell(nextCell);\n                        }\n                        else if (cell.spanLeft) {\n                            var newCell = cloneCell(cell);\n                            newCell.spanAbove = false;\n                            return newCell;\n                        }\n                        else {\n                            return {\n                                td: cloneNode(_this.getTd(_this.row, colIndex)),\n                            };\n                        }\n                    }));\n                };\n                var this_1 = this;\n                for (var i = firstRow; i <= lastRow; i++) {\n                    _loop_1(i);\n                }\n                break;\n            case 2 /* InsertLeft */:\n                var _loop_2 = function (i) {\n                    this_2.forEachCellOfCurrentColumn(function (cell, row) {\n                        row.splice(i, 0, cloneCell(cell));\n                    });\n                };\n                var this_2 = this;\n                for (var i = firstColumn; i <= lastColumn; i++) {\n                    _loop_2(i);\n                }\n                break;\n            case 3 /* InsertRight */:\n                var _loop_3 = function (i) {\n                    var newCol = lastColumn + this_3.countSpanLeft(this_3.row, lastColumn);\n                    this_3.forEachCellOfColumn(newCol - 1, function (cell, row, i) {\n                        var nextCell = _this.getCell(i, newCol);\n                        var newCell;\n                        if (nextCell.spanLeft) {\n                            newCell = cloneCell(nextCell);\n                        }\n                        else if (cell.spanAbove) {\n                            newCell = cloneCell(cell);\n                            newCell.spanLeft = false;\n                        }\n                        else {\n                            newCell = {\n                                td: cloneNode(_this.getTd(i, _this.col)),\n                            };\n                        }\n                        row.splice(newCol, 0, newCell);\n                    });\n                };\n                var this_3 = this;\n                for (var i = firstColumn; i <= lastColumn; i++) {\n                    _loop_3(i);\n                }\n                break;\n            case 6 /* DeleteRow */:\n                var _loop_4 = function (rowIndex) {\n                    this_4.forEachCellOfRow(rowIndex, function (cell, i) {\n                        var nextCell = _this.getCell(rowIndex + 1, i);\n                        if (cell.td && cell.td.rowSpan > 1 && nextCell.spanAbove) {\n                            nextCell.td = cell.td;\n                        }\n                    });\n                };\n                var this_4 = this;\n                for (var rowIndex = firstRow; rowIndex <= lastRow; rowIndex++) {\n                    _loop_4(rowIndex);\n                }\n                var removedRows = this.selection\n                    ? this.selection.lastCell.y - this.selection.firstCell.y\n                    : 0;\n                this.cells.splice(firstRow, removedRows + 1);\n                if (this.cells.length === 0) {\n                    this.cells = null;\n                }\n                break;\n            case 5 /* DeleteColumn */:\n                var deletedColumns_1 = 0;\n                var _loop_5 = function (colIndex) {\n                    this_5.forEachCellOfColumn(colIndex, function (cell, row, i) {\n                        var nextCell = _this.getCell(i, colIndex + 1);\n                        if (cell.td && cell.td.colSpan > 1 && nextCell.spanLeft) {\n                            nextCell.td = cell.td;\n                        }\n                        var removedColumns = _this.selection\n                            ? colIndex - deletedColumns_1\n                            : _this.col;\n                        row.splice(removedColumns, 1);\n                    });\n                    deletedColumns_1++;\n                };\n                var this_5 = this;\n                for (var colIndex = firstColumn; colIndex <= lastColumn; colIndex++) {\n                    _loop_5(colIndex);\n                }\n                if (((_a = this.cells) === null || _a === void 0 ? void 0 : _a.length) === 0 || ((_b = this.cells) === null || _b === void 0 ? void 0 : _b.every(function (row) { return row.length === 0; }))) {\n                    this.cells = null;\n                }\n                break;\n            case 7 /* MergeAbove */:\n            case 8 /* MergeBelow */:\n                var rowStep = operation == 7 /* MergeAbove */ ? -1 : 1;\n                for (var rowIndex = this.row + rowStep; rowIndex >= 0 && rowIndex < this.cells.length; rowIndex += rowStep) {\n                    var cell = this.getCell(rowIndex, this.col);\n                    if (cell.td && !cell.spanAbove) {\n                        var aboveCell = rowIndex < this.row ? cell : currentCell;\n                        var belowCell = rowIndex < this.row ? currentCell : cell;\n                        this.mergeCells(aboveCell, belowCell);\n                        break;\n                    }\n                }\n                break;\n            case 9 /* MergeLeft */:\n            case 10 /* MergeRight */:\n                var colStep = operation == 9 /* MergeLeft */ ? -1 : 1;\n                for (var colIndex = this.col + colStep; colIndex >= 0 && colIndex < this.cells[this.row].length; colIndex += colStep) {\n                    var cell = this.getCell(this.row, colIndex);\n                    if (cell.td && !cell.spanLeft) {\n                        var leftCell = colIndex < this.col ? cell : currentCell;\n                        var rightCell = colIndex < this.col ? currentCell : cell;\n                        this.mergeCells(leftCell, rightCell, true /** horizontally */);\n                        break;\n                    }\n                }\n                break;\n            case 11 /* MergeCells */:\n                for (var colIndex = firstColumn; colIndex <= lastColumn; colIndex++) {\n                    for (var rowIndex = firstRow + 1; rowIndex <= lastRow; rowIndex++) {\n                        var cell = this.getCell(firstRow, colIndex);\n                        var nextCellBelow = this.getCell(rowIndex, colIndex);\n                        this.mergeCells(cell, nextCellBelow);\n                    }\n                }\n                for (var colIndex = firstColumn + 1; colIndex <= lastColumn; colIndex++) {\n                    var cell = this.getCell(firstRow, firstColumn);\n                    var nextCellRight = this.getCell(firstRow, colIndex);\n                    this.mergeCells(cell, nextCellRight, true /** horizontally */);\n                }\n                break;\n            case 4 /* DeleteTable */:\n                this.cells = null;\n                break;\n            case 13 /* SplitVertically */:\n                if (currentCell.td && currentCell.td.rowSpan > 1) {\n                    this.getCell(this.row + 1, this.col).td = cloneNode(currentCell.td);\n                }\n                else {\n                    var splitRow = currentRow.map(function (cell) {\n                        return {\n                            td: cell == currentCell ? cloneNode(cell.td) : null,\n                            spanAbove: cell != currentCell,\n                            spanLeft: cell.spanLeft,\n                        };\n                    });\n                    this.cells.splice(this.row + 1, 0, splitRow);\n                }\n                break;\n            case 12 /* SplitHorizontally */:\n                if (currentCell.td && currentCell.td.colSpan > 1) {\n                    this.getCell(this.row, this.col + 1).td = cloneNode(currentCell.td);\n                }\n                else {\n                    this.forEachCellOfCurrentColumn(function (cell, row) {\n                        row.splice(_this.col + 1, 0, {\n                            td: row == currentRow ? cloneNode(cell.td) : null,\n                            spanAbove: cell.spanAbove,\n                            spanLeft: row != currentRow,\n                        });\n                    });\n                }\n                break;\n            case 14 /* AlignCenter */:\n                this.table.style.marginLeft = 'auto';\n                this.table.style.marginRight = 'auto';\n                break;\n            case 15 /* AlignLeft */:\n                this.table.style.marginLeft = '';\n                this.table.style.marginRight = 'auto';\n                break;\n            case 16 /* AlignRight */:\n                this.table.style.marginLeft = 'auto';\n                this.table.style.marginRight = '';\n                break;\n            case 18 /* AlignCellCenter */:\n                this.setAlignmentToSelectedCells(firstRow, lastRow, firstColumn, lastColumn, 'center');\n                break;\n            case 17 /* AlignCellLeft */:\n                this.setAlignmentToSelectedCells(firstRow, lastRow, firstColumn, lastColumn, 'left');\n                break;\n            case 19 /* AlignCellRight */:\n                this.setAlignmentToSelectedCells(firstRow, lastRow, firstColumn, lastColumn, 'right');\n                break;\n            case 20 /* AlignCellTop */:\n                this.setAlignmentToSelectedCells(firstRow, lastRow, firstColumn, lastColumn, 'top', true /** isVertical */);\n                break;\n            case 21 /* AlignCellMiddle */:\n                this.setAlignmentToSelectedCells(firstRow, lastRow, firstColumn, lastColumn, 'middle', true /** isVertical */);\n                break;\n            case 22 /* AlignCellBottom */:\n                this.setAlignmentToSelectedCells(firstRow, lastRow, firstColumn, lastColumn, 'bottom', true /** isVertical */);\n                break;\n        }\n    };\n    VTable.prototype.setAlignmentToSelectedCells = function (firstRow, lastRow, firstColumn, lastColumn, alignmentType, isVertical) {\n        var _a, _b;\n        for (var i = firstRow; i <= lastRow; i++) {\n            for (var j = firstColumn; j <= lastColumn; j++) {\n                if (this.cells) {\n                    var cell = this.cells[i][j].td;\n                    if (isVertical && cell) {\n                        (_a = cell.style) === null || _a === void 0 ? void 0 : _a.setProperty('vertical-align', alignmentType);\n                        var meta = getTableCellMetadata(cell);\n                        saveTableCellMetadata(cell, __assign(__assign({}, meta), { vAlignOverride: true }));\n                    }\n                    else if (cell) {\n                        (_b = cell.style) === null || _b === void 0 ? void 0 : _b.setProperty('text-align', alignmentType);\n                    }\n                }\n            }\n        }\n    };\n    VTable.prototype.mergeCells = function (cell, nextCell, horizontally) {\n        var _a, _b, _c, _d;\n        var checkSpans = horizontally\n            ? ((_a = cell.td) === null || _a === void 0 ? void 0 : _a.rowSpan) === ((_b = nextCell.td) === null || _b === void 0 ? void 0 : _b.rowSpan) && !cell.spanLeft\n            : ((_c = cell.td) === null || _c === void 0 ? void 0 : _c.colSpan) === ((_d = nextCell.td) === null || _d === void 0 ? void 0 : _d.colSpan) && !cell.spanAbove;\n        if (cell.td && nextCell.td && checkSpans) {\n            this.mergeCellContents(cell.td, nextCell.td);\n            nextCell.td = null;\n            if (horizontally) {\n                nextCell.spanLeft = true;\n            }\n            else {\n                nextCell.spanAbove = true;\n            }\n        }\n    };\n    VTable.prototype.isEmptyCell = function (td) {\n        return td.childElementCount === 1 && getTagOfNode(td.firstChild) === 'BR';\n    };\n    VTable.prototype.mergeCellContents = function (cellTd, nextCellTd) {\n        if (this.isEmptyCell(nextCellTd)) {\n            moveChildNodes(cellTd, nextCellTd, false /*keepExistingChildren*/);\n        }\n        else {\n            var br = document.createElement('br');\n            cellTd.appendChild(br);\n            moveChildNodes(cellTd, nextCellTd, true /*keepExistingChildren*/);\n        }\n    };\n    /**\n     * Loop each cell of current column and invoke a callback function\n     * @param callback The callback function to invoke\n     */\n    VTable.prototype.forEachCellOfCurrentColumn = function (callback) {\n        this.forEachCellOfColumn(this.col, callback);\n    };\n    /**\n     * Loop each table cell and get all the cells that share the same border from one side\n     * The result is an array of table cell elements\n     * @param borderPos The position of the border\n     * @param getLeftCells Get left-hand-side or right-hand-side cells of the border\n     *\n     * Example, consider having a 3 by 4 table as below with merged and split cells\n     *\n     *     | 1 | 4 | 7 | 8 |\n     *     |   5   |   9   |\n     *     |   3   |   10  |\n     *\n     *  input => borderPos: the 3rd border, getLeftCells: true\n     *  output => [4, 5, 3]\n     *\n     *  input => borderPos: the 3rd border, getLeftCells: false\n     *  output => [7, 9, 10]\n     *\n     *  input => borderPos: the 2nd border, getLeftCells: true\n     *  output => [1]\n     *\n     *  input => borderPos: the 2nd border, getLeftCells: false\n     *  output => [4]\n     */\n    VTable.prototype.getCellsWithBorder = function (borderPos, getLeftCells) {\n        var cells = [];\n        for (var i = 0; this.cells && i < this.cells.length; i++) {\n            for (var j = 0; j < this.cells[i].length; j++) {\n                var cell = this.getCell(i, j);\n                if (cell.td) {\n                    var cellRect = normalizeRect(cell.td.getBoundingClientRect());\n                    if (cellRect) {\n                        var found = false;\n                        if (getLeftCells) {\n                            if (cellRect.right == borderPos) {\n                                found = true;\n                                cells.push(cell.td);\n                            }\n                            else if (found) {\n                                break;\n                            }\n                        }\n                        else {\n                            if (cellRect.left == borderPos) {\n                                found = true;\n                                cells.push(cell.td);\n                            }\n                            else if (found) {\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * Loop each cell of current row and invoke a callback function\n     * @param callback The callback function to invoke\n     */\n    VTable.prototype.forEachCellOfCurrentRow = function (callback) {\n        this.forEachCellOfRow(this.row, callback);\n    };\n    /**\n     * Get a table cell using its row and column index. This function will always return an object\n     * even if the given indexes don't exist in table.\n     * @param row The row index\n     * @param col The column index\n     */\n    VTable.prototype.getCell = function (row, col) {\n        return (this.cells && this.cells[row] && this.cells[row][col]) || {};\n    };\n    /**\n     * Get current HTML table cell object. If the current table cell is a virtual expanded cell, return its root cell\n     */\n    VTable.prototype.getCurrentTd = function () {\n        return this.getTd(this.row, this.col);\n    };\n    /**\n     * Get the Table Cell in a provided coordinate\n     * @param row row of the cell\n     * @param col column of the cell\n     */\n    VTable.prototype.getTd = function (row, col) {\n        if (this.cells && row !== undefined && col !== undefined) {\n            row = Math.min(this.cells.length - 1, row);\n            col = this.cells[row] ? Math.min(this.cells[row].length - 1, col) : col;\n            if (!isNaN(row) && !isNaN(col)) {\n                while (row >= 0 && col >= 0) {\n                    var cell = this.getCell(row, col);\n                    if (cell.td) {\n                        return cell.td;\n                    }\n                    else if (cell.spanLeft) {\n                        col--;\n                    }\n                    else if (cell.spanAbove) {\n                        row--;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n        return null;\n    };\n    VTable.prototype.forEachCellOfColumn = function (col, callback) {\n        if (col !== undefined) {\n            for (var i = 0; this.cells && i < this.cells.length; i++) {\n                callback(this.getCell(i, col), this.cells[i], i);\n            }\n        }\n    };\n    VTable.prototype.forEachCellOfRow = function (row, callback) {\n        if (row !== undefined) {\n            for (var i = 0; this.cells && i < this.cells[row].length; i++) {\n                callback(this.getCell(row, i), i);\n            }\n        }\n    };\n    VTable.prototype.recalculateSpans = function (row, col) {\n        var td = this.getCell(row, col).td;\n        if (td) {\n            td.colSpan = this.countSpanLeft(row, col);\n            td.rowSpan = this.countSpanAbove(row, col);\n            if (td.colSpan == 1) {\n                td.removeAttribute('colSpan');\n            }\n            if (td.rowSpan == 1) {\n                td.removeAttribute('rowSpan');\n            }\n        }\n    };\n    VTable.prototype.countSpanLeft = function (row, col) {\n        var result = 1;\n        for (var i = col + 1; this.cells && i < this.cells[row].length; i++) {\n            var cell = this.getCell(row, i);\n            if (cell.td || !cell.spanLeft) {\n                break;\n            }\n            result++;\n        }\n        return result;\n    };\n    VTable.prototype.countSpanAbove = function (row, col) {\n        var result = 1;\n        for (var i = row + 1; this.cells && i < this.cells.length; i++) {\n            var cell = this.getCell(i, col);\n            if (cell.td || !cell.spanAbove) {\n                break;\n            }\n            result++;\n        }\n        return result;\n    };\n    VTable.prototype.normalizeEmptyTableCells = function () {\n        for (var i = 0, row = void 0; (row = this.table.rows[i]); i++) {\n            for (var j = 0, cell = void 0; (cell = row.cells[j]); j++) {\n                if (cell) {\n                    if (!cell.innerHTML || !cell.innerHTML.trim()) {\n                        cell.appendChild(document.createElement('br'));\n                    }\n                }\n            }\n        }\n    };\n    /* normalize width/height for each cell in the table */\n    VTable.prototype.normalizeTableCellSize = function (zoomScale) {\n        // remove width/height for each row\n        for (var i = 0, row = void 0; (row = this.table.rows[i]); i++) {\n            row.removeAttribute('width');\n            row.style.setProperty('width', null);\n            row.removeAttribute('height');\n            row.style.setProperty('height', null);\n        }\n        // set width/height for each cell\n        for (var i = 0; this.cells && i < this.cells.length; i++) {\n            for (var j = 0; j < this.cells[i].length; j++) {\n                var cell = this.cells[i][j];\n                if (cell) {\n                    var func = typeof zoomScale == 'number' ? function (n) { return n / zoomScale; } : zoomScale;\n                    var width = cell.width || 0;\n                    var height = cell.height || 0;\n                    setHTMLElementSizeInPx(cell.td, (func === null || func === void 0 ? void 0 : func(width)) || width, (func === null || func === void 0 ? void 0 : func(height)) || height);\n                }\n            }\n        }\n    };\n    VTable.prototype.normalizeSize = function (sizeTransformer) {\n        this.normalizeEmptyTableCells();\n        this.normalizeTableCellSize(sizeTransformer);\n        var rect = this.table.getBoundingClientRect();\n        // Make sure table width/height is fixed to avoid shifting effect\n        setHTMLElementSizeInPx(this.table, (sizeTransformer === null || sizeTransformer === void 0 ? void 0 : sizeTransformer(rect.width)) || rect.width, (sizeTransformer === null || sizeTransformer === void 0 ? void 0 : sizeTransformer(rect.height)) || rect.height);\n    };\n    return VTable;\n}());\nexport default VTable;\nfunction setHTMLElementSizeInPx(element, newWidth, newHeight) {\n    if (!!element) {\n        element.removeAttribute('width');\n        element.removeAttribute('height');\n        element.style.boxSizing = 'border-box';\n        element.style.width = newWidth + \"px\";\n        element.style.height = newHeight + \"px\";\n    }\n}\nfunction getTableFromTd(td) {\n    var result = td;\n    for (; result && result.tagName != 'TABLE'; result = result.parentElement) { }\n    return result;\n}\n/**\n * Clone a table cell\n * @param cell The cell to clone\n */\nfunction cloneCell(cell) {\n    return {\n        td: cloneNode(cell.td),\n        spanAbove: cell.spanAbove,\n        spanLeft: cell.spanLeft,\n    };\n}\n/**\n * Clone a node without its children.\n * @param node The node to clone\n */\nfunction cloneNode(node) {\n    var newNode = node ? node.cloneNode(false /*deep*/) : null;\n    if (safeInstanceOf(newNode, 'HTMLTableCellElement')) {\n        newNode.removeAttribute('id');\n        if (!newNode.firstChild) {\n            newNode.appendChild(node.ownerDocument.createElement('br'));\n        }\n    }\n    return newNode;\n}\n//# sourceMappingURL=VTable.js.map","var _a;\n/**\n * @internal\n * Set the marker of a bullet list\n * @param li\n * @param listStyleType\n */\nexport default function setBulletListMarkers(li, listStyleType) {\n    var marker = bulletListStyle[listStyleType];\n    var isDisc = listStyleType === 1 /* Disc */;\n    li.style.listStyleType = isDisc ? marker : \"\\\"\" + marker + \"\\\"\";\n}\nvar bulletListStyle = (_a = {},\n    _a[1 /* Disc */] = 'disc',\n    _a[3 /* Square */] = ' ',\n    _a[2 /* Dash */] = '- ',\n    _a[5 /* LongArrow */] = ' ',\n    _a[8 /* DoubleLongArrow */] = ' ',\n    _a[4 /* ShortArrow */] = ' ',\n    _a[6 /* UnfilledArrow */] = ' ',\n    _a[7 /* Hyphen */] = ' ',\n    _a);\n//# sourceMappingURL=setBulletListMarkers.js.map","/**\n * Check if the whole table is selected\n * @param vTable VTable to check whether all cells are selected\n * @param selection Table selection with first cell selected and last cell selected coordinates.\n * @returns\n */\nexport default function isWholeTableSelected(vTable, selection) {\n    if (!selection || !vTable.cells) {\n        return false;\n    }\n    var firstCell = selection.firstCell, lastCell = selection.lastCell;\n    var rowsLength = vTable.cells.length - 1;\n    var rowCells = vTable.cells[rowsLength];\n    if (!rowCells) {\n        return false;\n    }\n    var colIndex = rowCells.length - 1;\n    var firstX = firstCell.x;\n    var firstY = firstCell.y;\n    var lastX = lastCell.x;\n    var lastY = lastCell.y;\n    return firstX == 0 && firstY == 0 && lastX == colIndex && lastY == rowsLength;\n}\n//# sourceMappingURL=isWholeTableSelected.js.map","import getTagOfNode from '../utils/getTagOfNode';\nexport default function getListTypeFromNode(node) {\n    switch (getTagOfNode(node)) {\n        case 'OL':\n            return 1 /* Ordered */;\n        case 'UL':\n            return 2 /* Unordered */;\n        default:\n            return 0 /* None */;\n    }\n}\n/**\n * @internal\n * Check if the given DOM node is a list element (OL or UL)\n * @param node The node to check\n */\nexport function isListElement(node) {\n    return getListTypeFromNode(node) != 0 /* None */;\n}\n//# sourceMappingURL=getListTypeFromNode.js.map","import ContentTraverser from '../contentTraverser/ContentTraverser';\nimport findClosestElementAncestor from '../utils/findClosestElementAncestor';\nimport safeInstanceOf from '../utils/safeInstanceOf';\n/**\n * Set the Style of a List Item provided, with the styles that the inline child elements have\n * If the child inline elements have different styles, it will not modify the styles of the list item\n * @param element the LI Element to set the styles\n * @param styles The styles that should be applied to the element.\n * @param isCssStyle True means the given styles are CSS style names, false means they are HTML attributes @default true\n */\nexport default function setListItemStyle(element, styles, isCssStyle) {\n    if (isCssStyle === void 0) { isCssStyle = true; }\n    var elementsStyles = getInlineChildElementsStyle(element, styles, isCssStyle);\n    styles.forEach(function (styleName) {\n        var styleValues = elementsStyles.map(function (style) {\n            return style[styleName] !== undefined ? style[styleName] : '';\n        });\n        if (styleValues &&\n            (styleValues.length == 1 || new Set(styleValues).size == 1) &&\n            styleValues[0]) {\n            if (isCssStyle) {\n                element.style.setProperty(styleName, styleValues[0]);\n            }\n            else {\n                element.setAttribute(styleName, styleValues[0]);\n            }\n        }\n    });\n}\nfunction getInlineChildElementsStyle(element, styles, isCssStyle) {\n    var _a, _b;\n    var result = [];\n    var contentTraverser = ContentTraverser.createBodyTraverser(element);\n    var currentInlineElement = null;\n    var _loop_1 = function () {\n        currentInlineElement = contentTraverser.currentInlineElement;\n        var currentNode = (currentInlineElement === null || currentInlineElement === void 0 ? void 0 : currentInlineElement.getContainerNode()) || null;\n        var currentStyle = null;\n        currentNode = currentNode ? findClosestElementAncestor(currentNode) : null;\n        var _loop_2 = function () {\n            var element_1 = currentNode;\n            styles.forEach(function (styleName) {\n                var styleValue = isCssStyle\n                    ? element_1.style.getPropertyValue(styleName)\n                    : element_1.getAttribute(styleName);\n                if (!currentStyle) {\n                    currentStyle = {};\n                }\n                if (styleValue && !currentStyle[styleName]) {\n                    currentStyle[styleName] = styleValue;\n                }\n            });\n            if (((_b = currentNode === null || currentNode === void 0 ? void 0 : currentNode.parentNode) === null || _b === void 0 ? void 0 : _b.childNodes.length) === 1) {\n                currentNode = currentNode.parentNode;\n            }\n            else {\n                currentNode = null;\n            }\n        };\n        // we should consider of when it is the single child node of element, the parentNode's style should add\n        // such as the \"i\", \"b\", \"span\" node in <li><span><b><i>aa</i></b></span></li>\n        while (currentNode &&\n            currentNode !== element &&\n            safeInstanceOf(currentNode, 'HTMLElement') &&\n            (result.length == 0 || (((_a = currentNode.textContent) === null || _a === void 0 ? void 0 : _a.trim().length) || 0) > 0)) {\n            _loop_2();\n        }\n        if (currentStyle) {\n            result.push(currentStyle);\n        }\n        contentTraverser.getNextInlineElement();\n    };\n    while (contentTraverser.currentInlineElement != currentInlineElement) {\n        _loop_1();\n    }\n    return result;\n}\n//# sourceMappingURL=setListItemStyle.js.map","var ALPHABET = {\n    0: 'A',\n    1: 'B',\n    2: 'C',\n    3: 'D',\n    4: 'E',\n    5: 'F',\n    6: 'G',\n    7: 'H',\n    8: 'I',\n    9: 'J',\n    10: 'K',\n    11: 'L',\n    12: 'M',\n    13: 'N',\n    14: 'O',\n    15: 'P',\n    16: 'Q',\n    17: 'R',\n    18: 'S',\n    19: 'T',\n    20: 'U',\n    21: 'V',\n    22: 'W',\n    23: 'X',\n    24: 'Y',\n    25: 'Z',\n};\n/**\n * Convert decimal numbers into english alphabet letters\n * @param decimal The decimal number that needs to be converted\n * @param isLowerCase if true the roman value will appear in lower case\n * @returns\n */\nexport default function convertDecimalsToAlpha(decimal, isLowerCase) {\n    var alpha = '';\n    while (decimal >= 0) {\n        alpha = ALPHABET[decimal % 26] + alpha;\n        decimal = Math.floor(decimal / 26) - 1;\n    }\n    return isLowerCase ? alpha.toLowerCase() : alpha;\n}\n//# sourceMappingURL=convertDecimalsToAlpha.js.map","import { __values } from \"tslib\";\nimport getObjectKeys from '../jsUtils/getObjectKeys';\nvar RomanValues = {\n    M: 1000,\n    CM: 900,\n    D: 500,\n    CD: 400,\n    C: 100,\n    XC: 90,\n    L: 50,\n    XL: 40,\n    X: 10,\n    IX: 9,\n    V: 5,\n    IV: 4,\n    I: 1,\n};\n/**\n * Convert decimal numbers into roman numbers\n * @param decimal The decimal number that needs to be converted\n * @param isLowerCase if true the roman value will appear in lower case\n * @returns\n */\nexport default function convertDecimalsToRoman(decimal, isLowerCase) {\n    var e_1, _a;\n    var romanValue = '';\n    try {\n        for (var _b = __values(getObjectKeys(RomanValues)), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var i = _c.value;\n            var timesRomanCharAppear = Math.floor(decimal / RomanValues[i]);\n            decimal = decimal - timesRomanCharAppear * RomanValues[i];\n            romanValue = romanValue + i.repeat(timesRomanCharAppear);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return isLowerCase ? romanValue.toLocaleLowerCase() : romanValue;\n}\n//# sourceMappingURL=convertDecimalsToRomans.js.map","var _a;\nimport convertDecimalsToAlpha from './convertDecimalsToAlpha';\nimport convertDecimalsToRoman from './convertDecimalsToRomans';\nvar MarkerTypes;\n(function (MarkerTypes) {\n    MarkerTypes[MarkerTypes[\"Decimal\"] = 0] = \"Decimal\";\n    MarkerTypes[MarkerTypes[\"Roman\"] = 1] = \"Roman\";\n    MarkerTypes[MarkerTypes[\"Alpha\"] = 2] = \"Alpha\";\n})(MarkerTypes || (MarkerTypes = {}));\n/**\n * @internal\n * Set marker style of a numbering list\n * @param listStyleType\n * @param li\n */\nexport default function setNumberingListMarkers(li, listStyleType, level) {\n    var _a = numberingListStyle[listStyleType], markerSeparator = _a.markerSeparator, markerSecondSeparator = _a.markerSecondSeparator, markerType = _a.markerType, lowerCase = _a.lowerCase;\n    var markerNumber = level.toString();\n    if (markerType === MarkerTypes.Roman) {\n        markerNumber = convertDecimalsToRoman(level, lowerCase);\n    }\n    else if (markerType === MarkerTypes.Alpha) {\n        markerNumber = convertDecimalsToAlpha(level - 1, lowerCase);\n    }\n    var marker = markerSecondSeparator\n        ? markerSecondSeparator + markerNumber + markerSeparator\n        : markerNumber + markerSeparator;\n    li.style.listStyleType = \"\\\"\" + marker + \"\\\"\";\n}\nvar numberingListStyle = (_a = {},\n    _a[1 /* Decimal */] = {\n        markerType: MarkerTypes.Decimal,\n        markerSeparator: '. ',\n    },\n    _a[2 /* DecimalDash */] = {\n        markerType: MarkerTypes.Decimal,\n        markerSeparator: '- ',\n    },\n    _a[3 /* DecimalParenthesis */] = {\n        markerType: MarkerTypes.Decimal,\n        markerSeparator: ') ',\n    },\n    _a[4 /* DecimalDoubleParenthesis */] = {\n        markerType: MarkerTypes.Decimal,\n        markerSeparator: ') ',\n        markerSecondSeparator: '(',\n    },\n    _a[5 /* LowerAlpha */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: '. ',\n        lowerCase: true,\n    },\n    _a[8 /* LowerAlphaDash */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: '- ',\n        lowerCase: true,\n    },\n    _a[6 /* LowerAlphaParenthesis */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: ') ',\n        lowerCase: true,\n    },\n    _a[7 /* LowerAlphaDoubleParenthesis */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: ') ',\n        markerSecondSeparator: '(',\n        lowerCase: true,\n    },\n    _a[9 /* UpperAlpha */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: '. ',\n    },\n    _a[12 /* UpperAlphaDash */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: '- ',\n    },\n    _a[10 /* UpperAlphaParenthesis */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: ') ',\n    },\n    _a[11 /* UpperAlphaDoubleParenthesis */] = {\n        markerType: MarkerTypes.Alpha,\n        markerSeparator: ') ',\n        markerSecondSeparator: '(',\n    },\n    _a[13 /* LowerRoman */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: '. ',\n        lowerCase: true,\n    },\n    _a[16 /* LowerRomanDash */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: '- ',\n        lowerCase: true,\n    },\n    _a[14 /* LowerRomanParenthesis */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: ') ',\n        lowerCase: true,\n    },\n    _a[15 /* LowerRomanDoubleParenthesis */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: ') ',\n        markerSecondSeparator: '(',\n        lowerCase: true,\n    },\n    _a[17 /* UpperRoman */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: '. ',\n    },\n    _a[20 /* UpperRomanDash */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: '- ',\n    },\n    _a[18 /* UpperRomanParenthesis */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: ') ',\n    },\n    _a[19 /* UpperRomanDoubleParenthesis */] = {\n        markerType: MarkerTypes.Roman,\n        markerSeparator: ') ',\n        markerSecondSeparator: '(',\n    },\n    _a);\n//# sourceMappingURL=setNumberingListMarkers.js.map","import { __assign, __read, __spreadArray } from \"tslib\";\nimport contains from '../utils/contains';\nimport getListTypeFromNode from './getListTypeFromNode';\nimport getStyles from '../style/getStyles';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport isBlockElement from '../utils/isBlockElement';\nimport moveChildNodes from '../utils/moveChildNodes';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport setBulletListMarkers from './setBulletListMarkers';\nimport setListItemStyle from './setListItemStyle';\nimport setNumberingListMarkers from './setNumberingListMarkers';\nimport setStyles from '../style/setStyles';\nimport toArray from '../jsUtils/toArray';\nimport unwrap from '../utils/unwrap';\nimport wrap from '../utils/wrap';\nimport { createNumberDefinition, createObjectDefinition } from '../metadata/definitionCreators';\nimport { getMetadata, setMetadata } from '../metadata/metadata';\nvar orderListStyles = [null, 'lower-alpha', 'lower-roman'];\nvar unorderedListStyles = ['disc', 'circle', 'square'];\nvar MARGIN_BASE = '0in 0in 0in 0.5in';\nvar NEGATIVE_MARGIN = '-.25in';\nvar stylesToInherit = ['font-size', 'font-family', 'color'];\nvar attrsToInherit = ['data-ogsc', 'data-ogsb', 'data-ogac', 'data-ogab'];\n/**\n * @internal\n * The definition for the number of BulletListType or NumberingListType\n */\nexport var ListStyleDefinitionMetadata = createObjectDefinition({\n    orderedStyleType: createNumberDefinition(true /** isOptional */, undefined /** value **/, 1 /* Min */, 20 /* Max */),\n    unorderedStyleType: createNumberDefinition(true /** isOptional */, undefined /** value **/, 1 /* Min */, 9 /* Max */),\n}, true /** isOptional */, true /** allowNull */);\n/**\n * !!! Never directly create instance of this class. It should be created within VList class !!!\n *\n * Represent a list item.\n *\n * A list item is normally wrapped using a LI tag. But this class is only a logical item,\n * it can be a LI tag, or another other type of node which means it is actually not a list item.\n * That can happen after we do \"outdent\" on a 1-level list item, then it becomes not a list item.\n */\nvar VListItem = /** @class */ (function () {\n    /**\n     * Construct a new instance of VListItem class\n     * @param node The DOM node for this item\n     * @param listTypes An array represents list types of all parent and current level.\n     * Skip this parameter for a non-list item.\n     */\n    function VListItem(node) {\n        var listTypes = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            listTypes[_i - 1] = arguments[_i];\n        }\n        this.newListStart = undefined;\n        if (!node) {\n            throw new Error('node must not be null');\n        }\n        this.node = safeInstanceOf(node, 'HTMLLIElement')\n            ? node\n            : wrap(node, 4 /* BlockListItem */);\n        var display = this.node.style.display;\n        this.dummy = display != 'list-item' && display != '';\n        // Always add a None list type in front of all other types to represent non-list scenario.\n        this.listTypes = __spreadArray([0 /* None */], __read(listTypes), false);\n    }\n    /**\n     * Get type of current list item\n     */\n    VListItem.prototype.getListType = function () {\n        return this.listTypes[this.listTypes.length - 1];\n    };\n    /**\n     * Get the levels of this list item.\n     */\n    VListItem.prototype.getLevel = function () {\n        return this.listTypes.length - 1;\n    };\n    /**\n     * Get DOM node of this list item\n     */\n    VListItem.prototype.getNode = function () {\n        return this.node;\n    };\n    /**\n     * Get the Start Number of the new List\n     */\n    VListItem.prototype.getNewListStart = function () {\n        return this.newListStart;\n    };\n    /**\n     * Check if a given node is contained by this list item\n     * @param node The node to check\n     */\n    VListItem.prototype.contains = function (node) {\n        return contains(this.node, node, true /*treatSameNodeAsContain*/);\n    };\n    /**\n     * Check if this item is a dummy item.\n     * A dummy item is also represented by LI tag, but it won't render a bullet (for Unordered list) or a number (for Ordered list)\n     * normally it has CSS style display set to a value other than \"list-item\"\n     */\n    VListItem.prototype.isDummy = function () {\n        return this.dummy;\n    };\n    /**\n     * @deprecated Always return false\n     */\n    VListItem.prototype.isOrphanItem = function () {\n        return false;\n    };\n    /**\n     * @deprecated\n     */\n    VListItem.prototype.canMerge = function (item) {\n        if (!(item === null || item === void 0 ? void 0 : item.isOrphanItem()) || this.listTypes.length != item.listTypes.length) {\n            return false;\n        }\n        return this.listTypes.every(function (type, index) { return item.listTypes[index] == type; });\n    };\n    /**\n     * @deprecated\n     */\n    VListItem.prototype.mergeItems = function (items) {\n        var _this = this;\n        var nodesToWrap = (items === null || items === void 0 ? void 0 : items.map(function (item) { return item.node; })) || [];\n        var targetNodes = wrapIfNotBlockNode(nodesToWrap, true /*checkFirst*/, false /*checkLast*/);\n        targetNodes.forEach(function (node) { return _this.node.appendChild(node); });\n    };\n    /**\n     * Indent this item\n     * If this is not an list item, it will be no op\n     */\n    VListItem.prototype.indent = function () {\n        if (this.node.style.marginLeft == NEGATIVE_MARGIN) {\n            this.node.style.margin = '';\n            this.node.style.marginLeft = '';\n            return;\n        }\n        var listType = this.getListType();\n        if (listType != 0 /* None */) {\n            this.listTypes.push(listType);\n        }\n    };\n    /**\n     * Outdent this item\n     * If this item is already not an list item, it will be no op\n     * @param preventItemRemoval Whether prevent the list item to be removed for the listItem by default false\n     */\n    VListItem.prototype.outdent = function (preventItemRemoval) {\n        if (preventItemRemoval === void 0) { preventItemRemoval = false; }\n        var expectedLength = preventItemRemoval ? 2 : 1;\n        if (this.listTypes.length > expectedLength) {\n            this.listTypes.pop();\n        }\n    };\n    /**\n     * Add negative margin to the List item\n     */\n    VListItem.prototype.addNegativeMargins = function () {\n        this.node.style.margin = MARGIN_BASE;\n        this.node.style.marginLeft = NEGATIVE_MARGIN;\n    };\n    /**\n     * Change list type of this item\n     * @param targetType The target list type to change to\n     */\n    VListItem.prototype.changeListType = function (targetType) {\n        if (targetType == 0 /* None */) {\n            this.listTypes = [targetType];\n        }\n        else {\n            this.outdent();\n            this.listTypes.push(targetType);\n        }\n    };\n    /**\n     * Set whether the item is a dummy item\n     * @param isDummy Whether the item is a dummy item\n     */\n    VListItem.prototype.setIsDummy = function (isDummy) {\n        this.dummy = isDummy;\n    };\n    /**\n     * Set the start Number of the new list\n     * @param isDummy Whether the item is a dummy item\n     */\n    VListItem.prototype.setNewListStart = function (startNumber) {\n        this.newListStart = startNumber;\n    };\n    /**\n     * Apply the list style type\n     * @param rootList the vList that receives the style\n     * @param index the list item index\n     */\n    VListItem.prototype.applyListStyle = function (rootList, index) {\n        var style = getMetadata(rootList, ListStyleDefinitionMetadata);\n        // The list just need to be styled if it is at top level, so the listType length for this Vlist must be 2.\n        var isFirstLevel = this.listTypes.length < 3;\n        if (style) {\n            if (isFirstLevel &&\n                this.listTypes[1] === 2 /* Unordered */ &&\n                style.unorderedStyleType) {\n                setBulletListMarkers(this.node, style.unorderedStyleType);\n            }\n            else if (isFirstLevel &&\n                this.listTypes[1] === 1 /* Ordered */ &&\n                style.orderedStyleType) {\n                setNumberingListMarkers(this.node, style.orderedStyleType, index);\n            }\n            else {\n                this.node.style.removeProperty('list-style-type');\n            }\n        }\n    };\n    /**\n     * Write the change result back into DOM\n     * @param listStack current stack of list elements\n     * @param originalRoot Original list root element. It will be reused when write back if possible\n     * @param shouldReuseAllAncestorListElements Optional - defaults to false. If true, only make\n     *              sure the direct parent of this list matches the list types when writing back.\n     */\n    VListItem.prototype.writeBack = function (listStack, originalRoot, shouldReuseAllAncestorListElements) {\n        var _this = this;\n        var _a;\n        if (shouldReuseAllAncestorListElements === void 0) { shouldReuseAllAncestorListElements = false; }\n        var nextLevel = 1;\n        if (shouldReuseAllAncestorListElements) {\n            // Remove any un-needed lists from the stack.\n            if (listStack.length > this.listTypes.length) {\n                listStack.splice(this.listTypes.length);\n            }\n            // 1. If the listStack is the same length as the listTypes for this item, check\n            // if the last item needs to change, and remove it if needed. We can always re-use\n            // the other lists even if the type doesn't match - since the display is the same\n            // as long as the list immediately surrounding the item is correct.\n            var listStackEndIndex = listStack.length - 1;\n            if (listStackEndIndex === this.listTypes.length - 1 && // they are the same length\n                getListTypeFromNode(listStack[listStackEndIndex]) !==\n                    this.listTypes[listStackEndIndex]) {\n                listStack.splice(listStackEndIndex);\n            }\n            nextLevel = listStack.length;\n        }\n        else {\n            // 1. Determine list elements that we can reuse\n            // e.g.:\n            //    passed in listStack: Fragment > OL > UL > OL\n            //    local listTypes:     null     > OL > UL > UL > OL\n            //    then Fragment > OL > UL can be reused\n            for (; nextLevel < listStack.length; nextLevel++) {\n                if (getListTypeFromNode(listStack[nextLevel]) !== this.listTypes[nextLevel]) {\n                    listStack.splice(nextLevel);\n                    break;\n                }\n            }\n        }\n        // 2. Add new list elements\n        // e.g.:\n        //    passed in listStack: Fragment > OL > UL\n        //    local listTypes:     null     > OL > UL > UL > OL\n        //    then we need to create a UL and a OL tag\n        for (; nextLevel < this.listTypes.length; nextLevel++) {\n            var stackLength = listStack.length - 1;\n            var newList = createListElement(listStack[0], this.listTypes[nextLevel], nextLevel, originalRoot);\n            listStack[stackLength].appendChild(newList);\n            listStack.push(newList);\n            //If the current node parent is in the same deep child index,\n            //apply the styles of the current parent list to the new list\n            if (this.getDeepChildIndex(originalRoot) == stackLength) {\n                var listStyleType = (_a = this.node.parentElement) === null || _a === void 0 ? void 0 : _a.style.listStyleType;\n                if (listStyleType &&\n                    getTagOfNode(this.node.parentElement) === getTagOfNode(newList)) {\n                    newList.style.listStyleType = listStyleType;\n                }\n            }\n        }\n        // 3. Add current node into deepest list element\n        listStack[listStack.length - 1].appendChild(this.node);\n        this.node.style.setProperty('display', this.dummy ? 'block' : null);\n        // 4. Inherit styles of the child element to the li, so we are able to apply the styles to the ::marker\n        if (this.listTypes.length > 1) {\n            setListItemStyle(this.node, stylesToInherit, true /*isCssStyle*/);\n            setListItemStyle(this.node, attrsToInherit, false /*isCssStyle*/);\n        }\n        // 5. If this is not a list item now, need to unwrap the LI node and do proper handling\n        if (this.listTypes.length <= 1) {\n            // If original <LI> node has styles for font and color, we need to apply it to new parent\n            var isLi = getTagOfNode(this.node) == 'LI';\n            var stylesToApply = isLi\n                ? {\n                    'font-family': this.node.style.fontFamily,\n                    'font-size': this.node.style.fontSize,\n                    color: this.node.style.color,\n                }\n                : undefined;\n            var childNodes = isLi ? getChildrenAndUnwrap(this.node) : [this.node];\n            if (stylesToApply) {\n                var _loop_1 = function (i) {\n                    if (safeInstanceOf(childNodes[i], 'Text')) {\n                        childNodes[i] = wrap(childNodes[i], 'span');\n                    }\n                    var node = childNodes[i];\n                    if (safeInstanceOf(node, 'HTMLElement')) {\n                        var styles = __assign(__assign({}, stylesToApply), getStyles(node));\n                        setStyles(node, styles);\n                        attrsToInherit.forEach(function (attr) {\n                            var attrValue = _this.node.getAttribute(attr);\n                            if (attrValue) {\n                                node.setAttribute(attr, attrValue);\n                            }\n                        });\n                    }\n                };\n                for (var i = 0; i < childNodes.length; i++) {\n                    _loop_1(i);\n                }\n            }\n            wrapIfNotBlockNode(childNodes, true /*checkFirst*/, true /*checkLast*/);\n        }\n    };\n    /**\n     * Get the index of how deep is the current node parent list inside of the original root list.\n     * @example In the following structure this function would return 2\n     * ```html\n     *  <ol> <!-- original Root -->\n     *      <ol>\n     *          <ol>\n     *              <li></li> <!-- this.node  -->\n     *          </ol>\n     *      </ol>\n     *  </ol>\n     * ```\n     * @param originalRoot The root list\n     * @returns -1  if the node does not have parent element or if original root was not provided,\n     *              else, how deep is the parent element inside of the original root.\n     */\n    VListItem.prototype.getDeepChildIndex = function (originalRoot) {\n        var parentElement = this.node.parentElement;\n        if (originalRoot && parentElement) {\n            var deepIndex = 0;\n            while (parentElement && parentElement != originalRoot) {\n                deepIndex++;\n                parentElement = (parentElement === null || parentElement === void 0 ? void 0 : parentElement.parentElement) || null;\n            }\n            return deepIndex;\n        }\n        return -1;\n    };\n    return VListItem;\n}());\nexport default VListItem;\nfunction createListElement(newRoot, listType, nextLevel, originalRoot) {\n    var doc = newRoot.ownerDocument;\n    var result;\n    // Try to reuse the existing root element\n    // It can be reused when\n    // 1. Current list item is level 1 (top level), AND\n    // 2. Original root exists, AND\n    // 3. They have the same list type AND\n    // 4. The original root is not used yet\n    if (nextLevel == 1 && originalRoot && listType == getListTypeFromNode(originalRoot)) {\n        if (contains(newRoot, originalRoot)) {\n            // If it is already used, let's clone one and remove ID to avoid duplicating ID\n            result = originalRoot.cloneNode(false /*deep*/);\n            result.removeAttribute('id');\n        }\n        else {\n            // Remove all child nodes, they will be added back later when write back other items\n            moveChildNodes(originalRoot);\n            result = originalRoot;\n        }\n    }\n    else {\n        // Can't be reused, can't clone, let's create a new one\n        result = doc.createElement(listType == 1 /* Ordered */ ? 'ol' : 'ul');\n    }\n    if ((originalRoot === null || originalRoot === void 0 ? void 0 : originalRoot.style.marginBlockStart) == '0px' &&\n        (originalRoot === null || originalRoot === void 0 ? void 0 : originalRoot.style.marginBlockEnd) == '0px') {\n        result.style.marginBlockStart = '0px';\n        result.style.marginBlockEnd = '0px';\n    }\n    // Always maintain the metadata saved in the list\n    if (originalRoot && nextLevel == 1 && listType != getListTypeFromNode(originalRoot)) {\n        var style = getMetadata(originalRoot, ListStyleDefinitionMetadata);\n        if (style) {\n            setMetadata(result, style, ListStyleDefinitionMetadata);\n        }\n    }\n    if (listType == 1 /* Ordered */ && nextLevel > 1) {\n        result.style.setProperty('list-style-type', orderListStyles[(nextLevel - 1) % orderListStyles.length]);\n    }\n    if (listType == 2 /* Unordered */ && nextLevel > 1) {\n        result.style.setProperty('list-style-type', unorderedListStyles[(nextLevel - 1) % unorderedListStyles.length]);\n    }\n    return result;\n}\nfunction wrapIfNotBlockNode(nodes, checkFirst, checkLast) {\n    if (nodes.length > 0 &&\n        (!checkFirst || !isBlockElement(nodes[0])) &&\n        (!checkLast || !isBlockElement(nodes[nodes.length]))) {\n        nodes = [wrap(nodes)];\n    }\n    return nodes;\n}\nfunction getChildrenAndUnwrap(node) {\n    var result = toArray(node.childNodes);\n    unwrap(node);\n    return result;\n}\n//# sourceMappingURL=VListItem.js.map","import { __read, __spreadArray } from \"tslib\";\nimport changeElementTag from '../utils/changeElementTag';\nimport getListTypeFromNode, { isListElement } from './getListTypeFromNode';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport isBlockElement from '../utils/isBlockElement';\nimport isNodeEmpty from '../utils/isNodeEmpty';\nimport Position from '../selection/Position';\nimport queryElements from '../utils/queryElements';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport splitParentNode from '../utils/splitParentNode';\nimport toArray from '../jsUtils/toArray';\nimport unwrap from '../utils/unwrap';\nimport VListItem, { ListStyleDefinitionMetadata } from './VListItem';\nimport wrap from '../utils/wrap';\nimport { getMetadata, setMetadata } from '../metadata/metadata';\n/**\n * Represent a bullet or a numbering list\n *\n * @example\n * A VList is a logical representation of list items, it contains an item array with node and list type stack.\n * e.g. We have a list like this\n * ```html\n * <ol>\n *   <li>item 1</li>\n *   <li>item 2</li>\n *   <ul>\n *     <li>item 2.1</li>\n *     <li>item 2.2</li>\n *   <ul>\n * </ol>\n * ```\n *\n * A VList of this list will be like this:\n * ```javascript\n * {\n *   rootList: (OL node),\n *   items: [{\n *       node: (LI node with 'item 1'),\n *       listTypes: [null, OL],\n *     }, {\n *       node: (LI node with 'item 2'),\n *       listTypes: [null, OL],\n *     }, {\n *       node: (LI node with 'item 2.1),\n *       listTypes: [null, OL, UL],\n *     }, {\n *       node: (LI node with 'item 2.2'),\n *       listTypes: [null, OL, UL],\n *     }\n *   ]\n * }\n * ```\n *\n * When we want to outdent item 2.1, we just need to remove the last \"UL\" from listTypes of item 2.1, then\n * the writeBack() function will handle everything related to DOM change\n */\nvar VList = /** @class */ (function () {\n    /**\n     * Create a new instance of VList class\n     * @param rootList The root list element, can be either OL or UL tag\n     */\n    function VList(rootList) {\n        this.rootList = rootList;\n        this.items = [];\n        if (!rootList) {\n            throw new Error('rootList must not be null');\n        }\n        // Before populate items, we need to normalize the list to make sure it is in a correct format\n        // otherwise further action may mass thing up.\n        //\n        // There are two kinds of normalization to perform.\n        // 1. Move nodes directly under OL/UL into a LI node, unless it is an orphan node\n        // Please see comment for VListItem.isOrphanItem() for more information about orphan node\n        // e.g.:\n        // ```HTML\n        // <ol>\n        //   <li>item 1</li>\n        //   <div>item 2</div>\n        // </ol>\n        // ```\n        // After this step, it should become:\n        // ```html\n        // <ol>\n        //   <li>item 1\n        //     <div>item 2</div>\n        //   <li>\n        // </ol>\n        // ```\n        moveChildNodesToLi(this.rootList);\n        queryElements(this.rootList, 'ol,ul', moveChildNodesToLi);\n        // 2. Move LI node embedded into another LI node out to directly under OL/UL node\n        // Ideally browser we do this for us automatically when out the HTML into DOM. However after\n        // step 1, it is possible that we move some LI node into another one. e.g:\n        // ```HTML\n        // <ol>\n        //   <li>item 1</li>\n        //   <div>\n        //     item 1.1\n        //     <li>item 3</li>\n        //   </div>\n        // </ol>\n        // ```\n        // See that the second LI tag is not directly under OL, so after step 1, this will become:\n        // ```html\n        // <ol>\n        //   <li>item 1\n        //     <div>\n        //       item 1.1\n        //       <li>item 2</li>\n        //     </div>\n        //   <li>\n        // </ol>\n        // ```\n        // Now we have a LI tag embedded into another LI tag. So we need step 2 to move the inner LI tag out to be:\n        // ```html\n        // <ol>\n        //   <li>item1\n        //     <div>item 1.1</div>\n        //   </li>\n        //   <li><div>item2</div></li>\n        // </ol>\n        // ```\n        queryElements(this.rootList, 'li', moveLiToList);\n        this.populateItems(this.rootList);\n    }\n    /**\n     * Check if this list contains the given node\n     * @param node The node to check\n     */\n    VList.prototype.contains = function (node) {\n        // We don't check if the node is contained by this.rootList here, because after some operation,\n        // it is possible a node is logically contained by this list but the container list item hasn't\n        // been put under this.rootList in DOM tree yet.\n        return this.items.some(function (item) { return item.contains(node); });\n    };\n    /**\n     * Get list number of the last item in this VList.\n     * If there is no order list item, result will be undefined\n     */\n    VList.prototype.getLastItemNumber = function () {\n        var start = this.getStart();\n        return start === undefined\n            ? start\n            : start -\n                1 +\n                this.items.filter(function (item) {\n                    return item.getListType() == 1 /* Ordered */ &&\n                        item.getLevel() == 1 &&\n                        !item.isDummy();\n                }).length;\n    };\n    /**\n     * Write the result back into DOM tree\n     * After that, this VList becomes unavailable because we set this.rootList to null\n     *\n     * @param shouldReuseAllAncestorListElements Optional - defaults to false.\n     * @param disableListChain Whether we want to disable list chain functionality. @default false\n     */\n    VList.prototype.writeBack = function (shouldReuseAllAncestorListElements, disableListChain) {\n        var _this = this;\n        if (!this.rootList) {\n            throw new Error('rootList must not be null');\n        }\n        var doc = this.rootList.ownerDocument;\n        var listStack = [doc.createDocumentFragment()];\n        var placeholder = doc.createTextNode('');\n        var start = this.getStart() || 1;\n        var lastList;\n        // Use a placeholder to hold the position since the root list may be moved into document fragment later\n        this.rootList.parentNode.replaceChild(placeholder, this.rootList);\n        this.items.forEach(function (item) {\n            var newListStart = item.getNewListStart();\n            if (newListStart && newListStart != start) {\n                listStack.splice(1, listStack.length - 1);\n                start = newListStart;\n            }\n            item.writeBack(listStack, _this.rootList, shouldReuseAllAncestorListElements);\n            var topList = listStack[1];\n            item.applyListStyle(_this.rootList, start);\n            if (safeInstanceOf(topList, 'HTMLOListElement')) {\n                if (lastList != topList) {\n                    if (start == 1) {\n                        topList.removeAttribute('start');\n                    }\n                    else {\n                        topList.start = start;\n                    }\n                }\n                if (item.getLevel() == 1 && !item.isDummy() && !disableListChain) {\n                    start++;\n                }\n            }\n            lastList = topList;\n        });\n        // Restore the content to the position of placeholder\n        placeholder.parentNode.replaceChild(listStack[0], placeholder);\n    };\n    /**\n     * Sets the New List Start Property, that is going to be used to create a new List in the WriteBack function\n     * @param separator The HTML element that indicates when to split the VList\n     * @param startNumber The start number of the new List\n     */\n    VList.prototype.split = function (separator, startNumber) {\n        if (!this.rootList) {\n            throw new Error('rootList must not be null');\n        }\n        //Traverse the items of the VList, when the separator is found, set the New List Start Property\n        for (var index = 0; index < this.items.length; index++) {\n            if (this.items[index].getNode() == separator) {\n                this.items[index].setNewListStart(startNumber);\n                return;\n            }\n        }\n    };\n    VList.prototype.setIndentation = function (start, end, indentation, softOutdent, preventItemRemoval) {\n        var _this = this;\n        if (preventItemRemoval === void 0) { preventItemRemoval = false; }\n        var shouldAddMargin = false;\n        this.findListItems(start, end, function (item) {\n            shouldAddMargin = shouldAddMargin || _this.items.indexOf(item) == 0;\n            indentation == 1 /* Decrease */\n                ? softOutdent && !item.isDummy()\n                    ? item.setIsDummy(true /*isDummy*/)\n                    : item.outdent(preventItemRemoval)\n                : item.indent();\n        });\n        if (shouldAddMargin && preventItemRemoval) {\n            for (var index = 0; index < this.items.length; index++) {\n                this.items[index].addNegativeMargins();\n            }\n        }\n    };\n    /**\n     * Set alignment of the given range of this list\n     * @param start Start position to operate from\n     * @param end End position to operate to\n     * @param alignment Align items left, center or right\n     */\n    VList.prototype.setAlignment = function (start, end, alignment) {\n        this.rootList.style.display = 'flex';\n        this.rootList.style.flexDirection = 'column';\n        this.findListItems(start, end, function (item) {\n            var align = 'start';\n            if (alignment == 1 /* Center */) {\n                align = 'center';\n            }\n            else if (alignment == 2 /* Right */) {\n                align = 'end';\n            }\n            item.getNode().style.alignSelf = align;\n        });\n    };\n    /**\n     * Remove margins of a new list\n     */\n    VList.prototype.removeMargins = function () {\n        if (!this.rootList.style.marginTop && !this.rootList.style.marginBottom) {\n            this.rootList.style.marginBlockStart = '0px';\n            this.rootList.style.marginBlockEnd = '0px';\n        }\n    };\n    /**\n     * Change list type of the given range of this list.\n     * If some of the items are not real list item yet, this will make them to be list item with given type\n     * If all items in the given range are already in the type to change to, this becomes an outdent operation\n     * @param start Start position to operate from\n     * @param end End position to operate to\n     * @param targetType Target list type\n     */\n    VList.prototype.changeListType = function (start, end, targetType) {\n        var needChangeType = false;\n        this.findListItems(start, end, function (item) {\n            needChangeType = needChangeType || item.getListType() != targetType;\n        });\n        this.findListItems(start, end, function (item) {\n            return needChangeType ? item.changeListType(targetType) : item.outdent();\n        });\n    };\n    /**\n     * Change list style of the given range of this list.\n     * If some of the items are not real list item yet, this will make them to be list item with given style\n     * @param orderedStyle The style of ordered list\n     * @param unorderedStyle The style of unordered list\n     */\n    VList.prototype.setListStyleType = function (orderedStyle, unorderedStyle) {\n        var style = getMetadata(this.rootList, ListStyleDefinitionMetadata);\n        var styleMetadata = createListStyleMetadata(style, orderedStyle, unorderedStyle);\n        setMetadata(this.rootList, styleMetadata, ListStyleDefinitionMetadata);\n    };\n    /**\n     * Append a new item to this VList\n     * @param node node of the item to append. If it is not wrapped with LI tag, it will be wrapped\n     * @param type Type of this list item, can be ListType.None\n     */\n    VList.prototype.appendItem = function (node, type) {\n        var nodeTag = getTagOfNode(node);\n        // Change DIV tag to SPAN. Otherwise we cannot create new list item by Enter key in Safari\n        if (nodeTag == 'DIV') {\n            node = changeElementTag(node, 'LI');\n        }\n        else if (nodeTag != 'LI') {\n            node = wrap(node, 'LI');\n        }\n        this.items.push(type == 0 /* None */\n            ? new VListItem(node)\n            : new VListItem(node, type));\n    };\n    /**\n     * Merge the given VList into current VList.\n     * - All list items will be removed from the given VList and added into this list.\n     * - The root node of the given VList will be removed from DOM tree\n     * - If there are orphan items in the given VList, they will be merged into the last item\n     *   of this list if any.\n     * @param list The vList to merge from\n     */\n    VList.prototype.mergeVList = function (list) {\n        var _this = this;\n        var _a;\n        if (list && list != this) {\n            list.items.forEach(function (item) { return _this.items.push(item); });\n            list.items.splice(0, list.items.length);\n            (_a = list.rootList.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(list.rootList);\n        }\n    };\n    /**\n     * Get the index of the List Item in the current List\n     * If the root list is:\n     * Ordered list, the listIndex start count is going to be the start property of the OL - 1,\n     * @example For example if we want to find the index of Item 2 in the list below, the returned index is going to be 6\n     *  * ```html\n     * <ol start=\"5\">\n     *   <li>item 1</li>\n     *   <li>item 2</li> <!-- Node to find -->\n     *   <li>item 3</li>\n     * </ol>\n     * ```\n     * Unordered list, the listIndex start count starts from 0\n     * @example For example if we want to find the index of Item 2 in the list below, the returned index is going to be 2\n     * ```html\n     * <ul>\n     *   <li>item 1</li>\n     *   <li>item 2</li> <!-- Node to find -->\n     *   <li>item 3</li>\n     * </ul>\n     * ```\n     * @param input List item to find in the root list\n     */\n    VList.prototype.getListItemIndex = function (input) {\n        if (this.items) {\n            var listIndex = (this.getStart() || 1) - 1;\n            for (var index = 0; index < this.items.length; index++) {\n                var child = this.items[index];\n                if (child.getLevel() == 1 && !child.isDummy()) {\n                    listIndex++;\n                }\n                if (child.getNode() == input) {\n                    return listIndex;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * Get the Start property of the root list of this VList\n     * @returns Start number of the list\n     */\n    VList.prototype.getStart = function () {\n        return safeInstanceOf(this.rootList, 'HTMLOListElement') ? this.rootList.start : undefined;\n    };\n    VList.prototype.findListItems = function (start, end, callback) {\n        if (this.items.length == 0) {\n            return [];\n        }\n        var listStartPos = new Position(this.items[0].getNode(), 0 /* Begin */);\n        var listEndPos = new Position(this.items[this.items.length - 1].getNode(), -1 /* End */);\n        var startIndex = listStartPos.isAfter(start) ? 0 : -1;\n        var endIndex = this.items.length - (end.isAfter(listEndPos) ? 1 : 0);\n        this.items.forEach(function (item, index) {\n            startIndex = item.contains(start.node) ? index : startIndex;\n            endIndex = item.contains(end.node) ? index : endIndex;\n        });\n        startIndex = endIndex < this.items.length ? Math.max(0, startIndex) : startIndex;\n        endIndex = startIndex >= 0 ? Math.min(this.items.length - 1, endIndex) : endIndex;\n        var result = startIndex <= endIndex ? this.items.slice(startIndex, endIndex + 1) : [];\n        if (callback) {\n            result.forEach(callback);\n        }\n        return result;\n    };\n    VList.prototype.populateItems = function (list, listTypes) {\n        var _this = this;\n        if (listTypes === void 0) { listTypes = []; }\n        var type = getListTypeFromNode(list);\n        var items = toArray(list.childNodes);\n        items.forEach(function (item) {\n            var newListTypes = __spreadArray(__spreadArray([], __read(listTypes), false), [type], false);\n            if (isListElement(item)) {\n                _this.populateItems(item, newListTypes);\n            }\n            else if (item.nodeType != 3 /* Text */ || (item.nodeValue || '').trim() != '') {\n                _this.items.push(new (VListItem.bind.apply(VListItem, __spreadArray([void 0, item], __read(newListTypes), false)))());\n            }\n        });\n    };\n    return VList;\n}());\nexport default VList;\n//Normalization\n// Step 1: Move all non-LI direct children under list into LI\n// e.g.\n// From: <ul><li>line 1</li>line 2</ul>\n// To:   <ul><li>line 1<div>line 2</div></li></ul>\nfunction moveChildNodesToLi(list) {\n    var currentItem = null;\n    toArray(list.childNodes).forEach(function (child) {\n        if (getTagOfNode(child) == 'LI') {\n            currentItem = child;\n        }\n        else if (isListElement(child)) {\n            currentItem = null;\n        }\n        else if (currentItem && !isNodeEmpty(child, true /*trimContent*/)) {\n            currentItem.appendChild(isBlockElement(child) ? child : wrap(child));\n        }\n    });\n}\n// Step 2: Move nested LI up to under list directly\n// e.g.\n// From: <ul><li>line 1<li>line 2</li>line 3</li></ul>\n// To:   <ul><li>line 1</li><li>line 2<div>line 3</div></li></ul>\nfunction moveLiToList(li) {\n    while (!isListElement(li.parentNode)) {\n        splitParentNode(li, true /*splitBefore*/);\n        var furtherNodes = toArray(li.parentNode.childNodes).slice(1);\n        if (furtherNodes.length > 0) {\n            if (!isBlockElement(furtherNodes[0])) {\n                furtherNodes = [wrap(furtherNodes)];\n            }\n            furtherNodes.forEach(function (node) { return li.appendChild(node); });\n        }\n        unwrap(li.parentNode);\n    }\n}\nfunction getValidValue() {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return values.filter(function (x) { return x !== undefined; })[0];\n}\nfunction createListStyleMetadata(style, orderedStyle, unorderedStyle) {\n    return {\n        orderedStyleType: getValidValue(orderedStyle, style === null || style === void 0 ? void 0 : style.orderedStyleType, 1 /* Decimal */),\n        unorderedStyleType: getValidValue(unorderedStyle, style === null || style === void 0 ? void 0 : style.unorderedStyleType, 1 /* Disc */),\n    };\n}\n//# sourceMappingURL=VList.js.map","import findClosestElementAncestor from '../utils/findClosestElementAncestor';\n/**\n * @internal\n * Get Root list node from the given node within the given region\n * @param region Region to scope the search into\n * @param selector The selector to search\n * @param node The start node\n */\nexport default function getRootListNode(region, selector, node) {\n    var list = region &&\n        findClosestElementAncestor(node, region.rootNode, selector);\n    if (list) {\n        var ancestor = void 0;\n        while ((ancestor = findClosestElementAncestor(list.parentNode, region.rootNode, selector))) {\n            list = ancestor;\n        }\n    }\n    return list;\n}\n//# sourceMappingURL=getRootListNode.js.map","import createRange from '../selection/createRange';\nimport Position from '../selection/Position';\nimport { getNextLeafSibling, getPreviousLeafSibling } from '../utils/getLeafSibling';\n/**\n * Get the selection range in the given region.\n * The original range can cover multiple regions, this function will narrow the original selection\n * of a region into current region\n * @param regionBase The region to get range from\n */\nexport default function getSelectionRangeInRegion(regionBase) {\n    if (!regionBase) {\n        return null;\n    }\n    var nodeBefore = regionBase.nodeBefore, nodeAfter = regionBase.nodeAfter, rootNode = regionBase.rootNode, skipTags = regionBase.skipTags;\n    var startNode = nodeBefore\n        ? getNextLeafSibling(regionBase.rootNode, nodeBefore, regionBase.skipTags)\n        : rootNode.firstChild;\n    var endNode = nodeAfter\n        ? getPreviousLeafSibling(rootNode, nodeAfter, skipTags)\n        : rootNode.lastChild;\n    var regionRange = startNode && endNode && createRange(startNode, endNode);\n    if (!isRegion(regionBase)) {\n        return regionRange;\n    }\n    else if (regionRange) {\n        var regionStart = Position.getStart(regionRange).normalize();\n        var regionEnd = Position.getEnd(regionRange).normalize();\n        var fullSelectionEnd = regionBase.fullSelectionEnd, fullSelectionStart = regionBase.fullSelectionStart;\n        if (!fullSelectionStart.isAfter(regionEnd) && !regionStart.isAfter(fullSelectionEnd)) {\n            var start = fullSelectionStart.isAfter(regionStart)\n                ? fullSelectionStart\n                : regionStart;\n            var end = fullSelectionEnd.isAfter(regionEnd) ? regionEnd : fullSelectionEnd;\n            return createRange(start, end);\n        }\n    }\n    return null;\n}\nfunction isRegion(regionBase) {\n    var region = regionBase;\n    return !!region.fullSelectionEnd && !!region.fullSelectionStart;\n}\n//# sourceMappingURL=getSelectionRangeInRegion.js.map","import ContentTraverser from '../contentTraverser/ContentTraverser';\nimport createElement from '../utils/createElement';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getSelectionRangeInRegion from './getSelectionRangeInRegion';\nimport shouldSkipNode from '../utils/shouldSkipNode';\n/**\n * Get all block elements covered by the selection under this region\n * @param regionBase The region to get block elements from\n * @param createBlockIfEmpty When set to true, a new empty block element will be created if there is not\n * any blocks in the region. Default value is false\n * @param deprecated Deprecated parameter, not used\n */\nexport default function getSelectedBlockElementsInRegion(regionBase, createBlockIfEmpty, deprecated) {\n    var range = getSelectionRangeInRegion(regionBase);\n    var blocks = [];\n    if (range) {\n        var rootNode = regionBase.rootNode, skipTags = regionBase.skipTags;\n        var traverser = ContentTraverser.createSelectionTraverser(rootNode, range, skipTags);\n        for (var block = traverser === null || traverser === void 0 ? void 0 : traverser.currentBlockElement; !!block; block = traverser.getNextBlockElement()) {\n            blocks.push(block);\n        }\n        // Remove meaningless nodes\n        blocks = blocks.filter(function (block) {\n            var _a;\n            var startNode = block.getStartNode();\n            var endNode = block.getEndNode();\n            if (startNode == endNode && shouldSkipNode(startNode, true /*ignoreSpace*/)) {\n                (_a = startNode.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(startNode);\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    if (blocks.length == 0 && regionBase && !regionBase.rootNode.firstChild && createBlockIfEmpty) {\n        var newNode = createElement(1 /* EmptyLine */, regionBase.rootNode.ownerDocument);\n        regionBase.rootNode.appendChild(newNode);\n        var block = getBlockElementAtNode(regionBase.rootNode, newNode);\n        if (block) {\n            blocks.push(block);\n        }\n    }\n    return blocks;\n}\n//# sourceMappingURL=getSelectedBlockElementsInRegion.js.map","import contains from '../utils/contains';\n/**\n * Check if a given node is contained by the given region\n * @param region The region to check from\n * @param node The node or block element to check\n */\nexport default function isNodeInRegion(region, node) {\n    return !!(region &&\n        contains(region.rootNode, node) &&\n        (!region.nodeBefore ||\n            region.nodeBefore.compareDocumentPosition(node) == 4 /* Following */) &&\n        (!region.nodeAfter ||\n            region.nodeAfter.compareDocumentPosition(node) == 2 /* Preceding */));\n}\n//# sourceMappingURL=isNodeInRegion.js.map","import createElement from '../utils/createElement';\nimport getRootListNode from './getRootListNode';\nimport getSelectedBlockElementsInRegion from '../region/getSelectedBlockElementsInRegion';\nimport isNodeInRegion from '../region/isNodeInRegion';\nimport Position from '../selection/Position';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport shouldSkipNode from '../utils/shouldSkipNode';\nimport toArray from '../jsUtils/toArray';\nimport VList from './VList';\nimport wrap from '../utils/wrap';\nimport { getLeafSibling } from '../utils/getLeafSibling';\nimport { isListElement } from './getListTypeFromNode';\nvar ListSelector = 'ol,ul';\n/**\n * Create a VList object from the given region.\n * @param region The region to get VList from\n * @param includeSiblingLists True to also try get lists before and after the selection and merge them together,\n * false to only include the list for the selected blocks\n * @param startNode (Optional) When specified, try get VList which will contain this node.\n * If not specified, get VList from selection of this region\n */\nexport default function createVListFromRegion(region, includeSiblingLists, startNode) {\n    if (!region) {\n        return null;\n    }\n    var nodes = [];\n    if (startNode) {\n        var list = getRootListNode(region, ListSelector, startNode);\n        if (list) {\n            nodes.push(list);\n        }\n    }\n    else {\n        var blocks = getSelectedBlockElementsInRegion(region, undefined, true /* shouldApplyFormatToSpan */);\n        blocks.forEach(function (block) {\n            var list = getRootListNode(region, ListSelector, block.getStartNode());\n            if (list) {\n                if (nodes[nodes.length - 1] != list) {\n                    nodes.push(list);\n                }\n                if (nodes.length == 1 &&\n                    safeInstanceOf(list, 'HTMLOListElement') &&\n                    list.start > 1) {\n                    // Do not include sibling lists if this list is not start from 1\n                    includeSiblingLists = false;\n                }\n            }\n            else {\n                nodes.push(block.collapseToSingleElement());\n            }\n        });\n        if (nodes.length == 0 && !region.rootNode.firstChild) {\n            var newNode = createElement(1 /* EmptyLine */, region.rootNode.ownerDocument);\n            region.rootNode.appendChild(newNode);\n            nodes.push(newNode);\n            region.fullSelectionStart = new Position(newNode, 0 /* Begin */);\n            region.fullSelectionEnd = new Position(newNode, -1 /* End */);\n        }\n        if (includeSiblingLists) {\n            tryIncludeSiblingNode(region, nodes, false /*isNext*/);\n            tryIncludeSiblingNode(region, nodes, true /*isNext*/);\n        }\n        nodes = nodes.filter(function (node) { return !shouldSkipNode(node, true /*ignoreSpace*/); });\n    }\n    var vList = null;\n    if (nodes.length > 0) {\n        var firstNode = nodes.shift() || null;\n        vList = isListElement(firstNode)\n            ? new VList(firstNode)\n            : firstNode\n                ? createVListFromItemNode(firstNode)\n                : null;\n        if (vList) {\n            nodes.forEach(function (node) {\n                if (isListElement(node)) {\n                    vList.mergeVList(new VList(node));\n                }\n                else {\n                    vList.appendItem(node, 0 /* None */);\n                }\n            });\n        }\n    }\n    return vList;\n}\nfunction tryIncludeSiblingNode(region, nodes, isNext) {\n    var node = nodes[isNext ? nodes.length - 1 : 0];\n    node = getLeafSibling(region.rootNode, node, isNext, region.skipTags, true /*ignoreSpace*/);\n    node = getRootListNode(region, ListSelector, node);\n    if (isNodeInRegion(region, node) && isListElement(node)) {\n        if (isNext) {\n            if (!safeInstanceOf(node, 'HTMLOListElement') || node.start == 1) {\n                // Only include sibling list when\n                // 1. This is a unordered list, OR\n                // 2. This list starts from 1\n                nodes.push(node);\n            }\n        }\n        else {\n            nodes.unshift(node);\n        }\n    }\n}\nfunction createVListFromItemNode(node) {\n    // Wrap all child nodes under a single one, and put the new list under original root node\n    // so that the list can carry over styles under the root node.\n    var childNodes = toArray(node.childNodes);\n    var nodeForItem = childNodes.length == 1 ? childNodes[0] : wrap(childNodes, 'SPAN');\n    // Create a temporary OL root element for this list.\n    var listNode = node.ownerDocument.createElement('ol'); // Either OL or UL is ok here\n    node.appendChild(listNode);\n    // Create the VList and append items\n    var vList = new VList(listNode);\n    vList.appendItem(nodeForItem, 0 /* None */);\n    return vList;\n}\n//# sourceMappingURL=createVListFromRegion.js.map","/**\n * A type-safe wrapper for Array.prototype.push.apply()\n * @param mainArray The main array to push items into\n * @param itemsArray The items to push to main array\n */\nexport default function arrayPush(mainArray, itemsArray) {\n    Array.prototype.push.apply(mainArray, itemsArray);\n}\n//# sourceMappingURL=arrayPush.js.map","import arrayPush from '../jsUtils/arrayPush';\nimport getRootListNode from './getRootListNode';\nimport isNodeAfter from '../utils/isNodeAfter';\nimport isNodeInRegion from '../region/isNodeInRegion';\nimport queryElements from '../utils/queryElements';\nimport VList from './VList';\nvar CHAIN_NAME_PREFIX = '__List_Chain_';\nvar CHAIN_DATASET_NAME = 'listchain';\nvar AFTER_CURSOR_DATASET_NAME = 'listchainafter';\nvar lastChainIndex = 0;\n/**\n * Represent a chain of list nodes.\n * A chain of lists is a virtual link of lists that have continuous numbers, when editor one of them,\n * all others should also be updated in order to main the list number to be continuous.\n */\nvar VListChain = /** @class */ (function () {\n    /**\n     * Construct a new instance of VListChain class\n     * @param editor Editor object\n     */\n    function VListChain(region, name) {\n        this.region = region;\n        this.name = name;\n        this.lastNumber = 0;\n        this.lastNumberBeforeCursor = 0;\n    }\n    /**\n     * Create an array of VListChain from current region in editor\n     * @param region The region to create VListChain from\n     * @param currentNode Optional current node, used for mark lists that are after this node\n     * @param nameGenerator Used by test code only\n     */\n    VListChain.createListChains = function (region, currentNode, nameGenerator) {\n        var regions = Array.isArray(region) ? region : region ? [region] : [];\n        var result = [];\n        regions.forEach(function (region) {\n            var chains = [];\n            var lastList;\n            queryElements(region.rootNode, 'ol', function (ol) {\n                var list = getRootListNode(region, 'ol', ol);\n                if (lastList != list) {\n                    var chain = chains.filter(function (c) { return c.canAppendToTail(list); })[0] ||\n                        new VListChain(region, (nameGenerator || createListChainName)());\n                    var index = chains.indexOf(chain);\n                    var afterCurrentNode = !!currentNode && isNodeAfter(list, currentNode);\n                    if (!afterCurrentNode) {\n                        // Make sure current one is at the front if current block has not been met, so that\n                        // the first chain is always the nearest one from current node\n                        if (index >= 0) {\n                            chains.splice(index, 1);\n                        }\n                        chains.unshift(chain);\n                    }\n                    else if (index < 0) {\n                        chains.push(chain);\n                    }\n                    chain.append(list, afterCurrentNode);\n                    lastList = list;\n                }\n            });\n            arrayPush(result, chains);\n        });\n        return result;\n    };\n    /**\n     * Check if a list with the given start number can be appended next to the last list before cursor\n     * @param startNumber The start number of the new list\n     */\n    VListChain.prototype.canAppendAtCursor = function (startNumber) {\n        return startNumber > 1 && this.lastNumberBeforeCursor + 1 == startNumber;\n    };\n    /**\n     * Create a VList to wrap the block of the given node, and append to current chain\n     * @param container The container node to create list at\n     * @param startNumber Start number of the new list\n     */\n    VListChain.prototype.createVListAtBlock = function (container, startNumber) {\n        if (container && container.parentNode) {\n            var list = container.ownerDocument.createElement('ol');\n            list.start = startNumber;\n            this.applyChainName(list);\n            container.parentNode.insertBefore(list, container);\n            var vList = new VList(list);\n            vList.appendItem(container, 0 /* None */);\n            return vList;\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * After change the lists, commit the change to all lists in this chain to update the list number,\n     * and clear the temporary dataset values added to list node\n     * @param shouldReuseAllAncestorListElements Whether we can parent list item (OL/UL) even if its list type does not match the previous one. @default false\n     * @param disableListChain Whether we want to disable list chain functionality, so splitted list will always restart its number from 1 @default false\n     */\n    VListChain.prototype.commit = function (shouldReuseAllAncestorListElements, disableListChain) {\n        var lists = this.getLists();\n        var lastNumber = 0;\n        for (var i = 0; i < lists.length; i++) {\n            var list = lists[i];\n            if (!disableListChain) {\n                //If there is a list chain sequence, ensure the list chain keep increasing correctly\n                if (list.start > 1) {\n                    list.start = list.start === lastNumber ? lastNumber + 1 : list.start;\n                }\n                else {\n                    list.start = lastNumber + 1;\n                }\n            }\n            var vlist = new VList(list);\n            lastNumber = vlist.getLastItemNumber() || 0;\n            delete list.dataset[CHAIN_DATASET_NAME];\n            delete list.dataset[AFTER_CURSOR_DATASET_NAME];\n            vlist.writeBack(shouldReuseAllAncestorListElements);\n        }\n    };\n    /**\n     * Check if the given list node is can be appended into current list chain\n     * @param list The list node to check\n     */\n    VListChain.prototype.canAppendToTail = function (list) {\n        return this.lastNumber + 1 == list.start;\n    };\n    /**\n     * Append the given list node into this VListChain\n     * @param list The list node to append\n     * @param isAfterCurrentNode Whether this list is after current node\n     */\n    VListChain.prototype.append = function (list, isAfterCurrentNode) {\n        this.applyChainName(list);\n        this.lastNumber = new VList(list).getLastItemNumber() || 0;\n        if (isAfterCurrentNode) {\n            list.dataset[AFTER_CURSOR_DATASET_NAME] = 'true';\n        }\n        else {\n            this.lastNumberBeforeCursor = this.lastNumber;\n        }\n    };\n    VListChain.prototype.applyChainName = function (list) {\n        list.dataset[CHAIN_DATASET_NAME] = this.name;\n    };\n    VListChain.prototype.getLists = function () {\n        var _this = this;\n        return queryElements(this.region.rootNode, \"ol[data-\" + CHAIN_DATASET_NAME + \"=\" + this.name + \"]\").filter(function (node) { return isNodeInRegion(_this.region, node); });\n    };\n    return VListChain;\n}());\nexport default VListChain;\nfunction createListChainName() {\n    return CHAIN_NAME_PREFIX + lastChainIndex++;\n}\n//# sourceMappingURL=VListChain.js.map","var _a;\nimport { __read } from \"tslib\";\nimport contains from '../utils/contains';\nimport findClosestElementAncestor from '../utils/findClosestElementAncestor';\nimport Position from '../selection/Position';\nimport queryElements from '../utils/queryElements';\nimport { getNextLeafSibling, getPreviousLeafSibling } from '../utils/getLeafSibling';\nvar regionTypeData = (_a = {},\n    _a[0 /* Table */] = {\n        skipTags: ['TABLE'],\n        outerSelector: 'table',\n        innerSelector: 'td,th',\n    },\n    _a);\n/**\n * Get regions impacted by the given range under the root node\n * @param root Root node to get regions from\n * @param range A selection range. Regions will be created according to this range. Each region will be\n * fully or partially covered by this range.\n * @param type Type of region. Currently we only support TABLE region.\n */\nexport default function getRegionsFromRange(root, range, type) {\n    var _a;\n    var regions = [];\n    if (root && range) {\n        var _b = regionTypeData[type], innerSelector = _b.innerSelector, skipTags = _b.skipTags;\n        var boundaryTree = buildBoundaryTree(root, range, type);\n        var start = findClosestElementAncestor(range.startContainer, root, innerSelector) || root;\n        var end = findClosestElementAncestor(range.endContainer, root, innerSelector) || root;\n        var creator = getRegionCreator(range, skipTags);\n        _a = __read(iterateNodes(creator, boundaryTree, start, end), 1), regions = _a[0];\n    }\n    return regions.filter(function (r) { return !!r; });\n}\n/**\n * @internal export for test only\n */\nexport function getRegionCreator(fullRange, skipTags) {\n    var fullSelectionStart = Position.getStart(fullRange).normalize();\n    var fullSelectionEnd = Position.getEnd(fullRange).normalize();\n    return function (rootNode, nodeBefore, nodeAfter) {\n        return areNodesValid(rootNode, nodeBefore, nodeAfter, skipTags)\n            ? {\n                rootNode: rootNode,\n                nodeBefore: nodeBefore,\n                nodeAfter: nodeAfter,\n                skipTags: skipTags,\n                fullSelectionStart: fullSelectionStart,\n                fullSelectionEnd: fullSelectionEnd,\n            }\n            : null;\n    };\n}\n/**\n * Step 1: Build boundary tree\n * @param root Root node of the whole scope, normally this will be the root of editable scope\n * @param range Existing selected full range\n * @param type Type of region to create\n */\nfunction buildBoundaryTree(root, range, type) {\n    var allBoundaries = [{ innerNode: root, children: [] }];\n    var _a = regionTypeData[type], outerSelector = _a.outerSelector, innerSelector = _a.innerSelector;\n    var inSelectionOuterNode = queryElements(root, outerSelector, null /*callback*/, 2 /* InSelection */, range);\n    // According to https://www.w3.org/TR/selectors-api/#queryselectorall, the result of querySelectorAll\n    // is in document order, which is what we expect. So we don't need to sort the result here.\n    queryElements(root, innerSelector, function (thisInnerNode) {\n        var thisOuterNode = findClosestElementAncestor(thisInnerNode, root, outerSelector);\n        if (thisOuterNode && inSelectionOuterNode.indexOf(thisOuterNode) < 0) {\n            var boundary = { innerNode: thisInnerNode, children: [] };\n            for (var i = allBoundaries.length - 1; i >= 0; i--) {\n                var _a = allBoundaries[i], innerNode = _a.innerNode, children = _a.children;\n                if (contains(innerNode, thisOuterNode)) {\n                    var child = children.filter(function (c) { return c.outerNode == thisOuterNode; })[0];\n                    if (!child) {\n                        child = { outerNode: thisOuterNode, boundaries: [] };\n                        children.push(child);\n                    }\n                    child.boundaries.push(boundary);\n                    break;\n                }\n            }\n            allBoundaries.push(boundary);\n        }\n    }, 1 /* OnSelection */, range);\n    return allBoundaries[0];\n}\n/**\n * Step 2: Recursively iterate all boundaries and create regions\n * @param creator A region creator function to help create region\n * @param boundary Current root boundary\n * @param start A node where full range start from. This may not be the direct node container of range.startContainer.\n * It is the nearest ancestor which satisfies the InnerSelector of the given region type\n * @param end A node where full range end from. This may not be the direct node container of range.endContainer.\n * It is the nearest ancestor which satisfies the InnerSelector of the given region type\n * @param started Whether we have already hit the start node\n */\nfunction iterateNodes(creator, boundary, start, end, started) {\n    var _a;\n    started = started || boundary.innerNode == start;\n    var ended = false;\n    var children = boundary.children, innerNode = boundary.innerNode;\n    var regions = [];\n    if (children.length == 0) {\n        var region = creator(innerNode);\n        if (region) {\n            regions.push(region);\n        }\n    }\n    else {\n        // Need to run one more time to add region after all children\n        for (var i = 0; i <= children.length && !ended; i++) {\n            var _b = children[i] || {}, outerNode = _b.outerNode, boundaries = _b.boundaries;\n            var previousOuterNode = (_a = children[i - 1]) === null || _a === void 0 ? void 0 : _a.outerNode;\n            if (started) {\n                var region = creator(innerNode, previousOuterNode, outerNode);\n                if (region) {\n                    regions.push(region);\n                }\n            }\n            boundaries === null || boundaries === void 0 ? void 0 : boundaries.forEach(function (child) {\n                var _a;\n                var newRegions;\n                _a = __read(iterateNodes(creator, child, start, end, started), 3), newRegions = _a[0], started = _a[1], ended = _a[2];\n                regions = regions.concat(newRegions);\n            });\n        }\n    }\n    return [regions, started, ended || innerNode == end];\n}\n/**\n * Check if the given nodes combination is valid to create a region.\n * A combination is valid when:\n * 1. Root node is not null and is not empty. And\n * 2. For nodeBefore and nodeAfter, each of them should be either null or contained by root node. And\n * 3. If none of nodeBefore and nodeAfter is null, the should not contain each other, and there should be\n * node between them.\n * @param root Root node of region\n * @param nodeBefore The boundary node before the region under root\n * @param nodeAfter The boundary node after the region under root\n * @param skipTags Tags to skip\n */\nfunction areNodesValid(root, nodeBefore, nodeAfter, skipTags) {\n    if (!root) {\n        return false;\n    }\n    else {\n        var firstNodeOfRegion = nodeBefore && getNextLeafSibling(root, nodeBefore, skipTags);\n        var lastNodeOfRegion = nodeAfter && getPreviousLeafSibling(root, nodeAfter, skipTags);\n        var firstNodeValid = !nodeBefore || (contains(root, nodeBefore) && contains(root, firstNodeOfRegion));\n        var lastNodeValid = !nodeAfter || (contains(root, nodeAfter) && contains(root, lastNodeOfRegion));\n        var bothValid = !nodeBefore ||\n            !nodeAfter ||\n            (!contains(nodeBefore, nodeAfter, true /*treatSameAsContain*/) &&\n                !contains(nodeBefore, lastNodeOfRegion, true /*treatSameAsContain*/) &&\n                !contains(nodeAfter, nodeBefore, true /*treatSameAsContain*/) &&\n                !contains(nodeAfter, firstNodeOfRegion, true /*treatSameAsContain*/));\n        return firstNodeValid && lastNodeValid && bothValid;\n    }\n}\n//# sourceMappingURL=getRegionsFromRange.js.map","import collapseNode from '../utils/collapseNodes';\nimport isNodeInRegion from './isNodeInRegion';\nimport safeInstanceOf from '../utils/safeInstanceOf';\n/**\n * Collapse nodes within this region to their common ancestor node under this region\n * @param region The region to collapse nodes in.\n * @param nodesOrBlockElements Nodes or block elements to collapse. When take BlockElement[] as input,\n * start node of the first BlockElement and end node of the last BlockElement will be used as the nodes.\n * All nodes not contained by the given region will be ignored.\n */\nexport default function collapseNodesInRegion(region, nodesOrBlockElements) {\n    if (!nodesOrBlockElements || nodesOrBlockElements.length == 0) {\n        return [];\n    }\n    var nodes = safeInstanceOf(nodesOrBlockElements[0], 'Node')\n        ? nodesOrBlockElements\n        : [\n            nodesOrBlockElements[0].getStartNode(),\n            nodesOrBlockElements[nodesOrBlockElements.length - 1].getEndNode(),\n        ];\n    nodes = nodes && nodes.filter(function (node) { return isNodeInRegion(region, node); });\n    var firstNode = nodes[0];\n    var lastNode = nodes[nodes.length - 1];\n    if (isNodeInRegion(region, firstNode) && isNodeInRegion(region, lastNode)) {\n        return collapseNode(region.rootNode, firstNode, lastNode, true /*canSplitParent*/);\n    }\n    else {\n        return [];\n    }\n}\n//# sourceMappingURL=collapseNodesInRegion.js.map","import contains from '../utils/contains';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport isNodeEmpty from '../utils/isNodeEmpty';\n/**\n * Check if this position is at beginning of the given node.\n * This will return true if all nodes between the beginning of target node and the position are empty.\n * @param position The position to check\n * @param targetNode The node to check\n * @returns True if position is at beginning of the node, otherwise false\n */\nexport default function isPositionAtBeginningOf(position, targetNode) {\n    if (position) {\n        position = position.normalize();\n        var node = position.node;\n        var offset = position.offset;\n        if (offset == 0) {\n            while (node && contains(targetNode, node) && areAllPreviousNodesEmpty(node)) {\n                node = (node === null || node === void 0 ? void 0 : node.parentNode) || null;\n            }\n            return node == targetNode;\n        }\n    }\n    return false;\n}\nfunction areAllPreviousNodesEmpty(node) {\n    while (node.previousSibling) {\n        node = node.previousSibling;\n        if (getTagOfNode(node) == 'BR' || !isNodeEmpty(node)) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=isPositionAtBeginningOf.js.map","import contains from '../utils/contains';\nimport Position from './Position';\n/**\n * Get path of the given selection range related to the given rootNode\n * @param rootNode The root node where the path start from\n * @param range The range of selection\n */\nexport default function getSelectionPath(rootNode, range) {\n    if (!range) {\n        return null;\n    }\n    var selectionPath = {\n        start: getPositionPath(Position.getStart(range), rootNode),\n        end: getPositionPath(Position.getEnd(range), rootNode),\n    };\n    return selectionPath;\n}\n/**\n * Get the path of the node relative to rootNode.\n * The path of the node is an array of integer indices into the childNodes of the given node.\n *\n * The node path will be what the node path will be on a _normalized_ dom\n * (e.g. empty text nodes will be ignored and adjacent text nodes will be concatenated)\n *\n * @param rootNode the node the path will be relative to\n * @param position the position to get indexes from. Follows the same semantics\n * as selectionRange (if node is of type Text, it is an offset into the text of that node.\n * If node is of type Element, it is the index of a child in that Element node.)\n */\nfunction getPositionPath(position, rootNode) {\n    var _a, _b;\n    if (!position || !rootNode) {\n        return [];\n    }\n    var node = position.node;\n    var offset = position.offset;\n    var result = [];\n    var parent;\n    if (!contains(rootNode, node, true)) {\n        return [];\n    }\n    if (node.nodeType == 3 /* Text */) {\n        parent = node.parentNode;\n        while (node.previousSibling && node.previousSibling.nodeType == 3 /* Text */) {\n            offset += ((_a = node.previousSibling.nodeValue) === null || _a === void 0 ? void 0 : _a.length) || 0;\n            node = node.previousSibling;\n        }\n        result.unshift(offset);\n    }\n    else {\n        parent = node;\n        node = node.childNodes[offset];\n    }\n    do {\n        offset = 0;\n        var isPreviousText = false;\n        for (var c = (parent === null || parent === void 0 ? void 0 : parent.firstChild) || null; c && c != node; c = c.nextSibling) {\n            if (c.nodeType == 3 /* Text */) {\n                if (((_b = c.nodeValue) === null || _b === void 0 ? void 0 : _b.length) === 0 || isPreviousText) {\n                    continue;\n                }\n                isPreviousText = true;\n            }\n            else {\n                isPreviousText = false;\n            }\n            offset++;\n        }\n        result.unshift(offset);\n        node = parent;\n        parent = (parent === null || parent === void 0 ? void 0 : parent.parentNode) || null;\n    } while (node && node != rootNode);\n    return result;\n}\n//# sourceMappingURL=getSelectionPath.js.map","import getInnerHTML from '../utils/getInnerHTML';\nimport getSelectionPath from './getSelectionPath';\n/**\n * Get inner Html of a root node with a selection path which can be used for restore selection.\n * The result string can be used by setHtmlWithSelectionPath() to restore the HTML and selection.\n * @param rootNode Root node to get inner Html from\n * @param range The range of selection. If pass null, no selection path will be added\n * @returns Inner HTML of the root node, followed by HTML comment contains selection path if the given range is valid\n */\nexport default function getHtmlWithSelectionPath(rootNode, range) {\n    if (!rootNode) {\n        return '';\n    }\n    var content = getInnerHTML(rootNode);\n    var selectionPath = range && getSelectionPath(rootNode, range);\n    return selectionPath ? content + \"<!--\" + JSON.stringify(selectionPath) + \"-->\" : content;\n}\n//# sourceMappingURL=getHtmlWithSelectionPath.js.map","import safeInstanceOf from './safeInstanceOf';\n/**\n * Get innerHTML of the given node\n * @param node The DOM node to get innerHTML from\n */\nexport default function getInnerHTML(node) {\n    if (safeInstanceOf(node, 'HTMLElement')) {\n        return node.innerHTML;\n    }\n    else if (node) {\n        var tempNode = node.ownerDocument.createElement('span');\n        tempNode.appendChild(node.cloneNode(true /*deep*/));\n        return tempNode.innerHTML;\n    }\n    else {\n        return '';\n    }\n}\n//# sourceMappingURL=getInnerHTML.js.map","import createRange from './createRange';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport validate from '../metadata/validate';\nimport { createArrayDefinition, createBooleanDefinition, createNumberDefinition, createObjectDefinition, createStringDefinition, } from '../metadata/definitionCreators';\nvar NumberArrayDefinition = createArrayDefinition(createNumberDefinition());\nvar CoordinatesDefinition = createObjectDefinition({\n    x: createNumberDefinition(),\n    y: createNumberDefinition(),\n});\nvar IsDarkModeDefinition = createBooleanDefinition(true /*isOptional*/);\nvar NormalContentMetadataDefinition = createObjectDefinition({\n    type: createNumberDefinition(true /*isOptional*/, 0 /* Normal */),\n    isDarkMode: IsDarkModeDefinition,\n    start: NumberArrayDefinition,\n    end: NumberArrayDefinition,\n});\nvar TableContentMetadataDefinition = createObjectDefinition({\n    type: createNumberDefinition(false /*isOptional*/, 1 /* TableSelection */),\n    isDarkMode: IsDarkModeDefinition,\n    tableId: createStringDefinition(),\n    firstCell: CoordinatesDefinition,\n    lastCell: CoordinatesDefinition,\n});\nvar ImageContentMetadataDefinition = createObjectDefinition({\n    type: createNumberDefinition(false /*isOptional*/, 2 /* ImageSelection */),\n    isDarkMode: IsDarkModeDefinition,\n    imageId: createStringDefinition(),\n});\n/**\n * @deprecated Use setHtmlWithMetadata instead\n * Restore inner HTML of a root element from given html string. If the string contains selection path,\n * remove the selection path and return a range represented by the path\n * @param root The root element\n * @param html The HTML to restore\n * @param trustedHTMLHandler An optional trusted HTML handler to convert HTML string to security string\n * @returns A selection range if the html contains a valid selection path, otherwise null\n */\nexport default function setHtmlWithSelectionPath(rootNode, html, trustedHTMLHandler) {\n    var metadata = setHtmlWithMetadata(rootNode, html, trustedHTMLHandler);\n    return (metadata === null || metadata === void 0 ? void 0 : metadata.type) == 0 /* Normal */\n        ? createRange(rootNode, metadata.start, metadata.end)\n        : null;\n}\n/**\n * Restore inner HTML of a root element from given html string. If the string contains metadata,\n * remove it from DOM tree and return the metadata\n * @param root The root element\n * @param html The HTML to restore\n * @param trustedHTMLHandler An optional trusted HTML handler to convert HTML string to security string\n * @returns Content metadata if any, or undefined\n */\nexport function setHtmlWithMetadata(rootNode, html, trustedHTMLHandler) {\n    if (!rootNode) {\n        return undefined;\n    }\n    html = html || '';\n    rootNode.innerHTML = (trustedHTMLHandler === null || trustedHTMLHandler === void 0 ? void 0 : trustedHTMLHandler(html)) || html;\n    return extractContentMetadata(rootNode);\n}\n/**\n * Extract content metadata from DOM tree\n * @param rootNode Root of the DOM tree\n * @returns If there is a valid content metadata node in the give DOM tree, return this metadata object, otherwise undefined\n */\nexport function extractContentMetadata(rootNode) {\n    var potentialMetadataComment = rootNode.lastChild;\n    if (safeInstanceOf(potentialMetadataComment, 'Comment')) {\n        try {\n            var obj = JSON.parse(potentialMetadataComment.nodeValue || '');\n            if (validate(obj, NormalContentMetadataDefinition) ||\n                validate(obj, TableContentMetadataDefinition) ||\n                validate(obj, ImageContentMetadataDefinition)) {\n                rootNode.removeChild(potentialMetadataComment);\n                obj.type = typeof obj.type === 'undefined' ? 0 /* Normal */ : obj.type;\n                obj.isDarkMode = obj.isDarkMode || false;\n                return obj;\n            }\n        }\n        catch (_a) { }\n    }\n    return undefined;\n}\n//# sourceMappingURL=setHtmlWithSelectionPath.js.map","import { Browser } from '../utils/Browser';\n/**\n * Add the given range into selection of the given document\n * @param range The range to select\n * @param skipSameRange When set to true, do nothing if the given range is the same with current selection,\n * otherwise it will always remove current selection range and set to the given one.\n * This parameter is always treat as true in Edge to avoid some weird runtime exception.\n */\nexport default function addRangeToSelection(range, skipSameRange) {\n    var _a, _b, _c;\n    var selection = (_c = (_b = (_a = range === null || range === void 0 ? void 0 : range.commonAncestorContainer) === null || _a === void 0 ? void 0 : _a.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView) === null || _c === void 0 ? void 0 : _c.getSelection();\n    if (selection) {\n        var needAddRange = true;\n        if (selection.rangeCount > 0) {\n            // Workaround IE exception 800a025e\n            try {\n                var currentRange = null;\n                // Do not remove/add range if current selection is the same with target range\n                // Without this check, execCommand() may fail in Edge since we changed the selection\n                if ((skipSameRange || Browser.isEdge) &&\n                    (currentRange = selection.rangeCount == 1 ? selection.getRangeAt(0) : null) &&\n                    currentRange.startContainer == range.startContainer &&\n                    currentRange.startOffset == range.startOffset &&\n                    currentRange.endContainer == range.endContainer &&\n                    currentRange.endOffset == range.endOffset) {\n                    needAddRange = false;\n                }\n                else {\n                    selection.removeAllRanges();\n                }\n            }\n            catch (e) { }\n        }\n        if (needAddRange) {\n            selection.addRange(range);\n        }\n    }\n}\n//# sourceMappingURL=addRangeToSelection.js.map","/**\n * Check whether can move current snapshot with the given step\n * @param snapshots The snapshots data structure to check\n * @param step The step to check, can be positive, negative or 0\n * @returns True if can move current snapshot with the given step, otherwise false\n */\nexport default function canMoveCurrentSnapshot(snapshots, step) {\n    var newIndex = snapshots.currentIndex + step;\n    return newIndex >= 0 && newIndex < snapshots.snapshots.length;\n}\n//# sourceMappingURL=canMoveCurrentSnapshot.js.map","import canMoveCurrentSnapshot from './canMoveCurrentSnapshot';\n/**\n * Clear all snapshots after the current one\n * @param snapshots The snapshots data structure to clear\n */\nexport default function clearProceedingSnapshots(snapshots, getLength) {\n    getLength = getLength || (function (str) { var _a; return ((_a = str) === null || _a === void 0 ? void 0 : _a.length) || 0; });\n    if (canMoveCurrentSnapshot(snapshots, 1)) {\n        var removedSize = 0;\n        for (var i = snapshots.currentIndex + 1; i < snapshots.snapshots.length; i++) {\n            removedSize += getLength(snapshots.snapshots[i]);\n        }\n        snapshots.snapshots.splice(snapshots.currentIndex + 1);\n        snapshots.totalSize -= removedSize;\n        snapshots.autoCompleteIndex = -1;\n    }\n}\n/**\n * Clear all snapshots after the current one\n * @param snapshots The snapshots data structure to clear\n */\nexport function clearProceedingSnapshotsV2(snapshots) {\n    clearProceedingSnapshots(snapshots, function (s) { var _a; return ((_a = s.html) === null || _a === void 0 ? void 0 : _a.length) || 0; });\n}\n//# sourceMappingURL=clearProceedingSnapshots.js.map","import clearProceedingSnapshots from './clearProceedingSnapshots';\nexport default function addSnapshot(snapshots, snapshot, isAutoCompleteSnapshot, getLength, compare) {\n    getLength = getLength || (function (str) { var _a; return ((_a = str) === null || _a === void 0 ? void 0 : _a.length) || 0; });\n    compare = compare || defaultCompare;\n    var currentSnapshot = snapshots.snapshots[snapshots.currentIndex];\n    var isSameSnapshot = currentSnapshot && compare(currentSnapshot, snapshot);\n    if (snapshots.currentIndex < 0 || !currentSnapshot || !isSameSnapshot) {\n        clearProceedingSnapshots(snapshots, getLength);\n        snapshots.snapshots.push(snapshot);\n        snapshots.currentIndex++;\n        snapshots.totalSize += getLength(snapshot);\n        var removeCount = 0;\n        while (removeCount < snapshots.snapshots.length &&\n            snapshots.totalSize > snapshots.maxSize) {\n            snapshots.totalSize -= getLength(snapshots.snapshots[removeCount]);\n            removeCount++;\n        }\n        if (removeCount > 0) {\n            snapshots.snapshots.splice(0, removeCount);\n            snapshots.currentIndex -= removeCount;\n            snapshots.autoCompleteIndex -= removeCount;\n        }\n        if (isAutoCompleteSnapshot) {\n            snapshots.autoCompleteIndex = snapshots.currentIndex;\n        }\n    }\n    else if (isSameSnapshot) {\n        // replace the currentSnapshot's metadata so the selection is updated\n        snapshots.snapshots.splice(snapshots.currentIndex, 1, snapshot);\n    }\n}\n/**\n * Add a new snapshot to the given snapshots data structure\n * @param snapshots The snapshots data structure to add new snapshot into\n * @param snapshot The snapshot object to add\n * @param isAutoCompleteSnapshot Whether this is a snapshot before auto complete action\n */\nexport function addSnapshotV2(snapshots, snapshot, isAutoCompleteSnapshot) {\n    addSnapshot(snapshots, snapshot, isAutoCompleteSnapshot, function (s) { var _a; return ((_a = s.html) === null || _a === void 0 ? void 0 : _a.length) || 0; }, compareSnapshots);\n}\nfunction compareSnapshots(s1, s2) {\n    return s1.html == s2.html && !s1.entityStates && !s2.entityStates;\n}\nfunction defaultCompare(s1, s2) {\n    return s1 == s2;\n}\n//# sourceMappingURL=addSnapshot.js.map","import { __read, __spreadArray } from \"tslib\";\n/**\n * Chain all callback for an attribute together\n * @param map The source callback map\n * @param name Name of the property to chain\n * @param newCallback A new callback to process the given name on the given map.\n * If the same property got multiple callbacks, the final return value will be the return\n * value of the latest callback\n */\nexport default function chainSanitizerCallback(map, name, newCallback) {\n    if (!map[name]) {\n        map[name] = newCallback;\n    }\n    else {\n        var originalCallback_1 = map[name];\n        map[name] = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            originalCallback_1.apply(void 0, __spreadArray([], __read(args), false));\n            return newCallback.apply(void 0, __spreadArray([], __read(args), false));\n        };\n    }\n}\n//# sourceMappingURL=chainSanitizerCallback.js.map","var CONTENT_EDITABLE = 'contenteditable';\n/**\n * Commit information of an entity (type, isReadonly, id) into the wrapper node as CSS Classes\n * @param wrapper The entity wrapper element\n * @param type Entity type\n * @param isReadonly Whether this is a readonly entity\n * @param id Optional Id of the entity\n */\nexport default function commitEntity(wrapper, type, isReadonly, id) {\n    if (wrapper) {\n        wrapper.className = \"_Entity\" /* ENTITY_INFO_NAME */ + \" \" + \"_EType_\" /* ENTITY_TYPE_PREFIX */ + type + \" \" + (id ? \"\" + \"_EId_\" /* ENTITY_ID_PREFIX */ + id + \" \" : '') + \"_EReadonly_\" /* ENTITY_READONLY_PREFIX */ + (isReadonly ? '1' : '0');\n        if (isReadonly) {\n            wrapper.contentEditable = 'false';\n        }\n        else if (wrapper.getAttribute(CONTENT_EDITABLE)) {\n            wrapper.removeAttribute(CONTENT_EDITABLE);\n        }\n    }\n}\n//# sourceMappingURL=commitEntity.js.map","/**\n * Get Entity object from an entity root element\n * @param element The entity root element. If this element is not an entity root element,\n * it will return null\n */\nexport default function getEntityFromElement(element) {\n    var _a;\n    var isEntity = false;\n    var type = '';\n    var id = '';\n    var isReadonly = false;\n    (_a = element === null || element === void 0 ? void 0 : element.className) === null || _a === void 0 ? void 0 : _a.split(' ').forEach(function (name) {\n        if (name == \"_Entity\" /* ENTITY_INFO_NAME */) {\n            isEntity = true;\n        }\n        else if (name.indexOf(\"_EType_\" /* ENTITY_TYPE_PREFIX */) == 0) {\n            type = name.substr(\"_EType_\" /* ENTITY_TYPE_PREFIX */.length);\n        }\n        else if (name.indexOf(\"_EId_\" /* ENTITY_ID_PREFIX */) == 0) {\n            id = name.substr(\"_EId_\" /* ENTITY_ID_PREFIX */.length);\n        }\n        else if (name.indexOf(\"_EReadonly_\" /* ENTITY_READONLY_PREFIX */) == 0) {\n            isReadonly = name.substr(\"_EReadonly_\" /* ENTITY_READONLY_PREFIX */.length) == '1';\n        }\n    });\n    return isEntity\n        ? {\n            wrapper: element,\n            id: id,\n            type: type,\n            isReadonly: isReadonly,\n        }\n        : null;\n}\n//# sourceMappingURL=getEntityFromElement.js.map","/**\n * Get a selector string for specified entity type and id\n * @param type (Optional) Type of entity\n * @param id (Optional) Id of entity\n */\nexport default function getEntitySelector(type, id) {\n    var typeSelector = type ? \".\" + \"_EType_\" /* ENTITY_TYPE_PREFIX */ + type : '';\n    var idSelector = id ? \".\" + \"_EId_\" /* ENTITY_ID_PREFIX */ + id : '';\n    return '.' + \"_Entity\" /* ENTITY_INFO_NAME */ + typeSelector + idSelector;\n}\n//# sourceMappingURL=getEntitySelector.js.map","import getEntityFromElement from './getEntityFromElement';\nimport getEntitySelector from './getEntitySelector';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nvar EntityPlaceHolderTagName = 'ENTITY-PLACEHOLDER';\n/**\n * @deprecated\n * Create a placeholder comment node for entity\n * @param entity The entity to create placeholder from\n * @returns A placeholder comment node as\n */\nexport function createEntityPlaceholder(entity) {\n    var placeholder = entity.wrapper.ownerDocument.createElement(EntityPlaceHolderTagName);\n    placeholder.id = entity.id;\n    return placeholder;\n}\n/**\n * Move content from a container into a new Document fragment, and try keep entities to be reusable by creating placeholder\n * for them in the document fragment.\n * If an entity is directly under root container, the whole entity can be reused and no need to move it at all.\n * If an entity is not directly under root container, it is still reusable, but it may need some movement.\n * In any case, entities will be replaced with a placeholder in the target document fragment.\n * We will use an entity map (the \"entities\" parameter) to save the map from entity id to its wrapper element.\n * @param root The root element\n * @param entities A map from entity id to entity wrapper element\n * @returns A new document fragment contains all the content and entity placeholders\n */\nexport function moveContentWithEntityPlaceholders(root, entities) {\n    var entitySelector = getEntitySelector();\n    var fragment = root.ownerDocument.createDocumentFragment();\n    var next = null;\n    var _loop_1 = function (child) {\n        var entity;\n        var nodeToAppend = child;\n        next = child.nextSibling;\n        if (safeInstanceOf(child, 'HTMLElement')) {\n            if ((entity = getEntityFromElement(child))) {\n                nodeToAppend = getPlaceholder(entity, entities);\n            }\n            else {\n                child.querySelectorAll(entitySelector).forEach(function (wrapper) {\n                    var _a;\n                    if ((entity = getEntityFromElement(wrapper))) {\n                        var placeholder = getPlaceholder(entity, entities);\n                        (_a = wrapper.parentNode) === null || _a === void 0 ? void 0 : _a.replaceChild(placeholder, wrapper);\n                    }\n                });\n            }\n        }\n        fragment.appendChild(nodeToAppend);\n    };\n    for (var child = root.firstChild; child; child = next) {\n        _loop_1(child);\n    }\n    fragment.normalize();\n    return fragment;\n}\n/**\n * Restore HTML content from a document fragment that may contain entity placeholders.\n * @param source Source document fragment that contains HTML content and entity placeholders\n * @param target Target container, usually to be editor root container\n * @param entities A map from entity id to entity wrapper, used for reusing existing DOM structure for entity\n * @param insertClonedNode When pass true, merge with a cloned copy of the nodes from source fragment rather than the nodes themselves @default false\n */\nexport function restoreContentWithEntityPlaceholder(source, target, entities, insertClonedNode) {\n    var anchor = target.firstChild;\n    var entitySelector = getEntitySelector();\n    for (var current = source.firstChild; current;) {\n        var next = current.nextSibling;\n        var wrapper = tryGetWrapperFromEntityPlaceholder(entities, current);\n        if (wrapper) {\n            anchor = removeUntil(anchor, wrapper);\n            if (anchor) {\n                anchor = anchor.nextSibling;\n            }\n            else {\n                target.appendChild(wrapper);\n            }\n        }\n        else {\n            var nodeToInsert = insertClonedNode ? current.cloneNode(true /*deep*/) : current;\n            target.insertBefore(nodeToInsert, anchor);\n            if (safeInstanceOf(nodeToInsert, 'HTMLElement')) {\n                nodeToInsert.querySelectorAll(entitySelector).forEach(function (placeholder) {\n                    var _a;\n                    var wrapper = tryGetWrapperFromEntityPlaceholder(entities, placeholder);\n                    if (wrapper) {\n                        (_a = placeholder.parentNode) === null || _a === void 0 ? void 0 : _a.replaceChild(wrapper, placeholder);\n                    }\n                });\n            }\n        }\n        current = next;\n    }\n    removeUntil(anchor);\n}\nfunction removeUntil(anchor, nodeToStop) {\n    var _a;\n    while (anchor && (!nodeToStop || anchor != nodeToStop)) {\n        var nodeToRemove = anchor;\n        anchor = anchor.nextSibling;\n        (_a = nodeToRemove.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(nodeToRemove);\n    }\n    return anchor;\n}\nfunction tryGetWrapperFromEntityPlaceholder(entities, node) {\n    var _a;\n    var id = safeInstanceOf(node, 'HTMLElement') &&\n        node.classList.contains(\"_Entity\" /* ENTITY_INFO_NAME */) &&\n        ((_a = getEntityFromElement(node)) === null || _a === void 0 ? void 0 : _a.id);\n    var item = id ? entities === null || entities === void 0 ? void 0 : entities[id] : null;\n    return !item\n        ? null\n        : safeInstanceOf(item, 'HTMLElement')\n            ? item\n            : (item === null || item === void 0 ? void 0 : item.canPersist)\n                ? item.element\n                : null;\n}\nfunction getPlaceholder(entity, entities) {\n    entities[entity.id] = entity.wrapper;\n    return entity.wrapper.cloneNode(true /*deep*/);\n}\n//# sourceMappingURL=entityPlaceholderUtils.js.map","/**\n * Gets the cached event data by cache key from event object if there is already one.\n * Otherwise, call getter function to create one, and cache it.\n * @param event The event object\n * @param key Cache key string, need to be unique\n * @param getter Getter function to get the object when it is not in cache yet\n */\nexport default function cacheGetEventData(event, key, getter) {\n    var result = event && event.eventDataCache && event.eventDataCache.hasOwnProperty(key)\n        ? event.eventDataCache[key]\n        : getter();\n    if (event) {\n        event.eventDataCache = event.eventDataCache || {};\n        event.eventDataCache[key] = result;\n    }\n    return result;\n}\n//# sourceMappingURL=cacheGetEventData.js.map","var CTRL_CHAR_CODE = 'Control';\nvar ALT_CHAR_CODE = 'Alt';\nvar META_CHAR_CODE = 'Meta';\n/**\n * Returns true when the event was fired from a modifier key, otherwise false\n * @param event The keyboard event object\n */\nexport default function isModifierKey(event) {\n    var isCtrlKey = event.ctrlKey || event.key === CTRL_CHAR_CODE;\n    var isAltKey = event.altKey || event.key === ALT_CHAR_CODE;\n    var isMetaKey = event.metaKey || event.key === META_CHAR_CODE;\n    return isCtrlKey || isAltKey || isMetaKey;\n}\n//# sourceMappingURL=isModifierKey.js.map","import isModifierKey from './isModifierKey';\n/**\n * Returns true when the event was fired from a key that produces a character value, otherwise false\n * This detection is not 100% accurate. event.key is not fully supported by all browsers, and in some browsers (e.g. IE),\n * event.key is longer than 1 for num pad input. But here we just want to improve performance as much as possible.\n * So if we missed some case here it is still acceptable.\n * @param event The keyboard event object\n */\nexport default function isCharacterValue(event) {\n    return !isModifierKey(event) && !!event.key && event.key.length == 1;\n}\n//# sourceMappingURL=isCharacterValue.js.map","import { Browser } from '../utils/Browser';\nvar isCtrlOrMetaPressedImpl = Browser.isMac\n    ? function (event) { return event.metaKey; }\n    : function (event) { return event.ctrlKey; };\n/**\n * Check if Ctrl key (Windows) or Meta key (Mac) is pressed for the given Event\n * @param event A Keyboard event or Mouse event object\n * @returns True if Ctrl key is pressed on Windows or Meta key is pressed on Mac\n */\nexport default function isCtrlOrMetaPressed(event) {\n    return isCtrlOrMetaPressedImpl(event);\n}\n//# sourceMappingURL=isCtrlOrMetaPressed.js.map","import getStyles from './getStyles';\nimport setStyles from './setStyles';\n/**\n * Removes the css important rule from some css properties\n * @param element The HTMLElement\n * @param styleProperties The css properties that important must be removed. Ex: ['background-color', 'background']\n */\nexport default function removeImportantStyleRule(element, styleProperties) {\n    var styles = getStyles(element);\n    var modifiedStyles = 0;\n    styleProperties.forEach(function (style) {\n        var _a;\n        if (((_a = styles[style]) === null || _a === void 0 ? void 0 : _a.indexOf('!important')) > -1) {\n            var index = styles[style].indexOf('!');\n            styles[style] = styles[style].substring(0, index);\n            modifiedStyles++;\n        }\n    });\n    if (modifiedStyles > 0) {\n        setStyles(element, styles);\n    }\n}\n//# sourceMappingURL=removeImportantStyleRule.js.map","/**\n * Add global css styles\n * @param doc The document object\n * @param cssRule The css rule that must added to the selection\n * @param styleId The id of the style tag\n */\nexport default function setGlobalCssStyles(doc, cssRule, styleId) {\n    var _a;\n    if (cssRule) {\n        var styleTag = doc.getElementById(styleId);\n        if (!styleTag) {\n            styleTag = doc.createElement('style');\n            styleTag.id = styleId;\n            doc.head.appendChild(styleTag);\n        }\n        (_a = styleTag.sheet) === null || _a === void 0 ? void 0 : _a.insertRule(cssRule);\n    }\n}\n//# sourceMappingURL=setGlobalCssStyles.js.map","/**\n * Remove a css rule style from a style sheet\n * @param doc The document object\n * @param styleId the ID of the style tag\n */\nexport default function removeGlobalCssStyle(doc, styleId) {\n    var _a;\n    var styleTag = doc.getElementById(styleId);\n    if (styleTag) {\n        (_a = styleTag.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(styleTag);\n    }\n}\n//# sourceMappingURL=removeGlobalCssStyle.js.map","import { __assign } from \"tslib\";\nimport { getTableCellMetadata, saveTableCellMetadata } from './tableCellInfo';\n/**\n * Clone css styles from a element an set to another.\n * @param cell cell that will receive the styles\n * @param styledCell cell where the styles will be clone\n */\nexport default function cloneCellStyles(cell, styledCell) {\n    var styles = styledCell.getAttribute('style');\n    if (styles) {\n        cell.setAttribute('style', styles);\n        var meta = getTableCellMetadata(styledCell);\n        if (meta) {\n            saveTableCellMetadata(cell, __assign({}, meta));\n        }\n    }\n}\n//# sourceMappingURL=cloneCellStyles.js.map","import changeElementTag from '../utils/changeElementTag';\nimport contains from '../utils/contains';\nimport ContentTraverser from '../contentTraverser/ContentTraverser';\nimport createRange from '../selection/createRange';\nimport findClosestElementAncestor from '../utils/findClosestElementAncestor';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getTagOfNode from '../utils/getTagOfNode';\nimport isNodeEmpty from '../utils/isNodeEmpty';\nimport isPositionAtBeginningOf from '../selection/isPositionAtBeginningOf';\nimport isVoidHtmlElement from '../utils/isVoidHtmlElement';\nimport LinkInlineElement from '../inlineElements/LinkInlineElement';\nimport moveChildNodes from '../utils/moveChildNodes';\nimport pasteTable from '../table/pasteTable';\nimport Position from '../selection/Position';\nimport PositionContentSearcher from '../contentTraverser/PositionContentSearcher';\nimport queryElements from '../utils/queryElements';\nimport splitTextNode from '../utils/splitTextNode';\nimport toArray from '../jsUtils/toArray';\nimport unwrap from '../utils/unwrap';\nimport wrap from '../utils/wrap';\nimport { splitBalancedNodeRange } from '../utils/splitParentNode';\nvar NOT_EDITABLE_SELECTOR = '[contenteditable=false]';\nvar adjustSteps = [\n    adjustInsertPositionForHyperLink,\n    adjustInsertPositionForStructuredNode,\n    adjustInsertPositionForParagraph,\n    adjustInsertPositionForVoidElement,\n    adjustInsertPositionForMoveCursorOutOfALink,\n    adjustInsertPositionForNotEditableNode,\n    adjustInsertPositionForTable,\n];\n/**\n * Adjust position for A tag don't be nested inside another A tag.\n */\nfunction adjustInsertPositionForHyperLink(root, nodeToInsert, position, range) {\n    var _a, _b;\n    var blockElement = getBlockElementAtNode(root, position.node);\n    if (blockElement) {\n        // Find the first <A> tag within current block which covers current selection\n        // If there are more than one nested, let's handle the first one only since that is not a common scenario.\n        var anchor = queryElements(root, 'a[href]', null /*forEachCallback*/, 1 /* OnSelection */, createRange(position)).filter(function (a) { return blockElement.contains(a); })[0];\n        // If this is about to insert node to an empty A tag, clear the A tag and reset position\n        if (anchor && isNodeEmpty(anchor)) {\n            position = new Position(anchor, -2 /* Before */);\n            safeRemove(anchor);\n            anchor = null;\n        }\n        // If this is about to insert nodes which contains A tag into another A tag, need to break current A tag\n        // otherwise we will have nested A tags which is a wrong HTML structure\n        if (anchor &&\n            ((_a = nodeToInsert) === null || _a === void 0 ? void 0 : _a.querySelector) &&\n            ((_b = nodeToInsert) === null || _b === void 0 ? void 0 : _b.querySelector('a[href]'))) {\n            var normalizedPosition = position.normalize();\n            var parentNode = normalizedPosition.node.parentNode;\n            var nextNode = normalizedPosition.node.nodeType == 3 /* Text */\n                ? splitTextNode(normalizedPosition.node, normalizedPosition.offset, false /*returnFirstPart*/)\n                : normalizedPosition.isAtEnd\n                    ? normalizedPosition.node.nextSibling\n                    : normalizedPosition.node;\n            var splitter = root.ownerDocument.createTextNode('');\n            parentNode.insertBefore(splitter, nextNode);\n            while (splitter && contains(anchor, splitter)) {\n                splitter = splitBalancedNodeRange(splitter);\n            }\n            if (splitter) {\n                position = new Position(splitter, -2 /* Before */);\n                safeRemove(splitter);\n            }\n        }\n    }\n    return position;\n}\n/**\n * Adjust position for a node don't be nested inside tags like BR, LI, TD.\n */\nfunction adjustInsertPositionForStructuredNode(root, nodeToInsert, position, range) {\n    var rootNodeToInsert = nodeToInsert;\n    var isFragment = false;\n    if (rootNodeToInsert.nodeType == 11 /* DocumentFragment */) {\n        isFragment = true;\n        var rootNodes = toArray(rootNodeToInsert.childNodes).filter(function (n) { return getTagOfNode(n) != 'BR'; });\n        rootNodeToInsert = rootNodes.length == 1 ? rootNodes[0] : null;\n    }\n    var tag = getTagOfNode(rootNodeToInsert);\n    var hasBrNextToRoot = tag && rootNodeToInsert && getTagOfNode(rootNodeToInsert.nextSibling) == 'BR';\n    var listItem = findClosestElementAncestor(position.node, root, 'LI');\n    var listNode = listItem && findClosestElementAncestor(listItem, root, 'OL,UL');\n    var tdNode = findClosestElementAncestor(position.node, root, 'TD,TH');\n    if (tag == 'LI') {\n        tag = listNode ? getTagOfNode(listNode) : 'UL';\n        rootNodeToInsert = wrap(rootNodeToInsert, tag);\n    }\n    if ((tag == 'OL' || tag == 'UL') &&\n        rootNodeToInsert &&\n        getTagOfNode(rootNodeToInsert.firstChild) == 'LI') {\n        var shouldInsertListAsText = !rootNodeToInsert.firstChild.nextSibling && !hasBrNextToRoot;\n        if (hasBrNextToRoot && rootNodeToInsert.parentNode) {\n            safeRemove(rootNodeToInsert.nextSibling);\n        }\n        if (shouldInsertListAsText) {\n            unwrap(rootNodeToInsert.firstChild);\n            unwrap(rootNodeToInsert);\n        }\n        else if (getTagOfNode(listNode) == tag) {\n            unwrap(rootNodeToInsert);\n            position = new Position(listItem, isPositionAtBeginningOf(position, listItem)\n                ? -2 /* Before */\n                : -3 /* After */);\n        }\n    }\n    if (isFragment && tag == 'TABLE' && tdNode) {\n        pasteTable(tdNode, rootNodeToInsert, position, range);\n        position = new Position(rootNodeToInsert, 0);\n        moveChildNodes(nodeToInsert);\n    }\n    return position;\n}\n/**\n * Change P tag to DIV, when a new node when insert node.\n */\nfunction adjustInsertPositionForParagraph(root, nodeToInsert, position, range) {\n    if (getTagOfNode(position.node) == 'P') {\n        // Insert into a P tag may cause issues when the inserted content contains any block element.\n        // Change P tag to DIV to make sure it works well\n        var pos = position.normalize();\n        var div = changeElementTag(position.node, 'div');\n        if (pos.node != div) {\n            position = pos;\n        }\n    }\n    return position;\n}\n/**\n * Adjust position for a node that can have children.\n */\nfunction adjustInsertPositionForVoidElement(root, nodeToInsert, position, range) {\n    if (isVoidHtmlElement(position.node)) {\n        position = new Position(position.node, position.isAtEnd ? -3 /* After */ : -2 /* Before */);\n    }\n    return position;\n}\n/**\n * Adjust the position cursor out of link when a new node is inserted.\n */\nfunction adjustInsertPositionForMoveCursorOutOfALink(root, nodeToInsert, position, range) {\n    if (range && range.collapsed) {\n        var searcher = new PositionContentSearcher(root, Position.getStart(range));\n        var inlineElementBefore = searcher.getInlineElementBefore();\n        var inlineElementAfter = searcher.getInlineElementAfter();\n        if (inlineElementBefore instanceof LinkInlineElement) {\n            position = new Position(inlineElementBefore.getContainerNode(), -3 /* After */);\n        }\n        else if (inlineElementAfter instanceof LinkInlineElement) {\n            position = new Position(inlineElementAfter.getContainerNode(), -2 /* Before */);\n        }\n    }\n    return position;\n}\n/**\n * Adjust the position cursor out of a not contenteditable element.\n */\nfunction adjustInsertPositionForNotEditableNode(root, nodeToInsert, position, range) {\n    var _a;\n    if (!((_a = position.element) === null || _a === void 0 ? void 0 : _a.isContentEditable)) {\n        var nonEditableElement = void 0;\n        var lastNonEditableElement = findClosestElementAncestor(position.node, root, NOT_EDITABLE_SELECTOR);\n        while (lastNonEditableElement) {\n            nonEditableElement = lastNonEditableElement;\n            lastNonEditableElement = (nonEditableElement === null || nonEditableElement === void 0 ? void 0 : nonEditableElement.parentElement)\n                ? findClosestElementAncestor(nonEditableElement.parentElement, root, NOT_EDITABLE_SELECTOR)\n                : null;\n        }\n        if (nonEditableElement) {\n            position = new Position(nonEditableElement, -3 /* After */);\n            return adjustInsertPositionForNotEditableNode(root, nodeToInsert, position, range);\n        }\n    }\n    return position;\n}\n/**\n * Adjust the position of a table to be one line after another table.\n */\nfunction adjustInsertPositionForTable(root, nodeToInsert, position, range) {\n    if ((nodeToInsert.childNodes.length == 1 &&\n        getTagOfNode(nodeToInsert.childNodes[0]) == 'TABLE') ||\n        getTagOfNode(nodeToInsert) == 'TABLE') {\n        var element = position.element;\n        var posBefore = new Position(element, -2 /* Before */);\n        var rangeToTraverse = createRange(posBefore, position);\n        var contentTraverser = ContentTraverser.createSelectionTraverser(root, rangeToTraverse);\n        var blockElement = contentTraverser && contentTraverser.currentBlockElement;\n        if (blockElement) {\n            var nextBlockElement = blockElement;\n            while (!nextBlockElement) {\n                nextBlockElement = contentTraverser.getNextBlockElement();\n                if (nextBlockElement) {\n                    blockElement = nextBlockElement;\n                }\n            }\n            var prevElement = blockElement === null || blockElement === void 0 ? void 0 : blockElement.getEndNode();\n            if (prevElement && findClosestElementAncestor(prevElement, root, 'TABLE')) {\n                var tempRange = createRange(position);\n                tempRange.collapse(false /* toStart */);\n                var br = root.ownerDocument.createElement('br');\n                tempRange.insertNode(br);\n                tempRange = createRange(br);\n                position = Position.getEnd(tempRange);\n            }\n        }\n    }\n    return position;\n}\n/**\n *\n * @param root the contentDiv of the ditor\n * @param nodeToInsert the node to be inserted\n * @param position the position of the node to be inserted\n * @param range the range current or cached range of the editor\n * @returns the adjusted position of the inserted node\n */\nexport default function adjustInsertPositionBySteps(root, nodeToInsert, position, range) {\n    adjustSteps.forEach(function (handler) {\n        position = handler(root, nodeToInsert, position, range);\n    });\n    return position;\n}\nfunction safeRemove(node) {\n    var _a;\n    (_a = node === null || node === void 0 ? void 0 : node.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(node);\n}\n//# sourceMappingURL=adjustInsertPosition.js.map","import cloneCellStyles from './cloneCellStyles';\nimport moveChildNodes from '../utils/moveChildNodes';\nimport VTable from './VTable';\n/**\n *\n * Pastes a table inside another, modifying the original to create a merged one\n * @param currentTd The cell where the cursor is in the table to paste into\n * @param rootNodeToInsert A Node containing the table to be inserted\n * @param position The position to paste the table\n * @param range The selected range of the table\n *\n * Position and range are here for when table selection allows to move pivot point\n */\nexport default function pasteTable(currentTd, rootNodeToInsert, position, range) {\n    var _a, _b, _c, _d;\n    // This is the table on the clipboard\n    var newTable = new VTable(rootNodeToInsert);\n    // This table is already on the editor\n    var currentTable = new VTable(currentTd);\n    // Which cell in the currentTable is the cursor placed\n    var cursorRow = currentTable.row;\n    var cursorCol = currentTable.col;\n    // Total rows and columns of the final table\n    var rows = (_b = cursorRow + ((_a = newTable.cells) === null || _a === void 0 ? void 0 : _a.length)) !== null && _b !== void 0 ? _b : 0;\n    var columns = (_d = cursorCol + ((_c = newTable.cells) === null || _c === void 0 ? void 0 : _c[0].length)) !== null && _d !== void 0 ? _d : 0;\n    // Add new rows\n    currentTable.row = currentTable.cells.length - 1;\n    while (currentTable.cells.length < rows) {\n        currentTable.edit(1 /* InsertBelow */);\n    }\n    // Add new columns\n    currentTable.col = currentTable.cells[0].length - 1;\n    while (currentTable.cells[0].length < columns) {\n        currentTable.edit(3 /* InsertRight */);\n    }\n    // Create final table\n    for (var i = cursorRow; i < rows; i++) {\n        for (var j = cursorCol; j < columns; j++) {\n            var cell = currentTable.getCell(i, j);\n            var newCell = newTable.getTd(i - cursorRow, j - cursorCol);\n            if (cell.td && newCell) {\n                moveChildNodes(cell.td, newCell);\n                cloneCellStyles(cell.td, newCell);\n            }\n            else {\n                cell.td = document.createElement('td');\n            }\n        }\n    }\n    currentTable.writeBack();\n}\n//# sourceMappingURL=pasteTable.js.map","import { __read } from \"tslib\";\nimport arrayPush from '../jsUtils/arrayPush';\nimport collapseNodesInRegion from '../region/collapseNodesInRegion';\nimport getRegionsFromRange from '../region/getRegionsFromRange';\nimport getSelectionRangeInRegion from '../region/getSelectionRangeInRegion';\nimport mergeBlocksInRegion from '../region/mergeBlocksInRegion';\nimport Position from '../selection/Position';\nimport queryElements from '../utils/queryElements';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport splitTextNode from '../utils/splitTextNode';\n/**\n * Delete selected content, and return the new position to select\n * @param core The EditorCore object.\n * @param range The range to delete\n */\nexport default function deleteSelectedContent(root, range) {\n    var nodeBefore = null;\n    // 1. TABLE and TR node in selected should be deleted. It is possible we don't detect them from step 2\n    // since table cells will fall in to different regions\n    var nodesToDelete = queryElements(root, 'table,tr', null /*callback*/, 2 /* InSelection */, range);\n    // 2. Loop all selected regions, find out those nodes need to be deleted and merged.\n    // We don't delete them directly here because delete node from one region may cause selection range\n    // another region becomes invalid. So we delay the process of deletion.\n    var regions = getRegionsFromRange(root, range, 0 /* Table */);\n    var nodesPairToMerge = regions\n        .map(function (region) {\n        var regionRange = getSelectionRangeInRegion(region);\n        if (!regionRange) {\n            return null;\n        }\n        var startContainer = regionRange.startContainer, endContainer = regionRange.endContainer, startOffset = regionRange.startOffset, endOffset = regionRange.endOffset, commonAncestorContainer = regionRange.commonAncestorContainer;\n        // Disallow merging of readonly elements\n        if (safeInstanceOf(commonAncestorContainer, 'HTMLElement') &&\n            !commonAncestorContainer.isContentEditable) {\n            return null;\n        }\n        // Make sure there are node before and after the merging point.\n        // This is required by mergeBlocksInRegion API.\n        // This may create some empty text node as anchor\n        var _a = __read(ensureBeforeAndAfter(endContainer, endOffset, false /*isStart*/), 2), beforeEnd = _a[0], afterEnd = _a[1];\n        var _b = __read(ensureBeforeAndAfter(startContainer, startOffset, true /*isStart*/), 2), beforeStart = _b[0], afterStart = _b[1];\n        nodeBefore = nodeBefore || beforeStart;\n        // Find out all nodes to be deleted\n        var nodes = collapseNodesInRegion(region, [afterStart, beforeEnd]);\n        arrayPush(nodesToDelete, nodes);\n        return { region: region, beforeStart: beforeStart, afterEnd: afterEnd };\n    })\n        .filter(function (x) { return !!x; });\n    // 3. Delete all nodes that we found, whose parent is editable\n    nodesToDelete.forEach(function (node) { var _a; return ((_a = node.parentElement) === null || _a === void 0 ? void 0 : _a.isContentEditable) && node.parentElement.removeChild(node); });\n    // 4. Merge lines for each region, so that after we don't see extra line breaks\n    nodesPairToMerge.forEach(function (nodes) {\n        if (nodes) {\n            mergeBlocksInRegion(nodes.region, nodes.beforeStart, nodes.afterEnd);\n        }\n    });\n    return nodeBefore && new Position(nodeBefore, -1 /* End */);\n}\nfunction ensureBeforeAndAfter(node, offset, isStart) {\n    var _a, _b;\n    if (safeInstanceOf(node, 'Text')) {\n        var newNode = splitTextNode(node, offset, isStart);\n        return isStart ? [newNode, node] : [node, newNode];\n    }\n    else {\n        var nodeBefore = node.childNodes[offset - 1];\n        var nodeAfter = node.childNodes[offset];\n        // Condition 1: node child nodes\n        // (\"I\" means cursor; \"o\" means a DOM node, \"[ ]\" means a parent node)\n        // [ I ]\n        // need to use parent node instead to convert to condition 2\n        if (!nodeBefore && !nodeAfter) {\n            if (isStart) {\n                nodeAfter = node;\n                nodeBefore = nodeAfter.previousSibling;\n            }\n            else {\n                nodeBefore = node;\n                nodeAfter = nodeBefore.nextSibling;\n            }\n        }\n        // Condition 2: Either nodeBefore or nodeAfter is null (XOR case)\n        // [ o I ]  or [ I o]\n        // need to add empty text node to convert to condition 3\n        if ((nodeBefore || nodeAfter) && (!nodeBefore || !nodeAfter)) {\n            var emptyNode = node.ownerDocument.createTextNode('');\n            (_b = (_a = (nodeBefore || nodeAfter)) === null || _a === void 0 ? void 0 : _a.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(emptyNode, nodeAfter);\n            if (nodeBefore) {\n                nodeAfter = emptyNode;\n            }\n            else {\n                nodeBefore = emptyNode;\n            }\n        }\n        // Condition 3: Both nodeBefore and nodeAfter are not null\n        // [o I o]\n        // return the nodes\n        return [nodeBefore, nodeAfter];\n    }\n}\n//# sourceMappingURL=deleteSelectedContent.js.map","import { __assign } from \"tslib\";\nimport changeElementTag from '../utils/changeElementTag';\nimport contains from '../utils/contains';\nimport getBlockElementAtNode from '../blockElements/getBlockElementAtNode';\nimport getPredefinedCssForElement from '../htmlSanitizer/getPredefinedCssForElement';\nimport getStyles from '../style/getStyles';\nimport isNodeInRegion from './isNodeInRegion';\nimport safeInstanceOf from '../utils/safeInstanceOf';\nimport setStyles from '../style/setStyles';\nimport { collapse } from '../utils/collapseNodes';\n/**\n * Merge a BlockElement of given node after another node\n * @param region Region to operate in\n * @param refNode The node to merge after\n * @param targetNode The node of target block element\n */\nexport default function mergeBlocksInRegion(region, refNode, targetNode) {\n    var _a, _b, _c;\n    var block;\n    if (!isNodeInRegion(region, refNode) ||\n        !isNodeInRegion(region, targetNode) ||\n        !(block = getBlockElementAtNode(region.rootNode, targetNode)) ||\n        block.contains(refNode)) {\n        return;\n    }\n    var blockRoot = block.collapseToSingleElement();\n    var commonContainer = collapse(region.rootNode, blockRoot, refNode, false /*isStart*/, true /*canSplitParent*/);\n    // Copy styles of parent nodes into blockRoot\n    for (var node = blockRoot; contains(commonContainer, node);) {\n        var parent_1 = node.parentNode;\n        if (safeInstanceOf(parent_1, 'HTMLElement')) {\n            var styles = __assign(__assign(__assign({}, (getPredefinedCssForElement(parent_1) || {})), getStyles(parent_1)), getStyles(blockRoot));\n            setStyles(blockRoot, styles);\n        }\n        node = parent_1;\n    }\n    var nodeToRemove = null;\n    var nodeToMerge = blockRoot.childNodes.length == 1 && blockRoot.attributes.length == 0\n        ? blockRoot.firstChild\n        : changeElementTag(blockRoot, 'SPAN');\n    // Remove empty node\n    for (var node = nodeToMerge; contains(commonContainer, node) && ((_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.childNodes.length) == 1; node = node.parentNode) {\n        // If the only child is the one which is about to be removed, this node should also be removed\n        nodeToRemove = node.parentNode;\n    }\n    // Finally, merge blocks, and remove empty nodes\n    (_b = refNode.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(nodeToMerge, refNode.nextSibling);\n    (_c = nodeToRemove === null || nodeToRemove === void 0 ? void 0 : nodeToRemove.parentNode) === null || _c === void 0 ? void 0 : _c.removeChild(nodeToRemove);\n}\n//# sourceMappingURL=mergeBlocksInRegion.js.map","var WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES = [\n    'TableInsertRowGapBlank',\n    'TableColumnResizeHandle',\n    'TableCellTopBorderHandle',\n    'TableCellLeftBorderHandle',\n    'TableHoverColumnHandle',\n    'TableHoverRowHandle',\n];\nvar WAC_IDENTIFY_SELECTOR = 'ul[class^=\"BulletListStyle\"]>.OutlineElement,ol[class^=\"NumberListStyle\"]>.OutlineElement,span.WACImageContainer,' +\n    WORD_ONLINE_TABLE_TEMP_ELEMENT_CLASSES.map(function (c) { return \"table div[class^=\\\"\" + c + \"\\\"]\"; }).join(',');\n/**\n * @internal\n * Check whether the fragment provided contain Wac Elements\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar documentContainWacElements = function (props) {\n    var fragment = props.fragment;\n    return !!fragment.querySelector(WAC_IDENTIFY_SELECTOR);\n};\nexport default documentContainWacElements;\n//# sourceMappingURL=documentContainWacElements.js.map","/**\n * @internal\n * Node attribute used to identify if the content is from Google Sheets.\n */\nexport var GOOGLE_SHEET_NODE_NAME = 'google-sheets-html-origin';\n/**\n * @internal\n * Name of the HTMLMeta Property that provides the Office App Source of the pasted content\n */\nexport var PROG_ID_NAME = 'ProgId';\n/**\n * @internal\n * Name of the HTMLMeta Property that identifies pated content as from Excel Desktop\n */\nexport var EXCEL_DESKTOP_ATTRIBUTE_NAME = 'xmlns:x';\n//# sourceMappingURL=constants.js.map","import documentContainWacElements from './documentContainWacElements';\nimport isExcelDesktopDocument from './isExcelDesktopDocument';\nimport isExcelOnlineDocument from './isExcelOnlineDocument';\nimport isGoogleSheetDocument from './isGoogleSheetDocument';\nimport isPowerPointDesktopDocument from './isPowerPointDesktopDocument';\nimport isWordDesktopDocument from './isWordDesktopDocument';\nimport shouldConvertToSingleImage from './shouldConvertToSingleImage';\nvar getSourceFunctions = new Map([\n    [0 /* WordDesktop */, isWordDesktopDocument],\n    [1 /* ExcelDesktop */, isExcelDesktopDocument],\n    [2 /* ExcelOnline */, isExcelOnlineDocument],\n    [3 /* PowerPointDesktop */, isPowerPointDesktopDocument],\n    [5 /* WacComponents */, documentContainWacElements],\n    [4 /* GoogleSheets */, isGoogleSheetDocument],\n    [7 /* SingleImage */, shouldConvertToSingleImage],\n]);\n/**\n * This function tries to get the source of the Pasted content\n * @param event the before paste event\n * @param shouldConvertSingleImage Whether convert single image is enabled.\n * @returns The Type of pasted content, if no type found will return {KnownSourceType.Default}\n */\nexport default function getPasteSource(event, shouldConvertSingleImage) {\n    var htmlAttributes = event.htmlAttributes, clipboardData = event.clipboardData, fragment = event.fragment;\n    var result = null;\n    var param = {\n        htmlAttributes: htmlAttributes,\n        fragment: fragment,\n        shouldConvertSingleImage: shouldConvertSingleImage,\n        clipboardData: clipboardData,\n    };\n    getSourceFunctions.forEach(function (func, key) {\n        if (!result && func(param)) {\n            result = key;\n        }\n    });\n    return result !== null && result !== void 0 ? result : 6 /* Default */;\n}\n//# sourceMappingURL=getPasteSource.js.map","import { PROG_ID_NAME } from './constants';\nvar WORD_ATTRIBUTE_NAME = 'xmlns:w';\nvar WORD_ATTRIBUTE_VALUE = 'urn:schemas-microsoft-com:office:word';\nvar WORD_PROG_ID = 'Word.Document';\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Word Desktop documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar isWordDesktopDocument = function (props) {\n    var htmlAttributes = props.htmlAttributes;\n    return (htmlAttributes[WORD_ATTRIBUTE_NAME] == WORD_ATTRIBUTE_VALUE ||\n        htmlAttributes[PROG_ID_NAME] == WORD_PROG_ID);\n};\nexport default isWordDesktopDocument;\n//# sourceMappingURL=isWordDesktopDocument.js.map","import { EXCEL_DESKTOP_ATTRIBUTE_NAME } from './constants';\nvar EXCEL_ATTRIBUTE_VALUE = 'urn:schemas-microsoft-com:office:excel';\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Excel Desktop documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar isExcelDesktopDocument = function (props) {\n    var htmlAttributes = props.htmlAttributes;\n    // The presence of this attribute confirms its origin from Excel Desktop\n    return htmlAttributes[EXCEL_DESKTOP_ATTRIBUTE_NAME] == EXCEL_ATTRIBUTE_VALUE;\n};\nexport default isExcelDesktopDocument;\n//# sourceMappingURL=isExcelDesktopDocument.js.map","import { EXCEL_DESKTOP_ATTRIBUTE_NAME, PROG_ID_NAME } from './constants';\n// Excel Desktop also has this attribute\nvar EXCEL_ONLINE_ATTRIBUTE_VALUE = 'Excel.Sheet';\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Excel Online documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar isExcelOnlineDocument = function (props) {\n    var htmlAttributes = props.htmlAttributes;\n    // The presence of Excel.Sheet confirms its origin from Excel, the absence of EXCEL_DESKTOP_ATTRIBUTE_NAME confirms it is from the Online version\n    return (htmlAttributes[PROG_ID_NAME] == EXCEL_ONLINE_ATTRIBUTE_VALUE &&\n        htmlAttributes[EXCEL_DESKTOP_ATTRIBUTE_NAME] == undefined);\n};\nexport default isExcelOnlineDocument;\n//# sourceMappingURL=isExcelOnlineDocument.js.map","import { PROG_ID_NAME } from './constants';\nvar POWERPOINT_ATTRIBUTE_VALUE = 'PowerPoint.Slide';\n/**\n * @internal\n * Checks whether the Array provided contains strings that identify Power Point Desktop documents\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar isPowerPointDesktopDocument = function (props) {\n    return props.htmlAttributes[PROG_ID_NAME] == POWERPOINT_ATTRIBUTE_VALUE;\n};\nexport default isPowerPointDesktopDocument;\n//# sourceMappingURL=isPowerPointDesktopDocument.js.map","import { GOOGLE_SHEET_NODE_NAME } from './constants';\n/**\n * @internal\n * Checks whether the fragment provided contain elements from Google sheets\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar isGoogleSheetDocument = function (props) {\n    var fragment = props.fragment;\n    return !!fragment.querySelector(GOOGLE_SHEET_NODE_NAME);\n};\nexport default isGoogleSheetDocument;\n//# sourceMappingURL=isGoogleSheetDocument.js.map","/**\n * @internal\n * Checks whether the fragment only contains a single image to paste\n * and the editor have the ConvertSingleImageBody Experimental feature\n * @param props Properties related to the PasteEvent\n * @returns\n */\nvar shouldConvertToSingleImage = function (props) {\n    var _a;\n    var shouldConvertSingleImage = props.shouldConvertSingleImage, clipboardData = props.clipboardData;\n    return (shouldConvertSingleImage &&\n        ((_a = clipboardData.htmlFirstLevelChildTags) === null || _a === void 0 ? void 0 : _a.length) == 1 &&\n        clipboardData.htmlFirstLevelChildTags[0] == 'IMG');\n};\nexport default shouldConvertToSingleImage;\n//# sourceMappingURL=shouldConvertToSingleImage.js.map","import formatUndoSnapshot from './formatUndoSnapshot';\nimport { getTagOfNode } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Apply inline style to current selection\n * @param editor The editor instance\n * @param callback The callback function to apply style\n */\nexport default function applyInlineStyle(editor, callback, apiName) {\n    editor.focus();\n    var selection = editor.getSelectionRangeEx();\n    var safeCallback = function (element, isInnerNode) {\n        return element.isContentEditable && callback(element, isInnerNode);\n    };\n    if (selection && selection.areAllCollapsed) {\n        var range = selection.ranges[0];\n        var node = range.startContainer;\n        var isEmptySpan = getTagOfNode(node) == 'SPAN' &&\n            (!node.firstChild ||\n                (getTagOfNode(node.firstChild) == 'BR' && !node.firstChild.nextSibling));\n        if (isEmptySpan) {\n            editor.addUndoSnapshot();\n            safeCallback(node);\n        }\n        else {\n            editor.triggerPluginEvent(13 /* PendingFormatStateChanged */, {\n                formatState: {},\n                // Here we use callback instead of safeCallback because we know it's contentEditable.\n                // In addition, for elements that are not added to the DOM tree, isContentEditable always returns false on Safari.\n                formatCallback: callback,\n            });\n            editor.triggerContentChangedEvent(\"Format\" /* Format */);\n        }\n    }\n    else {\n        // This is start and end node that get the style. The start and end needs to be recorded so that selection\n        // can be re-applied post-applying style\n        formatUndoSnapshot(editor, function () {\n            var firstNode;\n            var lastNode;\n            selection.ranges.forEach(function (range) {\n                var contentTraverser = editor.getSelectionTraverser(range);\n                if (!contentTraverser) {\n                    return;\n                }\n                var inlineElement = contentTraverser && contentTraverser.currentInlineElement;\n                while (inlineElement) {\n                    var nextInlineElement = contentTraverser.getNextInlineElement();\n                    inlineElement.applyStyle(function (element, isInnerNode) {\n                        safeCallback(element, isInnerNode);\n                        firstNode = firstNode || element;\n                        lastNode = element;\n                    });\n                    inlineElement = nextInlineElement;\n                }\n            });\n            if (firstNode && lastNode && selection.type == 0 /* Normal */) {\n                editor.select(firstNode, -2 /* Before */, lastNode, -3 /* After */);\n            }\n        }, apiName);\n    }\n}\n//# sourceMappingURL=applyInlineStyle.js.map","import applyInlineStyle from '../utils/applyInlineStyle';\nimport { getComputedStyle } from 'roosterjs-editor-dom';\n/**\n * Default font size sequence, in pt. Suggest editor UI use this sequence as your font size list,\n * So that when increase/decrease font size, the font size can match the sequence of your font size picker\n */\nexport var FONT_SIZES = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\nvar MIN_FONT_SIZE = 1;\nvar MAX_FONT_SIZE = 1000;\n/**\n * Increase or decrease font size in selection\n * @param editor The editor instance\n * @param change Whether increase or decrease font size\n * @param fontSizes A sorted font size array, in pt. Default value is FONT_SIZES\n */\nexport default function changeFontSize(editor, change, fontSizes) {\n    if (fontSizes === void 0) { fontSizes = FONT_SIZES; }\n    var changeBase = change == 0 /* Increase */ ? 1 : -1;\n    applyInlineStyle(editor, function (element) {\n        var pt = parseFloat(getComputedStyle(element, 'font-size') || element.style.fontSize);\n        element.style.fontSize = getNewFontSize(pt, changeBase, fontSizes) + 'pt';\n        var lineHeight = getComputedStyle(element, 'line-height');\n        if (lineHeight && lineHeight != 'normal') {\n            element.style.lineHeight = 'normal';\n        }\n    }, 'changeFontSize');\n}\n/**\n * @internal\n * Get new font size after increase/decrease. This is exported for test only\n * @param pt Original font size, in Point\n * @param changeBase Changed value, 1 means increase, -1 means decrease\n * @param fontSizes Known font size array\n */\nexport function getNewFontSize(pt, changeBase, fontSizes) {\n    pt = changeBase == 1 ? Math.floor(pt) : Math.ceil(pt);\n    var last = fontSizes[fontSizes.length - 1];\n    if (pt <= fontSizes[0]) {\n        pt = Math.max(pt + changeBase, MIN_FONT_SIZE);\n    }\n    else if (pt > last || (pt == last && changeBase == 1)) {\n        pt = pt / 10;\n        pt = changeBase == 1 ? Math.floor(pt) : Math.ceil(pt);\n        pt = Math.min(Math.max((pt + changeBase) * 10, last), MAX_FONT_SIZE);\n    }\n    else if (changeBase == 1) {\n        for (var i = 0; i < fontSizes.length; i++) {\n            if (pt < fontSizes[i]) {\n                pt = fontSizes[i];\n                break;\n            }\n        }\n    }\n    else {\n        for (var i = fontSizes.length - 1; i >= 0; i--) {\n            if (pt > fontSizes[i]) {\n                pt = fontSizes[i];\n                break;\n            }\n        }\n    }\n    return pt;\n}\n//# sourceMappingURL=changeFontSize.js.map","import applyInlineStyle from '../utils/applyInlineStyle';\nimport { safeInstanceOf, setListItemStyle } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Set the List Item Style when all inner inline element have the same style\n * @param editor The editor instance\n * @param styleName Name of the style to apply to the list item\n * @param formatCallback callback to apply the style to each element\n */\nexport default function applyListItemStyleWrap(editor, styleName, formatCallback, apiName) {\n    var parentNodes = [];\n    applyInlineStyle(editor, function (element, isInnerNode) {\n        formatCallback(element, isInnerNode);\n        var parent = editor.getElementAtCursor('LI', element);\n        if (parent && parentNodes.indexOf(parent) === -1) {\n            parentNodes.push(parent);\n        }\n    }, apiName);\n    applyStyleToListItems(parentNodes, [styleName]);\n}\n/**\n * @internal\n * Checks if the parent element is a List Item, if it is, apply the style elements to the list item\n * @param parentNodes parentNodes to apply the style\n * @param styles styles to apply to the List Item Element\n */\nfunction applyStyleToListItems(parentNodes, styles) {\n    parentNodes.forEach(function (node) {\n        if (safeInstanceOf(node, 'HTMLLIElement')) {\n            setListItemStyle(node, styles);\n        }\n    });\n}\n//# sourceMappingURL=applyListItemWrap.js.map","import { Position } from 'roosterjs-editor-dom';\n/**\n * Commit changes of all list changes when experiment features are allowed\n * @param editor The Editor object\n * @param chains List chains to commit\n */\nexport default function commitListChains(editor, chains) {\n    if ((chains === null || chains === void 0 ? void 0 : chains.length) > 0) {\n        var range = editor.getSelectionRange();\n        var start = range && Position.getStart(range);\n        var end = range && Position.getEnd(range);\n        var shouldReuseAllAncestorListElements_1 = editor.isFeatureEnabled(\"ReuseAllAncestorListElements\" /* ReuseAllAncestorListElements */);\n        var shouldDisableListChain_1 = editor.isFeatureEnabled(\"DisableListChain\" /* DisableListChain */);\n        chains.forEach(function (chain) {\n            return chain.commit(shouldReuseAllAncestorListElements_1, shouldDisableListChain_1);\n        });\n        if (start && end) {\n            editor.select(start, end);\n        }\n    }\n}\n/**\n * @deprecated\n * Same with commitListChains, keep this export just for backward compatibility\n */\nexport var experimentCommitListChains = commitListChains;\n//# sourceMappingURL=commitListChains.js.map","import commitListChains from '../utils/commitListChains';\nimport formatUndoSnapshot from './formatUndoSnapshot';\nimport { VListChain } from 'roosterjs-editor-dom';\n/**\n * Split selection into regions, and perform a block-wise formatting action for each region.\n */\nexport default function blockFormat(editor, callback, beforeRunCallback, apiName) {\n    editor.focus();\n    var selection = editor.getSelectionRangeEx();\n    formatUndoSnapshot(editor, function (start, end) {\n        if (!beforeRunCallback || beforeRunCallback()) {\n            var regions = editor.getSelectedRegions();\n            if (regions.length > 0) {\n                var chains_1 = VListChain.createListChains(regions, start === null || start === void 0 ? void 0 : start.node);\n                regions.forEach(function (region) { return callback(region, start, end, chains_1); });\n                commitListChains(editor, chains_1);\n            }\n        }\n        if (selection.type == 0 /* Normal */ && start && end) {\n            editor.select(start, end);\n        }\n        else {\n            editor.select(selection);\n        }\n    }, apiName);\n}\n//# sourceMappingURL=blockFormat.js.map","import formatUndoSnapshot from './formatUndoSnapshot';\nimport { getObjectKeys, PendableFormatCommandMap } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Execute a document command\n * @param editor The editor instance\n * @param command The command to execute\n * @param addUndoSnapshotWhenCollapsed Optional, set to true to always add undo snapshot even current selection is collapsed.\n * Default value is false.\n * @param doWorkaroundForList Optional, set to true to do workaround for list in order to keep current format.\n * Default value is false.\n */\nexport default function execCommand(editor, command, apiName) {\n    editor.focus();\n    var formatter = function () { return editor.getDocument().execCommand(command, false, undefined); };\n    var selection = editor.getSelectionRangeEx();\n    if (selection && selection.areAllCollapsed) {\n        editor.addUndoSnapshot();\n        var formatState = editor.getPendableFormatState(false /* forceGetStateFromDom */);\n        formatter();\n        var formatName = getObjectKeys(PendableFormatCommandMap).filter(function (x) { return PendableFormatCommandMap[x] == command; })[0];\n        if (formatName) {\n            formatState[formatName] = !formatState[formatName];\n            editor.triggerPluginEvent(13 /* PendingFormatStateChanged */, {\n                formatState: formatState,\n            });\n        }\n    }\n    else {\n        formatUndoSnapshot(editor, function () {\n            var needToSwitchSelection = selection.type != 0 /* Normal */;\n            selection.ranges.forEach(function (range) {\n                if (needToSwitchSelection) {\n                    editor.select(range);\n                }\n                formatter();\n            });\n            if (needToSwitchSelection) {\n                editor.select(selection);\n            }\n        }, apiName);\n    }\n}\n//# sourceMappingURL=execCommand.js.map","import applyInlineStyle from '../utils/applyInlineStyle';\nimport { setColor } from 'roosterjs-editor-dom';\n/**\n * Set background color at current selection\n * @param editor The editor instance\n * @param color One of two options:\n * The color string, can be any of the predefined color names (e.g, 'red')\n * or hexadecimal color string (e.g, '#FF0000') or rgb value (e.g, 'rgb(255, 0, 0)') supported by browser.\n * Currently there's no validation to the string, if the passed string is invalid, it won't take effect\n * Alternatively, you can pass a @typedef ModeIndependentColor. If in light mode, the lightModeColor property will be used.\n * If in dark mode, the darkModeColor will be used and the lightModeColor will be used when converting back to light mode.\n **/\nexport default function setBackgroundColor(editor, color) {\n    applyInlineStyle(editor, function (element, isInnerNode) {\n        setColor(element, isInnerNode ? '' : color, true /*isBackground*/, editor.isDarkMode(), false /*shouldAdaptFontColor*/, editor.getDarkColorHandler());\n    }, 'setBackgroundColor');\n}\n//# sourceMappingURL=setBackgroundColor.js.map","import applyListItemStyleWrap from '../utils/applyListItemWrap';\nimport { setColor } from 'roosterjs-editor-dom';\n/**\n * Set text color at selection\n * @param editor The editor instance\n * @param color One of two options:\n * The color string, can be any of the predefined color names (e.g, 'red')\n * or hexadecimal color string (e.g, '#FF0000') or rgb value (e.g, 'rgb(255, 0, 0)') supported by browser.\n * Currently there's no validation to the string, if the passed string is invalid, it won't take affect\n * Alternatively, you can pass a @typedef ModeIndependentColor. If in light mode, the lightModeColor property will be used.\n * If in dark mode, the darkModeColor will be used and the lightModeColor will be used when converting back to light mode.\n * @param shouldApplyInlineStyle Optional callback function to be invoked to verify if the current element should have the inline Style applied\n */\nexport default function setTextColor(editor, color, shouldApplyInlineStyle) {\n    applyListItemStyleWrap(editor, 'color', function (element, isInnerNode) {\n        if (!shouldApplyInlineStyle || shouldApplyInlineStyle(element)) {\n            setColor(element, isInnerNode ? '' : color, false /*isBackground*/, editor.isDarkMode(), false /*shouldAdaptFontColor*/, editor.getDarkColorHandler());\n        }\n    }, 'setTextColor');\n}\n//# sourceMappingURL=setTextColor.js.map","import execCommand from '../utils/execCommand';\n/**\n * Toggle bold at selection\n * If selection is collapsed, it will only affect the following input after caret\n * If selection contains only bold text, the bold style will be removed\n * If selection contains only normal text, bold style will be added to the whole selected text\n * If selection contains both bold and normal text, bold style will be added to the whole selected text\n * @param editor The editor instance\n */\nexport default function toggleBold(editor) {\n    execCommand(editor, \"bold\" /* Bold */, 'toggleBold');\n}\n//# sourceMappingURL=toggleBold.js.map","import execCommand from '../utils/execCommand';\n/**\n * Toggle italic at selection\n * If selection is collapsed, it will only affect the input after caret\n * If selection contains only italic text, the italic style will be removed\n * If selection contains only normal text, italic style will be added to the whole selected text\n * If selection contains both italic and normal text, italic style will be added to the whole selected text\n * @param editor The editor instance\n */\nexport default function toggleItalic(editor) {\n    execCommand(editor, \"italic\" /* Italic */, 'toggleItalic');\n}\n//# sourceMappingURL=toggleItalic.js.map","import execCommand from '../utils/execCommand';\n/**\n * Toggle underline at selection\n * If selection is collapsed, it will only affect the input after caret\n * If selection contains only underlined text, the underline style will be removed\n * If selection contains only normal text, underline style will be added to the whole selected text\n * If selection contains both underlined and normal text, the underline style will be added to the whole selected text\n * @param editor The editor instance\n */\nexport default function toggleUnderline(editor) {\n    execCommand(editor, \"underline\" /* Underline */, 'toggleUnderline');\n}\n//# sourceMappingURL=toggleUnderline.js.map","import { __values } from \"tslib\";\nimport applyListItemStyleWrap from '../utils/applyListItemWrap';\nimport blockFormat from '../utils/blockFormat';\nimport execCommand from '../utils/execCommand';\nimport formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport setBackgroundColor from './setBackgroundColor';\nimport setFontName from './setFontName';\nimport setFontSize from './setFontSize';\nimport setTextColor from './setTextColor';\nimport toggleBold from './toggleBold';\nimport toggleItalic from './toggleItalic';\nimport toggleUnderline from './toggleUnderline';\nimport { collapseNodesInRegion, getObjectKeys, getSelectedBlockElementsInRegion, getStyles, getTagOfNode, isBlockElement, isNodeInRegion, isVoidHtmlElement, PartialInlineElement, NodeInlineElement, safeInstanceOf, setStyles, splitBalancedNodeRange, toArray, unwrap, wrap, } from 'roosterjs-editor-dom';\nvar STYLES_TO_REMOVE = ['font', 'text-decoration', 'color', 'background'];\nvar TAGS_TO_UNWRAP = 'B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE'.split(',');\nvar ATTRIBUTES_TO_PRESERVE = ['href', 'src', 'cellpadding', 'cellspacing'];\nvar TAGS_TO_STOP_UNWRAP = ['TD', 'TH', 'TR', 'TABLE', 'TBODY', 'THEAD'];\n/**\n * @param editor The editor instance\n * @returns if the current selection is composed of two or more block elements\n */\nfunction isMultiBlockSelection(editor) {\n    var transverser = editor.getSelectionTraverser();\n    var blockElement = transverser === null || transverser === void 0 ? void 0 : transverser.currentBlockElement;\n    if (!blockElement) {\n        return false;\n    }\n    var nextBlockElement = transverser === null || transverser === void 0 ? void 0 : transverser.getNextBlockElement();\n    //At least two blocks are selected\n    return !!nextBlockElement;\n}\nfunction clearNodeFormat(node) {\n    // 1. Recursively clear format of all its child nodes\n    var areBlockElements = toArray(node.childNodes).map(clearNodeFormat);\n    var areAllChildrenBlock = areBlockElements.every(function (b) { return b; });\n    var returnBlockElement = isBlockElement(node);\n    // 2. Unwrap the tag if necessary\n    var tag = getTagOfNode(node);\n    if (tag) {\n        if (TAGS_TO_UNWRAP.indexOf(tag) >= 0 ||\n            (areAllChildrenBlock &&\n                !isVoidHtmlElement(node) &&\n                TAGS_TO_STOP_UNWRAP.indexOf(tag) < 0)) {\n            if (returnBlockElement && !areAllChildrenBlock) {\n                wrap(node);\n            }\n            unwrap(node);\n        }\n        else {\n            // 3. Otherwise, remove all attributes\n            clearAttribute(node);\n        }\n    }\n    return returnBlockElement;\n}\nfunction clearAttribute(element) {\n    var e_1, _a;\n    var isTableCell = safeInstanceOf(element, 'HTMLTableCellElement');\n    var isTable = safeInstanceOf(element, 'HTMLTableElement');\n    try {\n        for (var _b = __values(toArray(element.attributes)), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var attr = _c.value;\n            if (isTableCell && attr.name == 'style') {\n                removeNonBorderStyles(element);\n            }\n            else if (isTable && attr.name == 'style') {\n                removeNotTableDefaultStyles(element);\n            }\n            else if (ATTRIBUTES_TO_PRESERVE.indexOf(attr.name.toLowerCase()) < 0 &&\n                attr.name.indexOf('data-') != 0) {\n                element.removeAttribute(attr.name);\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n}\nfunction updateStyles(element, callbackfn) {\n    var styles = getStyles(element);\n    var result = {};\n    getObjectKeys(styles).forEach(function (style) { return callbackfn(style, styles, result); });\n    setStyles(element, styles);\n    return result;\n}\nfunction removeNonBorderStyles(element) {\n    return updateStyles(element, function (name, styles, result) {\n        if (name.indexOf('border') < 0) {\n            result[name] = styles[name];\n            delete styles[name];\n        }\n    });\n}\nfunction removeNotTableDefaultStyles(element) {\n    return updateStyles(element, function (name, styles, result) {\n        if (name != 'border-collapse') {\n            result[name] = styles[name];\n            delete styles[name];\n        }\n    });\n}\n/**\n * Verifies recursively if a node and its parents have any siblings with text content\n * Ignoring the children of contentDiv and returning true if any node is LI\n * @returns `true` if this node, and its parents (minus the children of the contentDiv) have no siblings with text content\n */\nfunction isNodeWholeBlock(node, editor) {\n    var _a;\n    var currentNode = node;\n    var _loop_1 = function () {\n        if (currentNode.nextSibling || currentNode.previousSibling) {\n            if (safeInstanceOf(currentNode, 'HTMLLIElement')) {\n                return { value: true };\n            }\n            var isOnlySiblingWithContent_1 = true;\n            (_a = currentNode.parentNode) === null || _a === void 0 ? void 0 : _a.childNodes.forEach(function (node) {\n                var _a;\n                if (node != currentNode && ((_a = node.textContent) === null || _a === void 0 ? void 0 : _a.length)) {\n                    isOnlySiblingWithContent_1 = false;\n                }\n            });\n            return { value: isOnlySiblingWithContent_1 };\n        }\n        currentNode = currentNode.parentNode;\n    };\n    while (currentNode && editor.contains(currentNode.parentNode)) {\n        var state_1 = _loop_1();\n        if (typeof state_1 === \"object\")\n            return state_1.value;\n    }\n    return true;\n}\n/**\n * Clear the format of the selected text or list of blocks\n * If the current selection is compose of multiple block elements then remove the text and struture format for all the selected blocks\n * If the current selection is compose of a partial inline element then only the text format is removed from the current selection\n * @param editor The editor instance\n */\nfunction clearAutoDetectFormat(editor) {\n    var isMultiBlock = isMultiBlockSelection(editor);\n    if (!isMultiBlock) {\n        var transverser = editor.getSelectionTraverser();\n        var inlineElement = transverser === null || transverser === void 0 ? void 0 : transverser.currentInlineElement;\n        var isPartial = inlineElement instanceof PartialInlineElement ||\n            (inlineElement instanceof NodeInlineElement &&\n                !isNodeWholeBlock(inlineElement.getContainerNode(), editor));\n        if (isPartial) {\n            clearFormat(editor);\n            return;\n        }\n    }\n    clearBlockFormat(editor);\n}\n/**\n * Clear all formats of selected blocks.\n * When selection is collapsed, only clear format of current block.\n * @param editor The editor instance\n */\nfunction clearBlockFormat(editor) {\n    formatUndoSnapshot(editor, function () {\n        blockFormat(editor, function (region) {\n            var blocks = getSelectedBlockElementsInRegion(region);\n            var nodes = collapseNodesInRegion(region, blocks);\n            if (editor.contains(region.rootNode)) {\n                // If there are styles on table cell, wrap all its children and move down all non-border styles.\n                // So that we can preserve styles for unselected blocks as well as border styles for table\n                var nonborderStyles = removeNonBorderStyles(region.rootNode);\n                if (getObjectKeys(nonborderStyles).length > 0) {\n                    var wrapper = wrap(toArray(region.rootNode.childNodes));\n                    setStyles(wrapper, nonborderStyles);\n                }\n            }\n            while (nodes.length > 0 &&\n                nodes[0].parentNode &&\n                isNodeInRegion(region, nodes[0].parentNode)) {\n                var balancedNodes = splitBalancedNodeRange(nodes);\n                nodes = balancedNodes ? [balancedNodes] : [];\n            }\n            nodes.forEach(clearNodeFormat);\n        });\n        setDefaultFormat(editor);\n    }, 'clearBlockFormat');\n}\nfunction clearInlineFormat(editor) {\n    editor.focus();\n    editor.addUndoSnapshot(function () {\n        execCommand(editor, \"removeFormat\" /* RemoveFormat */);\n        editor.queryElements('[class]', 1 /* OnSelection */, function (node) {\n            return node.removeAttribute('class');\n        });\n        setDefaultFormat(editor);\n        return 'clearInlineFormat';\n    }, \"Format\" /* Format */);\n}\nfunction setDefaultFontWeight(editor, fontWeight) {\n    if (fontWeight === void 0) { fontWeight = '400'; }\n    applyListItemStyleWrap(editor, 'font-weight', function (element) { return (element.style.fontWeight = fontWeight); }, 'setDefaultFontWeight');\n}\nfunction setDefaultFormat(editor) {\n    var defaultFormat = editor.getDefaultFormat();\n    var isDefaultFormatEmpty = getObjectKeys(defaultFormat).length === 0;\n    editor.queryElements('[style]', 2 /* InSelection */, function (node) {\n        var tag = getTagOfNode(node);\n        if (TAGS_TO_STOP_UNWRAP.indexOf(tag) == -1) {\n            removeStyles(tag, node, isDefaultFormatEmpty);\n        }\n        else {\n            node.childNodes.forEach(function (node) {\n                node.childNodes.forEach(function (cNode) {\n                    var tag = getTagOfNode(cNode);\n                    if (safeInstanceOf(cNode, 'HTMLElement')) {\n                        removeStyles(tag, cNode, isDefaultFormatEmpty);\n                    }\n                });\n            });\n        }\n    });\n    if (!isDefaultFormatEmpty) {\n        if (defaultFormat.fontFamily) {\n            setFontName(editor, defaultFormat.fontFamily);\n        }\n        if (defaultFormat.fontSize) {\n            setFontSize(editor, defaultFormat.fontSize);\n        }\n        if (defaultFormat.textColor) {\n            var setColorIgnoredElements_1 = editor.queryElements('a *, a', 1 /* OnSelection */);\n            var shouldApplyInlineStyle = setColorIgnoredElements_1.length > 0\n                ? function (element) { return setColorIgnoredElements_1.indexOf(element) == -1; }\n                : undefined;\n            if (defaultFormat.textColors) {\n                setTextColor(editor, defaultFormat.textColors, shouldApplyInlineStyle);\n            }\n            else {\n                setTextColor(editor, defaultFormat.textColor, shouldApplyInlineStyle);\n            }\n        }\n        if (defaultFormat.backgroundColor) {\n            if (defaultFormat.backgroundColors) {\n                setBackgroundColor(editor, defaultFormat.backgroundColors);\n            }\n            else {\n                setBackgroundColor(editor, defaultFormat.backgroundColor);\n            }\n        }\n        if (defaultFormat.bold) {\n            toggleBold(editor);\n        }\n        else {\n            setDefaultFontWeight(editor);\n        }\n        if (defaultFormat.italic) {\n            toggleItalic(editor);\n        }\n        if (defaultFormat.underline) {\n            toggleUnderline(editor);\n        }\n    }\n}\nfunction removeStyles(tag, node, isDefaultFormatEmpty) {\n    if (TAGS_TO_STOP_UNWRAP.indexOf(tag) == -1) {\n        STYLES_TO_REMOVE.forEach(function (style) { return node.style.removeProperty(style); });\n        // when default format is empty, keep the HTML minimum by removing style attribute if there's no style\n        // (note: because default format is empty, we're not adding style back in)\n        if (isDefaultFormatEmpty && node.getAttribute('style') === '') {\n            node.removeAttribute('style');\n        }\n    }\n}\n/**\n * Clear the format in current selection, after cleaning, the format will be\n * changed to default format. The format that get cleaned include B/I/U/font name/\n * font size/text color/background color/align left/align right/align center/superscript/subscript\n * @param editor The editor instance\n * @param formatType type of format to apply\n */\nexport default function clearFormat(editor, formatType) {\n    if (formatType === void 0) { formatType = 0 /* Inline */; }\n    switch (formatType) {\n        case 0 /* Inline */:\n            clearInlineFormat(editor);\n            break;\n        case 1 /* Block */:\n            clearBlockFormat(editor);\n            break;\n        default:\n            clearAutoDetectFormat(editor);\n    }\n}\n//# sourceMappingURL=clearFormat.js.map","import applyListItemStyleWrap from '../utils/applyListItemWrap';\n/**\n * Set font name at selection\n * @param editor The editor instance\n * @param fontName The fontName string, should be a valid CSS font-family style.\n * Currently there's no validation to the string, if the passed string is invalid, it won't take affect\n */\nexport default function setFontName(editor, fontName) {\n    // The browser provided execCommand creates a HTML <font> tag with face attribute. <font> is not HTML5 standard\n    // (http://www.w3schools.com/tags/tag_font.asp).\n    applyListItemStyleWrap(editor, 'font-family', function (element, isInnerNode) {\n        element.style.fontFamily = isInnerNode ? '' : fontName;\n    }, 'setFontName');\n}\n//# sourceMappingURL=setFontName.js.map","import applyListItemStyleWrap from '../utils/applyListItemWrap';\nimport { getComputedStyle } from 'roosterjs-editor-dom';\n/**\n * Set font size at selection\n * @param editor The editor instance\n * @param fontSize The fontSize string, should be a valid CSS font-size style.\n * Currently there's no validation to the string, if the passed string is invalid, it won't take affect\n */\nexport default function setFontSize(editor, fontSize) {\n    // The browser provided execCommand only accepts 1-7 point value. In addition, it uses HTML <font> tag with size attribute.\n    // <font> is not HTML5 standard (http://www.w3schools.com/tags/tag_font.asp).\n    applyListItemStyleWrap(editor, 'font-size', function (element, isInnerNode) {\n        element.style.fontSize = isInnerNode ? '' : fontSize;\n        var lineHeight = getComputedStyle(element, 'line-height');\n        if (lineHeight && lineHeight != 'normal') {\n            element.style.lineHeight = 'normal';\n        }\n    }, 'setFontSize');\n}\n//# sourceMappingURL=setFontSize.js.map","import { HtmlSanitizer, matchLink, wrap } from 'roosterjs-editor-dom';\n// Regex matching Uri scheme\nvar URI_REGEX = /^[a-zA-Z]+:/i;\n// Regex matching begin of email address\nvar MAILTO_REGEX = /^[\\w.%+-]+@/i;\n// Regex matching begin of ftp, i.e. ftp.microsoft.com\nvar FTP_REGEX = /^ftp\\./i;\nfunction applyLinkPrefix(url) {\n    if (!url) {\n        return url;\n    }\n    // Add link prefix per rule:\n    // (a) if the url always starts with a URI scheme, leave it as it is\n    // (b) if the url is an email address, xxx@... add mailto: prefix\n    // (c) if the url starts with ftp., add ftp:// prefix\n    // (d) rest, add http:// prefix\n    var prefix = '';\n    if (url.search(URI_REGEX) < 0) {\n        if (url.search(MAILTO_REGEX) == 0) {\n            prefix = 'mailto:';\n        }\n        else if (url.search(FTP_REGEX) == 0) {\n            prefix = 'ftp://';\n        }\n        else {\n            // fallback to http://\n            prefix = 'http://';\n        }\n    }\n    return prefix + url;\n}\n/**\n * Insert a hyperlink at cursor.\n * When there is a selection, hyperlink will be applied to the selection,\n * otherwise a hyperlink will be inserted to the cursor position.\n * @param editor Editor object\n * @param link Link address, can be http(s), mailto, notes, file, unc, ftp, news, telnet, gopher, wais.\n * When protocol is not specified, a best matched protocol will be predicted.\n * @param altText Optional alt text of the link, will be shown when hover on the link\n * @param displayText Optional display text for the link.\n * @param target Optional display target for the link (\"_blank\"|\"_self\"|\"_parent\"|\"_top\"|\"{framename}\")\n * If specified, the display text of link will be replaced with this text.\n * If not specified and there wasn't a link, the link url will be used as display text.\n */\nexport default function createLink(editor, link, altText, displayText, target) {\n    editor.focus();\n    var url = (checkXss(link) || '').trim();\n    if (url) {\n        var linkData = matchLink(url);\n        // matchLink can match most links, but not all, i.e. if you pass link a link as \"abc\", it won't match\n        // we know in that case, users will want to insert a link like http://abc\n        // so we have separate logic in applyLinkPrefix to add link prefix depending on the format of the link\n        // i.e. if the link starts with something like abc@xxx, we will add mailto: prefix\n        // if the link starts with ftp.xxx, we will add ftp:// link. For more, see applyLinkPrefix\n        var normalizedUrl_1 = linkData ? linkData.normalizedUrl : applyLinkPrefix(url);\n        var originalUrl_1 = linkData ? linkData.originalUrl : url;\n        editor.addUndoSnapshot(function () {\n            var selection = editor.getSelectionRangeEx();\n            var anchor = null;\n            if (selection.type === 0 /* Normal */) {\n                var range = selection.ranges[0];\n                if (range && range.collapsed) {\n                    anchor = getAnchorNodeAtCursor(editor);\n                    // If there is already a link, just change its href\n                    if (anchor) {\n                        anchor.href = normalizedUrl_1;\n                        // Change text content if it is specified\n                        updateAnchorDisplayText(anchor, displayText);\n                    }\n                    else {\n                        anchor = editor.getDocument().createElement('A');\n                        anchor.textContent = displayText || originalUrl_1;\n                        anchor.href = normalizedUrl_1;\n                        editor.insertNode(anchor);\n                    }\n                }\n                else {\n                    // the selection is not collapsed, use browser execCommand\n                    editor\n                        .getDocument()\n                        .execCommand(\"createLink\" /* CreateLink */, false, normalizedUrl_1);\n                    var traverser = editor.getSelectionTraverser();\n                    var currentInline = traverser === null || traverser === void 0 ? void 0 : traverser.getNextInlineElement();\n                    // list for removing unwanted lines\n                    var deletionInlineList = [];\n                    while (currentInline) {\n                        deletionInlineList.push(currentInline.getContainerNode());\n                        currentInline = traverser === null || traverser === void 0 ? void 0 : traverser.getNextInlineElement();\n                    }\n                    deletionInlineList.forEach(function (node) { return editor.deleteNode(node); });\n                    anchor = getAnchorNodeAtCursor(editor);\n                    updateAnchorDisplayText(anchor, displayText);\n                }\n            }\n            else if (selection.type === 2 /* ImageSelection */) {\n                anchor = wrap(selection.image, 'A');\n                anchor.href = normalizedUrl_1;\n            }\n            if (altText && anchor) {\n                anchor.title = altText;\n            }\n            if (anchor) {\n                updateAnchorTarget(anchor, target);\n            }\n            return anchor;\n        }, \"CreateLink\" /* CreateLink */);\n    }\n}\nfunction getAnchorNodeAtCursor(editor) {\n    return editor.queryElements('a[href]', 1 /* OnSelection */)[0];\n}\nfunction updateAnchorDisplayText(anchor, displayText) {\n    if (displayText && anchor.textContent != displayText) {\n        anchor.textContent = displayText;\n    }\n}\nfunction updateAnchorTarget(anchor, target) {\n    if (target) {\n        anchor.target = target;\n    }\n    else if (!target && anchor.getAttribute('target')) {\n        anchor.removeAttribute('target');\n    }\n}\nfunction checkXss(link) {\n    var sanitizer = new HtmlSanitizer();\n    var a = document.createElement('a');\n    a.href = link || '';\n    sanitizer.sanitize(a);\n    // We use getAttribute because some browsers will try to make the href property a valid link.\n    // This has unintended side effects when the link lacks a protocol.\n    return a.getAttribute('href');\n}\n//# sourceMappingURL=createLink.js.map","import { __assign } from \"tslib\";\nimport { getTableFormatInfo, getTagOfNode, toArray } from 'roosterjs-editor-dom';\n/**\n * Get element based Format State at cursor\n * @param editor The editor instance\n * @param event (Optional) The plugin event, it stores the event cached data for looking up.\n * In this function the event cache is used to get list state and heading level. If not passed,\n * it will query the node within selection to get the info\n * @returns An ElementBasedFormatState object\n */\nexport function getElementBasedFormatState(editor, event) {\n    var listTag = getTagOfNode(editor.getElementAtCursor('OL,UL', undefined /*startFrom*/, event));\n    // Check if selection is multiline, spans more than one block\n    var range = editor.getSelectionRange();\n    var multiline = false;\n    if (range && !range.collapsed) {\n        var startingBlock = editor.getBlockElementAtNode(range.startContainer);\n        var endingBlock = editor.getBlockElementAtNode(range.endContainer);\n        multiline = endingBlock && startingBlock ? !endingBlock.equals(startingBlock) : false;\n    }\n    var headingTag = getTagOfNode(editor.getElementAtCursor('H1,H2,H3,H4,H5,H6', undefined /*startFrom*/, event));\n    var table = editor.queryElements('table', 1 /* OnSelection */)[0];\n    var tableFormat = table ? getTableFormatInfo(table) : undefined;\n    var hasTableHeader = (table === null || table === void 0 ? void 0 : table.rows[0])\n        ? toArray(table.rows[0].cells).every(function (cell) { return getTagOfNode(cell) == 'TH'; })\n        : undefined;\n    var headingLevel = (headingTag && parseInt(headingTag[1])) || 0;\n    return {\n        isBullet: listTag == 'UL',\n        isNumbering: listTag == 'OL',\n        isMultilineSelection: multiline,\n        headingLevel: headingLevel,\n        headerLevel: headingLevel,\n        canUnlink: !!editor.queryElements('a[href]', 1 /* OnSelection */)[0],\n        canAddImageAltText: !!editor.queryElements('img', 1 /* OnSelection */)[0],\n        isBlockQuote: !!editor.queryElements('blockquote', 1 /* OnSelection */)[0],\n        isCodeInline: !!editor.queryElements('code', 1 /* OnSelection */)[0],\n        isCodeBlock: !!editor.queryElements('pre>code', 1 /* OnSelection */)[0],\n        isInTable: !!table,\n        tableFormat: tableFormat || {},\n        tableHasHeader: hasTableHeader,\n        canMergeTableCell: canMergeTableCell(editor),\n    };\n}\n/**\n * Get format state at cursor\n * A format state is a collection of all format related states, e.g.,\n * bold, italic, underline, font name, font size, etc.\n * @param editor The editor instance\n * @param event (Optional) The plugin event, it stores the event cached data for looking up.\n * In this function the event cache is used to get list state and heading level. If not passed,\n * it will query the node within selection to get the info\n * @returns The format state at cursor\n */\nexport default function getFormatState(editor, event) {\n    return __assign(__assign(__assign(__assign(__assign({}, editor.getPendableFormatState(false /* forceGetStateFromDom */)), getElementBasedFormatState(editor, event)), editor.getStyleBasedFormatState()), editor.getUndoState()), { isDarkMode: editor.isDarkMode(), zoomScale: editor.getZoomScale() });\n}\n/**\n * Checks whether the editor selection range is starting and ending at a table element.\n * @param editor Editor Instance\n * @returns\n */\nvar canMergeTableCell = function (editor) {\n    var selection = editor.getSelectionRangeEx();\n    var isATable = selection && selection.type === 1 /* TableSelection */;\n    if (isATable && selection.coordinates) {\n        var _a = selection.coordinates, firstCell = _a.firstCell, lastCell = _a.lastCell;\n        if (firstCell.x !== lastCell.x || firstCell.y !== lastCell.y) {\n            return true;\n        }\n        return false;\n    }\n    return false;\n};\n//# sourceMappingURL=getFormatState.js.map","import formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport { getObjectKeys, readFile } from 'roosterjs-editor-dom';\n/**\n * Insert an image to editor at current selection\n * @param editor The editor instance\n * @param imageFileOrSrc Either the image file blob or source string of the image.\n * @param attributes Optional image element attributes\n */\nexport default function insertImage(editor, imageFileOrSrc, attributes) {\n    if (typeof imageFileOrSrc == 'string') {\n        insertImageWithSrc(editor, imageFileOrSrc, attributes);\n    }\n    else {\n        readFile(imageFileOrSrc, function (dataUrl) {\n            if (dataUrl && !editor.isDisposed()) {\n                insertImageWithSrc(editor, dataUrl, attributes);\n            }\n        });\n    }\n}\nfunction insertImageWithSrc(editor, src, attributes) {\n    formatUndoSnapshot(editor, function () {\n        var image = editor.getDocument().createElement('img');\n        image.src = src;\n        if (attributes) {\n            getObjectKeys(attributes).forEach(function (attribute) {\n                return image.setAttribute(attribute, attributes[attribute]);\n            });\n        }\n        editor.insertNode(image);\n    }, 'insertImage');\n}\n//# sourceMappingURL=insertImage.js.map","import formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport { VTable } from 'roosterjs-editor-dom';\n/**\n * Edit table with given operation. If there is no table at cursor then no op.\n * @param editor The editor instance\n * @param operation Table operation\n */\nexport default function editTable(editor, operation) {\n    var td = editor.getElementAtCursor('TD,TH');\n    if (td) {\n        formatUndoSnapshot(editor, function () {\n            var vtable = new VTable(td);\n            saveTableSelection(editor, vtable);\n            vtable.edit(operation);\n            vtable.writeBack(false /** skipApplyFormat */, editor.getDarkColorHandler());\n            editor.transformToDarkColor(vtable.table);\n            editor.focus();\n            if (isUndefined(vtable.row) || isUndefined(vtable.col)) {\n                return;\n            }\n            var _a = calculateCellToSelect(operation, vtable.row, vtable.col), newCol = _a.newCol, newRow = _a.newRow;\n            var newTd = vtable.getCell(newRow, newCol).td;\n            if (newTd) {\n                editor.select(newTd, 0 /* Begin */);\n            }\n        }, 'editTable');\n    }\n}\nfunction isUndefined(n) {\n    return n == undefined;\n}\nfunction calculateCellToSelect(operation, currentRow, currentCol) {\n    var newRow = currentRow;\n    var newCol = currentCol;\n    switch (operation) {\n        case 0 /* InsertAbove */:\n            newCol = 0;\n            break;\n        case 1 /* InsertBelow */:\n            newRow += 1;\n            newCol = 0;\n            break;\n        case 2 /* InsertLeft */:\n            newRow = 0;\n            break;\n        case 3 /* InsertRight */:\n            newRow = 0;\n            newCol += 1;\n            break;\n    }\n    return {\n        newRow: newRow,\n        newCol: newCol,\n    };\n}\nfunction saveTableSelection(editor, vtable) {\n    var _a;\n    var selection = editor.getSelectionRangeEx();\n    if (selection && selection.type === 1 /* TableSelection */) {\n        vtable.selection = (_a = selection.coordinates) !== null && _a !== void 0 ? _a : null;\n    }\n}\n//# sourceMappingURL=editTable.js.map","import formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport { unwrap } from 'roosterjs-editor-dom';\n/**\n * Remove link at selection. If no links at selection, do nothing.\n * If selection contains multiple links, all of the link styles will be removed.\n * If only part of a link is selected, the whole link style will be removed.\n * @param editor The editor instance\n */\nexport default function removeLink(editor) {\n    editor.focus();\n    formatUndoSnapshot(editor, function (start, end) {\n        editor.queryElements('a[href]', 1 /* OnSelection */, unwrap);\n        if (start && end) {\n            editor.select(start, end);\n        }\n    }, 'removeLink');\n}\n//# sourceMappingURL=removeLink.js.map","import { findClosestElementAncestor, getComputedStyle, safeInstanceOf } from 'roosterjs-editor-dom';\n/**\n * @internal\n * @param node start node to normalize\n * @param quotesHandled Optional parameter to prevent already modified quotes to be rechecked.\n * @returns\n */\nexport default function normalizeBlockquote(node, quotesHandled) {\n    if (safeInstanceOf(node, 'HTMLElement')) {\n        var alignment = node.style.textAlign;\n        var quote = findClosestElementAncestor(node, undefined /* root */, 'blockquote');\n        if (!quote) {\n            return;\n        }\n        var isNodeRTL = isRTL(node);\n        if (quotesHandled) {\n            if (quotesHandled.indexOf(quote) > -1) {\n                return;\n            }\n            quotesHandled.push(quote);\n        }\n        while (quote) {\n            if (alignment == 'center') {\n                if (isNodeRTL) {\n                    quote.style.removeProperty('marginInlineEnd');\n                    quote.style.marginInlineStart = 'auto';\n                }\n                else {\n                    quote.style.removeProperty('marginInlineStart');\n                    quote.style.marginInlineEnd = 'auto';\n                }\n            }\n            else {\n                quote.style.removeProperty('marginInlineEnd');\n                quote.style.removeProperty('marginInlineStart');\n            }\n            quote = findClosestElementAncestor(quote.parentElement, undefined /* root */, 'blockquote');\n        }\n    }\n}\nfunction isRTL(el) {\n    return getComputedStyle(el, 'direction') == 'rtl' || el.getAttribute('dir') == 'rtl';\n}\n//# sourceMappingURL=normalizeBlockquote.js.map","import blockFormat from '../utils/blockFormat';\nimport execCommand from '../utils/execCommand';\nimport formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport normalizeBlockquote from '../utils/normalizeBlockquote';\nimport { createVListFromRegion, findClosestElementAncestor, getSelectedBlockElementsInRegion, isWholeTableSelected, VTable, } from 'roosterjs-editor-dom';\n/**\n * Set content alignment\n * @param editor The editor instance\n * @param alignment The alignment option:\n * Alignment.Center, Alignment.Left, Alignment.Right\n */\nexport default function setAlignment(editor, alignment) {\n    formatUndoSnapshot(editor, function () {\n        var selection = editor.getSelectionRangeEx();\n        var isATable = selection && selection.type === 1 /* TableSelection */;\n        var elementAtCursor = editor.getElementAtCursor();\n        if (isATable &&\n            selection.coordinates &&\n            isWholeTableSelected(new VTable(selection.table), selection.coordinates)) {\n            alignTable(selection, alignment);\n        }\n        else if (elementAtCursor && isList(elementAtCursor)) {\n            alignList(editor, alignment);\n        }\n        else {\n            alignText(editor, alignment);\n        }\n    }, 'setAlignment');\n}\n/**\n * Align text using the margins\n * @param editor\n * @param element\n * @param alignment\n * @param addUndoSnapshot\n * @returns\n */\nfunction alignTable(selection, alignment) {\n    var table = selection.table;\n    if (alignment == 1 /* Center */) {\n        table.style.marginLeft = 'auto';\n        table.style.marginRight = 'auto';\n    }\n    else if (alignment == 2 /* Right */) {\n        table.style.marginLeft = 'auto';\n        table.style.marginRight = '';\n    }\n    else {\n        table.style.marginLeft = '';\n        table.style.marginRight = 'auto';\n    }\n}\n/**\n * Align text using the text-align\n * @param editor\n * @param alignment\n * @returns\n */\nfunction alignText(editor, alignment) {\n    var align = 'left';\n    var command = \"justifyLeft\" /* JustifyLeft */;\n    if (alignment == 1 /* Center */) {\n        command = \"justifyCenter\" /* JustifyCenter */;\n        align = 'center';\n    }\n    else if (alignment == 2 /* Right */) {\n        command = \"justifyRight\" /* JustifyRight */;\n        align = 'right';\n    }\n    execCommand(editor, command);\n    var elements = editor.queryElements('[align]', 1 /* OnSelection */, function (node) {\n        node.style.textAlign = align;\n        normalizeBlockquote(node);\n    });\n    if (elements.length == 0) {\n        var node = editor.getElementAtCursor();\n        if (node) {\n            normalizeBlockquote(node);\n        }\n    }\n}\nfunction isList(element) {\n    return findClosestElementAncestor(element, undefined /** root */, 'LI');\n}\nfunction alignList(editor, alignment) {\n    blockFormat(editor, function (region, start, end) {\n        var blocks = getSelectedBlockElementsInRegion(region);\n        var startNode = blocks[0].getStartNode();\n        var vList = createVListFromRegion(region, true /*includeSiblingLists*/, startNode);\n        if (start && end) {\n            vList === null || vList === void 0 ? void 0 : vList.setAlignment(start, end, alignment);\n        }\n    }, undefined /* beforeRunCallback */, 'alignList');\n}\n//# sourceMappingURL=setAlignment.js.map","import { getTagOfNode } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Collapse all selected blocks, return single HTML elements for each block\n * @param editor The editor instance\n * @param forEachCallback A callback function to invoke for each of the collapsed element\n */\nexport default function collapseSelectedBlocks(editor, forEachCallback) {\n    var traverser = editor.getSelectionTraverser();\n    if (!traverser) {\n        return;\n    }\n    var block = traverser.currentBlockElement;\n    var blocks = [];\n    while (block) {\n        if (!isEmptyBlockUnderTR(block)) {\n            blocks.push(block);\n        }\n        block = traverser.getNextBlockElement();\n    }\n    blocks.forEach(function (block) {\n        var element = block.collapseToSingleElement();\n        forEachCallback(element);\n    });\n}\nfunction isEmptyBlockUnderTR(block) {\n    var startNode = block.getStartNode();\n    return (startNode == block.getEndNode() &&\n        startNode.nodeType == 3 /* Text */ &&\n        ['TR', 'TABLE'].indexOf(getTagOfNode(startNode.parentNode)) >= 0);\n}\n//# sourceMappingURL=collapseSelectedBlocks.js.map","import collapseSelectedBlocks from '../utils/collapseSelectedBlocks';\nimport formatUndoSnapshot from '../utils/formatUndoSnapshot';\n/**\n * Change direction for the blocks/paragraph at selection\n * @param editor The editor instance\n * @param direction The direction option:\n * Direction.LeftToRight refers to 'ltr', Direction.RightToLeft refers to 'rtl'\n */\nexport default function setDirection(editor, direction) {\n    editor.focus();\n    formatUndoSnapshot(editor, function (start, end) {\n        collapseSelectedBlocks(editor, function (element) {\n            element.setAttribute('dir', direction == 0 /* LeftToRight */ ? 'ltr' : 'rtl');\n            element.style.textAlign = direction == 0 /* LeftToRight */ ? 'left' : 'right';\n        });\n        if (start && end) {\n            editor.select(start, end);\n        }\n    }, 'setDirection');\n}\n//# sourceMappingURL=setDirection.js.map","import blockFormat from '../utils/blockFormat';\nimport normalizeBlockquote from '../utils/normalizeBlockquote';\nimport { collapseNodesInRegion, createVListFromRegion, findClosestElementAncestor, getSelectedBlockElementsInRegion, getTagOfNode, isNodeInRegion, isWholeTableSelected, splitBalancedNodeRange, toArray, unwrap, VTable, wrap, } from 'roosterjs-editor-dom';\n/**\n * Set indentation at selection\n * If selection contains bullet/numbering list, increase/decrease indentation will\n * increase/decrease the list level by one.\n * @param editor The editor instance\n * @param indentation The indentation option:\n * Indentation.Increase to increase indentation or Indentation.Decrease to decrease indentation\n */\nexport default function setIndentation(editor, indentation) {\n    var handler = indentation == 0 /* Increase */ ? indent : outdent;\n    blockFormat(editor, function (region, start, end) {\n        var blocks = getSelectedBlockElementsInRegion(region, true /*createBlockIfEmpty*/);\n        var blockGroups = [[]];\n        for (var i = 0; i < blocks.length; i++) {\n            var startNode = blocks[i].getStartNode();\n            var vList = createVListFromRegion(region, true /*includeSiblingLists*/, startNode);\n            if (vList) {\n                while (blocks[i + 1] && vList.contains(blocks[i + 1].getStartNode())) {\n                    i++;\n                }\n                var isTabKeyTextFeaturesEnabled = editor.isFeatureEnabled(\"TabKeyTextFeatures\" /* TabKeyTextFeatures */);\n                if (isTabKeyTextFeaturesEnabled &&\n                    isFirstItem(vList, startNode) &&\n                    shouldHandleWithBlockquotes(indentation, editor, startNode)) {\n                    var block = editor.getBlockElementAtNode(vList.rootList);\n                    if (block) {\n                        blockGroups.push([block]);\n                    }\n                }\n                else {\n                    if (start && end) {\n                        indentation == 1 /* Decrease */\n                            ? vList.setIndentation(start, end, indentation, false /* softOutdent */, isTabKeyTextFeaturesEnabled /* preventItemRemoval */)\n                            : vList.setIndentation(start, end, indentation);\n                        vList.writeBack(editor.isFeatureEnabled(\"ReuseAllAncestorListElements\" /* ReuseAllAncestorListElements */), editor.isFeatureEnabled(\"DisableListChain\" /* DisableListChain */));\n                        blockGroups.push([]);\n                    }\n                }\n            }\n            else {\n                blockGroups[blockGroups.length - 1].push(blocks[i]);\n            }\n        }\n        blockGroups.forEach(function (group) { return handler(region, group); });\n    }, function () {\n        var selection = editor.getSelectionRangeEx();\n        if (selection.type == 1 /* TableSelection */ &&\n            selection.coordinates &&\n            isWholeTableSelected(new VTable(selection.table), selection.coordinates)) {\n            if (indentation == 1 /* Decrease */) {\n                var quote = editor.getElementAtCursor('blockquote', selection.table);\n                if (quote) {\n                    unwrap(quote);\n                }\n            }\n            else if (indentation == 0 /* Increase */) {\n                wrap(selection.table, 2 /* BlockquoteWrapper */);\n            }\n            return false;\n        }\n        return true;\n    }, 'setIndentation');\n    function indent(region, blocks) {\n        var nodes = collapseNodesInRegion(region, blocks);\n        wrap(nodes, 2 /* BlockquoteWrapper */);\n        var quotesHandled = [];\n        nodes.forEach(function (node) { return normalizeBlockquote(node, quotesHandled); });\n    }\n}\nfunction outdent(region, blocks) {\n    blocks.forEach(function (blockElement) {\n        var node = blockElement.collapseToSingleElement();\n        var quote = findClosestElementAncestor(node, region.rootNode, 'blockquote');\n        if (quote) {\n            if (node == quote) {\n                node = wrap(toArray(node.childNodes));\n            }\n            while (node && isNodeInRegion(region, node) && getTagOfNode(node) != 'BLOCKQUOTE') {\n                node = splitBalancedNodeRange(node);\n            }\n            if (node && isNodeInRegion(region, node)) {\n                unwrap(node);\n            }\n        }\n    });\n}\nfunction isFirstItem(vList, startNode) {\n    var _a;\n    return (((_a = vList.items[0]) === null || _a === void 0 ? void 0 : _a.getNode()) == startNode &&\n        vList.getListItemIndex(startNode) == (vList.getStart() || 1));\n}\nfunction shouldHandleWithBlockquotes(indentation, editor, startNode) {\n    return (indentation == 0 /* Increase */ || editor.getElementAtCursor('blockquote', startNode));\n}\n//# sourceMappingURL=setIndentation.js.map","import blockFormat from '../utils/blockFormat';\nimport { createVListFromRegion, getBlockElementAtNode } from 'roosterjs-editor-dom';\n/**\n * Toggle List Type at selection\n * If ListType Provided is Ordered:\n *      If selection contains numbering in deep level, toggle numbering will decrease the numbering level by one\n *      If selection contains bullet list, toggle numbering will convert the bullet list into number list\n *      If selection contains both bullet/numbering and normal text, the behavior is decided by corresponding\n *       realization of browser execCommand API\n * If ListType Provided is Unordered:\n *      If selection contains bullet in deep level, toggle bullet will decrease the bullet level by one\n *      If selection contains number list, toggle bullet will convert the number list into bullet list\n *      If selection contains both bullet/numbering and normal text, the behavior is decided by corresponding\n *      browser execCommand API\n * @param editor The editor instance\n * @param listType The list type to toggle\n * @param startNumber (Optional) Start number of the list\n * @param includeSiblingLists Sets wether the operation should include Sibling Lists, by default true\n * @param orderedStyle (Optional) the style of an ordered. If not defined, the style will be set to decimal.\n * @param unorderedStyle (Optional) the style of an unordered list. If not defined, the style will be set to disc.\n * @param apiNameOverride (Optional) Set a new api name, if empty the api name will be 'toggleListType'.\n */\nexport default function toggleListType(editor, listType, startNumber, includeSiblingLists, orderedStyle, unorderedStyle, apiNameOverride) {\n    if (startNumber === void 0) { startNumber = 0; }\n    if (includeSiblingLists === void 0) { includeSiblingLists = true; }\n    blockFormat(editor, function (region, start, end, chains) {\n        var _a, _b;\n        var chain = startNumber > 0 && chains.filter(function (chain) { return chain.canAppendAtCursor(startNumber); })[0];\n        var block = (_b = getBlockElementAtNode(region.rootNode, (_a = start === null || start === void 0 ? void 0 : start.node) !== null && _a !== void 0 ? _a : null)) === null || _b === void 0 ? void 0 : _b.collapseToSingleElement();\n        if (!block) {\n            return;\n        }\n        var vList = chain && end && (start === null || start === void 0 ? void 0 : start.equalTo(end))\n            ? chain.createVListAtBlock(block, startNumber)\n            : createVListFromRegion(region, startNumber === 1 ? false : includeSiblingLists);\n        if (vList && start && end) {\n            vList.changeListType(start, end, listType);\n            vList.setListStyleType(orderedStyle, unorderedStyle);\n            if (isNewList(vList)) {\n                vList.removeMargins();\n            }\n            vList.writeBack(editor.isFeatureEnabled(\"ReuseAllAncestorListElements\" /* ReuseAllAncestorListElements */), editor.isFeatureEnabled(\"DisableListChain\" /* DisableListChain */));\n        }\n    }, undefined /* beforeRunCallback */, apiNameOverride || 'toggleListType');\n}\nfunction isNewList(vList) {\n    var list = vList === null || vList === void 0 ? void 0 : vList.rootList;\n    if (list) {\n        return list.childElementCount === 0;\n    }\n    return false;\n}\n//# sourceMappingURL=toggleListType.js.map","import toggleListType from '../utils/toggleListType';\n/**\n * Toggle bullet at selection\n * If selection contains bullet in deep level, toggle bullet will decrease the bullet level by one\n * If selection contains number list, toggle bullet will convert the number list into bullet list\n * If selection contains both bullet/numbering and normal text, the behavior is decided by corresponding\n * browser execCommand API\n * @param editor The editor instance\n * @param listStyle (Optional) the style of the bullet list. If not defined, the style will be set to disc.\n * @param apiNameOverride (Optional) Set a new api name, if empty the api name will be 'toggleListType'.\n */\nexport default function toggleBullet(editor, listStyle, apiNameOverride) {\n    toggleListType(editor, 2 /* Unordered */, undefined /* startNumber */, false /* includeSiblingLists */, undefined /** orderedStyle  */, listStyle, apiNameOverride);\n}\n//# sourceMappingURL=toggleBullet.js.map","import toggleListType from '../utils/toggleListType';\n/**\n * Toggle numbering at selection\n * If selection contains numbering in deep level, toggle numbering will decrease the numbering level by one\n * If selection contains bullet list, toggle numbering will convert the bullet list into number list\n * If selection contains both bullet/numbering and normal text, the behavior is decided by corresponding\n * realization of browser execCommand API\n * @param editor The editor instance\n * @param startNumber (Optional) Start number of the list\n * @param listStyle (Optional) The style of the numbering list. If not defined, the style will be set to decimal.\n * @param apiNameOverride (Optional) Set a new api name, if empty the api name will be 'toggleListType'.\n */\nexport default function toggleNumbering(editor, startNumber, listStyle, apiNameOverride) {\n    toggleListType(editor, 1 /* Ordered */, startNumber, undefined /* includeSiblingLists */, listStyle, undefined /* unorderedStyle */, apiNameOverride);\n}\n//# sourceMappingURL=toggleNumbering.js.map","import blockFormat from './blockFormat';\nimport { collapseNodesInRegion, getSelectedBlockElementsInRegion, getTagOfNode, isNodeInRegion, splitBalancedNodeRange, toArray, wrap, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Toggle a tag at selection, if selection already contains elements of such tag,\n * the elements will be untagged and other elements will take no effect\n * @param editor The editor instance\n * @param wrapFunction  The wrap function\n * @param beforeRunCallback A callback function to run before looping all regions. If it returns false,\n * the loop for regions will be skipped\n */\nexport default function blockWrap(editor, wrapFunction, beforeRunCallback, apiName) {\n    blockFormat(editor, function (region) {\n        var blocks = getSelectedBlockElementsInRegion(region, true /*createBlockIfEmpty*/);\n        var nodes = collapseNodesInRegion(region, blocks);\n        if (nodes.length > 0) {\n            if (nodes.length == 1) {\n                var NodeTag = getTagOfNode(nodes[0]);\n                if (NodeTag == 'BR') {\n                    nodes = [wrap(nodes[0])];\n                }\n                else if (NodeTag == 'LI' || NodeTag == 'TD') {\n                    nodes = toArray(nodes[0].childNodes);\n                }\n            }\n            while (nodes[0] &&\n                nodes[0].parentNode &&\n                isNodeInRegion(region, nodes[0].parentNode) &&\n                nodes.some(function (node) { return getTagOfNode(node) == 'LI'; })) {\n                var result = splitBalancedNodeRange(nodes);\n                nodes = result ? [result] : [];\n            }\n            wrapFunction(nodes);\n        }\n    }, beforeRunCallback, apiName);\n}\n//# sourceMappingURL=blockWrap.js.map","import blockWrap from '../utils/blockWrap';\nimport { unwrap, wrap } from 'roosterjs-editor-dom';\nvar BLOCKQUOTE_TAG = 'blockquote';\nvar DEFAULT_STYLER = function (element) {\n    element.style.borderLeft = '3px solid';\n    element.style.borderColor = '#C8C8C8';\n    element.style.paddingLeft = '10px';\n    element.style.color = '#666666';\n};\n/**\n * Toggle blockquote at selection, if selection already contains any blockquote elements,\n * the blockquote elements will be unquote and other elements will take no effect\n * @param editor The editor instance\n * @param styler (Optional) The custom styler for setting the style for the blockquote element\n */\nexport default function toggleBlockQuote(editor, styler) {\n    blockWrap(editor, function (nodes) {\n        var wrapper = wrap(nodes, BLOCKQUOTE_TAG);\n        (styler || DEFAULT_STYLER)(wrapper);\n    }, function () { return editor.queryElements('blockquote', 1 /* OnSelection */, unwrap).length == 0; }, 'toggleBlockQuote');\n}\n//# sourceMappingURL=toggleBlockQuote.js.map","import blockWrap from '../utils/blockWrap';\nimport { unwrap, wrap } from 'roosterjs-editor-dom';\nvar PRE_TAG = 'pre';\nvar CODE_TAG = 'code';\nvar SELECTOR = PRE_TAG + \">\" + CODE_TAG;\n/**\n * Toggle code block at selection, if selection already contains any code blocked elements,\n * the code block elements will be no longer be code blocked and other elements will take no affect\n * @param editor The editor instance\n * @param styler (Optional) The custom styler for setting the style for the code block element\n */\nexport default function toggleCodeBlock(editor, styler) {\n    blockWrap(editor, function (nodes) {\n        var code = wrap(nodes, CODE_TAG);\n        var pre = wrap(code, PRE_TAG);\n        styler === null || styler === void 0 ? void 0 : styler(pre);\n    }, function () {\n        return editor.queryElements(SELECTOR, 1 /* OnSelection */, function (code) {\n            if (!code.previousSibling && !code.nextSibling) {\n                var parent_1 = code.parentNode;\n                unwrap(code);\n                if (parent_1) {\n                    unwrap(parent_1);\n                }\n            }\n        }).length == 0;\n    }, 'toggleCodeBlock');\n}\n//# sourceMappingURL=toggleCodeBlock.js.map","import { removeLink, replaceWithNode } from 'roosterjs-editor-api';\nimport { cacheGetEventData, clearEventDataCache, LinkInlineElement, matchLink, } from 'roosterjs-editor-dom';\n/**\n * When user type, they may end a link with a punctuation, i.e. www.bing.com;\n * we need to trim off the trailing punctuation before turning it to link match\n */\nvar TRAILING_PUNCTUATION_REGEX = /[.+=\\s:;\"',>]+$/i;\nvar MINIMUM_LENGTH = 5;\n/**\n * AutoLink edit feature, provides the ability to automatically convert text user typed or pasted\n * in hyperlink format into a real hyperlink\n */\nvar AutoLink = {\n    keys: [13 /* ENTER */, 32 /* SPACE */, 257 /* CONTENTCHANGED */],\n    shouldHandleEvent: cacheGetLinkData,\n    handleEvent: autoLink,\n};\n/**\n * UnlinkWhenBackspaceAfterLink edit feature, provides the ability to convert a hyperlink back into text\n * if user presses BACKSPACE right after a hyperlink\n */\nvar UnlinkWhenBackspaceAfterLink = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: hasLinkBeforeCursor,\n    handleEvent: function (event, editor) {\n        event.rawEvent.preventDefault();\n        removeLink(editor);\n    },\n    defaultDisabled: true,\n};\nfunction cacheGetLinkData(event, editor) {\n    return event.eventType == 0 /* KeyDown */ ||\n        (event.eventType == 7 /* ContentChanged */ && event.source == \"Paste\" /* Paste */)\n        ? cacheGetEventData(event, 'LINK_DATA', function () {\n            // First try to match link from the whole paste string from the plain text in clipboard.\n            // This helps when we paste a link next to some existing character, and the text we got\n            // from clipboard will only contain what we pasted, any existing characters will not\n            // be included.\n            var clipboardData = (event.eventType == 7 /* ContentChanged */ &&\n                event.source == \"Paste\" /* Paste */ &&\n                event.data) ||\n                null;\n            var link = matchLink(((clipboardData === null || clipboardData === void 0 ? void 0 : clipboardData.text) || '').trim());\n            var searcher = editor.getContentSearcherOfCursor(event);\n            // In case the matched link is already inside a <A> tag, we do a range search.\n            // getRangeFromText will return null if the given text is already in a LinkInlineElement\n            if (link && (searcher === null || searcher === void 0 ? void 0 : searcher.getRangeFromText(link.originalUrl, false /*exactMatch*/))) {\n                return link;\n            }\n            var word = searcher && searcher.getWordBefore();\n            if (word && word.length > MINIMUM_LENGTH) {\n                // Check for trailing punctuation\n                var trailingPunctuations = word.match(TRAILING_PUNCTUATION_REGEX);\n                var trailingPunctuation = (trailingPunctuations || [])[0] || '';\n                var candidate_1 = word.substring(0, word.length - trailingPunctuation.length);\n                // Do special handling for ')', '}', ']'\n                ['()', '{}', '[]'].forEach(function (str) {\n                    if (candidate_1[candidate_1.length - 1] == str[1] &&\n                        candidate_1.indexOf(str[0]) < 0) {\n                        candidate_1 = candidate_1.substr(0, candidate_1.length - 1);\n                    }\n                });\n                // Match and replace in editor\n                return matchLink(candidate_1);\n            }\n            return null;\n        })\n        : null;\n}\nfunction hasLinkBeforeCursor(event, editor) {\n    var contentSearcher = editor.getContentSearcherOfCursor(event);\n    var inline = contentSearcher === null || contentSearcher === void 0 ? void 0 : contentSearcher.getInlineElementBefore();\n    return inline instanceof LinkInlineElement;\n}\nfunction autoLink(event, editor) {\n    var linkData = cacheGetLinkData(event, editor);\n    if (!linkData) {\n        return;\n    }\n    var anchor = editor.getDocument().createElement('a');\n    // Need to get searcher before we enter the async callback since the callback can happen when cursor is moved to next line\n    // and at that time a new searcher won't be able to find the link text to replace\n    var searcher = editor.getContentSearcherOfCursor();\n    anchor.textContent = linkData.originalUrl;\n    anchor.href = linkData.normalizedUrl;\n    editor.runAsync(function (editor) {\n        editor.addUndoSnapshot(function () {\n            replaceWithNode(editor, linkData.originalUrl, anchor, false /* exactMatch */, searcher !== null && searcher !== void 0 ? searcher : undefined);\n            // The content at cursor has changed. Should also clear the cursor data cache\n            clearEventDataCache(event);\n            return anchor;\n        }, \"AutoLink\" /* AutoLink */, true /*canUndoByBackspace*/);\n    });\n}\n/**\n * @internal\n */\nexport var AutoLinkFeatures = {\n    autoLink: AutoLink,\n    unlinkWhenBackspaceAfterLink: UnlinkWhenBackspaceAfterLink,\n};\n//# sourceMappingURL=autoLinkFeatures.js.map","export default function replaceWithNode(editor, textOrRange, node, exactMatch, searcher) {\n    var _a, _b;\n    // Make sure the text and node is valid\n    if (!textOrRange || !node) {\n        return false;\n    }\n    var range;\n    if (typeof textOrRange == 'string') {\n        searcher = (_a = (searcher || editor.getContentSearcherOfCursor())) !== null && _a !== void 0 ? _a : undefined;\n        range = (_b = searcher === null || searcher === void 0 ? void 0 : searcher.getRangeFromText(textOrRange, exactMatch)) !== null && _b !== void 0 ? _b : null;\n    }\n    else {\n        range = textOrRange;\n    }\n    if (range) {\n        var backupRange = editor.getSelectionRange();\n        // If the range to replace is right before current cursor, it is actually an exact match\n        if ((backupRange === null || backupRange === void 0 ? void 0 : backupRange.collapsed) &&\n            range.endContainer == backupRange.startContainer &&\n            range.endOffset == backupRange.startOffset) {\n            exactMatch = true;\n        }\n        editor.insertNode(node, {\n            position: 5 /* Range */,\n            updateCursor: exactMatch,\n            replaceSelection: true,\n            insertOnNewLine: false,\n            range: range,\n        });\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=replaceWithNode.js.map","/**\n * Clear a cached object by its key from an event object\n * @param event The event object\n * @param key The cache key\n */\nexport default function clearEventDataCache(event, key) {\n    if (event && event.eventDataCache) {\n        if (key && event.eventDataCache.hasOwnProperty(key)) {\n            delete event.eventDataCache[key];\n        }\n        else if (!key) {\n            event.eventDataCache = {};\n        }\n    }\n}\n//# sourceMappingURL=clearEventDataCache.js.map","import { isNodeEmpty, cacheGetEventData, safeInstanceOf, splitBalancedNodeRange, unwrap, } from 'roosterjs-editor-dom';\nvar RemoveCodeWhenEnterOnEmptyLine = {\n    keys: [13 /* ENTER */],\n    shouldHandleEvent: function (event, editor) {\n        var childOfCode = cacheGetCodeChild(event, editor);\n        return childOfCode && isNodeEmpty(childOfCode);\n    },\n    handleEvent: function (event, editor) {\n        event.rawEvent.preventDefault();\n        editor.addUndoSnapshot(function () {\n            splitCode(event, editor);\n        }, undefined /* changeSource */, true /* canUndoByBackspace */);\n    },\n};\nvar RemoveCodeWhenBackspaceOnEmptyFirstLine = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        var childOfCode = cacheGetCodeChild(event, editor);\n        return childOfCode && isNodeEmpty(childOfCode) && !childOfCode.previousSibling;\n    },\n    handleEvent: function (event, editor) {\n        event.rawEvent.preventDefault();\n        editor.addUndoSnapshot(function () { return splitCode(event, editor); });\n    },\n};\nfunction cacheGetCodeChild(event, editor) {\n    return cacheGetEventData(event, 'CODE_CHILD', function () {\n        var _a;\n        var codeElement = (_a = editor.getElementAtCursor('code')) !== null && _a !== void 0 ? _a : editor.queryElements('code', 1 /* OnSelection */)[0];\n        if (codeElement) {\n            var pos = editor.getFocusedPosition();\n            var block = pos && editor.getBlockElementAtNode(pos.normalize().node);\n            if (block) {\n                var node = block.getStartNode() == codeElement.parentNode\n                    ? block.getStartNode()\n                    : block.collapseToSingleElement();\n                return isNodeEmpty(node) ? node : null;\n            }\n        }\n        return null;\n    });\n}\nfunction splitCode(event, editor) {\n    var currentContainer = cacheGetCodeChild(event, editor);\n    if (!safeInstanceOf(currentContainer, 'HTMLElement')) {\n        return;\n    }\n    var codeChild = currentContainer.querySelector('code');\n    if (!codeChild) {\n        var codeParent = splitBalancedNodeRange(currentContainer);\n        if (codeParent) {\n            unwrap(codeParent);\n        }\n        if (safeInstanceOf(currentContainer.parentElement, 'HTMLPreElement')) {\n            var preParent = splitBalancedNodeRange(currentContainer);\n            if (preParent) {\n                unwrap(preParent);\n            }\n        }\n    }\n    else {\n        //Content model\n        unwrap(codeChild);\n    }\n    editor.select(currentContainer, 0 /* Begin */);\n}\nexport var CodeFeatures = {\n    removeCodeWhenEnterOnEmptyLine: RemoveCodeWhenEnterOnEmptyLine,\n    removeCodeWhenBackspaceOnEmptyFirstLine: RemoveCodeWhenBackspaceOnEmptyFirstLine,\n};\n//# sourceMappingURL=codeFeatures.js.map","import { Browser, getComputedStyle, Position } from 'roosterjs-editor-dom';\nvar NoCycleCursorMove = {\n    keys: [37 /* LEFT */, 39 /* RIGHT */],\n    allowFunctionKeys: true,\n    shouldHandleEvent: function (event, editor, ctrlOrMeta) {\n        var range = null;\n        var position;\n        if (!ctrlOrMeta ||\n            !(range = editor.getSelectionRange()) ||\n            !range.collapsed ||\n            !(position = Position.getStart(range)) ||\n            !editor.isPositionAtBeginning(position)) {\n            return false;\n        }\n        var rtl = getComputedStyle(position.element, 'direction') == 'rtl';\n        var rawEvent = event.rawEvent;\n        return (!rtl && rawEvent.which == 37 /* LEFT */) || (rtl && rawEvent.which == 39 /* RIGHT */);\n    },\n    handleEvent: function (event) {\n        event.rawEvent.preventDefault();\n    },\n    defaultDisabled: !Browser.isChrome,\n};\n/**\n * @internal\n */\nexport var CursorFeatures = {\n    noCycleCursorMove: NoCycleCursorMove,\n};\n//# sourceMappingURL=cursorFeatures.js.map","import { __read } from \"tslib\";\nimport { ContentTraverser, addDelimiters, cacheGetEventData, createRange, getComputedStyle, getDelimiterFromElement, getEntityFromElement, getEntitySelector, isBlockElement, matchesSelector, Position, } from 'roosterjs-editor-dom';\n/**\n * A content edit feature to trigger EntityOperation event with operation \"Click\" when user\n * clicks on a readonly entity.\n */\nvar ClickOnEntityFeature = {\n    keys: [13 /* ENTER */],\n    shouldHandleEvent: function (event, editor) { return cacheGetReadonlyEntityElement(event, editor); },\n    handleEvent: function (event, editor) {\n        cacheGetReadonlyEntityElement(event, editor, 1 /* Click */);\n    },\n};\n/**\n * A content edit feature to trigger EntityOperation event with operation \"Escape\" when user\n * presses ESC on a readonly entity.\n */\nvar EscapeFromEntityFeature = {\n    keys: [27 /* ESCAPE */],\n    shouldHandleEvent: function (event, editor) { return cacheGetReadonlyEntityElement(event, editor); },\n    handleEvent: function (event, editor) {\n        cacheGetReadonlyEntityElement(event, editor, 3 /* Escape */);\n    },\n};\nfunction cacheGetReadonlyEntityElement(event, editor, operation) {\n    var element = cacheGetEventData(event, 'READONLY_ENTITY_ELEMENT', function () {\n        var node = event.rawEvent.target;\n        var entityElement = node && editor.getElementAtCursor(getEntitySelector(), node);\n        return entityElement && !entityElement.isContentEditable ? entityElement : null;\n    });\n    if (element && operation !== undefined) {\n        var entity = getEntityFromElement(element);\n        if (entity) {\n            editor.triggerPluginEvent(15 /* EntityOperation */, {\n                operation: operation,\n                rawEvent: event.rawEvent,\n                entity: entity,\n            });\n        }\n    }\n    return element;\n}\n/**\n * A content edit feature to split current line into two lines at the cursor when user presses\n * ENTER right before a readonly entity.\n * Browser's default behavior will insert an extra BR tag before the entity which causes an extra\n * empty line. So we override the default behavior here.\n */\nvar EnterBeforeReadonlyEntityFeature = {\n    keys: [13 /* ENTER */],\n    shouldHandleEvent: function (event, editor) {\n        return cacheGetNeighborEntityElement(event, editor, true /*isNext*/, false /*collapseOnly*/);\n    },\n    handleEvent: function (event, editor) {\n        var _a, _b, _c;\n        event.rawEvent.preventDefault();\n        var range = editor.getSelectionRange();\n        if (!range) {\n            return;\n        }\n        var node = Position.getEnd(range).normalize().node;\n        var br = editor.getDocument().createElement('BR');\n        (_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(br, node.nextSibling);\n        var block = editor.getBlockElementAtNode(node);\n        var newContainer;\n        if (block) {\n            newContainer = block.collapseToSingleElement();\n            (_b = br.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(br);\n        }\n        (_c = editor.getSelectionRange()) === null || _c === void 0 ? void 0 : _c.deleteContents();\n        if (newContainer === null || newContainer === void 0 ? void 0 : newContainer.nextSibling) {\n            editor.select(newContainer.nextSibling, 0 /* Begin */);\n        }\n    },\n};\n/**\n * A content edit feature to trigger EntityOperation event with operation \"RemoveFromEnd\" when user\n * press BACKSPACE right after an entity\n */\nvar BackspaceAfterEntityFeature = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        return cacheGetNeighborEntityElement(event, editor, false /*isNext*/, true /*collapseOnly*/);\n    },\n    handleEvent: function (event, editor) {\n        cacheGetNeighborEntityElement(event, editor, false /*isNext*/, true /*collapseOnly*/, 5 /* RemoveFromEnd */);\n    },\n};\n/**\n * A content edit feature to trigger EntityOperation event with operation \"RemoveFromStart\" when user\n * press DELETE right after an entity\n */\nvar DeleteBeforeEntityFeature = {\n    keys: [46 /* DELETE */],\n    shouldHandleEvent: function (event, editor) {\n        return cacheGetNeighborEntityElement(event, editor, true /*isNext*/, true /*collapseOnly*/);\n    },\n    handleEvent: function (event, editor) {\n        cacheGetNeighborEntityElement(event, editor, true /*isNext*/, true /*collapseOnly*/, 4 /* RemoveFromStart */);\n    },\n};\nfunction cacheGetNeighborEntityElement(event, editor, isNext, collapseOnly, operation) {\n    var element = cacheGetEventData(event, 'NEIGHBOR_ENTITY_ELEMENT_' + isNext + '_' + collapseOnly, function () {\n        var _a;\n        var range = editor.getSelectionRange();\n        if (!range || (collapseOnly && !range.collapsed)) {\n            return null;\n        }\n        var regions = editor.getSelectedRegions();\n        var regionRoot = (_a = regions[0]) === null || _a === void 0 ? void 0 : _a.rootNode;\n        range.commonAncestorContainer.normalize();\n        var pos = Position.getEnd(range).normalize();\n        var isAtBeginOrEnd = pos.offset == 0 || pos.isAtEnd;\n        var entityNode = null;\n        if (isAtBeginOrEnd && regionRoot) {\n            var traverser = ContentTraverser.createBodyTraverser(regionRoot, pos.node);\n            var sibling = isNext\n                ? pos.offset == 0\n                    ? traverser.currentInlineElement\n                    : traverser.getNextInlineElement()\n                : pos.isAtEnd\n                    ? traverser.currentInlineElement\n                    : traverser.getPreviousInlineElement();\n            var node = sibling && sibling.getContainerNode();\n            if (!collapseOnly) {\n                var block = editor.getBlockElementAtNode(pos.node);\n                if (!block || (node && !block.contains(node))) {\n                    node = null;\n                }\n            }\n            entityNode = node && editor.getElementAtCursor(getEntitySelector(), node);\n        }\n        return entityNode;\n    });\n    if (element && operation !== undefined) {\n        var entity = getEntityFromElement(element);\n        if (entity) {\n            triggerOperation(entity, editor, operation, event);\n        }\n    }\n    return element;\n}\n/**\n * Content edit feature to move the cursor from Delimiters around Entities when using Right or Left Arrow Keys\n */\nvar MoveBetweenDelimitersFeature = {\n    keys: [39 /* RIGHT */, 37 /* LEFT */],\n    allowFunctionKeys: true,\n    shouldHandleEvent: function (event, editor) {\n        if (event.rawEvent.altKey) {\n            return false;\n        }\n        var element = editor.getElementAtCursor();\n        if (!element) {\n            return false;\n        }\n        var isRTL = getComputedStyle(element, 'direction') === 'rtl';\n        var shouldCheckBefore = isRTL == (event.rawEvent.which === 37 /* LEFT */);\n        return getIsDelimiterAtCursor(event, editor, shouldCheckBefore);\n    },\n    handleEvent: function (event, editor) {\n        var checkBefore = cacheGetCheckBefore(event);\n        var delimiter = cacheDelimiter(event, checkBefore);\n        if (!delimiter) {\n            return;\n        }\n        var _a = getRelatedElements(delimiter, checkBefore, editor), delimiterPair = _a.delimiterPair, entity = _a.entity;\n        if (delimiterPair && entity && matchesSelector(entity, getEntitySelector())) {\n            event.rawEvent.preventDefault();\n            editor.runAsync(function () {\n                var positionType = checkBefore\n                    ? event.rawEvent.shiftKey\n                        ? -3 /* After */\n                        : -1 /* End */\n                    : -2 /* Before */;\n                var position = new Position(delimiterPair, positionType);\n                if (event.rawEvent.shiftKey) {\n                    var selection = delimiterPair.ownerDocument.getSelection();\n                    selection === null || selection === void 0 ? void 0 : selection.extend(position.node, position.offset);\n                }\n                else {\n                    editor.select(position);\n                }\n            });\n        }\n    },\n};\n/**\n * Content edit Feature to trigger a Delete Entity Operation when one of the Delimiter is about to be removed with DELETE or Backspace\n */\nvar RemoveEntityBetweenDelimitersFeature = {\n    keys: [8 /* BACKSPACE */, 46 /* DELETE */],\n    shouldHandleEvent: function (event, editor) {\n        var range = editor.getSelectionRange();\n        if (!(range === null || range === void 0 ? void 0 : range.collapsed)) {\n            return false;\n        }\n        var checkBefore = event.rawEvent.which === 46 /* DELETE */;\n        var isDelimiter = getIsDelimiterAtCursor(event, editor, checkBefore);\n        if (isDelimiter) {\n            var delimiter = cacheDelimiter(event, checkBefore);\n            var entityElement = checkBefore\n                ? delimiter === null || delimiter === void 0 ? void 0 : delimiter.nextElementSibling\n                : delimiter === null || delimiter === void 0 ? void 0 : delimiter.previousElementSibling;\n            return !!cacheEntityBetweenDelimiter(event, editor, checkBefore, entityElement);\n        }\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        var checkBefore = event.rawEvent.which === 46 /* DELETE */;\n        cacheEntityBetweenDelimiter(event, editor, checkBefore, null, checkBefore ? 4 /* RemoveFromStart */ : 5 /* RemoveFromEnd */);\n    },\n};\nfunction getIsDelimiterAtCursor(event, editor, checkBefore) {\n    var _a;\n    var position = (_a = editor.getFocusedPosition()) === null || _a === void 0 ? void 0 : _a.normalize();\n    cacheGetCheckBefore(event, checkBefore);\n    if (!position) {\n        return false;\n    }\n    var focusedElement = position.node.nodeType == 3 /* Text */\n        ? position.node\n        : position.node == position.element\n            ? position.element.childNodes.item(position.offset)\n            : position.element;\n    var data = checkBefore\n        ? {\n            class: \"entityDelimiterBefore\" /* DELIMITER_BEFORE */,\n            pairClass: \"entityDelimiterAfter\" /* DELIMITER_AFTER */,\n            isAtEndOrBeginning: position.isAtEnd,\n        }\n        : {\n            class: \"entityDelimiterAfter\" /* DELIMITER_AFTER */,\n            pairClass: \"entityDelimiterBefore\" /* DELIMITER_BEFORE */,\n            isAtEndOrBeginning: position.offset == 0,\n        };\n    var sibling = getNextSibling(editor, focusedElement, checkBefore);\n    if (data.isAtEndOrBeginning && sibling) {\n        var elAtCursor = editor.getElementAtCursor('.' + data.class, sibling);\n        if (elAtCursor && !!shouldHandle(elAtCursor)) {\n            return true;\n        }\n    }\n    var entityAtCursor = focusedElement && editor.getElementAtCursor('.' + data.class, focusedElement);\n    return !!shouldHandle(entityAtCursor);\n    function shouldHandle(element) {\n        if (!element) {\n            return false;\n        }\n        var delimiterPair = getRelatedElements(element, checkBefore, editor).delimiterPair;\n        return (delimiterPair &&\n            (delimiterPair.className || '').indexOf(data.pairClass) > -1 &&\n            cacheDelimiter(event, checkBefore, element));\n    }\n}\nfunction getNextSibling(editor, element, checkBefore) {\n    var traverser = getBlockTraverser(editor, element);\n    if (!traverser) {\n        return undefined;\n    }\n    var traverseFn = function (t) {\n        return checkBefore ? t.getNextInlineElement() : t.getPreviousInlineElement();\n    };\n    var currentInline = traverser.currentInlineElement;\n    while (currentInline && currentInline.getContainerNode() === element) {\n        currentInline = traverseFn(traverser);\n    }\n    return currentInline === null || currentInline === void 0 ? void 0 : currentInline.getContainerNode();\n}\nfunction getBlockTraverser(editor, element) {\n    var _a;\n    if (!element) {\n        return undefined;\n    }\n    var blockElement = (_a = editor.getBlockElementAtNode(element)) === null || _a === void 0 ? void 0 : _a.getStartNode();\n    if (!blockElement || !isBlockElement(blockElement)) {\n        return undefined;\n    }\n    return ContentTraverser.createBodyTraverser(blockElement, element);\n}\nfunction cacheDelimiter(event, checkBefore, delimiter) {\n    return cacheGetEventData(event, 'delimiter_cache_key_' + checkBefore, function () { return delimiter; });\n}\nfunction cacheEntityBetweenDelimiter(event, editor, checkBefore, entity, operation) {\n    var element = cacheGetEventData(event, 'entity_delimiter_cache_key_' + checkBefore, function () { return entity && editor.getElementAtCursor(getEntitySelector(), entity); });\n    if (element && operation !== undefined) {\n        var entity_1 = getEntityFromElement(element);\n        if (entity_1) {\n            triggerOperation(entity_1, editor, operation, event);\n        }\n    }\n    return element;\n}\nfunction triggerOperation(entity, editor, operation, event) {\n    var _a = entity.wrapper, nextElementSibling = _a.nextElementSibling, previousElementSibling = _a.previousElementSibling;\n    editor.triggerPluginEvent(15 /* EntityOperation */, {\n        operation: operation,\n        rawEvent: event.rawEvent,\n        entity: entity,\n    });\n    if (entity.isReadonly && !isBlockElement(entity.wrapper)) {\n        if (event.rawEvent.defaultPrevented) {\n            editor.runAsync(function () {\n                if (!editor.contains(entity.wrapper)) {\n                    removeDelimiters(nextElementSibling, previousElementSibling);\n                }\n                else {\n                    var _a = __read(addDelimiters(entity.wrapper), 1), delimiterAfter = _a[0];\n                    if (delimiterAfter) {\n                        editor.select(delimiterAfter, -3 /* After */);\n                    }\n                }\n            });\n        }\n        else if (getDelimiterFromElement(nextElementSibling) &&\n            getDelimiterFromElement(previousElementSibling)) {\n            editor.select(createRange(previousElementSibling, nextElementSibling));\n        }\n    }\n}\nfunction removeDelimiters(nextElementSibling, previousElementSibling) {\n    [nextElementSibling, previousElementSibling].forEach(function (sibling) {\n        var _a;\n        if (getDelimiterFromElement(sibling)) {\n            (_a = sibling === null || sibling === void 0 ? void 0 : sibling.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(sibling);\n        }\n    });\n}\nfunction cacheGetCheckBefore(event, checkBefore) {\n    return !!cacheGetEventData(event, 'Check_Before', function () { return checkBefore; });\n}\nfunction getRelatedElements(delimiter, checkBefore, editor) {\n    var entity = null;\n    var delimiterPair = null;\n    var traverser = getBlockTraverser(editor, delimiter);\n    if (!traverser) {\n        return { delimiterPair: delimiterPair, entity: entity };\n    }\n    var selector = \".\" + (checkBefore ? \"entityDelimiterAfter\" /* DELIMITER_AFTER */ : \"entityDelimiterBefore\" /* DELIMITER_BEFORE */);\n    var traverseFn = function (t) {\n        return checkBefore ? t.getNextInlineElement() : t.getPreviousInlineElement();\n    };\n    var getElementFromInline = function (element, selector) {\n        var _a;\n        var node = element === null || element === void 0 ? void 0 : element.getContainerNode();\n        return (_a = (node && editor.getElementAtCursor(selector, node))) !== null && _a !== void 0 ? _a : null;\n    };\n    var entitySelector = getEntitySelector();\n    var current = traverser.currentInlineElement;\n    while (current && (!entity || !delimiterPair)) {\n        entity = entity || getElementFromInline(current, entitySelector);\n        delimiterPair = delimiterPair || getElementFromInline(current, selector);\n        // If we found the entity but the next inline after the entity is not a delimiter,\n        // it means that the delimiter pair got removed or is invalid, return null instead.\n        if (entity && !delimiterPair && !getElementFromInline(current, entitySelector)) {\n            delimiterPair = null;\n            break;\n        }\n        current = traverseFn(traverser);\n    }\n    return { entity: entity, delimiterPair: delimiterPair };\n}\n/**\n * @internal\n */\nexport var EntityFeatures = {\n    clickOnEntity: ClickOnEntityFeature,\n    escapeFromEntity: EscapeFromEntityFeature,\n    enterBeforeReadonlyEntity: EnterBeforeReadonlyEntityFeature,\n    backspaceAfterEntity: BackspaceAfterEntityFeature,\n    deleteBeforeEntity: DeleteBeforeEntityFeature,\n    moveBetweenDelimitersFeature: MoveBetweenDelimitersFeature,\n    removeEntityBetweenDelimiters: RemoveEntityBetweenDelimitersFeature,\n};\n//# sourceMappingURL=entityFeatures.js.map","var bulletListType = {\n    '*': 1 /* Disc */,\n    '-': 2 /* Dash */,\n    '--': 3 /* Square */,\n    '->': 5 /* LongArrow */,\n    '-->': 8 /* DoubleLongArrow */,\n    '=>': 6 /* UnfilledArrow */,\n    '>': 4 /* ShortArrow */,\n    '': 7 /* Hyphen */,\n};\nvar identifyBulletListType = function (bullet) {\n    return bulletListType[bullet] || null;\n};\n/**\n * @internal\n * @param textBeforeCursor The trigger character\n * @returns The style of a bullet list triggered by a string\n */\nexport default function getAutoBulletListStyle(textBeforeCursor) {\n    var trigger = textBeforeCursor.trim();\n    var bulletType = identifyBulletListType(trigger);\n    return bulletType;\n}\n//# sourceMappingURL=getAutoBulletListStyle.js.map","var _a, _b, _c, _d, _e, _f;\nimport convertAlphaToDecimals from './convertAlphaToDecimals';\nvar NumberingTypes;\n(function (NumberingTypes) {\n    NumberingTypes[NumberingTypes[\"Decimal\"] = 1] = \"Decimal\";\n    NumberingTypes[NumberingTypes[\"LowerAlpha\"] = 2] = \"LowerAlpha\";\n    NumberingTypes[NumberingTypes[\"UpperAlpha\"] = 3] = \"UpperAlpha\";\n    NumberingTypes[NumberingTypes[\"LowerRoman\"] = 4] = \"LowerRoman\";\n    NumberingTypes[NumberingTypes[\"UpperRoman\"] = 5] = \"UpperRoman\";\n})(NumberingTypes || (NumberingTypes = {}));\nvar Character;\n(function (Character) {\n    Character[Character[\"Dot\"] = 1] = \"Dot\";\n    Character[Character[\"Dash\"] = 2] = \"Dash\";\n    Character[Character[\"Parenthesis\"] = 3] = \"Parenthesis\";\n    Character[Character[\"DoubleParenthesis\"] = 4] = \"DoubleParenthesis\";\n})(Character || (Character = {}));\nvar characters = {\n    '.': 1 /* Dot */,\n    '-': 2 /* Dash */,\n    ')': 3 /* Parenthesis */,\n};\nvar lowerRomanTypes = [\n    13 /* LowerRoman */,\n    16 /* LowerRomanDash */,\n    15 /* LowerRomanDoubleParenthesis */,\n    14 /* LowerRomanParenthesis */,\n];\nvar upperRomanTypes = [\n    17 /* UpperRoman */,\n    20 /* UpperRomanDash */,\n    19 /* UpperRomanDoubleParenthesis */,\n    18 /* UpperRomanParenthesis */,\n];\nvar numberingTriggers = ['1', 'a', 'A', 'I', 'i'];\nvar lowerRomanNumbers = ['i', 'v', 'x', 'l', 'c', 'd', 'm'];\nvar upperRomanNumbers = ['I', 'V', 'X', 'L', 'C', 'D', 'M'];\nvar identifyNumberingType = function (text, previousListStyle) {\n    if (!isNaN(parseInt(text))) {\n        return 1 /* Decimal */;\n    }\n    else if (/[a-z]+/g.test(text)) {\n        if ((previousListStyle != undefined &&\n            lowerRomanTypes.indexOf(previousListStyle) > -1 &&\n            lowerRomanNumbers.indexOf(text[0]) > -1) ||\n            (!previousListStyle && text === 'i')) {\n            return 4 /* LowerRoman */;\n        }\n        else if (previousListStyle || (!previousListStyle && text === 'a')) {\n            return 2 /* LowerAlpha */;\n        }\n    }\n    else if (/[A-Z]+/g.test(text)) {\n        if ((previousListStyle != undefined &&\n            upperRomanTypes.indexOf(previousListStyle) > -1 &&\n            upperRomanNumbers.indexOf(text[0]) > -1) ||\n            (!previousListStyle && text === 'I')) {\n            return 5 /* UpperRoman */;\n        }\n        else if (previousListStyle || (!previousListStyle && text === 'A')) {\n            return 3 /* UpperAlpha */;\n        }\n    }\n};\nvar numberingListTypes = (_a = {},\n    _a[1 /* Decimal */] = function (char) { return DecimalsTypes[char] || null; },\n    _a[2 /* LowerAlpha */] = function (char) { return LowerAlphaTypes[char] || null; },\n    _a[3 /* UpperAlpha */] = function (char) { return UpperAlphaTypes[char] || null; },\n    _a[4 /* LowerRoman */] = function (char) { return LowerRomanTypes[char] || null; },\n    _a[5 /* UpperRoman */] = function (char) { return UpperRomanTypes[char] || null; },\n    _a);\nvar UpperRomanTypes = (_b = {},\n    _b[1 /* Dot */] = 17 /* UpperRoman */,\n    _b[2 /* Dash */] = 20 /* UpperRomanDash */,\n    _b[3 /* Parenthesis */] = 18 /* UpperRomanParenthesis */,\n    _b[4 /* DoubleParenthesis */] = 19 /* UpperRomanDoubleParenthesis */,\n    _b);\nvar LowerRomanTypes = (_c = {},\n    _c[1 /* Dot */] = 13 /* LowerRoman */,\n    _c[2 /* Dash */] = 16 /* LowerRomanDash */,\n    _c[3 /* Parenthesis */] = 14 /* LowerRomanParenthesis */,\n    _c[4 /* DoubleParenthesis */] = 15 /* LowerRomanDoubleParenthesis */,\n    _c);\nvar UpperAlphaTypes = (_d = {},\n    _d[1 /* Dot */] = 9 /* UpperAlpha */,\n    _d[2 /* Dash */] = 12 /* UpperAlphaDash */,\n    _d[3 /* Parenthesis */] = 10 /* UpperAlphaParenthesis */,\n    _d[4 /* DoubleParenthesis */] = 11 /* UpperAlphaDoubleParenthesis */,\n    _d);\nvar LowerAlphaTypes = (_e = {},\n    _e[1 /* Dot */] = 5 /* LowerAlpha */,\n    _e[2 /* Dash */] = 8 /* LowerAlphaDash */,\n    _e[3 /* Parenthesis */] = 6 /* LowerAlphaParenthesis */,\n    _e[4 /* DoubleParenthesis */] = 7 /* LowerAlphaDoubleParenthesis */,\n    _e);\nvar DecimalsTypes = (_f = {},\n    _f[1 /* Dot */] = 1 /* Decimal */,\n    _f[2 /* Dash */] = 2 /* DecimalDash */,\n    _f[3 /* Parenthesis */] = 3 /* DecimalParenthesis */,\n    _f[4 /* DoubleParenthesis */] = 4 /* DecimalDoubleParenthesis */,\n    _f);\nvar identifyNumberingListType = function (numbering, isDoubleParenthesis, previousListStyle) {\n    var separatorCharacter = isDoubleParenthesis\n        ? 4 /* DoubleParenthesis */\n        : characters[numbering[numbering.length - 1]];\n    // if separator is not valid, no need to check if the number is valid.\n    if (separatorCharacter) {\n        var number = isDoubleParenthesis ? numbering.slice(1, -1) : numbering.slice(0, -1);\n        var numberingType = identifyNumberingType(number, previousListStyle);\n        return numberingType ? numberingListTypes[numberingType](separatorCharacter) : null;\n    }\n    return null;\n};\n/**\n * @internal\n * @param textBeforeCursor The trigger character\n * @param previousListChain @optional This parameters is used to keep the list chain, if the is not a new list\n * @param previousListStyle @optional The list style of the previous list\n * @returns The style of a numbering list triggered by a string\n */\nexport default function getAutoNumberingListStyle(textBeforeCursor, previousListChain, previousListStyle) {\n    var _a;\n    var trigger = textBeforeCursor.trim();\n    var isDoubleParenthesis = trigger[0] === '(' && trigger[trigger.length - 1] === ')';\n    //Only the staring items ['1', 'a', 'A', 'I', 'i'] must trigger a new list. All the other triggers is used to keep the list chain.\n    //The index is always the characters before the last character\n    var listIndex = isDoubleParenthesis ? trigger.slice(1, -1) : trigger.slice(0, -1);\n    var indexNumber = parseInt(listIndex);\n    var index = !isNaN(indexNumber) ? indexNumber : convertAlphaToDecimals(listIndex);\n    if (!index || index < 1) {\n        return null;\n    }\n    if (previousListChain && index > 1) {\n        if ((previousListChain.length < 1 && numberingTriggers.indexOf(listIndex) < 0) ||\n            ((previousListChain === null || previousListChain === void 0 ? void 0 : previousListChain.length) > 0 &&\n                !((_a = previousListChain[previousListChain.length - 1]) === null || _a === void 0 ? void 0 : _a.canAppendAtCursor(index)))) {\n            return null;\n        }\n    }\n    var numberingType = isValidNumbering(listIndex)\n        ? identifyNumberingListType(trigger, isDoubleParenthesis, previousListStyle)\n        : null;\n    return numberingType;\n}\n/**\n * Check if index has only numbers or only letters to avoid sequence of character such 1:1. trigger a list.\n * @param index\n * @returns\n */\nfunction isValidNumbering(index) {\n    return Number(index) || /^[A-Za-z\\s]*$/.test(index);\n}\n//# sourceMappingURL=getAutoNumberingListStyle.js.map","/**\n * @internal\n * Convert english alphabet numbers into decimal numbers\n * @param letter The letter that needs to be converted\n * @returns\n */\nexport default function convertAlphaToDecimals(letter) {\n    var alpha = letter.toLocaleLowerCase();\n    if (alpha) {\n        var size = alpha.length - 1;\n        var number = 26 * size + alpha.charCodeAt(size) - 96;\n        return number;\n    }\n    return null;\n}\n//# sourceMappingURL=convertAlphaToDecimals.js.map","import getAnnounceDataForList from '../../../pluginUtils/announceData/getAnnounceDataForList';\nimport getAutoBulletListStyle from '../utils/getAutoBulletListStyle';\nimport getAutoNumberingListStyle from '../utils/getAutoNumberingListStyle';\nimport { Browser, cacheGetEventData, createNumberDefinition, createObjectDefinition, createVListFromRegion, findClosestElementAncestor, getComputedStyle, getMetadata, getTagOfNode, isBlockElement, isNodeEmpty, isPositionAtBeginningOf, Position, safeInstanceOf, VList, VListChain, } from 'roosterjs-editor-dom';\nimport { blockFormat, commitListChains, setIndentation, toggleBullet, toggleNumbering, toggleListType, } from 'roosterjs-editor-api';\nvar PREVIOUS_BLOCK_CACHE_KEY = 'previousBlock';\nvar NEXT_BLOCK_CACHE_KEY = 'nextBlock';\nvar ListStyleDefinitionMetadata = createObjectDefinition({\n    orderedStyleType: createNumberDefinition(true /** isOptional */, undefined /** value **/, 1 /* Min */, 20 /* Max */),\n    unorderedStyleType: createNumberDefinition(true /** isOptional */, undefined /** value **/, 1 /* Min */, 9 /* Max */),\n}, true /** isOptional */, true /** allowNull */);\nvar shouldHandleIndentationEvent = function (indenting) { return function (event, editor) {\n    var _a = event.rawEvent, keyCode = _a.keyCode, altKey = _a.altKey, shiftKey = _a.shiftKey, ctrlKey = _a.ctrlKey, metaKey = _a.metaKey;\n    return (!ctrlKey &&\n        !metaKey &&\n        (keyCode === 9 /* TAB */\n            ? !altKey && shiftKey === !indenting\n            : shiftKey && altKey && keyCode === (indenting ? 39 /* RIGHT */ : 37 /* LEFT */)) &&\n        cacheGetListElement(event, editor));\n}; };\nvar handleIndentationEvent = function (indenting) { return function (event, editor) {\n    var currentElement = null;\n    var isRTL = event.rawEvent.keyCode !== 9 /* TAB */ &&\n        (currentElement = editor.getElementAtCursor()) &&\n        getComputedStyle(currentElement, 'direction') == 'rtl';\n    editor.addUndoSnapshot(function () {\n        setIndentation(editor, isRTL == indenting ? 1 /* Decrease */ : 0 /* Increase */);\n    }, \"Format\" /* Format */, false /* canUndoByBackspace */, {\n        getAnnounceData: function () {\n            return getAnnounceDataForList(editor.getElementAtCursor('OL,UL'), editor.getElementAtCursor('LI'));\n        },\n    });\n    event.rawEvent.preventDefault();\n}; };\n/**\n * IndentWhenTab edit feature, provides the ability to indent current list when user press TAB\n */\nvar IndentWhenTab = {\n    keys: [9 /* TAB */],\n    shouldHandleEvent: shouldHandleIndentationEvent(true),\n    handleEvent: handleIndentationEvent(true),\n};\n/**\n * OutdentWhenShiftTab edit feature, provides the ability to outdent current list when user press Shift+TAB\n */\nvar OutdentWhenShiftTab = {\n    keys: [9 /* TAB */],\n    shouldHandleEvent: shouldHandleIndentationEvent(false),\n    handleEvent: handleIndentationEvent(false),\n    allowFunctionKeys: true,\n};\n/**\n * indentWhenAltShiftRight edit feature, provides the ability to indent or outdent current list when user press Alt+shift+Right\n */\nvar IndentWhenAltShiftRight = {\n    keys: [39 /* RIGHT */],\n    shouldHandleEvent: shouldHandleIndentationEvent(true),\n    handleEvent: handleIndentationEvent(true),\n    allowFunctionKeys: true,\n    defaultDisabled: Browser.isMac,\n};\n/**\n * outdentWhenAltShiftLeft edit feature, provides the ability to indent or outdent current list when user press Alt+shift+Left\n */\nvar OutdentWhenAltShiftLeft = {\n    keys: [37 /* LEFT */],\n    shouldHandleEvent: shouldHandleIndentationEvent(false),\n    handleEvent: handleIndentationEvent(false),\n    allowFunctionKeys: true,\n    defaultDisabled: Browser.isMac,\n};\n/**\n * MergeInNewLine edit feature, provides the ability to merge current line into a new line when user press\n * BACKSPACE at beginning of a list item\n */\nvar MergeInNewLine = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        var li = editor.getElementAtCursor('LI', undefined /*startFrom*/, event);\n        var range = editor.getSelectionRange();\n        return li && (range === null || range === void 0 ? void 0 : range.collapsed) && isPositionAtBeginningOf(Position.getStart(range), li);\n    },\n    handleEvent: function (event, editor) {\n        var li = editor.getElementAtCursor('LI', undefined /*startFrom*/, event);\n        if (li === null || li === void 0 ? void 0 : li.previousSibling) {\n            blockFormat(editor, function (region, start, end) {\n                var vList = createVListFromRegion(region, false /*includeSiblingList*/, li !== null && li !== void 0 ? li : undefined);\n                if (vList && start && end) {\n                    vList.setIndentation(start, end, 1 /* Decrease */, true /*softOutdent*/);\n                    vList.writeBack(editor.isFeatureEnabled(\"ReuseAllAncestorListElements\" /* ReuseAllAncestorListElements */), editor.isFeatureEnabled(\"DisableListChain\" /* DisableListChain */));\n                    event.rawEvent.preventDefault();\n                }\n            });\n        }\n        else {\n            toggleListAndPreventDefault(event, editor);\n        }\n    },\n    defaultDisabled: true,\n};\n/**\n * OutdentWhenBackOn1stEmptyLine edit feature, provides the ability to outdent current item if user press\n * BACKSPACE at the first and empty line of a list\n */\nvar OutdentWhenBackOn1stEmptyLine = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        var li = editor.getElementAtCursor('LI', undefined /*startFrom*/, event);\n        return (li &&\n            isNodeEmpty(li) &&\n            !li.previousSibling &&\n            !li.getElementsByTagName('blockquote').length);\n    },\n    handleEvent: toggleListAndPreventDefault,\n};\n/**\n * MaintainListChainWhenDelete edit feature, provides the ability to indent the list if user press\n * DELETE before the first item of a list\n */\nvar MaintainListChainWhenDelete = {\n    keys: [46 /* DELETE */],\n    shouldHandleEvent: function (event, editor) {\n        var li = editor.getElementAtCursor('LI', undefined /*startFrom*/, event);\n        var range = editor.getSelectionRange();\n        if (li || !range) {\n            return false;\n        }\n        var isAtEnd = Position.getEnd(range).isAtEnd;\n        var nextSibling = isAtEnd ? getCacheNextSibling(event, editor) : undefined;\n        var isAtEndAndBeforeLI = editor.getElementAtCursor('LI', nextSibling, event);\n        return isAtEndAndBeforeLI;\n    },\n    handleEvent: function (event, editor) {\n        var chains = getListChains(editor);\n        editor.runAsync(function (editor) { return commitListChains(editor, chains); });\n    },\n};\n/**\n * OutdentWhenEnterOnEmptyLine edit feature, provides the ability to outdent current item if user press\n * ENTER at the beginning of an empty line of a list\n */\nvar OutdentWhenEnterOnEmptyLine = {\n    keys: [13 /* ENTER */],\n    shouldHandleEvent: function (event, editor) {\n        var li = editor.getElementAtCursor('LI', undefined /*startFrom*/, event);\n        return !event.rawEvent.shiftKey && li && isNodeEmpty(li);\n    },\n    handleEvent: function (event, editor) {\n        editor.addUndoSnapshot(function () { return toggleListAndPreventDefault(event, editor, false /* includeSiblingLists */); }, undefined /*changeSource*/, true /*canUndoByBackspace*/);\n    },\n    defaultDisabled: !Browser.isIE && !Browser.isChrome,\n};\n/**\n * @deprecated Use AutoBulletList and AutoNumberingList instead\n */\nvar AutoBullet = {\n    keys: [32 /* SPACE */],\n    shouldHandleEvent: function (event, editor) {\n        return false;\n    },\n    handleEvent: function (event, editor) { },\n    defaultDisabled: true,\n};\n/**\n * AutoBulletList edit feature, provides the ability to automatically convert current line into a bullet list.\n */\nvar AutoBulletList = {\n    keys: [32 /* SPACE */],\n    shouldHandleEvent: function (event, editor) {\n        if (!cacheGetListElement(event, editor)) {\n            return shouldTriggerList(event, editor, getAutoBulletListStyle, 2 /* Unordered */);\n        }\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        editor.insertContent('&nbsp;');\n        event.rawEvent.preventDefault();\n        editor.addUndoSnapshot(function () {\n            var _a;\n            var searcher = editor.getContentSearcherOfCursor();\n            if (!searcher) {\n                return;\n            }\n            var textBeforeCursor = searcher.getSubStringBefore(5);\n            var textRange = searcher.getRangeFromText(textBeforeCursor, true /*exactMatch*/);\n            var listStyle = getAutoBulletListStyle(textBeforeCursor);\n            if (textRange) {\n                prepareAutoBullet(editor, textRange);\n                toggleBullet(editor, listStyle !== null && listStyle !== void 0 ? listStyle : undefined, 'autoToggleList' /** apiNameOverride */);\n            }\n            (_a = searcher.getRangeFromText(textBeforeCursor, true /*exactMatch*/)) === null || _a === void 0 ? void 0 : _a.deleteContents();\n        }, undefined /*changeSource*/, true /*canUndoByBackspace*/);\n    },\n};\n/**\n * AutoNumberingList edit feature, provides the ability to automatically convert current line into a numbering list.\n */\nvar AutoNumberingList = {\n    keys: [32 /* SPACE */],\n    shouldHandleEvent: function (event, editor) {\n        if (!cacheGetListElement(event, editor)) {\n            return shouldTriggerList(event, editor, getAutoNumberingListStyle, 1 /* Ordered */);\n        }\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        editor.insertContent('&nbsp;');\n        event.rawEvent.preventDefault();\n        editor.addUndoSnapshot(function () {\n            var _a, _b;\n            var searcher = editor.getContentSearcherOfCursor();\n            if (!searcher) {\n                return;\n            }\n            var textBeforeCursor = searcher.getSubStringBefore(5);\n            var textRange = searcher.getRangeFromText(textBeforeCursor, true /*exactMatch*/);\n            if (textRange) {\n                var number = isFirstItemOfAList(textBeforeCursor)\n                    ? 1\n                    : parseInt(textBeforeCursor);\n                var isLi = getPreviousListItem(editor, textRange);\n                var listStyle = (_a = getAutoNumberingListStyle(textBeforeCursor)) !== null && _a !== void 0 ? _a : undefined;\n                prepareAutoBullet(editor, textRange);\n                toggleNumbering(editor, isLi && number !== 1 ? undefined : number /** startNumber */, listStyle, 'autoToggleList' /** apiNameOverride */);\n            }\n            (_b = searcher.getRangeFromText(textBeforeCursor, true /*exactMatch*/)) === null || _b === void 0 ? void 0 : _b.deleteContents();\n        }, undefined /*changeSource*/, true /*canUndoByBackspace*/);\n    },\n};\nvar getPreviousListItem = function (editor, textRange) {\n    var _a;\n    var blockElement = editor\n        .getBodyTraverser(textRange === null || textRange === void 0 ? void 0 : textRange.startContainer)\n        .getPreviousBlockElement();\n    var previousNode = (_a = blockElement === null || blockElement === void 0 ? void 0 : blockElement.getEndNode()) !== null && _a !== void 0 ? _a : null;\n    return getTagOfNode(previousNode) === 'LI' ? previousNode : undefined;\n};\nvar getPreviousListType = function (editor, textRange, listType) {\n    var type = listType === 1 /* Ordered */ ? 'orderedStyleType' : 'unorderedStyleType';\n    var listItem = getPreviousListItem(editor, textRange);\n    var list = listItem\n        ? findClosestElementAncestor(listItem, undefined /** root*/, listType === 1 /* Ordered */ ? 'ol' : 'ul')\n        : null;\n    var metadata = list ? getMetadata(list, ListStyleDefinitionMetadata) : null;\n    return metadata ? metadata[type] : null;\n};\nvar isFirstItemOfAList = function (item) {\n    var number = parseInt(item);\n    if (number && number === 1) {\n        return 1;\n    }\n    else {\n        var letter = item.replace(/\\(|\\)|\\-|\\./g, '').trim();\n        return letter.length === 1 && ['i', 'a', 'I', 'A'].indexOf(letter) > -1 ? 1 : undefined;\n    }\n};\n/**\n * Maintain the list numbers in list chain\n * e.g. we have two lists:\n * 1, 2, 3 and 4, 5, 6\n * Now we delete list item 2, so the first one becomes \"1, 2\".\n * This edit feature can maintain the list number of the second list to become \"3, 4, 5\"\n */\nvar MaintainListChain = {\n    keys: [13 /* ENTER */, 9 /* TAB */, 46 /* DELETE */, 8 /* BACKSPACE */, 258 /* RANGE */],\n    shouldHandleEvent: function (event, editor) {\n        return editor\n            .queryElements('li', 1 /* OnSelection */)\n            .filter(function (li) { return !li.getElementsByTagName('blockquote').length; }).length > 0;\n    },\n    handleEvent: function (event, editor) {\n        var chains = getListChains(editor);\n        editor.runAsync(function (editor) { return commitListChains(editor, chains); });\n    },\n};\nfunction getListChains(editor) {\n    return VListChain.createListChains(editor.getSelectedRegions());\n}\nfunction getCacheNextSibling(event, editor) {\n    var element = cacheGetEventData(event, 'nextSibling', function () {\n        var _a;\n        var range = editor.getSelectionRange();\n        var pos = range && Position.getEnd(range).normalize();\n        var traverser = pos && editor.getBodyTraverser(pos.node);\n        return (_a = traverser === null || traverser === void 0 ? void 0 : traverser.getNextBlockElement()) === null || _a === void 0 ? void 0 : _a.getStartNode();\n    });\n    return element;\n}\nfunction prepareAutoBullet(editor, range) {\n    var _a;\n    var block = editor.getBlockElementAtNode(range.startContainer);\n    var endNode = block === null || block === void 0 ? void 0 : block.getEndNode();\n    if (endNode && getTagOfNode(endNode) != 'BR') {\n        var br = editor.getDocument().createElement('BR');\n        if (isBlockElement(endNode)) {\n            endNode.appendChild(br);\n        }\n        else {\n            (_a = endNode.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(br, endNode.nextSibling);\n        }\n        editor.select(range.startContainer, range.startOffset);\n    }\n}\nfunction toggleListAndPreventDefault(event, editor, includeSiblingLists) {\n    if (includeSiblingLists === void 0) { includeSiblingLists = true; }\n    var listInfo = cacheGetListElement(event, editor);\n    if (listInfo) {\n        var listElement = listInfo[0];\n        var tag = getTagOfNode(listElement);\n        if (tag == 'UL' || tag == 'OL') {\n            toggleListType(editor, tag == 'UL' ? 2 /* Unordered */ : 1 /* Ordered */, undefined /* startNumber */, includeSiblingLists);\n        }\n        editor.focus();\n        event.rawEvent.preventDefault();\n    }\n}\nfunction cacheGetListElement(event, editor) {\n    var li = editor.getElementAtCursor('LI,TABLE', undefined /*startFrom*/, event);\n    var listElement = li && getTagOfNode(li) == 'LI' && editor.getElementAtCursor('UL,OL', li);\n    return listElement ? [listElement, li] : null;\n}\nfunction shouldTriggerList(event, editor, getListStyle, listType) {\n    var searcher = editor.getContentSearcherOfCursor(event);\n    if (!searcher) {\n        return false;\n    }\n    var textBeforeCursor = searcher.getSubStringBefore(4);\n    var traverser = editor.getBlockTraverser();\n    var text = traverser && traverser.currentBlockElement\n        ? traverser.currentBlockElement.getTextContent().slice(0, textBeforeCursor.length)\n        : null;\n    var isATheBeginning = text && text === textBeforeCursor;\n    var listChains = getListChains(editor);\n    var textRange = searcher.getRangeFromText(textBeforeCursor, true /*exactMatch*/);\n    var previousListType = textRange && getPreviousListType(editor, textRange, listType);\n    var isFirstItem = isFirstItemOfAList(textBeforeCursor);\n    var listStyle = getListStyle(textBeforeCursor, listChains, previousListType !== null && previousListType !== void 0 ? previousListType : undefined);\n    var shouldTriggerNewListStyle = isFirstItem ||\n        !previousListType ||\n        previousListType === listStyle ||\n        listType === 2 /* Unordered */;\n    return (isATheBeginning &&\n        !searcher.getNearestNonTextInlineElement() &&\n        listStyle &&\n        shouldTriggerNewListStyle);\n}\n/**\n * MergeListOnBackspaceAfterList edit feature, provides the ability to merge list on backspace on block after a list.\n */\nvar MergeListOnBackspaceAfterList = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        var _a, _b;\n        var target = editor.getElementAtCursor();\n        if (target) {\n            var cursorBlock = (_a = editor.getBlockElementAtNode(target)) === null || _a === void 0 ? void 0 : _a.getStartNode();\n            var previousBlock_1 = (_b = cursorBlock === null || cursorBlock === void 0 ? void 0 : cursorBlock.previousElementSibling) !== null && _b !== void 0 ? _b : null;\n            if (isList(previousBlock_1)) {\n                var range = editor.getSelectionRange();\n                var searcher = editor.getContentSearcherOfCursor(event);\n                var textBeforeCursor = searcher === null || searcher === void 0 ? void 0 : searcher.getSubStringBefore(4);\n                var nearestInline = searcher === null || searcher === void 0 ? void 0 : searcher.getNearestNonTextInlineElement();\n                if (range && range.collapsed && textBeforeCursor === '' && !nearestInline) {\n                    var tempBlock = cursorBlock === null || cursorBlock === void 0 ? void 0 : cursorBlock.nextElementSibling;\n                    var nextBlock_1 = isList(tempBlock) ? tempBlock : tempBlock === null || tempBlock === void 0 ? void 0 : tempBlock.firstChild;\n                    if (isList(nextBlock_1) &&\n                        getTagOfNode(previousBlock_1) == getTagOfNode(nextBlock_1)) {\n                        var element = cacheGetEventData(event, PREVIOUS_BLOCK_CACHE_KEY, function () { return previousBlock_1; });\n                        var nextElement = cacheGetEventData(event, NEXT_BLOCK_CACHE_KEY, function () { return nextBlock_1; });\n                        return !!element && !!nextElement;\n                    }\n                }\n            }\n        }\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        editor.runAsync(function (editor) {\n            var previousList = cacheGetEventData(event, PREVIOUS_BLOCK_CACHE_KEY, function () { return null; });\n            var targetBlock = cacheGetEventData(event, NEXT_BLOCK_CACHE_KEY, function () { return null; });\n            var rangeBeforeWriteBack = editor.getSelectionRange();\n            if (previousList && targetBlock && rangeBeforeWriteBack) {\n                var fvList = new VList(previousList);\n                fvList.mergeVList(new VList(targetBlock));\n                var span = editor.getDocument().createElement('span');\n                span.id = 'restoreRange';\n                rangeBeforeWriteBack.insertNode(span);\n                fvList.writeBack();\n                span = editor.queryElements('#restoreRange')[0];\n                if (span.parentElement) {\n                    editor.select(new Position(span, -3 /* After */));\n                    span.parentElement.removeChild(span);\n                }\n            }\n        });\n    },\n};\n/**\n * @internal\n */\nexport var ListFeatures = {\n    autoBullet: AutoBullet,\n    indentWhenTab: IndentWhenTab,\n    outdentWhenShiftTab: OutdentWhenShiftTab,\n    outdentWhenBackspaceOnEmptyFirstLine: OutdentWhenBackOn1stEmptyLine,\n    outdentWhenEnterOnEmptyLine: OutdentWhenEnterOnEmptyLine,\n    mergeInNewLineWhenBackspaceOnFirstChar: MergeInNewLine,\n    maintainListChain: MaintainListChain,\n    maintainListChainWhenDelete: MaintainListChainWhenDelete,\n    autoNumberingList: AutoNumberingList,\n    autoBulletList: AutoBulletList,\n    mergeListOnBackspaceAfterList: MergeListOnBackspaceAfterList,\n    outdentWhenAltShiftLeft: OutdentWhenAltShiftLeft,\n    indentWhenAltShiftRight: IndentWhenAltShiftRight,\n};\nfunction isList(element) {\n    return (!!element &&\n        (safeInstanceOf(element, 'HTMLOListElement') || safeInstanceOf(element, 'HTMLUListElement')));\n}\n//# sourceMappingURL=listFeatures.js.map","import { convertDecimalsToAlpha, convertDecimalsToRoman, safeInstanceOf, VList, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Get the announce data for the current List\n * @returns announce data for list or undefined.\n */\nexport default function getAnnounceDataForList(list, li) {\n    if (!safeInstanceOf(li, 'HTMLLIElement')) {\n        return undefined;\n    }\n    if (li && safeInstanceOf(list, 'HTMLOListElement')) {\n        var vList = new VList(list);\n        var listItemIndex = vList.getListItemIndex(li);\n        var stringToAnnounce = listItemIndex == -1 ? '' : listItemIndex.toString();\n        switch (list.style.listStyleType) {\n            case 'lower-alpha':\n            case 'lower-latin':\n            case 'upper-alpha':\n            case 'upper-latin':\n                stringToAnnounce = convertDecimalsToAlpha(listItemIndex - 1);\n                break;\n            case 'lower-roman':\n            case 'upper-roman':\n                stringToAnnounce = convertDecimalsToRoman(listItemIndex);\n                break;\n        }\n        return {\n            defaultStrings: 1 /* AnnounceListItemNumbering */,\n            formatStrings: [stringToAnnounce],\n        };\n    }\n    else if (safeInstanceOf(list, 'HTMLUListElement')) {\n        return {\n            defaultStrings: 2 /* AnnounceListItemBullet */,\n        };\n    }\n    return undefined;\n}\n//# sourceMappingURL=getAnnounceDataForList.js.map","import { cacheGetEventData, createRange, Position, wrap } from 'roosterjs-editor-dom';\nvar ZERO_WIDTH_SPACE = '\\u200B';\nfunction generateBasicMarkdownFeature(key, triggerCharacter, elementTag, useShiftKey) {\n    return {\n        keys: [key],\n        shouldHandleEvent: function (event, editor) {\n            return event.rawEvent.shiftKey === useShiftKey &&\n                !!cacheGetRangeForMarkdownOperation(event, editor, triggerCharacter);\n        },\n        handleEvent: function (event, editor) {\n            // runAsync is here to allow the event to complete so autocomplete will present the trigger character.\n            editor.runAsync(function (editor) {\n                handleMarkdownEvent(event, editor, triggerCharacter, elementTag);\n            });\n        },\n    };\n}\nfunction cacheGetRangeForMarkdownOperation(event, editor, triggerCharacter) {\n    return cacheGetEventData(event, 'MARKDOWN_RANGE', function () {\n        var searcher = editor.getContentSearcherOfCursor(event);\n        var startPosition = null;\n        var endPosition = null;\n        searcher === null || searcher === void 0 ? void 0 : searcher.forEachTextInlineElement(function (textInlineElement) {\n            if (endPosition && startPosition) {\n                return true;\n            }\n            var inlineTextContent = textInlineElement.getTextContent();\n            // special case for immediately preceding character being whitespace\n            if (inlineTextContent[inlineTextContent.length - 1].trim().length == 0) {\n                return false;\n            }\n            //if the text is pasted, it might create a inner element inside the text element,\n            // then is necessary to check the parent block to get whole text\n            var parentBlockText = textInlineElement.getParentBlock().getTextContent();\n            // special case for consecutive trigger characters\n            // check parent block in case of pasted text\n            if (parentBlockText[parentBlockText.length - 1].trim() === triggerCharacter) {\n                return false;\n            }\n            if (!endPosition) {\n                endPosition = textInlineElement.getStartPosition().move(inlineTextContent.length);\n            }\n            if (inlineTextContent[0] == triggerCharacter) {\n                startPosition = textInlineElement.getStartPosition();\n            }\n            else {\n                var contentIndex = inlineTextContent.length - 1;\n                for (; contentIndex > 0; contentIndex--) {\n                    if (startPosition) {\n                        return true;\n                    }\n                    if (inlineTextContent[contentIndex] == triggerCharacter &&\n                        inlineTextContent[contentIndex - 1].trim().length == 0) {\n                        startPosition = textInlineElement.getStartPosition().move(contentIndex);\n                        return true;\n                    }\n                }\n            }\n        });\n        return startPosition && endPosition && createRange(startPosition, endPosition);\n    });\n}\nfunction handleMarkdownEvent(event, editor, triggerCharacter, elementTag) {\n    editor.addUndoSnapshot(function () {\n        var range = cacheGetRangeForMarkdownOperation(event, editor, triggerCharacter);\n        if (!range) {\n            return;\n        }\n        var lastTypedTriggerPosition = new Position(range.endContainer, -1 /* End */);\n        var hasLastTypedTrigger = range.endOffset + 1 <= lastTypedTriggerPosition.offset;\n        if (!!range && hasLastTypedTrigger) {\n            // get the text content range\n            var textContentRange = range.cloneRange();\n            textContentRange.setStart(textContentRange.startContainer, textContentRange.startOffset + 1);\n            var text = textContentRange.extractContents().textContent;\n            var textNode = editor.getDocument().createTextNode(text !== null && text !== void 0 ? text : '');\n            // extract content and put it into a new element.\n            var elementToWrap = wrap(textNode, elementTag);\n            //include last typed character\n            range.setEnd(range.endContainer, range.endOffset + 1);\n            range.deleteContents();\n            // ZWS here ensures we don't end up inside the newly created node.\n            var nonPrintedSpaceTextNode = editor\n                .getDocument()\n                .createTextNode(ZERO_WIDTH_SPACE);\n            range.insertNode(nonPrintedSpaceTextNode);\n            range.insertNode(elementToWrap);\n            editor.select(nonPrintedSpaceTextNode, -1 /* End */);\n        }\n    }, \"Format\" /* Format */, true /*canUndoByBackspace*/);\n}\n/**\n * Markdown bold feature. Make bold text with markdown shortcuts.\n */\nvar MarkdownBold = generateBasicMarkdownFeature(56 /* EIGHT_ASTERISK */, '*', 'b', true /* useShiftKey */);\n/**\n * Markdown italics feature. Make italic text with markdown shortcuts.\n */\nvar MarkdownItalic = generateBasicMarkdownFeature(189 /* DASH_UNDERSCORE */, '_', 'i', true /* useShiftKey */);\n/**\n * Markdown strikethrough feature. MAke strikethrough text with markdown shortcuts.\n */\nvar MarkdownStrikethrough = generateBasicMarkdownFeature(192 /* GRAVE_TILDE */, '~', 's', true /* useShiftKey */);\n/**\n * Markdown inline code feature. Marks specific text as inline code with markdown shortcuts.\n */\nvar MarkdownInlineCode = generateBasicMarkdownFeature(192 /* GRAVE_TILDE */, '`', 'code', false /* useShiftKey */);\n/**\n * @internal\n */\nexport var MarkdownFeatures = {\n    markdownBold: MarkdownBold,\n    markdownItalic: MarkdownItalic,\n    markdownStrikethru: MarkdownStrikethrough,\n    markdownInlineCode: MarkdownInlineCode,\n};\n//# sourceMappingURL=markdownFeatures.js.map","import { clearFormat } from 'roosterjs-editor-api';\nimport { cacheGetEventData, getTagOfNode, isNodeEmpty, safeInstanceOf, splitBalancedNodeRange, toArray, unwrap, wrap, } from 'roosterjs-editor-dom';\nvar QUOTE_TAG = 'BLOCKQUOTE';\nvar STRUCTURED_TAGS = [QUOTE_TAG, 'LI', 'TD', 'TH'].join(',');\n/**\n * UnquoteWhenBackOnEmpty1stLine edit feature, provides the ability to Unquote current line when\n * user press BACKSPACE on first and empty line of a BLOCKQUOTE\n */\nvar UnquoteWhenBackOnEmpty1stLine = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        var childOfQuote = cacheGetQuoteChild(event, editor);\n        return childOfQuote && isNodeEmpty(childOfQuote) && !childOfQuote.previousSibling;\n    },\n    handleEvent: splitQuote,\n};\n/**\n * UnquoteWhenEnterOnEmptyLine edit feature, provides the ability to Unquote current line when\n * user press ENTER on an empty line of a BLOCKQUOTE\n */\nvar UnquoteWhenEnterOnEmptyLine = {\n    keys: [13 /* ENTER */],\n    shouldHandleEvent: function (event, editor) {\n        var childOfQuote = cacheGetQuoteChild(event, editor);\n        var shift = event.rawEvent.shiftKey;\n        return !shift && childOfQuote && isNodeEmpty(childOfQuote);\n    },\n    handleEvent: function (event, editor) {\n        return editor.addUndoSnapshot(function () { return splitQuote(event, editor); }, undefined /*changeSource*/, true /*canUndoByBackspace*/);\n    },\n};\nfunction cacheGetQuoteChild(event, editor) {\n    return cacheGetEventData(event, 'QUOTE_CHILD', function () {\n        var quote = editor.getElementAtCursor(STRUCTURED_TAGS);\n        if (quote && getTagOfNode(quote) == QUOTE_TAG) {\n            var pos = editor.getFocusedPosition();\n            var block = pos && editor.getBlockElementAtNode(pos.normalize().node);\n            if (block) {\n                var node = block.getStartNode() == quote\n                    ? block.getStartNode()\n                    : block.collapseToSingleElement();\n                return isNodeEmpty(node) ? node : null;\n            }\n        }\n        return null;\n    });\n}\nfunction splitQuote(event, editor) {\n    editor.addUndoSnapshot(function () {\n        var childOfQuote = cacheGetQuoteChild(event, editor);\n        if (!childOfQuote) {\n            return;\n        }\n        if (getTagOfNode(childOfQuote) == QUOTE_TAG) {\n            childOfQuote = wrap(toArray(childOfQuote.childNodes));\n        }\n        var parent = splitBalancedNodeRange(childOfQuote);\n        var shouldClearFormat = !!parent && isStyledBlockquote(parent);\n        var newParent = parent && unwrap(parent);\n        editor.select(childOfQuote, 0 /* Begin */);\n        if (shouldClearFormat) {\n            if (safeInstanceOf(newParent, 'HTMLLIElement')) {\n                newParent.style.removeProperty('color');\n            }\n            clearFormat(editor);\n        }\n    });\n    event.rawEvent.preventDefault();\n}\nvar isStyledBlockquote = function (element) {\n    if (element &&\n        safeInstanceOf(element, 'HTMLQuoteElement') &&\n        element.style.borderLeft &&\n        element.style.borderColor &&\n        element.style.paddingLeft &&\n        element.style.color) {\n        return true;\n    }\n    return false;\n};\n/**\n * @internal\n */\nexport var QuoteFeatures = {\n    unquoteWhenBackspaceOnEmptyFirstLine: UnquoteWhenBackOnEmpty1stLine,\n    unquoteWhenEnterOnEmptyLine: UnquoteWhenEnterOnEmptyLine,\n};\n//# sourceMappingURL=quoteFeatures.js.map","import { Browser, cacheGetEventData } from 'roosterjs-editor-dom';\nimport { changeFontSize, toggleBold, toggleItalic, toggleUnderline, toggleBullet, toggleNumbering, clearFormat, } from 'roosterjs-editor-api';\nfunction createCommand(winKey, macKey, action, disabled) {\n    if (disabled === void 0) { disabled = false; }\n    if (disabled) {\n        return null;\n    }\n    return {\n        winKey: winKey,\n        macKey: macKey,\n        action: action,\n    };\n}\nvar commands = [\n    createCommand(4096 /* Ctrl */ | 66 /* B */, 8192 /* Meta */ | 66 /* B */, toggleBold),\n    createCommand(4096 /* Ctrl */ | 73 /* I */, 8192 /* Meta */ | 73 /* I */, toggleItalic),\n    createCommand(4096 /* Ctrl */ | 85 /* U */, 8192 /* Meta */ | 85 /* U */, toggleUnderline),\n    createCommand(4096 /* Ctrl */ | 32 /* SPACE */, 8192 /* Meta */ | 32 /* SPACE */, clearFormat),\n    createCommand(4096 /* Ctrl */ | 90 /* Z */, 8192 /* Meta */ | 90 /* Z */, function (editor) { return editor.undo(); }),\n    createCommand(18 /* ALT */ | 8 /* BACKSPACE */, 18 /* ALT */ | 8 /* BACKSPACE */, function (editor) { return editor.undo(); }, Browser.isMac /* Option+Backspace to be handled by browsers on Mac */),\n    createCommand(4096 /* Ctrl */ | 89 /* Y */, 8192 /* Meta */ | 16384 /* Shift */ | 90 /* Z */, function (editor) { return editor.redo(); }),\n    createCommand(4096 /* Ctrl */ | 190 /* PERIOD */, 8192 /* Meta */ | 190 /* PERIOD */, toggleBullet),\n    createCommand(4096 /* Ctrl */ | 191 /* FORWARD_SLASH */, 8192 /* Meta */ | 191 /* FORWARD_SLASH */, toggleNumbering),\n    createCommand(4096 /* Ctrl */ | 16384 /* Shift */ | 190 /* PERIOD */, 8192 /* Meta */ | 16384 /* Shift */ | 190 /* PERIOD */, function (editor) { return changeFontSize(editor, 0 /* Increase */); }),\n    createCommand(4096 /* Ctrl */ | 16384 /* Shift */ | 188 /* COMMA */, 8192 /* Meta */ | 16384 /* Shift */ | 188 /* COMMA */, function (editor) { return changeFontSize(editor, 1 /* Decrease */); }),\n].filter(function (command) { return !!command; });\n/**\n * DefaultShortcut edit feature, provides shortcuts for the following features:\n * Ctrl/Meta+B: toggle bold style\n * Ctrl/Meta+I: toggle italic style\n * Ctrl/Meta+U: toggle underline style\n * Ctrl/Meta+Space: clear formatting\n * Alt+Backspace: undo\n * Ctrl/Meta+Z: undo\n * Ctrl+Y/Meta+Shift+Z: redo\n * Ctrl/Meta+PERIOD: toggle bullet list\n * Ctrl/Meta+/: toggle numbering list\n * Ctrl/Meta+Shift+>: increase font size\n * Ctrl/Meta+Shift+<: decrease font size\n */\nvar DefaultShortcut = {\n    allowFunctionKeys: true,\n    keys: [\n        66 /* B */,\n        73 /* I */,\n        85 /* U */,\n        89 /* Y */,\n        90 /* Z */,\n        188 /* COMMA */,\n        190 /* PERIOD */,\n        191 /* FORWARD_SLASH */,\n        32 /* SPACE */,\n        8 /* BACKSPACE */,\n    ],\n    shouldHandleEvent: cacheGetCommand,\n    handleEvent: function (event, editor) {\n        var command = cacheGetCommand(event);\n        if (command) {\n            command.action(editor);\n            event.rawEvent.preventDefault();\n            event.rawEvent.stopPropagation();\n        }\n    },\n};\nfunction cacheGetCommand(event) {\n    return cacheGetEventData(event, 'DEFAULT_SHORT_COMMAND', function () {\n        var e = event.rawEvent;\n        var key = \n        // Need to check AltGraph isn't being pressed since some languages (e.g. Polski) use AltGr\n        // to input some special characters. In that case, ctrlKey and altKey are both true in Edge,\n        // but we should not trigger any shortcut function here. However, we still want to capture\n        // the ALT+BACKSPACE combination.\n        event.eventType == 0 /* KeyDown */ && !e.getModifierState('AltGraph')\n            ? e.which |\n                (e.metaKey && 8192 /* Meta */) |\n                (e.shiftKey && 16384 /* Shift */) |\n                (e.ctrlKey && 4096 /* Ctrl */) |\n                (e.altKey && 18 /* ALT */)\n            : 0;\n        return key && commands.filter(function (cmd) { return (Browser.isMac ? cmd.macKey : cmd.winKey) == key; })[0];\n    });\n}\n/**\n * @internal\n */\nexport var ShortcutFeatures = {\n    defaultShortcut: DefaultShortcut,\n};\n//# sourceMappingURL=shortcutFeatures.js.map","import { cacheGetEventData, isPositionAtBeginningOf, Position, getTagOfNode, createElement, getObjectKeys, } from 'roosterjs-editor-dom';\nvar CHILD_PARENT_TAG_MAP = {\n    TD: 'TABLE',\n    TH: 'TABLE',\n    LI: 'OL,UL',\n};\nvar CHILD_SELECTOR = getObjectKeys(CHILD_PARENT_TAG_MAP).join(',');\n/**\n * InsertLineBeforeStructuredNode edit feature, provides the ability to insert an empty line before\n * a structured element (bullet/numbering list, blockquote, table) if the element is at beginning of\n * document\n */\nvar InsertLineBeforeStructuredNodeFeature = {\n    keys: [13 /* ENTER */],\n    shouldHandleEvent: cacheGetStructuredElement,\n    handleEvent: function (event, editor) {\n        var element = cacheGetStructuredElement(event, editor);\n        var div = createElement(1 /* EmptyLine */, editor.getDocument());\n        editor.addUndoSnapshot(function () {\n            var _a;\n            (_a = element === null || element === void 0 ? void 0 : element.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(div, element);\n            // Select the new line when we are in table. This is the same behavior with Word\n            if (getTagOfNode(element) == 'TABLE') {\n                editor.select(new Position(div, 0 /* Begin */).normalize());\n            }\n        });\n        event.rawEvent.preventDefault();\n    },\n    defaultDisabled: true,\n};\nfunction cacheGetStructuredElement(event, editor) {\n    return cacheGetEventData(event, 'FIRST_STRUCTURE', function () {\n        // Provide a chance to keep browser default behavior by pressing SHIFT\n        var element = event.rawEvent.shiftKey ? null : editor.getElementAtCursor(CHILD_SELECTOR);\n        if (element) {\n            var range = editor.getSelectionRange();\n            if (range &&\n                range.collapsed &&\n                isPositionAtBeginningOf(Position.getStart(range), element) &&\n                !editor.getBodyTraverser(element).getPreviousBlockElement()) {\n                return editor.getElementAtCursor(CHILD_PARENT_TAG_MAP[getTagOfNode(element)]);\n            }\n        }\n        return null;\n    });\n}\n/**\n * @internal\n */\nexport var StructuredNodeFeatures = {\n    insertLineBeforeStructuredNodeFeature: InsertLineBeforeStructuredNodeFeature,\n};\n//# sourceMappingURL=structuredNodeFeatures.js.map","import { editTable, setIndentation } from 'roosterjs-editor-api';\nimport { cacheGetEventData, contains, getTagOfNode, isVoidHtmlElement, isWholeTableSelected, Position, VTable, } from 'roosterjs-editor-dom';\n/**\n * TabInTable edit feature, provides the ability to jump between cells when user press TAB in table\n */\nvar TabInTable = {\n    keys: [9 /* TAB */],\n    shouldHandleEvent: function (event, editor) {\n        return cacheGetTableCell(event, editor) && !cacheIsWholeTableSelected(event, editor);\n    },\n    handleEvent: function (event, editor) {\n        var _a, _b, _c;\n        var shift = event.rawEvent.shiftKey;\n        var td = cacheGetTableCell(event, editor);\n        if (!td) {\n            return;\n        }\n        var vtable = cacheVTable(event, td);\n        for (var step = shift ? -1 : 1, row = (_a = vtable.row) !== null && _a !== void 0 ? _a : 0, col = ((_b = vtable.col) !== null && _b !== void 0 ? _b : 0) + step;; col += step) {\n            var tableCells = (_c = vtable.cells) !== null && _c !== void 0 ? _c : [];\n            if (col < 0 || col >= tableCells[row].length) {\n                row += step;\n                if (row < 0) {\n                    editor.select(vtable.table, -2 /* Before */);\n                    break;\n                }\n                else if (row >= tableCells.length) {\n                    editTable(editor, 1 /* InsertBelow */);\n                    break;\n                }\n                col = shift ? tableCells[row].length - 1 : 0;\n            }\n            var cell = vtable.getCell(row, col);\n            if (cell.td) {\n                var newPos = new Position(cell.td, 0 /* Begin */).normalize();\n                editor.select(newPos);\n                break;\n            }\n        }\n        event.rawEvent.preventDefault();\n    },\n};\n/**\n * IndentTableOnTab edit feature, provides the ability to indent the table if it is all cells are selected.\n */\nvar IndentTableOnTab = {\n    keys: [9 /* TAB */],\n    shouldHandleEvent: function (event, editor) {\n        return cacheGetTableCell(event, editor) && cacheIsWholeTableSelected(event, editor);\n    },\n    handleEvent: function (event, editor) {\n        event.rawEvent.preventDefault();\n        editor.addUndoSnapshot(function () {\n            var shift = event.rawEvent.shiftKey;\n            var selection = editor.getSelectionRangeEx();\n            var td = cacheGetTableCell(event, editor);\n            if (!td) {\n                return;\n            }\n            var vtable = cacheVTable(event, td);\n            if (shift && editor.getElementAtCursor('blockquote', vtable.table, event)) {\n                setIndentation(editor, 1 /* Decrease */);\n            }\n            else if (!shift) {\n                setIndentation(editor, 0 /* Increase */);\n            }\n            if (selection.coordinates) {\n                editor.select(selection.table, selection.coordinates);\n            }\n        });\n    },\n};\n/**\n * UpDownInTable edit feature, provides the ability to jump to cell above/below when user press UP/DOWN\n * in table\n */\nvar UpDownInTable = {\n    keys: [38 /* UP */, 40 /* DOWN */],\n    shouldHandleEvent: function (event, editor) {\n        return cacheGetTableCell(event, editor) && !cacheIsWholeTableSelected(event, editor);\n    },\n    handleEvent: function (event, editor) {\n        var _a, _b, _c;\n        var td = cacheGetTableCell(event, editor);\n        if (!td) {\n            return;\n        }\n        var vtable = new VTable(td);\n        var isUp = event.rawEvent.which == 38 /* UP */;\n        var step = isUp ? -1 : 1;\n        var hasShiftKey = event.rawEvent.shiftKey;\n        var selection = (_a = editor.getDocument().defaultView) === null || _a === void 0 ? void 0 : _a.getSelection();\n        var targetTd = null;\n        if (selection) {\n            var anchorNode_1 = selection.anchorNode, anchorOffset_1 = selection.anchorOffset;\n            for (var row = (_b = vtable.row) !== null && _b !== void 0 ? _b : 0; row >= 0 && vtable.cells && row < vtable.cells.length; row += step) {\n                var cell = vtable.getCell(row, (_c = vtable.col) !== null && _c !== void 0 ? _c : 0);\n                if (cell.td && cell.td != td) {\n                    targetTd = cell.td;\n                    break;\n                }\n            }\n            editor.runAsync(function (editor) {\n                var _a;\n                var newContainer = editor.getElementAtCursor();\n                if (contains(vtable.table, newContainer) &&\n                    !contains(td, newContainer, true /*treatSameNodeAsContain*/)) {\n                    var newPos = targetTd\n                        ? new Position(targetTd, 0 /* Begin */)\n                        : new Position(vtable.table, isUp ? -2 /* Before */ : -3 /* After */);\n                    if (hasShiftKey) {\n                        newPos =\n                            newPos.node.nodeType == 1 /* Element */ &&\n                                isVoidHtmlElement(newPos.node)\n                                ? new Position(newPos.node, newPos.isAtEnd ? -3 /* After */ : -2 /* Before */)\n                                : newPos;\n                        var selection_1 = (_a = editor.getDocument().defaultView) === null || _a === void 0 ? void 0 : _a.getSelection();\n                        if (anchorNode_1) {\n                            selection_1 === null || selection_1 === void 0 ? void 0 : selection_1.setBaseAndExtent(anchorNode_1, anchorOffset_1, newPos.node, newPos.offset);\n                        }\n                    }\n                    else {\n                        editor.select(newPos.normalize());\n                    }\n                }\n            });\n        }\n    },\n};\n/**\n * Requires @see ExperimentalFeatures.DeleteTableWithBackspace\n * Delete a table selected with the table selector pressing Backspace key\n */\nvar DeleteTableWithBackspace = {\n    keys: [8 /* BACKSPACE */],\n    shouldHandleEvent: function (event, editor) {\n        return editor.isFeatureEnabled(\"DeleteTableWithBackspace\" /* DeleteTableWithBackspace */) &&\n            cacheIsWholeTableSelected(event, editor);\n    },\n    handleEvent: function (event, editor) {\n        var td = cacheGetTableCell(event, editor);\n        if (!td) {\n            return;\n        }\n        var vtable = new VTable(td);\n        vtable.edit(4 /* DeleteTable */);\n        vtable.writeBack();\n    },\n};\nfunction cacheGetTableCell(event, editor) {\n    return cacheGetEventData(event, 'TABLE_CELL_FOR_TABLE_FEATURES', function () {\n        var pos = editor.getFocusedPosition();\n        var firstTd = pos && editor.getElementAtCursor('TD,TH,LI', pos.node);\n        return (firstTd && (getTagOfNode(firstTd) == 'LI' ? null : firstTd));\n    });\n}\nfunction cacheIsWholeTableSelected(event, editor) {\n    return cacheGetEventData(event, 'WHOLE_TABLE_SELECTED_FOR_FEATURES', function () {\n        var td = cacheGetTableCell(event, editor);\n        if (!td) {\n            return false;\n        }\n        var vtable = cacheVTable(event, td);\n        var selection = editor.getSelectionRangeEx();\n        return (selection.type == 1 /* TableSelection */ &&\n            selection.coordinates &&\n            isWholeTableSelected(vtable, selection.coordinates));\n    });\n}\nfunction cacheVTable(event, td) {\n    return cacheGetEventData(event, 'VTABLE_FOR_TABLE_FEATURES', function () {\n        return new VTable(td);\n    });\n}\n/**\n * @internal\n */\nexport var TableFeatures = {\n    tabInTable: TabInTable,\n    upDownInTable: UpDownInTable,\n    indentTableOnTab: IndentTableOnTab,\n    deleteTableWithBackspace: DeleteTableWithBackspace,\n};\n//# sourceMappingURL=tableFeatures.js.map","import { setIndentation } from 'roosterjs-editor-api';\nimport { createRange, getEntitySelector, getTagOfNode, Position, queryElements, } from 'roosterjs-editor-dom';\nvar TAB_SPACES = 6;\n/**\n * Requires @see ExperimentalFeatures.TabKeyTextFeatures to be enabled\n * Provides additional functionality when press Tab:\n *      If Whole Paragraph selected, indent paragraph,\n *      If range is collapsed, add tab spaces\n *      If range is not collapsed but not all the paragraph is selected, replace selection with Tab spaces\n *      If there are more than one block in the selection, indent all selection\n */\nvar IndentWhenTabText = {\n    keys: [9 /* TAB */],\n    shouldHandleEvent: function (event, editor) {\n        if (editor.isFeatureEnabled(\"TabKeyTextFeatures\" /* TabKeyTextFeatures */) &&\n            !event.rawEvent.shiftKey) {\n            var activeElement = editor.getDocument().activeElement;\n            var listOrTable = editor.getElementAtCursor('LI,TABLE', undefined /*startFrom*/, event);\n            var entity = editor.getElementAtCursor(getEntitySelector(), undefined /*startFrom*/, event);\n            return (!listOrTable &&\n                (entity ? entity.isContentEditable : activeElement.isContentEditable));\n        }\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        var selection = editor.getSelectionRangeEx();\n        if (selection.type == 0 /* Normal */) {\n            editor.addUndoSnapshot(function () {\n                if (selection.areAllCollapsed) {\n                    insertTab(editor, event);\n                }\n                else {\n                    var ranges = selection.ranges;\n                    var range = ranges[0];\n                    if (shouldSetIndentation(editor, range)) {\n                        setIndentation(editor, 0 /* Increase */);\n                    }\n                    else {\n                        var tempRange = createRange(range.startContainer, range.startOffset);\n                        ranges.forEach(function (range) { return range.deleteContents(); });\n                        editor.select(tempRange);\n                        insertTab(editor, event);\n                    }\n                }\n            });\n            event.rawEvent.preventDefault();\n        }\n    },\n};\n/**\n * Requires @see ExperimentalFeatures.TabKeyTextFeatures to be enabled\n * If Whole Paragraph selected, outdent paragraph on Tab press\n */\nvar OutdentWhenTabText = {\n    keys: [9 /* TAB */],\n    shouldHandleEvent: function (event, editor) {\n        if (event.rawEvent.shiftKey &&\n            editor.isFeatureEnabled(\"TabKeyTextFeatures\" /* TabKeyTextFeatures */)) {\n            var selection = editor.getSelectionRangeEx();\n            return (selection.type == 0 /* Normal */ &&\n                !selection.areAllCollapsed &&\n                editor.getElementAtCursor('blockquote', undefined, event) &&\n                !editor.getElementAtCursor('LI,TABLE', undefined /*startFrom*/, event) &&\n                shouldSetIndentation(editor, selection.ranges[0]));\n        }\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        editor.addUndoSnapshot(function () { return setIndentation(editor, 1 /* Decrease */); });\n        event.rawEvent.preventDefault();\n    },\n};\n/**\n * @deprecated\n * Automatically transform -- into hyphen, if typed between two words.\n */\nvar AutoHyphen = {\n    keys: [],\n    shouldHandleEvent: function (event, editor) {\n        return false;\n    },\n    handleEvent: function (event, editor) {\n        return false;\n    },\n    defaultDisabled: true,\n};\n/**\n * @internal\n */\nexport var TextFeatures = {\n    indentWhenTabText: IndentWhenTabText,\n    outdentWhenTabText: OutdentWhenTabText,\n    autoHyphen: AutoHyphen,\n};\nfunction shouldSetIndentation(editor, range) {\n    var result = false;\n    var startPosition = Position.getStart(range);\n    var endPosition = Position.getEnd(range);\n    var firstBlock = editor.getBlockElementAtNode(startPosition.node);\n    var lastBlock = editor.getBlockElementAtNode(endPosition.node);\n    if (!firstBlock || !lastBlock) {\n        return false;\n    }\n    if (!firstBlock.equals(lastBlock)) {\n        //If the selections has more than one block, we indent all the blocks in the selection\n        return true;\n    }\n    else {\n        //We only indent a single block if all the block is selected.\n        var blockStart = new Position(firstBlock.getStartNode(), 0 /* Begin */);\n        var blockEnd = new Position(firstBlock.getEndNode(), -1 /* End */);\n        var rangeBefore = createRange(blockStart, Position.getStart(range));\n        var rangeAfter = createRange(Position.getEnd(range), blockEnd);\n        if (!result && isRangeEmpty(rangeBefore) && isRangeEmpty(rangeAfter)) {\n            result = true;\n        }\n        return result;\n    }\n}\nfunction isRangeEmpty(range) {\n    return (range.toString() == '' &&\n        queryElements(range.commonAncestorContainer, 'img,table,ul,ol', null, 2 /* InSelection */, range).length == 0);\n}\nfunction insertTab(editor, event) {\n    var span = editor.getDocument().createElement('span');\n    var searcher = editor.getContentSearcherOfCursor(event);\n    if (!searcher) {\n        return;\n    }\n    var charsBefore = searcher.getSubStringBefore(Number.MAX_SAFE_INTEGER);\n    var numberOfChars = TAB_SPACES - (charsBefore.length % TAB_SPACES);\n    var span2 = null;\n    var textContent = '';\n    for (var index = 0; index < numberOfChars; index++) {\n        textContent += '&ensp;';\n    }\n    editor.insertNode(span);\n    if (span.nextElementSibling && getTagOfNode(span.nextElementSibling) == 'A') {\n        span2 = editor.getDocument().createElement('span');\n        span2.textContent = ' ';\n        editor.insertNode(span2);\n        editor.select(createRange(span2, -2 /* Before */));\n    }\n    editor.insertContent(textContent, {\n        position: 5 /* Range */,\n        range: createRange(span, 0 /* Begin */),\n        updateCursor: false,\n    });\n    editor.select(createRange(span, -3 /* After */));\n    if (span2) {\n        editor.deleteNode(span2);\n    }\n}\n//# sourceMappingURL=textFeatures.js.map","import { __assign } from \"tslib\";\nimport { AutoLinkFeatures } from './features/autoLinkFeatures';\nimport { CodeFeatures } from './features/codeFeatures';\nimport { CursorFeatures } from './features/cursorFeatures';\nimport { EntityFeatures } from './features/entityFeatures';\nimport { ListFeatures } from './features/listFeatures';\nimport { MarkdownFeatures } from './features/markdownFeatures';\nimport { QuoteFeatures } from './features/quoteFeatures';\nimport { ShortcutFeatures } from './features/shortcutFeatures';\nimport { StructuredNodeFeatures } from './features/structuredNodeFeatures';\nimport { TableFeatures } from './features/tableFeatures';\nimport { TextFeatures } from './features/textFeatures';\nvar allFeatures = __assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign({}, ListFeatures), QuoteFeatures), TableFeatures), StructuredNodeFeatures), AutoLinkFeatures), ShortcutFeatures), CursorFeatures), MarkdownFeatures), EntityFeatures), TextFeatures), CodeFeatures);\n/**\n * Get all content edit features provided by roosterjs\n */\nexport default function getAllFeatures() {\n    return allFeatures;\n}\n//# sourceMappingURL=getAllFeatures.js.map","import getAllFeatures from './getAllFeatures';\nimport { getObjectKeys } from 'roosterjs-editor-dom';\n/**\n * An editor plugin to handle content edit event.\n * The following cases are included:\n * 1. Auto increase/decrease indentation on Tab, Shift+tab\n * 2. Enter, Backspace on empty list item\n * 3. Enter, Backspace on empty blockquote line\n * 4. Auto bullet/numbering\n * 5. Auto link\n * 6. Tab in table\n * 7. Up/Down in table\n * 8. Manage list style\n */\nvar ContentEdit = /** @class */ (function () {\n    /**\n     * Create instance of ContentEdit plugin\n     * @param settingsOverride An optional feature set to override default feature settings\n     * @param additionalFeatures Optional. More features to add\n     */\n    function ContentEdit(settingsOverride, additionalFeatures) {\n        this.settingsOverride = settingsOverride;\n        this.additionalFeatures = additionalFeatures;\n        this.editor = undefined;\n        this.features = [];\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    ContentEdit.prototype.getName = function () {\n        return 'ContentEdit';\n    };\n    /**\n     * Initialize this plugin\n     * @param editor The editor instance\n     */\n    ContentEdit.prototype.initialize = function (editor) {\n        var _this = this;\n        this.editor = editor;\n        var allFeatures = getAllFeatures();\n        getObjectKeys(allFeatures).forEach(function (key) {\n            var _a;\n            var feature = allFeatures[key];\n            var hasSettingForKey = _this.settingsOverride && _this.settingsOverride[key] !== undefined;\n            if ((hasSettingForKey && ((_a = _this.settingsOverride) === null || _a === void 0 ? void 0 : _a[key])) ||\n                (!hasSettingForKey && !feature.defaultDisabled)) {\n                _this.features.push(feature);\n            }\n        });\n        this.features = this.features.concat(this.additionalFeatures || []);\n        this.features.forEach(function (feature) { var _a; return (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.addContentEditFeature(feature); });\n    };\n    ContentEdit.prototype.disposeFeatures = function () {\n        var _this = this;\n        if (this.editor) {\n            this.features.forEach(function (feature) { return _this.editor.removeContentEditFeature(feature); });\n        }\n        this.features = [];\n    };\n    /**\n     * Dispose this plugin\n     */\n    ContentEdit.prototype.dispose = function () {\n        this.disposeFeatures();\n        this.editor = undefined;\n    };\n    return ContentEdit;\n}());\nexport default ContentEdit;\n//# sourceMappingURL=ContentEdit.js.map","import { __read, __spreadArray } from \"tslib\";\nvar RESIZE_KEYS = ['widthPx', 'heightPx'];\nvar ROTATE_KEYS = ['angleRad'];\nvar CROP_KEYS = [\n    'leftPercent',\n    'rightPercent',\n    'topPercent',\n    'bottomPercent',\n];\nvar ROTATE_CROP_KEYS = __spreadArray(__spreadArray([], __read(ROTATE_KEYS), false), __read(CROP_KEYS), false);\nvar ALL_KEYS = __spreadArray(__spreadArray([], __read(ROTATE_CROP_KEYS), false), __read(RESIZE_KEYS), false);\n/**\n * @internal\n * State of an edit info object for image editing.\n * It is returned by checkEditInfoState() function\n */\nexport var ImageEditInfoState;\n(function (ImageEditInfoState) {\n    /**\n     * Invalid edit info. It means the given edit info object is either null,\n     * or not all its member are of correct type\n     */\n    ImageEditInfoState[ImageEditInfoState[\"Invalid\"] = 0] = \"Invalid\";\n    /**\n     * The edit info shows that it is only potentially edited by resizing action.\n     * Image is not rotated or cropped, or event not changed at all.\n     */\n    ImageEditInfoState[ImageEditInfoState[\"ResizeOnly\"] = 1] = \"ResizeOnly\";\n    /**\n     * When compare with another edit info, this value can be returned when both current\n     * edit info and the other one are not been rotated, and they have same cropping\n     * percentages. So that they can share the same image src, only width and height\n     * need to be adjusted.\n     */\n    ImageEditInfoState[ImageEditInfoState[\"SameWithLast\"] = 2] = \"SameWithLast\";\n    /**\n     * When this value is returned, it means the image is edited by either cropping or\n     * rotation, or both. Image source can't be reused, need to generate a new image src\n     * data uri.\n     */\n    ImageEditInfoState[ImageEditInfoState[\"FullyChanged\"] = 3] = \"FullyChanged\";\n})(ImageEditInfoState || (ImageEditInfoState = {}));\n/**\n * @internal\n * Check the state of an edit info\n * @param editInfo The edit info to check\n * @param compareTo An optional edit info to compare to\n * @returns If the source edit info is not valid (wrong type, missing field, ...), returns Invalid.\n * If the source edit info doesn't contain any rotation or cropping, returns ResizeOnly\n * If the compare edit info exists, and both of them don't contain rotation, and the have same cropping values,\n * returns SameWithLast. Otherwise, returns FullyChanged\n */\nexport default function checkEditInfoState(editInfo, compareTo) {\n    if (!editInfo || !editInfo.src || ALL_KEYS.some(function (key) { return !isNumber(editInfo[key]); })) {\n        return 0 /* Invalid */;\n    }\n    else if (ROTATE_CROP_KEYS.every(function (key) { return areSameNumber(editInfo[key], 0); }) &&\n        !editInfo.flippedHorizontal &&\n        !editInfo.flippedVertical &&\n        (!compareTo || (compareTo && editInfo.angleRad === compareTo.angleRad))) {\n        return 1 /* ResizeOnly */;\n    }\n    else if (compareTo &&\n        ROTATE_KEYS.every(function (key) { return areSameNumber(editInfo[key], 0); }) &&\n        ROTATE_KEYS.every(function (key) { return areSameNumber(compareTo[key], 0); }) &&\n        CROP_KEYS.every(function (key) { return areSameNumber(editInfo[key], compareTo[key]); }) &&\n        compareTo.flippedHorizontal === editInfo.flippedHorizontal &&\n        compareTo.flippedVertical === editInfo.flippedVertical) {\n        return 2 /* SameWithLast */;\n    }\n    else {\n        return 3 /* FullyChanged */;\n    }\n}\nfunction isNumber(o) {\n    return typeof o === 'number';\n}\nfunction areSameNumber(n1, n2) {\n    return Math.abs(n1 - n2) < 1e-3;\n}\n//# sourceMappingURL=checkEditInfoState.js.map","import { isCharacterValue, isCtrlOrMetaPressed, matchLink } from 'roosterjs-editor-dom';\n/**\n * An editor plugin that show a tooltip for existing link\n */\nvar HyperLink = /** @class */ (function () {\n    /**\n     * Create a new instance of HyperLink class\n     * @param getTooltipCallback A callback function to get tooltip text for an existing hyperlink.\n     * Default value is to return the href itself. If null, there will be no tooltip text.\n     * @param target (Optional) Target window name for hyperlink. If null, will use \"_blank\"\n     * @param onLinkClick (Optional) Open link callback (return false to use default behavior)\n     */\n    function HyperLink(getTooltipCallback, target, onLinkClick) {\n        var _this = this;\n        if (getTooltipCallback === void 0) { getTooltipCallback = function (href) { return href; }; }\n        this.getTooltipCallback = getTooltipCallback;\n        this.target = target;\n        this.onLinkClick = onLinkClick;\n        this.originalHref = null;\n        this.trackedLink = null;\n        this.editor = null;\n        this.disposer = null;\n        this.onMouse = function (e) {\n            var _a, _b;\n            var a = (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.getElementAtCursor('a[href]', e.target);\n            var href = a && _this.tryGetHref(a);\n            if (href) {\n                (_b = _this.editor) === null || _b === void 0 ? void 0 : _b.setEditorDomAttribute('title', e.type == 'mouseover' ? _this.getTooltipCallback(href, a) : null);\n            }\n        };\n        this.onBlur = function (e) {\n            if (_this.trackedLink) {\n                _this.updateLinkHrefIfShouldUpdate();\n            }\n            _this.resetLinkTracking();\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    HyperLink.prototype.getName = function () {\n        return 'Hyperlink';\n    };\n    /**\n     * Initialize this plugin\n     * @param editor The editor instance\n     */\n    HyperLink.prototype.initialize = function (editor) {\n        this.editor = editor;\n        this.disposer = editor.addDomEventHandler({\n            mouseover: this.onMouse,\n            mouseout: this.onMouse,\n            blur: this.onBlur,\n        });\n    };\n    /**\n     * Dispose this plugin\n     */\n    HyperLink.prototype.dispose = function () {\n        if (this.disposer) {\n            this.disposer();\n            this.disposer = null;\n        }\n        this.editor = null;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    HyperLink.prototype.onPluginEvent = function (event) {\n        var _a, _b, _c;\n        if (event.eventType == 6 /* MouseUp */ ||\n            (event.eventType == 2 /* KeyUp */ &&\n                (!this.isContentEditValue(event.rawEvent) || event.rawEvent.which == 32 /* SPACE */)) ||\n            event.eventType == 7 /* ContentChanged */) {\n            var anchor = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getElementAtCursor('A[href]', undefined /*startFrom*/, event);\n            var shouldCheckUpdateLink = (anchor && anchor !== this.trackedLink) ||\n                event.eventType == 2 /* KeyUp */ ||\n                event.eventType == 7 /* ContentChanged */;\n            if (event.eventType == 7 /* ContentChanged */ &&\n                event.source == \"Keyboard\" /* Keyboard */ &&\n                this.trackedLink != anchor &&\n                anchor) {\n                // For Keyboard event that causes content change (mostly come from Content Model), this tracked list may be staled.\n                // So we need to get an up-to-date link element\n                // TODO: This is a temporary solution. Later when Content Model can fully take over this behavior, we can remove this code.\n                this.trackedLink = anchor;\n            }\n            if (this.trackedLink &&\n                (shouldCheckUpdateLink || this.tryGetHref(this.trackedLink) !== this.originalHref)) {\n                // If cursor has moved out of previously tracked link\n                // update link href if display text doesn't match href anymore.\n                if (shouldCheckUpdateLink) {\n                    this.updateLinkHrefIfShouldUpdate();\n                }\n                // If the link's href value was edited, or the cursor has moved out of the\n                // previously tracked link, stop tracking the link.\n                this.resetLinkTracking();\n            }\n            // Cache link and href value if its href attribute currently matches its display text\n            if (!this.trackedLink && anchor && this.doesLinkDisplayMatchHref(anchor)) {\n                this.trackedLink = anchor;\n                this.originalHref = this.tryGetHref(anchor);\n            }\n        }\n        if (event.eventType == 6 /* MouseUp */) {\n            var anchor = (_b = this.editor) === null || _b === void 0 ? void 0 : _b.getElementAtCursor('A', event.rawEvent.srcElement);\n            if (anchor) {\n                if (this.onLinkClick && this.onLinkClick(anchor, event.rawEvent) !== false) {\n                    return;\n                }\n                var href = void 0;\n                if ((href = this.tryGetHref(anchor)) &&\n                    isCtrlOrMetaPressed(event.rawEvent) &&\n                    event.rawEvent.button === 0) {\n                    event.rawEvent.preventDefault();\n                    try {\n                        var target = this.target || '_blank';\n                        var window_1 = (_c = this.editor) === null || _c === void 0 ? void 0 : _c.getDocument().defaultView;\n                        window_1 === null || window_1 === void 0 ? void 0 : window_1.open(href, target);\n                    }\n                    catch (_d) { }\n                }\n            }\n        }\n    };\n    /**\n     * Try get href from an anchor element\n     * The reason this is put in a try-catch is that\n     * it has been seen that accessing href may throw an exception, in particular on IE/Edge\n     */\n    HyperLink.prototype.tryGetHref = function (anchor) {\n        try {\n            return anchor ? anchor.href : null;\n        }\n        catch (_a) {\n            return null;\n        }\n    };\n    /**\n     * Determines if KeyboardEvent is meant to edit content\n     */\n    HyperLink.prototype.isContentEditValue = function (event) {\n        return (isCharacterValue(event) || event.which == 8 /* BACKSPACE */ || event.which == 46 /* DELETE */);\n    };\n    /**\n     * Updates the href of the tracked link if the display text doesn't match href anymore\n     */\n    HyperLink.prototype.updateLinkHrefIfShouldUpdate = function () {\n        if (this.trackedLink && !this.doesLinkDisplayMatchHref(this.trackedLink)) {\n            this.updateLinkHref();\n        }\n    };\n    /**\n     * Clears the tracked link and its original href value so that it's back to default state\n     */\n    HyperLink.prototype.resetLinkTracking = function () {\n        this.trackedLink = null;\n        this.originalHref = '';\n    };\n    /**\n     * Compares the normalized URL of inner text of element to its href to see if they match.\n     */\n    HyperLink.prototype.doesLinkDisplayMatchHref = function (element) {\n        if (element) {\n            var display = element.innerText.trim();\n            // We first escape the display text so that any text passed into the regex is not\n            // treated as a special character.\n            var escapedDisplay = display.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n            var rule = new RegExp(\"^(?:https?:\\\\/\\\\/)?\" + escapedDisplay + \"\\\\/?\", 'i');\n            var href = this.tryGetHref(element);\n            if (href !== null) {\n                return rule.test(href);\n            }\n        }\n        return false;\n    };\n    /**\n     * Update href of an element in place to new display text if it's a valid URL\n     */\n    HyperLink.prototype.updateLinkHref = function () {\n        var _this = this;\n        var _a;\n        if (this.trackedLink) {\n            var linkData_1 = matchLink(this.trackedLink.innerText.trim());\n            if (linkData_1 !== null) {\n                (_a = this.editor) === null || _a === void 0 ? void 0 : _a.addUndoSnapshot(function () {\n                    _this.trackedLink.href = linkData_1.normalizedUrl;\n                });\n            }\n        }\n    };\n    return HyperLink;\n}());\nexport default HyperLink;\n//# sourceMappingURL=HyperLink.js.map","/**\n * @internal\n * Calculate the target size of an image.\n * For image that is not rotated, target size is the same with resizing/cropping size.\n * For image that is rotated, target size is calculated from resizing/cropping size and its rotate angle\n * Say an image is resized to 100w*100h, cropped 25% on each side, then rotated 45deg, so that cropped size\n * will be (both height and width) 100*(1-0.25-0,25) = 50px, then final image size will be 50*sqrt(2) = 71px\n * @param editInfo The edit info to calculate size from\n * @param beforeCrop True to calculate the full size of original image before crop, false to calculate the size\n * after crop\n * @returns A GeneratedImageSize object which contains original, visible and target target width and height of the image\n */\nexport default function getGeneratedImageSize(editInfo, beforeCrop) {\n    var width = editInfo.widthPx, height = editInfo.heightPx, angle = editInfo.angleRad, left = editInfo.leftPercent, right = editInfo.rightPercent, top = editInfo.topPercent, bottom = editInfo.bottomPercent;\n    // Original image size before crop and rotate\n    var originalWidth = width / (1 - left - right);\n    var originalHeight = height / (1 - top - bottom);\n    // Visible size\n    var visibleWidth = beforeCrop ? originalWidth : width;\n    var visibleHeight = beforeCrop ? originalHeight : height;\n    // Target size after crop and rotate\n    var targetWidth = Math.abs(visibleWidth * Math.cos(angle)) + Math.abs(visibleHeight * Math.sin(angle));\n    var targetHeight = Math.abs(visibleWidth * Math.sin(angle)) + Math.abs(visibleHeight * Math.cos(angle));\n    return {\n        targetWidth: targetWidth,\n        targetHeight: targetHeight,\n        originalWidth: originalWidth,\n        originalHeight: originalHeight,\n        visibleWidth: visibleWidth,\n        visibleHeight: visibleHeight,\n    };\n}\n//# sourceMappingURL=getGeneratedImageSize.js.map","import getGeneratedImageSize from './getGeneratedImageSize';\n/**\n * @internal\n * Generate new dataURL from an image and edit info\n * @param image The image to generate data URL from. It is supposed to have original src loaded\n * @param editInfo Edit info of the image\n * @returns A BASE64 encoded string with image prefix that represents the content of the generated image.\n * If there are rotate/crop/resize info in the edit info, the generated image will also reflect the result.\n * It is possible to throw exception since the original image may not be able to read its content from\n * the code, so better check canRegenerateImage() of the image first.\n * @throws Exception when fail to generate dataURL from canvas\n */\nexport default function generateDataURL(image, editInfo) {\n    var angle = editInfo.angleRad, width = editInfo.widthPx, height = editInfo.heightPx, bottom = editInfo.bottomPercent, left = editInfo.leftPercent, right = editInfo.rightPercent, top = editInfo.topPercent, naturalWidth = editInfo.naturalWidth, naturalHeight = editInfo.naturalHeight;\n    var imageWidth = naturalWidth * (1 - left - right);\n    var imageHeight = naturalHeight * (1 - top - bottom);\n    // Adjust the canvas size and scaling for high display resolution\n    var devicePixelRatio = window.devicePixelRatio || 1;\n    var canvas = document.createElement('canvas');\n    var _a = getGeneratedImageSize(editInfo), targetWidth = _a.targetWidth, targetHeight = _a.targetHeight;\n    canvas.width = targetWidth * devicePixelRatio;\n    canvas.height = targetHeight * devicePixelRatio;\n    var context = canvas.getContext('2d');\n    if (context) {\n        context.scale(devicePixelRatio, devicePixelRatio);\n        context.translate(targetWidth / 2, targetHeight / 2);\n        context.rotate(angle);\n        context.scale(editInfo.flippedHorizontal ? -1 : 1, editInfo.flippedVertical ? -1 : 1);\n        context.drawImage(image, naturalWidth * left, naturalHeight * top, imageWidth, imageHeight, -width / 2, -height / 2, width, height);\n    }\n    return canvas.toDataURL('image/png', 1.0);\n}\n//# sourceMappingURL=generateDataURL.js.map","import checkEditInfoState from './checkEditInfoState';\nimport { getMetadata, removeMetadata, setMetadata } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Save edit info to image\n * @param image The image to save edit info to\n * @param editInfo The edit info to save\n */\nexport function saveEditInfo(image, editInfo) {\n    if (image) {\n        setMetadata(image, editInfo);\n    }\n}\n/**\n * @internal\n * Delete edit info of an image if any\n * @param image The image to delete edit info from\n */\nexport function deleteEditInfo(image) {\n    if (image) {\n        removeMetadata(image);\n    }\n}\n/**\n * @internal\n * Get image edit info from an image. If the image doesn't have edit info, create one from this image.\n * When create new edit info, it will have width/height set to the image's current client width/height, and\n * natural width/height set to the image's natural width/height, src set to its current src, and all\n * other fields set to 0.\n * @param image The image to get edit info from\n */\nexport function getEditInfoFromImage(image) {\n    var obj = getMetadata(image);\n    return !obj || checkEditInfoState(obj) == 0 /* Invalid */\n        ? getInitialEditInfo(image)\n        : obj;\n}\nfunction getInitialEditInfo(image) {\n    return {\n        src: image.getAttribute('src') || '',\n        widthPx: image.clientWidth,\n        heightPx: image.clientHeight,\n        naturalWidth: image.naturalWidth,\n        naturalHeight: image.naturalHeight,\n        leftPercent: 0,\n        rightPercent: 0,\n        topPercent: 0,\n        bottomPercent: 0,\n        angleRad: 0,\n    };\n}\n//# sourceMappingURL=editInfo.js.map","import checkEditInfoState from './checkEditInfoState';\nimport generateDataURL from './generateDataURL';\nimport getGeneratedImageSize from './getGeneratedImageSize';\nimport { deleteEditInfo, getEditInfoFromImage, saveEditInfo } from './editInfo';\n/**\n * @internal\n * Apply changes from the edit info of an image, write result to the image\n * @param editor The editor object that contains the image\n * @param image The image to apply the change\n * @param editInfo Edit info that contains the changed information of the image\n * @param previousSrc Last src value of the image before the change was made\n * @param wasResizedOrCropped if the image was resized or cropped apply the new image dimensions\n * @param editingImage (optional) Image in editing state\n */\nexport default function applyChange(editor, image, editInfo, previousSrc, wasResizedOrCropped, editingImage, applyChangesOnMouseUp) {\n    var newSrc = '';\n    var initEditInfo = getEditInfoFromImage(editingImage !== null && editingImage !== void 0 ? editingImage : image);\n    var state = checkEditInfoState(editInfo, initEditInfo);\n    switch (state) {\n        case 1 /* ResizeOnly */:\n            // For resize only case, no need to generate a new image, just reuse the original one\n            newSrc = editInfo.src;\n            break;\n        case 2 /* SameWithLast */:\n            // For SameWithLast case, image may be resized but the content is still the same with last one,\n            // so no need to create a new image, but just reuse last one\n            newSrc = previousSrc;\n            break;\n        case 3 /* FullyChanged */:\n            // For other cases (cropped, rotated, ...) we need to create a new image to reflect the change\n            newSrc = generateDataURL(editingImage !== null && editingImage !== void 0 ? editingImage : image, editInfo);\n            break;\n    }\n    var srcChanged = newSrc != previousSrc;\n    if (srcChanged) {\n        // If the src is changed, fire an EditImage event so that plugins knows that a new image is used, and can\n        // replace the new src with some other string and it will be used and set to the image\n        var event_1 = editor.triggerPluginEvent(19 /* EditImage */, {\n            image: image,\n            originalSrc: editInfo.src,\n            previousSrc: previousSrc,\n            newSrc: newSrc,\n        });\n        newSrc = event_1.newSrc;\n    }\n    else if (applyChangesOnMouseUp) {\n        editor.triggerPluginEvent(7 /* ContentChanged */, {\n            source: \"ImageResize\" /* ImageResize */,\n        });\n    }\n    if (newSrc == editInfo.src) {\n        // If newSrc is the same with original one, it means there is only size change, but no rotation, no cropping,\n        // so we don't need to keep edit info, we can delete it\n        deleteEditInfo(image);\n    }\n    else {\n        // Otherwise, save the new edit info to the image so that next time when we edit the same image, we know\n        // the edit info\n        saveEditInfo(image, editInfo);\n    }\n    // Write back the change to image, and set its new size\n    var _a = getGeneratedImageSize(editInfo), targetWidth = _a.targetWidth, targetHeight = _a.targetHeight;\n    image.src = newSrc;\n    if (wasResizedOrCropped || state == 3 /* FullyChanged */) {\n        image.width = targetWidth;\n        image.height = targetHeight;\n        // Remove width/height style so that it won't affect the image size, since style width/height has higher priority\n        image.style.removeProperty('width');\n        image.style.removeProperty('height');\n        image.style.removeProperty('max-width');\n        image.style.removeProperty('max-height');\n    }\n}\n//# sourceMappingURL=applyChange.js.map","import { __read } from \"tslib\";\nimport { Browser } from 'roosterjs-editor-dom';\n/**\n * Generate event names and getXY function based on different platforms to be compatible with desktop and mobile browsers\n */\nvar MOUSE_EVENT_INFO_DESKTOP = (function () {\n    return {\n        MOUSEDOWN: 'mousedown',\n        MOUSEMOVE: 'mousemove',\n        MOUSEUP: 'mouseup',\n        getPageXY: getMouseEventPageXY,\n    };\n})();\nvar MOUSE_EVENT_INFO_MOBILE = (function () {\n    return {\n        MOUSEDOWN: 'touchstart',\n        MOUSEMOVE: 'touchmove',\n        MOUSEUP: 'touchend',\n        getPageXY: getTouchEventPageXY,\n    };\n})();\nfunction getMouseEventPageXY(e) {\n    return [e.pageX, e.pageY];\n}\nfunction getTouchEventPageXY(e) {\n    var pageX = 0;\n    var pageY = 0;\n    if (e.targetTouches && e.targetTouches.length > 0) {\n        var touch = e.targetTouches[0];\n        pageX = touch.pageX;\n        pageY = touch.pageY;\n    }\n    return [pageX, pageY];\n}\n/**\n * @internal\n * A helper class to help manage drag and drop to an HTML element\n */\nvar DragAndDropHelper = /** @class */ (function () {\n    /**\n     * Create a new instance of DragAndDropHelper class\n     * @param trigger The trigger element. When user start drag on this element,\n     * events will be fired to the handler object\n     * @param context Context object that will be passed to handler function when event is fired,\n     * so that the handler object knows which element it is triggered from.\n     * @param onSubmit A callback that will be invoked when event handler in handler object returns true\n     * @param handler The event handler object, see DragAndDropHandler interface for more information\n     * @param zoomScale The zoom scale of the editor\n     * @param forceMobile A boolean to force the use of touch controls for the helper\n     */\n    function DragAndDropHelper(trigger, context, onSubmit, handler, zoomScale, forceMobile) {\n        var _this = this;\n        this.trigger = trigger;\n        this.context = context;\n        this.onSubmit = onSubmit;\n        this.handler = handler;\n        this.zoomScale = zoomScale;\n        this.initX = 0;\n        this.initY = 0;\n        this.initValue = undefined;\n        this.onMouseDown = function (e) {\n            var _a;\n            var _b, _c;\n            e.preventDefault();\n            e.stopPropagation();\n            _this.addDocumentEvents();\n            _a = __read(_this.dndMouse.getPageXY(e), 2), _this.initX = _a[0], _this.initY = _a[1];\n            _this.initValue = (_c = (_b = _this.handler).onDragStart) === null || _c === void 0 ? void 0 : _c.call(_b, _this.context, e);\n        };\n        this.onMouseMove = function (e) {\n            var _a, _b, _c;\n            e.preventDefault();\n            var _d = __read(_this.dndMouse.getPageXY(e), 2), pageX = _d[0], pageY = _d[1];\n            var deltaX = (pageX - _this.initX) / _this.zoomScale;\n            var deltaY = (pageY - _this.initY) / _this.zoomScale;\n            if (_this.initValue &&\n                ((_b = (_a = _this.handler).onDragging) === null || _b === void 0 ? void 0 : _b.call(_a, _this.context, e, _this.initValue, deltaX, deltaY))) {\n                (_c = _this.onSubmit) === null || _c === void 0 ? void 0 : _c.call(_this, _this.context, _this.trigger);\n            }\n        };\n        this.onMouseUp = function (e) {\n            var _a, _b, _c;\n            e.preventDefault();\n            _this.removeDocumentEvents();\n            if ((_b = (_a = _this.handler).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, _this.context, e, _this.initValue)) {\n                (_c = _this.onSubmit) === null || _c === void 0 ? void 0 : _c.call(_this, _this.context, _this.trigger);\n            }\n        };\n        this.dndMouse =\n            forceMobile || Browser.isMobileOrTablet\n                ? MOUSE_EVENT_INFO_MOBILE\n                : MOUSE_EVENT_INFO_DESKTOP;\n        trigger.addEventListener(this.dndMouse.MOUSEDOWN, this.onMouseDown);\n    }\n    /**\n     * Dispose this object, remove all event listeners that has been attached\n     */\n    DragAndDropHelper.prototype.dispose = function () {\n        this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN, this.onMouseDown);\n        this.removeDocumentEvents();\n    };\n    Object.defineProperty(DragAndDropHelper.prototype, \"mouseType\", {\n        get: function () {\n            return this.dndMouse == MOUSE_EVENT_INFO_MOBILE ? 'touch' : 'mouse';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DragAndDropHelper.prototype.addDocumentEvents = function () {\n        var doc = this.trigger.ownerDocument;\n        doc.addEventListener(this.dndMouse.MOUSEMOVE, this.onMouseMove, true /*useCapture*/);\n        doc.addEventListener(this.dndMouse.MOUSEUP, this.onMouseUp, true /*useCapture*/);\n    };\n    DragAndDropHelper.prototype.removeDocumentEvents = function () {\n        var doc = this.trigger.ownerDocument;\n        doc.removeEventListener(this.dndMouse.MOUSEMOVE, this.onMouseMove, true /*useCapture*/);\n        doc.removeEventListener(this.dndMouse.MOUSEUP, this.onMouseUp, true /*useCapture*/);\n    };\n    return DragAndDropHelper;\n}());\nexport default DragAndDropHelper;\n//# sourceMappingURL=DragAndDropHelper.js.map","import { __assign, __read } from \"tslib\";\nimport { RESIZE_HANDLE_MARGIN, RESIZE_HANDLE_SIZE, Xs, Ys } from '../constants/constants';\nvar HandleTypes;\n(function (HandleTypes) {\n    HandleTypes[HandleTypes[\"SquareHandles\"] = 0] = \"SquareHandles\";\n    HandleTypes[HandleTypes[\"CircularHandlesCorner\"] = 1] = \"CircularHandlesCorner\";\n})(HandleTypes || (HandleTypes = {}));\n/**\n * @internal\n * The resize drag and drop handler\n */\nexport var Resizer = {\n    onDragStart: function (_a) {\n        var editInfo = _a.editInfo;\n        return (__assign({}, editInfo));\n    },\n    onDragging: function (_a, e, base, deltaX, deltaY) {\n        var _b;\n        var x = _a.x, y = _a.y, editInfo = _a.editInfo, options = _a.options;\n        var ratio = base.widthPx > 0 && base.heightPx > 0 ? (base.widthPx * 1.0) / base.heightPx : 0;\n        _b = __read(rotateCoordinate(deltaX, deltaY, editInfo.angleRad), 2), deltaX = _b[0], deltaY = _b[1];\n        if (options.minWidth !== undefined && options.minHeight !== undefined) {\n            var horizontalOnly = x == '';\n            var verticalOnly = y == '';\n            var shouldPreserveRatio = !(horizontalOnly || verticalOnly) && (options.preserveRatio || e.shiftKey);\n            var newWidth = horizontalOnly\n                ? base.widthPx\n                : Math.max(base.widthPx + deltaX * (x == 'w' ? -1 : 1), options.minWidth);\n            var newHeight = verticalOnly\n                ? base.heightPx\n                : Math.max(base.heightPx + deltaY * (y == 'n' ? -1 : 1), options.minHeight);\n            if (shouldPreserveRatio && ratio > 0) {\n                if (ratio > 1) {\n                    // first sure newHeight is rightcalculate newWidth\n                    newWidth = newHeight * ratio;\n                    if (newWidth < options.minWidth) {\n                        newWidth = options.minWidth;\n                        newHeight = newWidth / ratio;\n                    }\n                }\n                else {\n                    // first sure newWidth is rightcalculate newHeight\n                    newHeight = newWidth / ratio;\n                    if (newHeight < options.minHeight) {\n                        newHeight = options.minHeight;\n                        newWidth = newHeight * ratio;\n                    }\n                }\n            }\n            editInfo.widthPx = newWidth;\n            editInfo.heightPx = newHeight;\n            return true;\n        }\n        else {\n            return false;\n        }\n    },\n};\n/**\n * @internal Calculate the rotated x and y distance for mouse moving\n * @param x Original x distance\n * @param y Original y distance\n * @param angle Rotated angle, in radian\n * @returns rotated x and y distances\n */\nexport function rotateCoordinate(x, y, angle) {\n    if (x == 0 && y == 0) {\n        return [0, 0];\n    }\n    var hypotenuse = Math.sqrt(x * x + y * y);\n    angle = Math.atan2(y, x) - angle;\n    return [hypotenuse * Math.cos(angle), hypotenuse * Math.sin(angle)];\n}\n/**\n * @internal\n * Double check if the changed size can satisfy current width of container.\n * When resize an image and preserve ratio, its size can be limited by the size of container.\n * So we need to check the actual size and calculate the size again\n * @param editInfo Edit info of the image\n * @param preserveRatio Whether w/h ratio need to be preserved\n * @param actualWidth Actual width of the image after resize\n * @param actualHeight Actual height of the image after resize\n */\nexport function doubleCheckResize(editInfo, preserveRatio, actualWidth, actualHeight) {\n    var widthPx = editInfo.widthPx, heightPx = editInfo.heightPx;\n    var ratio = heightPx > 0 ? widthPx / heightPx : 0;\n    actualWidth = Math.floor(actualWidth);\n    actualHeight = Math.floor(actualHeight);\n    widthPx = Math.floor(widthPx);\n    heightPx = Math.floor(heightPx);\n    editInfo.widthPx = actualWidth;\n    editInfo.heightPx = actualHeight;\n    if (preserveRatio && ratio > 0 && (widthPx !== actualWidth || heightPx !== actualHeight)) {\n        if (actualWidth < widthPx) {\n            editInfo.heightPx = actualWidth / ratio;\n        }\n        else {\n            editInfo.widthPx = actualHeight * ratio;\n        }\n    }\n}\n/**\n * @internal\n * Get HTML for resize handles at the corners\n */\nexport function getCornerResizeHTML(_a, onShowResizeHandle) {\n    var resizeBorderColor = _a.borderColor;\n    var result = [];\n    Xs.forEach(function (x) {\n        return Ys.forEach(function (y) {\n            var elementData = (x == '') == (y == '')\n                ? getResizeHandleHTML(x, y, resizeBorderColor, 1 /* CircularHandlesCorner */)\n                : null;\n            if (onShowResizeHandle && elementData) {\n                onShowResizeHandle(elementData, x, y);\n            }\n            if (elementData) {\n                result.push(elementData);\n            }\n        });\n    });\n    return result;\n}\n/**\n * @internal\n * Get HTML for resize handles on the sides\n */\nexport function getSideResizeHTML(_a, onShowResizeHandle) {\n    var resizeBorderColor = _a.borderColor;\n    var result = [];\n    Xs.forEach(function (x) {\n        return Ys.forEach(function (y) {\n            var elementData = (x == '') != (y == '')\n                ? getResizeHandleHTML(x, y, resizeBorderColor, 1 /* CircularHandlesCorner */)\n                : null;\n            if (onShowResizeHandle && elementData) {\n                onShowResizeHandle(elementData, x, y);\n            }\n            if (elementData) {\n                result.push(elementData);\n            }\n        });\n    });\n    return result;\n}\n/**\n * @internal\n * Get HTML for resize borders\n */\nexport function getResizeBordersHTML(_a) {\n    var resizeBorderColor = _a.borderColor;\n    return {\n        tag: 'div',\n        style: \"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px \" + resizeBorderColor + \";pointer-events:none;\",\n    };\n}\nfunction getResizeHandleHTML(x, y, borderColor, handleTypes) {\n    var leftOrRight = x == 'w' ? 'left' : 'right';\n    var topOrBottom = y == 'n' ? 'top' : 'bottom';\n    var leftOrRightValue = x == '' ? '50%' : '0px';\n    var topOrBottomValue = y == '' ? '50%' : '0px';\n    var direction = y + x;\n    return x == '' && y == ''\n        ? null\n        : {\n            tag: 'div',\n            style: \"position:absolute;\" + leftOrRight + \":\" + leftOrRightValue + \";\" + topOrBottom + \":\" + topOrBottomValue,\n            children: [\n                {\n                    tag: 'div',\n                    style: setHandleStyle[handleTypes](direction, topOrBottom, leftOrRight, borderColor),\n                    className: \"r_resizeH\" /* ResizeHandle */,\n                    dataset: { x: x, y: y },\n                },\n            ],\n        };\n}\nvar setHandleStyle = {\n    0: function (direction, leftOrRight, topOrBottom, borderColor) {\n        return \"position:relative;width:\" + RESIZE_HANDLE_SIZE + \"px;height:\" + RESIZE_HANDLE_SIZE + \"px;background-color: \" + borderColor + \";cursor:\" + direction + \"-resize;\" + topOrBottom + \":-\" + RESIZE_HANDLE_MARGIN + \"px;\" + leftOrRight + \":-\" + RESIZE_HANDLE_MARGIN + \"px;\";\n    },\n    1: function (direction, leftOrRight, topOrBottom) {\n        return \"position:relative;width:\" + RESIZE_HANDLE_SIZE + \"px;height:\" + RESIZE_HANDLE_SIZE + \"px;background-color: #FFFFFF;cursor:\" + direction + \"-resize;\" + topOrBottom + \":-\" + RESIZE_HANDLE_MARGIN + \"px;\" + leftOrRight + \":-\" + RESIZE_HANDLE_MARGIN + \"px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);\";\n    },\n};\n//# sourceMappingURL=Resizer.js.map","export var RESIZE_HANDLE_SIZE = 10;\nexport var RESIZE_HANDLE_MARGIN = 6;\nexport var ROTATE_SIZE = 32;\nexport var ROTATE_GAP = 15;\nexport var DEG_PER_RAD = 180 / Math.PI;\nexport var DEFAULT_ROTATE_HANDLE_HEIGHT = ROTATE_SIZE / 2 + ROTATE_GAP;\nexport var ROTATE_ICON_MARGIN = 8;\nexport var ROTATION = {\n    sw: 0,\n    nw: 90,\n    ne: 180,\n    se: 270,\n};\nexport var Xs = ['w', '', 'e'];\nexport var Ys = ['s', '', 'n'];\nexport var ROTATE_WIDTH = 1;\nexport var ROTATE_HANDLE_TOP = ROTATE_GAP + RESIZE_HANDLE_MARGIN;\nexport var CROP_HANDLE_SIZE = 22;\nexport var CROP_HANDLE_WIDTH = 7;\nexport var XS_CROP = ['w', 'e'];\nexport var YS_CROP = ['s', 'n'];\nexport var MIN_HEIGHT_WIDTH = 3 * RESIZE_HANDLE_SIZE + 2 * RESIZE_HANDLE_MARGIN;\n//# sourceMappingURL=constants.js.map","import { __assign, __read } from \"tslib\";\nimport { rotateCoordinate } from './Resizer';\nimport { CROP_HANDLE_SIZE, CROP_HANDLE_WIDTH, ROTATION, XS_CROP, YS_CROP, } from '../constants/constants';\n/**\n * @internal\n * Crop handle for DragAndDropHelper\n */\nexport var Cropper = {\n    onDragStart: function (_a) {\n        var editInfo = _a.editInfo;\n        return (__assign({}, editInfo));\n    },\n    onDragging: function (_a, e, base, dx, dy) {\n        var _b;\n        var editInfo = _a.editInfo, x = _a.x, y = _a.y, options = _a.options;\n        _b = __read(rotateCoordinate(dx, dy, editInfo.angleRad), 2), dx = _b[0], dy = _b[1];\n        var widthPx = editInfo.widthPx, heightPx = editInfo.heightPx, leftPercent = editInfo.leftPercent, rightPercent = editInfo.rightPercent, topPercent = editInfo.topPercent, bottomPercent = editInfo.bottomPercent;\n        var minWidth = options.minWidth, minHeight = options.minHeight;\n        var widthPercent = 1 - leftPercent - rightPercent;\n        var heightPercent = 1 - topPercent - bottomPercent;\n        if (widthPercent > 0 &&\n            heightPercent > 0 &&\n            minWidth !== undefined &&\n            minHeight !== undefined) {\n            var fullWidth = widthPx / widthPercent;\n            var fullHeight = heightPx / heightPercent;\n            var newLeft = x != 'e'\n                ? crop(base.leftPercent, dx, fullWidth, rightPercent, minWidth)\n                : leftPercent;\n            var newRight = x != 'w'\n                ? crop(base.rightPercent, -dx, fullWidth, leftPercent, minWidth)\n                : rightPercent;\n            var newTop = y != 's'\n                ? crop(base.topPercent, dy, fullHeight, bottomPercent, minHeight)\n                : topPercent;\n            var newBottom = y != 'n'\n                ? crop(base.bottomPercent, -dy, fullHeight, topPercent, minHeight)\n                : bottomPercent;\n            editInfo.leftPercent = newLeft;\n            editInfo.rightPercent = newRight;\n            editInfo.topPercent = newTop;\n            editInfo.bottomPercent = newBottom;\n            editInfo.widthPx = fullWidth * (1 - newLeft - newRight);\n            editInfo.heightPx = fullHeight * (1 - newTop - newBottom);\n            return true;\n        }\n        else {\n            return false;\n        }\n    },\n};\nfunction crop(basePercentage, deltaValue, fullValue, currentPercentage, minValue) {\n    var maxValue = fullValue * (1 - currentPercentage) - minValue;\n    var newValue = fullValue * basePercentage + deltaValue;\n    var validValue = Math.max(Math.min(newValue, maxValue), 0);\n    return validValue / fullValue;\n}\n/**\n * @internal\n * Get HTML for crop elements, including 4 overlays (to show dark shadow), 1 container and 4 crop handles\n */\nexport function getCropHTML() {\n    var overlayHTML = {\n        tag: 'div',\n        style: 'position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none',\n        className: \"r_cropO\" /* CropOverlay */,\n    };\n    var containerHTML = {\n        tag: 'div',\n        style: 'position:absolute;overflow:hidden',\n        className: \"r_cropC\" /* CropContainer */,\n        children: [],\n    };\n    if (containerHTML) {\n        XS_CROP.forEach(function (x) {\n            return YS_CROP.forEach(function (y) { var _a; return (_a = containerHTML.children) === null || _a === void 0 ? void 0 : _a.push(getCropHTMLInternal(x, y)); });\n        });\n    }\n    return [containerHTML, overlayHTML, overlayHTML, overlayHTML, overlayHTML];\n}\nfunction getCropHTMLInternal(x, y) {\n    var leftOrRight = x == 'w' ? 'left' : 'right';\n    var topOrBottom = y == 'n' ? 'top' : 'bottom';\n    var rotation = ROTATION[y + x];\n    return {\n        tag: 'div',\n        className: \"r_cropH\" /* CropHandle */,\n        style: \"position:absolute;pointer-events:auto;cursor:\" + y + x + \"-resize;\" + leftOrRight + \":0;\" + topOrBottom + \":0;width:\" + CROP_HANDLE_SIZE + \"px;height:\" + CROP_HANDLE_SIZE + \"px;transform:rotate(\" + rotation + \"deg)\",\n        dataset: { x: x, y: y },\n        children: getCropHandleHTML(),\n    };\n}\nfunction getCropHandleHTML() {\n    var result = [];\n    [0, 1].forEach(function (layer) {\n        return [0, 1].forEach(function (dir) {\n            result.push(getCropHandleHTMLInternal(layer, dir));\n        });\n    });\n    return result;\n}\nfunction getCropHandleHTMLInternal(layer, dir) {\n    var position = dir == 0\n        ? \"right:\" + layer + \"px;height:\" + (CROP_HANDLE_WIDTH - layer * 2) + \"px;\"\n        : \"top:\" + layer + \"px;width:\" + (CROP_HANDLE_WIDTH - layer * 2) + \"px;\";\n    var bgColor = layer == 0 ? 'white' : 'black';\n    return {\n        tag: 'div',\n        style: \"position:absolute;left:\" + layer + \"px;bottom:\" + layer + \"px;\" + position + \";background-color:\" + bgColor,\n    };\n}\n//# sourceMappingURL=Cropper.js.map","import { __assign } from \"tslib\";\nimport { DEFAULT_ROTATE_HANDLE_HEIGHT, DEG_PER_RAD, RESIZE_HANDLE_MARGIN, ROTATE_GAP, ROTATE_HANDLE_TOP, ROTATE_ICON_MARGIN, ROTATE_SIZE, ROTATE_WIDTH, } from '../constants/constants';\n/**\n * @internal\n * The rotate drag and drop handler\n */\nexport var Rotator = {\n    onDragStart: function (_a) {\n        var editInfo = _a.editInfo;\n        return (__assign({}, editInfo));\n    },\n    onDragging: function (_a, e, base, deltaX, deltaY) {\n        var editInfo = _a.editInfo, options = _a.options;\n        var distance = editInfo.heightPx / 2 + DEFAULT_ROTATE_HANDLE_HEIGHT;\n        var newX = distance * Math.sin(base.angleRad) + deltaX;\n        var newY = distance * Math.cos(base.angleRad) - deltaY;\n        var angleInRad = Math.atan2(newX, newY);\n        if (!e.altKey && options && options.minRotateDeg !== undefined) {\n            var angleInDeg = angleInRad * DEG_PER_RAD;\n            var adjustedAngleInDeg = Math.round(angleInDeg / options.minRotateDeg) * options.minRotateDeg;\n            angleInRad = adjustedAngleInDeg / DEG_PER_RAD;\n        }\n        if (editInfo.angleRad != angleInRad) {\n            editInfo.angleRad = angleInRad;\n            return true;\n        }\n        else {\n            return false;\n        }\n    },\n};\n/**\n * @internal\n * Move rotate handle. When image is very close to the border of editor, rotate handle may not be visible.\n * Fix it by reduce the distance from image to rotate handle\n */\nexport function updateRotateHandleState(editorRect, angleRad, wrapper, rotateCenter, rotateHandle, isSmallImage) {\n    if (isSmallImage) {\n        rotateCenter.style.display = 'none';\n        rotateHandle.style.display = 'none';\n        return;\n    }\n    else {\n        rotateCenter.style.display = '';\n        rotateHandle.style.display = '';\n        var rotateCenterRect = rotateCenter.getBoundingClientRect();\n        var wrapperRect = wrapper.getBoundingClientRect();\n        var ROTATOR_HEIGHT = ROTATE_SIZE + ROTATE_GAP + RESIZE_HANDLE_MARGIN;\n        if (rotateCenterRect && wrapperRect) {\n            var adjustedDistance = Number.MAX_SAFE_INTEGER;\n            var angle = angleRad * DEG_PER_RAD;\n            if (angle < 45 && angle > -45 && wrapperRect.top - editorRect.top < ROTATOR_HEIGHT) {\n                var top_1 = rotateCenterRect.top - editorRect.top;\n                adjustedDistance = top_1;\n            }\n            else if (angle <= -80 &&\n                angle >= -100 &&\n                wrapperRect.left - editorRect.left < ROTATOR_HEIGHT) {\n                var left = rotateCenterRect.left - editorRect.left;\n                adjustedDistance = left;\n            }\n            else if (angle >= 80 &&\n                angle <= 100 &&\n                editorRect.right - wrapperRect.right < ROTATOR_HEIGHT) {\n                var right = rotateCenterRect.right - editorRect.right;\n                adjustedDistance = Math.min(editorRect.right - wrapperRect.right, right);\n            }\n            else if ((angle <= -160 || angle >= 160) &&\n                editorRect.bottom - wrapperRect.bottom < ROTATOR_HEIGHT) {\n                var bottom = rotateCenterRect.bottom - editorRect.bottom;\n                adjustedDistance = Math.min(editorRect.bottom - wrapperRect.bottom, bottom);\n            }\n            var rotateGap = Math.max(Math.min(ROTATE_GAP, adjustedDistance), 0);\n            var rotateTop = Math.max(Math.min(ROTATE_SIZE, adjustedDistance - rotateGap), 0);\n            rotateCenter.style.top = -rotateGap - RESIZE_HANDLE_MARGIN + 'px';\n            rotateCenter.style.height = rotateGap + 'px';\n            rotateHandle.style.top = -rotateTop + 'px';\n        }\n    }\n}\n/**\n * @internal\n * Get HTML for rotate elements, including the rotate handle with icon, and a line between the handle and the image\n */\nexport function getRotateHTML(_a) {\n    var borderColor = _a.borderColor, rotateHandleBackColor = _a.rotateHandleBackColor;\n    var handleLeft = ROTATE_SIZE / 2;\n    return [\n        {\n            tag: 'div',\n            className: \"r_rotateC\" /* RotateCenter */,\n            style: \"position:absolute;left:50%;width:1px;background-color:\" + borderColor + \";top:\" + -ROTATE_HANDLE_TOP + \"px;height:\" + ROTATE_GAP + \"px;margin-left:\" + -ROTATE_WIDTH + \"px;\",\n            children: [\n                {\n                    tag: 'div',\n                    className: \"r_rotateH\" /* RotateHandle */,\n                    style: \"position:absolute;background-color:\" + rotateHandleBackColor + \";border:solid 1px \" + borderColor + \";border-radius:50%;width:\" + ROTATE_SIZE + \"px;height:\" + ROTATE_SIZE + \"px;left:-\" + (handleLeft + ROTATE_WIDTH) + \"px;cursor:move;top:\" + -ROTATE_SIZE + \"px;\",\n                    children: [getRotateIconHTML(borderColor)],\n                },\n            ],\n        },\n    ];\n}\nfunction getRotateIconHTML(borderColor) {\n    var _a;\n    return {\n        tag: 'svg',\n        namespace: 'http://www.w3.org/2000/svg',\n        style: \"width:16px;height:16px;margin: \" + ROTATE_ICON_MARGIN + \"px \" + ROTATE_ICON_MARGIN + \"px\",\n        children: [\n            {\n                tag: 'path',\n                namespace: 'http://www.w3.org/2000/svg',\n                attributes: (_a = {\n                        d: 'M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3',\n                        transform: 'matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)'\n                    },\n                    _a['fill-opacity'] = '0',\n                    _a.stroke = borderColor,\n                    _a),\n            },\n            {\n                tag: 'path',\n                namespace: 'http://www.w3.org/2000/svg',\n                attributes: {\n                    d: 'M12.0 3.648l.884-.884.53 2.298-2.298-.53z',\n                    stroke: borderColor,\n                },\n            },\n        ],\n    };\n}\n//# sourceMappingURL=Rotator.js.map","var _a;\nimport { __assign, __read, __spreadArray } from \"tslib\";\nimport applyChange from './editInfoUtils/applyChange';\nimport canRegenerateImage from './api/canRegenerateImage';\nimport DragAndDropHelper from '../../pluginUtils/DragAndDropHelper';\nimport getGeneratedImageSize from './editInfoUtils/getGeneratedImageSize';\nimport { Cropper, getCropHTML } from './imageEditors/Cropper';\nimport { deleteEditInfo, getEditInfoFromImage } from './editInfoUtils/editInfo';\nimport { getRotateHTML, Rotator, updateRotateHandleState } from './imageEditors/Rotator';\nimport { MIN_HEIGHT_WIDTH } from './constants/constants';\nimport { tryToConvertGifToPng } from './editInfoUtils/tryToConvertGifToPng';\nimport { arrayPush, Browser, createElement, getComputedStyle, getObjectKeys, safeInstanceOf, toArray, unwrap, wrap, } from 'roosterjs-editor-dom';\nimport { Resizer, doubleCheckResize, getSideResizeHTML, getCornerResizeHTML, getResizeBordersHTML, } from './imageEditors/Resizer';\nvar PI = Math.PI;\nvar DIRECTIONS = 8;\nvar DirectionRad = (PI * 2) / DIRECTIONS;\nvar DirectionOrder = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];\n/**\n * Default image edit options\n */\nvar DefaultOptions = {\n    borderColor: '#DB626C',\n    minWidth: 10,\n    minHeight: 10,\n    preserveRatio: false,\n    minRotateDeg: 5,\n    imageSelector: 'img',\n    rotateIconHTML: '',\n    disableCrop: false,\n    disableRotate: false,\n    disableSideResize: false,\n    onSelectState: 7 /* ResizeAndRotate */,\n    applyChangesOnMouseUp: false,\n};\n/**\n * Map the image edit operation to a function that returns editing elements HTML to help\n * build image editing UI\n */\nvar ImageEditHTMLMap = (_a = {},\n    _a[1 /* CornerResize */] = getCornerResizeHTML,\n    _a[2 /* SideResize */] = getSideResizeHTML,\n    _a[4 /* Rotate */] = getRotateHTML,\n    _a[8 /* Crop */] = getCropHTML,\n    _a);\n/**\n * Default background colors for rotate handle\n */\nvar LIGHT_MODE_BGCOLOR = 'white';\nvar DARK_MODE_BGCOLOR = '#333';\n/**\n * ImageEdit plugin provides the ability to edit an inline image in editor, including image resizing, rotation and cropping\n */\nvar ImageEdit = /** @class */ (function () {\n    /**\n     * Create a new instance of ImageEdit\n     * @param options Image editing options\n     * @param onShowResizeHandle An optional callback to allow customize resize handle element of image resizing.\n     * To customize the resize handle element, add this callback and change the attributes of elementData then it\n     * will be picked up by ImageEdit code\n     */\n    function ImageEdit(options, onShowResizeHandle) {\n        var _this = this;\n        this.onShowResizeHandle = onShowResizeHandle;\n        this.editor = null;\n        this.disposer = null;\n        // Current editing image\n        this.image = null;\n        // Image cloned from the current editing image\n        this.clonedImage = null;\n        // The image wrapper\n        this.wrapper = null;\n        // Current edit info of the image. All changes user made will be stored in this object.\n        // We use this object to update the editing UI, and finally we will use this object to generate\n        // the new image if necessary\n        this.editInfo = null;\n        // Src of the image before current editing\n        this.lastSrc = null;\n        // Drag and drop helper objects\n        this.dndHelpers = [];\n        /**\n         * Identify if the image was resized by the user.\n         */\n        this.wasResized = false;\n        /**\n         * The span element that wraps the image and opens shadow dom\n         */\n        this.shadowSpan = null;\n        /**\n         * The span element that wraps the image and opens shadow dom\n         */\n        this.isCropping = false;\n        /**\n         * If the image is a gif, this is the png source of the gif image\n         */\n        this.pngSource = null;\n        /**\n         * quit editing mode when editor lose focus\n         */\n        this.onBlur = function () {\n            _this.setEditingImage(null, false /* selectImage */);\n        };\n        /**\n         * Remove the temp wrapper of the image\n         */\n        this.removeWrapper = function () {\n            var _a;\n            if (_this.shadowSpan) {\n                unwrap(_this.shadowSpan);\n            }\n            if (_this.options.applyChangesOnMouseUp) {\n                (_a = _this.wrapper) === null || _a === void 0 ? void 0 : _a.removeEventListener('mouseup', _this.changesWhenMouseUp, true /* useCapture*/);\n            }\n            _this.wrapper = null;\n            _this.shadowSpan = null;\n        };\n        this.changesWhenMouseUp = function () {\n            if (_this.editor && _this.image && _this.editInfo && _this.lastSrc && _this.clonedImage) {\n                applyChange(_this.editor, _this.image, _this.editInfo, _this.lastSrc, _this.wasResized, _this.clonedImage, _this.options.applyChangesOnMouseUp);\n            }\n        };\n        /**\n         * Update image edit elements to reflect current editing result\n         * @param context\n         */\n        this.updateWrapper = function (context) {\n            var _a, _b;\n            var wrapper = _this.wrapper;\n            if (wrapper &&\n                _this.editInfo &&\n                _this.image &&\n                _this.clonedImage &&\n                _this.options &&\n                ((_a = _this.shadowSpan) === null || _a === void 0 ? void 0 : _a.parentElement)) {\n                // Prepare: get related editing elements\n                var cropContainers = getEditElements(wrapper, \"r_cropC\" /* CropContainer */);\n                var cropOverlays = getEditElements(wrapper, \"r_cropO\" /* CropOverlay */);\n                var resizeHandles = getEditElements(wrapper, \"r_resizeH\" /* ResizeHandle */);\n                var rotateCenter = getEditElements(wrapper, \"r_rotateC\" /* RotateCenter */)[0];\n                var rotateHandle = getEditElements(wrapper, \"r_rotateH\" /* RotateHandle */)[0];\n                var cropHandles = getEditElements(wrapper, \"r_cropH\" /* CropHandle */);\n                // Cropping and resizing will show different UI, so check if it is cropping here first\n                _this.isCropping = cropContainers.length == 1 && cropOverlays.length == 4;\n                var _c = _this.editInfo, angleRad = _c.angleRad, bottomPercent = _c.bottomPercent, leftPercent = _c.leftPercent, rightPercent = _c.rightPercent, topPercent = _c.topPercent, flippedHorizontal = _c.flippedHorizontal, flippedVertical = _c.flippedVertical;\n                // Width/height of the image\n                var _d = getGeneratedImageSize(_this.editInfo, _this.isCropping), targetWidth = _d.targetWidth, targetHeight = _d.targetHeight, originalWidth = _d.originalWidth, originalHeight = _d.originalHeight, visibleWidth = _d.visibleWidth, visibleHeight = _d.visibleHeight;\n                var marginHorizontal = (targetWidth - visibleWidth) / 2;\n                var marginVertical = (targetHeight - visibleHeight) / 2;\n                var cropLeftPx = originalWidth * leftPercent;\n                var cropRightPx = originalWidth * rightPercent;\n                var cropTopPx = originalHeight * topPercent;\n                var cropBottomPx = originalHeight * bottomPercent;\n                // Update size and margin of the wrapper\n                wrapper.style.margin = marginVertical + \"px \" + marginHorizontal + \"px\";\n                wrapper.style.transform = \"rotate(\" + angleRad + \"rad)\";\n                setWrapperSizeDimensions(wrapper, _this.image, visibleWidth, visibleHeight);\n                // Update the text-alignment to avoid the image to overflow if the parent element have align center or right\n                // or if the direction is Right To Left\n                wrapper.style.textAlign = isRtl(_this.shadowSpan.parentElement) ? 'right' : 'left';\n                // Update size of the image\n                _this.clonedImage.style.width = getPx(originalWidth);\n                _this.clonedImage.style.height = getPx(originalHeight);\n                //Update flip direction\n                setFlipped(_this.clonedImage.parentElement, flippedHorizontal, flippedVertical);\n                if (_this.isCropping) {\n                    // For crop, we also need to set position of the overlays\n                    setSize(cropContainers[0], cropLeftPx, cropTopPx, cropRightPx, cropBottomPx, undefined, undefined);\n                    setSize(cropOverlays[0], 0, 0, cropRightPx, undefined, undefined, cropTopPx);\n                    setSize(cropOverlays[1], undefined, 0, 0, cropBottomPx, cropRightPx, undefined);\n                    setSize(cropOverlays[2], cropLeftPx, undefined, 0, 0, undefined, cropBottomPx);\n                    setSize(cropOverlays[3], 0, cropTopPx, undefined, 0, cropLeftPx, undefined);\n                    updateHandleCursor(cropHandles, angleRad);\n                }\n                else {\n                    // For rotate/resize, set the margin of the image so that cropped part won't be visible\n                    _this.clonedImage.style.margin = -cropTopPx + \"px 0 0 \" + -cropLeftPx + \"px\";\n                    // Double check resize\n                    if ((context === null || context === void 0 ? void 0 : context.elementClass) == \"r_resizeH\" /* ResizeHandle */) {\n                        var clientWidth = wrapper.clientWidth;\n                        var clientHeight = wrapper.clientHeight;\n                        _this.wasResized = true;\n                        doubleCheckResize(_this.editInfo, _this.options.preserveRatio || false, clientWidth, clientHeight);\n                        _this.updateWrapper();\n                    }\n                    var viewport = (_b = _this.editor) === null || _b === void 0 ? void 0 : _b.getVisibleViewport();\n                    var isSmall = isASmallImage(targetWidth, targetHeight);\n                    if (rotateHandle && rotateCenter && viewport) {\n                        updateRotateHandleState(viewport, angleRad, wrapper, rotateCenter, rotateHandle, isSmall);\n                    }\n                    updateSideHandlesVisibility(resizeHandles, isSmall);\n                    updateHandleCursor(resizeHandles, angleRad);\n                }\n            }\n        };\n        this.options = __assign(__assign({}, DefaultOptions), (options || {}));\n        this.allowedOperations =\n            1 /* CornerResize */ |\n                (this.options.disableCrop ? 0 : 8 /* Crop */) |\n                (this.options.disableRotate ? 0 : 4 /* Rotate */) |\n                (this.options.disableSideResize ? 0 : 2 /* SideResize */);\n    }\n    /**\n     * Get a friendly name of this plugin\n     */\n    ImageEdit.prototype.getName = function () {\n        return 'ImageEdit';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    ImageEdit.prototype.initialize = function (editor) {\n        var _this = this;\n        this.editor = editor;\n        this.disposer = editor.addDomEventHandler({\n            blur: function () { return _this.onBlur(); },\n            dragstart: function (e) {\n                if (_this.image) {\n                    e.preventDefault();\n                }\n            },\n        });\n    };\n    /**\n     * Dispose this plugin\n     */\n    ImageEdit.prototype.dispose = function () {\n        var _a;\n        this.clearDndHelpers();\n        (_a = this.disposer) === null || _a === void 0 ? void 0 : _a.call(this);\n        this.disposer = null;\n        this.editor = null;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param e PluginEvent object\n     */\n    ImageEdit.prototype.onPluginEvent = function (e) {\n        var _a;\n        switch (e.eventType) {\n            case 22 /* SelectionChanged */:\n                if (e.selectionRangeEx &&\n                    e.selectionRangeEx.type === 2 /* ImageSelection */ &&\n                    this.options &&\n                    this.options.onSelectState !== undefined) {\n                    this.setEditingImage(e.selectionRangeEx.image, this.options.onSelectState);\n                }\n                break;\n            case 5 /* MouseDown */:\n                // When left click in a image that already in editing mode, do not quit edit mode\n                var mouseTarget = e.rawEvent.target;\n                var button = e.rawEvent.button;\n                if (this.shadowSpan !== mouseTarget ||\n                    (this.shadowSpan === mouseTarget && button !== 0) ||\n                    this.isCropping) {\n                    this.setEditingImage(null);\n                }\n                break;\n            case 6 /* MouseUp */:\n                if (this.editor && this.image && this.shadowSpan) {\n                    // When mouse up, if the image and the shadow span exists, the editing mode is on.\n                    // To make sure the selection did not jump to the shadow root, reselect the image.\n                    this.editor.select(this.image);\n                }\n                break;\n            case 0 /* KeyDown */:\n                this.setEditingImage(null);\n                break;\n            case 7 /* ContentChanged */:\n                //After contentChanged event, the current image wrapper may not be valid any more, remove all of them if any\n                this.removeWrapper();\n                break;\n            case 8 /* ExtractContentWithDom */:\n                // When extract content, remove all image info since they may not be valid when load the content again\n                if ((_a = this.options) === null || _a === void 0 ? void 0 : _a.imageSelector) {\n                    toArray(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach(function (img) {\n                        deleteEditInfo(img);\n                    });\n                }\n                break;\n            case 12 /* BeforeDispose */:\n                this.removeWrapper();\n                break;\n        }\n    };\n    /**\n     * Check if the given image edit operation is allowed by this plugin\n     * @param operation The image edit operation to check\n     * @returns True means it is allowed, otherwise false\n     */\n    ImageEdit.prototype.isOperationAllowed = function (operation) {\n        return !!(this.allowedOperations & operation);\n    };\n    ImageEdit.prototype.setEditingImage = function (image, operationOrSelect) {\n        var _this = this;\n        var operation = typeof operationOrSelect === 'number' ? operationOrSelect : 0 /* None */;\n        var selectImage = typeof operationOrSelect === 'number' ? false : !!operationOrSelect;\n        if (!image &&\n            this.image &&\n            this.editor &&\n            this.editInfo &&\n            this.lastSrc &&\n            this.clonedImage) {\n            // When there is image in editing, clean up any cached objects and elements\n            this.clearDndHelpers();\n            // If the image is a gif we change the editing image to a new png image, then we need to change the\n            // image source to the original gif image\n            if (this.pngSource) {\n                this.clonedImage.src = this.editInfo.src;\n            }\n            // Apply the changes, and add undo snapshot if necessary\n            applyChange(this.editor, this.image, this.editInfo, this.lastSrc, this.wasResized || this.isCropping, this.clonedImage);\n            // Remove editing wrapper\n            this.removeWrapper();\n            this.editor.addUndoSnapshot(function () { return _this.image; }, \"ImageResize\" /* ImageResize */);\n            if (selectImage) {\n                this.editor.select(this.image);\n            }\n            this.pngSource = null;\n            this.image = null;\n            this.editInfo = null;\n            this.lastSrc = null;\n            this.clonedImage = null;\n            this.isCropping = false;\n        }\n        if (!this.image && (image === null || image === void 0 ? void 0 : image.isContentEditable) && this.editor) {\n            // If there is new image to edit, enter editing mode for this image\n            this.editor.addUndoSnapshot();\n            this.image = image;\n            // Get initial edit info\n            this.editInfo = getEditInfoFromImage(image);\n            //Check if the image is a gif and convert it to a png\n            this.pngSource = tryToConvertGifToPng(this.editInfo);\n            //Check if the image was resized by the user\n            this.wasResized = checkIfImageWasResized(this.image);\n            operation =\n                (canRegenerateImage(image) ? operation : 3 /* Resize */) &\n                    this.allowedOperations;\n            // Create and update editing wrapper and elements\n            this.createWrapper(operation);\n            this.updateWrapper();\n            // Init drag and drop\n            this.dndHelpers = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(this.createDndHelpers(\"r_resizeH\" /* ResizeHandle */, Resizer)), false), __read(this.createDndHelpers(\"r_rotateH\" /* RotateHandle */, Rotator)), false), __read(this.createDndHelpers(\"r_cropH\" /* CropHandle */, Cropper)), false), __read(this.createDndHelpers(\"r_cropC\" /* CropContainer */, Cropper)), false);\n            this.editor.select(this.image);\n        }\n    };\n    /**\n     * Flip the image.\n     * @param image The image to be flipped\n     * @param direction\n     */\n    ImageEdit.prototype.flipImage = function (image, direction) {\n        var _a;\n        this.image = image;\n        this.editInfo = getEditInfoFromImage(image);\n        var angleRad = this.editInfo.angleRad;\n        var isInVerticalPostion = (angleRad >= Math.PI / 2 && angleRad < (3 * Math.PI) / 4) ||\n            (angleRad <= -Math.PI / 2 && angleRad > (-3 * Math.PI) / 4);\n        if (isInVerticalPostion) {\n            if (direction === 'horizontal') {\n                this.editInfo.flippedVertical = !this.editInfo.flippedVertical;\n            }\n            else {\n                this.editInfo.flippedHorizontal = !this.editInfo.flippedHorizontal;\n            }\n        }\n        else {\n            if (direction === 'vertical') {\n                this.editInfo.flippedVertical = !this.editInfo.flippedVertical;\n            }\n            else {\n                this.editInfo.flippedHorizontal = !this.editInfo.flippedHorizontal;\n            }\n        }\n        this.createWrapper(4 /* Rotate */);\n        this.updateWrapper();\n        this.setEditingImage(null);\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.select(image);\n    };\n    /**\n     * Rotate the image in radian angle.\n     * @param image The image to be rotated\n     * @param angleRad The angle in radian that the image must be rotated.\n     */\n    ImageEdit.prototype.rotateImage = function (image, angleRad) {\n        var _a;\n        this.image = image;\n        this.editInfo = getEditInfoFromImage(image);\n        this.editInfo.angleRad = this.editInfo.angleRad + angleRad;\n        this.createWrapper(4 /* Rotate */);\n        this.updateWrapper();\n        this.setEditingImage(null);\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.select(image);\n    };\n    /**\n     * Create editing wrapper for the image\n     */\n    ImageEdit.prototype.createWrapper = function (operation) {\n        var _this = this;\n        var _a, _b, _c;\n        if (this.image && this.editor && this.options && this.editInfo) {\n            //Clone the image and insert the clone in a entity\n            this.clonedImage = this.image.cloneNode(true);\n            this.clonedImage.removeAttribute('id');\n            this.clonedImage.style.removeProperty('max-width');\n            this.clonedImage.style.removeProperty('max-height');\n            this.clonedImage.style.width = this.editInfo.widthPx + 'px';\n            this.clonedImage.style.height = this.editInfo.heightPx + 'px';\n            this.wrapper = createElement(6 /* ImageEditWrapper */, this.image.ownerDocument);\n            (_b = (_a = this.wrapper) === null || _a === void 0 ? void 0 : _a.firstChild) === null || _b === void 0 ? void 0 : _b.appendChild(this.clonedImage);\n            this.wrapper.style.display = Browser.isSafari ? 'inline-block' : 'inline-flex';\n            // Cache current src so that we can compare it after edit see if src is changed\n            this.lastSrc = this.image.getAttribute('src');\n            // Set image src to original src to help show editing UI, also it will be used when regenerate image dataURL after editing\n            if (this.clonedImage) {\n                this.clonedImage.src = (_c = this.pngSource) !== null && _c !== void 0 ? _c : this.editInfo.src;\n                this.clonedImage.style.position = 'absolute';\n            }\n            // Get HTML for all edit elements (resize handle, rotate handle, crop handle and overlay, ...) and create HTML element\n            var options_1 = {\n                borderColor: getColorString(this.options.borderColor, this.editor.isDarkMode()),\n                rotateIconHTML: this.options.rotateIconHTML,\n                rotateHandleBackColor: this.editor.isDarkMode()\n                    ? DARK_MODE_BGCOLOR\n                    : LIGHT_MODE_BGCOLOR,\n                isSmallImage: isASmallImage(this.editInfo.widthPx, this.editInfo.heightPx),\n            };\n            var htmlData_1 = [getResizeBordersHTML(options_1)];\n            getObjectKeys(ImageEditHTMLMap).forEach(function (thisOperation) {\n                var element = ImageEditHTMLMap[thisOperation](options_1, _this.onShowResizeHandle);\n                if ((operation & thisOperation) == thisOperation && element) {\n                    arrayPush(htmlData_1, element);\n                }\n            });\n            htmlData_1.forEach(function (data) {\n                var element = createElement(data, _this.image.ownerDocument);\n                if (element && _this.wrapper) {\n                    _this.wrapper.appendChild(element);\n                }\n            });\n            this.insertImageWrapper(this.wrapper);\n        }\n    };\n    /**\n     * EXPORTED FOR TESTING PURPOSES ONLY\n     * @param wrapper\n     */\n    ImageEdit.prototype.insertImageWrapper = function (wrapper) {\n        if (this.image) {\n            this.shadowSpan = wrap(this.image, 'span');\n            if (this.shadowSpan) {\n                var shadowRoot = this.shadowSpan.attachShadow({\n                    mode: 'open',\n                });\n                this.shadowSpan.style.verticalAlign = 'bottom';\n                wrapper.style.fontSize = '24px';\n                if (this.options.applyChangesOnMouseUp) {\n                    wrapper.addEventListener('mouseup', this.changesWhenMouseUp, true /* useCapture*/);\n                }\n                shadowRoot.appendChild(wrapper);\n            }\n        }\n    };\n    /**\n     * Create drag and drop helpers\n     * @param wrapper\n     * @param elementClass\n     * @param dragAndDrop\n     */\n    ImageEdit.prototype.createDndHelpers = function (elementClass, dragAndDrop) {\n        var _this = this;\n        var wrapper = this.wrapper;\n        return wrapper && this.editInfo\n            ? getEditElements(wrapper, elementClass).map(function (element) {\n                return new DragAndDropHelper(element, {\n                    editInfo: _this.editInfo,\n                    options: _this.options,\n                    elementClass: elementClass,\n                    x: element.dataset.x,\n                    y: element.dataset.y,\n                }, _this.updateWrapper, dragAndDrop, _this.editor ? _this.editor.getZoomScale() : 1);\n            })\n            : [];\n    };\n    /**\n     * Clean up drag and drop helpers\n     */\n    ImageEdit.prototype.clearDndHelpers = function () {\n        var _a;\n        (_a = this.dndHelpers) === null || _a === void 0 ? void 0 : _a.forEach(function (helper) { return helper.dispose(); });\n        this.dndHelpers = [];\n    };\n    return ImageEdit;\n}());\nexport default ImageEdit;\nfunction setSize(element, left, top, right, bottom, width, height) {\n    element.style.left = left !== undefined ? getPx(left) : element.style.left;\n    element.style.top = top !== undefined ? getPx(top) : element.style.top;\n    element.style.right = right !== undefined ? getPx(right) : element.style.right;\n    element.style.bottom = bottom !== undefined ? getPx(bottom) : element.style.bottom;\n    element.style.width = width !== undefined ? getPx(width) : element.style.width;\n    element.style.height = height !== undefined ? getPx(height) : element.style.height;\n}\nfunction setWrapperSizeDimensions(wrapper, image, width, height) {\n    var hasBorder = image.style.borderStyle;\n    if (hasBorder) {\n        var borderWidth = image.style.borderWidth ? 2 * parseInt(image.style.borderWidth) : 2;\n        wrapper.style.width = getPx(width + borderWidth);\n        wrapper.style.height = getPx(height + borderWidth);\n        return;\n    }\n    wrapper.style.width = getPx(width);\n    wrapper.style.height = getPx(height);\n}\nfunction getPx(value) {\n    return value + 'px';\n}\nfunction getEditElements(wrapper, elementClass) {\n    return toArray(wrapper.querySelectorAll('.' + elementClass));\n}\nfunction isRtl(element) {\n    return safeInstanceOf(element, 'HTMLElement')\n        ? getComputedStyle(element, 'direction') == 'rtl'\n        : false;\n}\nfunction handleRadIndexCalculator(angleRad) {\n    var idx = Math.round(angleRad / DirectionRad) % DIRECTIONS;\n    return idx < 0 ? idx + DIRECTIONS : idx;\n}\nfunction rotateHandles(angleRad, y, x) {\n    if (y === void 0) { y = ''; }\n    if (x === void 0) { x = ''; }\n    var radIndex = handleRadIndexCalculator(angleRad);\n    var originalDirection = y + x;\n    var originalIndex = DirectionOrder.indexOf(originalDirection);\n    var rotatedIndex = originalIndex >= 0 && originalIndex + radIndex;\n    return rotatedIndex ? DirectionOrder[rotatedIndex % DIRECTIONS] : '';\n}\n/**\n * Rotate the resizer and cropper handles according to the image position.\n * @param handles The resizer handles.\n * @param angleRad The angle that the image was rotated.\n */\nfunction updateHandleCursor(handles, angleRad) {\n    handles.forEach(function (handle) {\n        var _a = handle.dataset, y = _a.y, x = _a.x;\n        handle.style.cursor = rotateHandles(angleRad, y, x) + \"-resize\";\n    });\n}\nfunction updateSideHandlesVisibility(handles, isSmall) {\n    handles.forEach(function (handle) {\n        var _a = handle.dataset, y = _a.y, x = _a.x;\n        var coordinate = (y !== null && y !== void 0 ? y : '') + (x !== null && x !== void 0 ? x : '');\n        var directions = ['n', 's', 'e', 'w'];\n        var isSideHandle = directions.indexOf(coordinate) > -1;\n        handle.style.display = isSideHandle && isSmall ? 'none' : '';\n    });\n}\n/**\n * Check if the current image was resized by the user\n * @param image the current image\n * @returns if the user resized the image, returns true, otherwise, returns false\n */\nfunction checkIfImageWasResized(image) {\n    var width = image.width, height = image.height, style = image.style;\n    var isMaxWidthInitial = style.maxWidth === '' || style.maxWidth === 'initial' || style.maxWidth === 'auto';\n    if (isMaxWidthInitial &&\n        (isFixedNumberValue(style.height) ||\n            isFixedNumberValue(style.width) ||\n            isFixedNumberValue(width) ||\n            isFixedNumberValue(height))) {\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nfunction isFixedNumberValue(value) {\n    var numberValue = typeof value === 'string' ? parseInt(value) : value;\n    return !isNaN(numberValue);\n}\nfunction isASmallImage(widthPx, heightPx) {\n    return widthPx && heightPx && (widthPx < MIN_HEIGHT_WIDTH || heightPx < MIN_HEIGHT_WIDTH)\n        ? true\n        : false;\n}\nfunction getColorString(color, isDarkMode) {\n    if (typeof color === 'string') {\n        return color.trim();\n    }\n    return isDarkMode ? color.darkModeColor.trim() : color.lightModeColor.trim();\n}\nfunction setFlipped(element, flippedHorizontally, flippedVertically) {\n    if (element) {\n        element.style.transform = \"scale(\" + (flippedHorizontally ? -1 : 1) + \", \" + (flippedVertically ? -1 : 1) + \")\";\n    }\n}\n//# sourceMappingURL=ImageEdit.js.map","import generateDataURL from './generateDataURL';\n/**\n * @internal\n * Check if the image is a gif, if true, use canvas to convert it to a png.\n * If the image is not a gif, return null.\n * @param image to be converted\n * @returns the converted image data url or null, if the image is not a gif\n */\nexport function tryToConvertGifToPng(editInfo) {\n    var src = editInfo.src, widthPx = editInfo.widthPx, heightPx = editInfo.heightPx, naturalHeight = editInfo.naturalHeight, naturalWidth = editInfo.naturalWidth;\n    if (src.indexOf('.gif') > -1 || src.indexOf('image/gif') > -1) {\n        try {\n            var image = document.createElement('img');\n            image.src = src;\n            var newEditInfo = {\n                src: src,\n                widthPx: widthPx,\n                heightPx: heightPx,\n                naturalWidth: naturalWidth,\n                naturalHeight: naturalHeight,\n                leftPercent: 0,\n                rightPercent: 0,\n                topPercent: 0,\n                bottomPercent: 0,\n                angleRad: 0,\n            };\n            return generateDataURL(image, newEditInfo);\n        }\n        catch (_a) {\n            return null;\n        }\n    }\n    return null;\n}\n//# sourceMappingURL=tryToConvertGifToPng.js.map","/**\n * Check if we can regenerate edited image from the source image.\n * An image can't regenerate result when there is CORS issue of the source content.\n * @param img The image element to test\n * @returns True when we can regenerate the edited image, otherwise false\n */\nexport default function canRegenerateImage(img) {\n    if (!img) {\n        return false;\n    }\n    try {\n        var canvas = img.ownerDocument.createElement('canvas');\n        canvas.width = 10;\n        canvas.height = 10;\n        var context = canvas.getContext('2d');\n        if (context) {\n            context.drawImage(img, 0, 0);\n            context.getImageData(0, 0, 1, 1);\n            return true;\n        }\n        return false;\n    }\n    catch (_a) {\n        return false;\n    }\n}\n//# sourceMappingURL=canRegenerateImage.js.map","import { changeElementTag, getTagOfNode, toArray, wrap, safeInstanceOf, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Convert content copied from Teams to be well-formed\n */\nexport default function convertPastedContentForLI(fragment) {\n    // Sometimes it is possible that we get LI nodes directly under DIV.\n    // In that case we need to convert DIV to UL. It is also possible to be OL, but we don't know it.\n    // So always assume it is UL here, and later user can change it.\n    if (isPureLiNode(fragment)) {\n        wrap(toArray(fragment.childNodes), 'UL');\n    }\n    else if (safeInstanceOf(fragment.firstChild, 'HTMLElement') &&\n        isPureLiNode(fragment.firstChild)) {\n        changeElementTag(fragment.firstChild, 'UL');\n    }\n}\nfunction isPureLiNode(node) {\n    if (node && !node.nextSibling && ['OL', 'UL', 'MENU'].indexOf(getTagOfNode(node)) < 0) {\n        var hasLi_1 = false;\n        if (toArray(node.childNodes).every(function (childNode) {\n            var _a;\n            if (safeInstanceOf(childNode, 'Text') && !((_a = childNode.nodeValue) === null || _a === void 0 ? void 0 : _a.trim())) {\n                return true;\n            }\n            else if (getTagOfNode(childNode) == 'LI') {\n                hasLi_1 = true;\n                return true;\n            }\n            else {\n                return false;\n            }\n        }) &&\n            hasLi_1) {\n            return true;\n        }\n    }\n    return false;\n}\n//# sourceMappingURL=convertPastedContentForLI.js.map","import { __extends } from \"tslib\";\nimport ImageEdit from '../ImageEdit/ImageEdit';\n/**\n * @deprecated Use ImageEdit plugin instead\n */\nvar ImageResize = /** @class */ (function (_super) {\n    __extends(ImageResize, _super);\n    /**\n     * Create a new instance of ImageResize\n     * @param minWidth Minimum width of image when resize in pixel, default value is 10\n     * @param minHeight Minimum height of image when resize in pixel, default value is 10\n     * @param selectionBorderColor Color of resize border and handles, default value is #DB626C\n     * @param forcePreserveRatio Whether always preserve width/height ratio when resize, default value is false\n     * @param resizableImageSelector Selector for picking which image is resizable (e.g. for all images not placeholders), note\n     * that the tag must be IMG regardless what the selector is\n     */\n    function ImageResize(minWidth, minHeight, selectionBorderColor, forcePreserveRatio, resizableImageSelector) {\n        if (minWidth === void 0) { minWidth = 10; }\n        if (minHeight === void 0) { minHeight = 10; }\n        if (selectionBorderColor === void 0) { selectionBorderColor = '#DB626C'; }\n        if (forcePreserveRatio === void 0) { forcePreserveRatio = false; }\n        if (resizableImageSelector === void 0) { resizableImageSelector = 'img'; }\n        return _super.call(this, {\n            minHeight: minHeight,\n            minWidth: minWidth,\n            borderColor: selectionBorderColor,\n            preserveRatio: forcePreserveRatio,\n            imageSelector: resizableImageSelector,\n        }) || this;\n    }\n    /**\n     * @deprecated\n     */\n    ImageResize.prototype.showResizeHandle = function (img) {\n        this.setEditingImage(img, 3 /* Resize */);\n    };\n    /**\n     * @deprecated\n     */\n    ImageResize.prototype.hideResizeHandle = function (selectImageAfterUnSelect) {\n        this.setEditingImage(null /*image*/, selectImageAfterUnSelect);\n    };\n    return ImageResize;\n}(ImageEdit));\nexport default ImageResize;\n//# sourceMappingURL=ImageResize.js.map","import { chainSanitizerCallback, getTagOfNode, moveChildNodes } from 'roosterjs-editor-dom';\nvar LAST_TD_END_REGEX = /<\\/\\s*td\\s*>((?!<\\/\\s*tr\\s*>)[\\s\\S])*$/i;\nvar LAST_TR_END_REGEX = /<\\/\\s*tr\\s*>((?!<\\/\\s*table\\s*>)[\\s\\S])*$/i;\nvar LAST_TR_REGEX = /<tr[^>]*>[^<]*/i;\nvar LAST_TABLE_REGEX = /<table[^>]*>[^<]*/i;\nvar DEFAULT_BORDER_STYLE = 'solid 1px #d4d4d4';\n/**\n * @internal\n * Convert pasted content from Excel, add borders when source doc doesn't have a border\n * @param event The BeforePaste event\n */\nexport default function convertPastedContentFromExcel(event, trustedHTMLHandler) {\n    var fragment = event.fragment, sanitizingOption = event.sanitizingOption, htmlBefore = event.htmlBefore, clipboardData = event.clipboardData;\n    var html = clipboardData.html ? excelHandler(clipboardData.html, htmlBefore) : undefined;\n    if (html && clipboardData.html != html) {\n        var doc = new DOMParser().parseFromString(trustedHTMLHandler(html), 'text/html');\n        moveChildNodes(fragment, doc === null || doc === void 0 ? void 0 : doc.body);\n    }\n    // For Excel Online\n    var firstChild = fragment.firstChild;\n    if (firstChild && firstChild.childNodes.length > 0 && getTagOfNode(firstChild) == 'DIV') {\n        var tableFound = Array.from(firstChild.childNodes).every(function (child) {\n            // Tables pasted from Excel Online should be of the format: 0 to N META tags and 1 TABLE tag\n            return getTagOfNode(child) == 'META'\n                ? true\n                : getTagOfNode(child) == 'TABLE' && child == firstChild.lastChild;\n        });\n        // Extract Table from Div\n        if (tableFound && firstChild.lastChild) {\n            event.fragment.replaceChildren(firstChild.lastChild);\n        }\n    }\n    chainSanitizerCallback(sanitizingOption.elementCallbacks, 'TD', function (element) {\n        if (element.style.borderStyle == 'none') {\n            element.style.border = DEFAULT_BORDER_STYLE;\n        }\n        return true;\n    });\n}\n/**\n * @internal Export for test only\n * @param html Source html\n */\nexport function excelHandler(html, htmlBefore) {\n    if (html.match(LAST_TD_END_REGEX)) {\n        var trMatch = htmlBefore.match(LAST_TR_REGEX);\n        var tr = trMatch ? trMatch[0] : '<TR>';\n        html = tr + html + '</TR>';\n    }\n    if (html.match(LAST_TR_END_REGEX)) {\n        var tableMatch = htmlBefore.match(LAST_TABLE_REGEX);\n        var table = tableMatch ? tableMatch[0] : '<TABLE>';\n        html = table + html + '</TABLE>';\n    }\n    return html;\n}\n//# sourceMappingURL=convertPastedContentFromExcel.js.map","/**\n * @internal\n * Initialize an empty ListItemBlock\n */\nexport function createListItemBlock(listItem) {\n    if (listItem === void 0) { listItem = null; }\n    return {\n        startElement: listItem,\n        endElement: listItem,\n        insertPositionNode: null,\n        listItemContainers: listItem ? [listItem] : [],\n    };\n}\n//# sourceMappingURL=ListItemBlock.js.map","import { createListItemBlock } from './ListItemBlock';\nimport { splitParentNode, getNextLeafSibling, getFirstLeafNode, getTagOfNode, collapseNodes, unwrap, toArray, safeInstanceOf, } from 'roosterjs-editor-dom';\nvar WORD_ONLINE_IDENTIFYING_SELECTOR = 'div.ListContainerWrapper>ul[class^=\"BulletListStyle\"],div.ListContainerWrapper>ol[class^=\"NumberListStyle\"],span.WACImageContainer > img';\nvar LIST_CONTAINER_ELEMENT_CLASS_NAME = 'ListContainerWrapper';\nvar IMAGE_CONTAINER_ELEMENT_CLASS_NAME = 'WACImageContainer';\n//When the list style is a symbol and the value is not in the clipboard, WordOnline\nvar VALID_LIST_STYLE_CHAR_CODES = [\n    '111',\n    '9643',\n    '9830', //''\n];\n/**\n * @internal\n */\nexport function isWordOnlineWithList(fragment) {\n    return !!(fragment && fragment.querySelector(WORD_ONLINE_IDENTIFYING_SELECTOR));\n}\n// Word Online pasted content DOM structure as of July 12th 2019\n//<html>\n//  <body>\n//      <div class='OutlineGroup'>  ----------> this layer may exist depend on the content user paste\n//          <div class=\"OutlineElement\">  ----------> text content\n//              <p></p>\n//          </div>\n//          <div class=\"ListItemWrapper\">  ----------> list items: for unordered list, all the items on the same level is under the same wrapper\n//              <ul>                                       list items in the same list can be divided into different ListItemWrapper\n//                  <li></li>                              list items in the same list can also be divided into different Outline Group;\n//                  <li></li>\n//              </ul>\n//          </div>\n//      </div>\n//      <div class='OutlineGroup'>\n//          <div class=\"ListItemWrapper\">  ----------> list items: for ordered list, each items has it's own wrapper\n//              <ol>\n//                  <li></li>\n//              </ol>\n//          </div>\n//          <div class=\"ListItemWrapper\">\n//              <ol>\n//                  <li></li>\n//              </ol>\n//          </div>\n//      </div>\n//  </body>\n//</html>\n//\n/**\n * @internal\n * Convert text copied from word online into text that's workable with rooster editor\n * @param fragment Document fragment that is being pasted into editor.\n */\nexport default function convertPastedContentFromWordOnline(fragment) {\n    sanitizeListItemContainer(fragment);\n    var listItemBlocks = getListItemBlocks(fragment);\n    listItemBlocks.forEach(function (itemBlock) {\n        var _a, _b, _c;\n        // There are cases where consecutive List Elements are separated into different nodes:\n        // <div>\n        //   <div>\n        //      <ol></ol>\n        //   </div>\n        //   <div>\n        //      <ol></ol>\n        //   </div>\n        // </div>\n        // <div>\n        //   <div>\n        //      <ol></ol>\n        //   </div>\n        // </div>\n        // in the above case we want to collapse the two root level div into one and unwrap the list item nodes.\n        // after the following flattening the list will become following:\n        //\n        // <div>\n        //    <ol></ol>\n        // </div>\n        // <div>\n        //    <ol></ol>\n        // </div>\n        // <div>\n        //    <ol></ol>\n        // </div>\n        // Then we are start processing.\n        flattenListBlock(fragment, itemBlock);\n        // Find the node to insertBefore, which is next sibling node of the end of a listItemBlock.\n        itemBlock.insertPositionNode = (_b = (_a = itemBlock.endElement) === null || _a === void 0 ? void 0 : _a.nextSibling) !== null && _b !== void 0 ? _b : null;\n        var convertedListElement = undefined;\n        var doc = fragment.ownerDocument;\n        itemBlock.listItemContainers.forEach(function (listItemContainer) {\n            var listType = getContainerListType(listItemContainer); // list type that is contained by iterator.\n            if (listType) {\n                // Initialize processed element with proper listType if this is the first element\n                if (!convertedListElement) {\n                    convertedListElement = createNewList(listItemContainer, doc, listType);\n                }\n                // Get all list items(<li>) in the current iterator element.\n                var currentListItems = toArray(listItemContainer.querySelectorAll('li'));\n                currentListItems.forEach(function (item) {\n                    var _a;\n                    // If item is in root level and the type of list changes then\n                    // insert the current list into body and then reinitialize the convertedListElement\n                    // Word Online is using data-aria-level to determine the the depth of the list item.\n                    var itemLevel = parseInt((_a = item.getAttribute('data-aria-level')) !== null && _a !== void 0 ? _a : '');\n                    // In first level list, there are cases where a consecutive list item DIV may have different list type\n                    // When that happens we need to insert the processed elements into the document, then change the list type\n                    // and keep the processing going.\n                    if (convertedListElement &&\n                        getTagOfNode(convertedListElement) != listType &&\n                        itemLevel == 1 &&\n                        listType) {\n                        insertConvertedListToDoc(convertedListElement, fragment, itemBlock);\n                        convertedListElement = createNewList(listItemContainer, doc, listType);\n                    }\n                    if (convertedListElement && listType) {\n                        insertListItem(convertedListElement, item, listType, doc);\n                    }\n                });\n            }\n        });\n        if (convertedListElement) {\n            insertConvertedListToDoc(convertedListElement, fragment, itemBlock);\n        }\n        // Once we finish the process the list items and put them into a list.\n        // After inserting the processed element,\n        // we need to remove all the non processed node from the parent node.\n        var parentContainer = (_c = itemBlock.startElement) === null || _c === void 0 ? void 0 : _c.parentNode;\n        if (parentContainer) {\n            itemBlock.listItemContainers.forEach(function (listItemContainer) {\n                parentContainer.removeChild(listItemContainer);\n            });\n        }\n    });\n    var imageNodes = getImageNodes(fragment);\n    imageNodes.forEach(function (node) {\n        //   Structure when pasting Word Wac Image as of 10/22/2021\n        //   <span class='WACImageContainer'>\n        //        <img class=\"WACImage\" >\n        //        <span style=\"display:block\">\n        //        </span>\n        //   </span>\n        //\n        //   Since the second span inside of WACImageContainer have style display block it displays an additional space at the bottom of the image.\n        //   Removing the nodes that are not img will resolve the additional space\n        if (safeInstanceOf(node, 'HTMLSpanElement')) {\n            node.childNodes.forEach(function (childNode) {\n                var _a;\n                if (getTagOfNode(childNode) != 'IMG') {\n                    (_a = childNode.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(childNode);\n                }\n            });\n        }\n    });\n}\nfunction createNewList(listItemContainer, doc, tag) {\n    var _a;\n    var newList = doc.createElement(tag);\n    var startAttribute = (_a = listItemContainer.firstElementChild) === null || _a === void 0 ? void 0 : _a.getAttribute('start');\n    if (startAttribute) {\n        newList.setAttribute('start', startAttribute);\n    }\n    return newList;\n}\n/**\n * The node processing is based on the premise of only ol/ul is in ListContainerWrapper class\n * However the html might be malformed, this function is to split all the other elements out of ListContainerWrapper\n * @param fragment pasted document that contains all the list element.\n */\nfunction sanitizeListItemContainer(fragment) {\n    var listItemContainerListEl = toArray(fragment.querySelectorAll(WORD_ONLINE_IDENTIFYING_SELECTOR));\n    listItemContainerListEl.forEach(function (el) {\n        var replaceRegex = new RegExp(\"\\\\b\" + LIST_CONTAINER_ELEMENT_CLASS_NAME + \"\\\\b\", 'g');\n        if (el.previousSibling) {\n            var prevParent = splitParentNode(el, true);\n            prevParent.className = prevParent.className.replace(replaceRegex, '');\n        }\n        if (el.nextSibling) {\n            var nextParent = splitParentNode(el, false);\n            nextParent.className = nextParent.className.replace(replaceRegex, '');\n        }\n    });\n}\n/**\n * Take all the list items in the document, and group the consecutive list times in a list block;\n * @param fragment pasted document that contains all the list element.\n */\nfunction getListItemBlocks(fragment) {\n    var listElements = fragment.querySelectorAll('.' + LIST_CONTAINER_ELEMENT_CLASS_NAME);\n    var result = [];\n    var curListItemBlock = null;\n    for (var i = 0; i < listElements.length; i++) {\n        var curItem = listElements[i];\n        if (!curListItemBlock) {\n            curListItemBlock = createListItemBlock(curItem);\n        }\n        else {\n            var listItemContainers = curListItemBlock.listItemContainers;\n            var lastItemInCurBlock = listItemContainers[listItemContainers.length - 1];\n            if (curItem == lastItemInCurBlock.nextSibling ||\n                (lastItemInCurBlock.parentNode &&\n                    getFirstLeafNode(curItem) ==\n                        getNextLeafSibling(lastItemInCurBlock.parentNode, lastItemInCurBlock))) {\n                listItemContainers.push(curItem);\n                curListItemBlock.endElement = curItem;\n            }\n            else {\n                curListItemBlock.endElement = lastItemInCurBlock;\n                result.push(curListItemBlock);\n                curListItemBlock = createListItemBlock(curItem);\n            }\n        }\n    }\n    if (curListItemBlock && curListItemBlock.listItemContainers.length > 0) {\n        result.push(curListItemBlock);\n    }\n    return result;\n}\n/**\n * Flatten the list items, so that all the consecutive list items are under the same parent.\n * @param fragment Root element of that contains the element.\n * @param listItemBlock The list item block needed to be flattened.\n */\nfunction flattenListBlock(fragment, listItemBlock) {\n    if (listItemBlock.startElement && listItemBlock.endElement) {\n        var collapsedListItemSections = collapseNodes(fragment, listItemBlock.startElement, listItemBlock.endElement, true);\n        collapsedListItemSections.forEach(function (section) {\n            if (getTagOfNode(section.firstChild) == 'DIV') {\n                unwrap(section);\n            }\n        });\n    }\n}\n/**\n * Get the list type that the container contains. If there is no list in the container\n * return null;\n * @param listItemContainer Container that contains a list\n */\nfunction getContainerListType(listItemContainer) {\n    var tag = getTagOfNode(listItemContainer.firstChild);\n    return tag == 'UL' || tag == 'OL' ? tag : null;\n}\n/**\n * Insert list item into the correct position of a list\n * @param listRootElement Root element of the list that is accepting a coming element.\n * @param itemToInsert List item that needed to be inserted.\n * @param listType Type of list(ul/ol)\n */\nfunction insertListItem(listRootElement, itemToInsert, listType, doc) {\n    var _a;\n    if (!listType) {\n        return;\n    }\n    // Get item level from 'data-aria-level' attribute\n    var itemLevel = parseInt((_a = itemToInsert.getAttribute('data-aria-level')) !== null && _a !== void 0 ? _a : '');\n    // Try to reuse the List Marker\n    var style = itemToInsert.getAttribute('data-leveltext');\n    if (listType == 'UL' &&\n        style &&\n        VALID_LIST_STYLE_CHAR_CODES.indexOf(style.charCodeAt(0).toString()) > -1) {\n        itemToInsert.style.listStyleType = \"\\\"\" + style + \"  \\\"\";\n    }\n    var curListLevel = listRootElement; // Level iterator to find the correct place for the current element.\n    // if the itemLevel is 1 it means the level iterator is at the correct place.\n    while (itemLevel > 1) {\n        if (!curListLevel.firstChild) {\n            // If the current level is empty, create empty list within the current level\n            // then move the level iterator into the next level.\n            curListLevel.appendChild(doc.createElement(listType));\n            if (curListLevel.firstElementChild) {\n                curListLevel = curListLevel.firstElementChild;\n            }\n        }\n        else {\n            // If the current level is not empty, the last item in the needs to be a UL or OL\n            // and the level iterator should move to the UL/OL at the last position.\n            var lastChild = curListLevel.lastElementChild;\n            var lastChildTag = getTagOfNode(lastChild);\n            if (lastChild && (lastChildTag == 'UL' || lastChildTag == 'OL')) {\n                // If the last child is a list(UL/OL), then move the level iterator to last child.\n                curListLevel = lastChild;\n            }\n            else {\n                // If the last child is not a list, then append a new list to the level\n                // and move the level iterator to the new level.\n                curListLevel.appendChild(doc.createElement(listType));\n                if (curListLevel.lastElementChild) {\n                    curListLevel = curListLevel.lastElementChild;\n                }\n            }\n        }\n        itemLevel--;\n    }\n    // Once the level iterator is at the right place, then append the list item in the level.\n    curListLevel.appendChild(itemToInsert);\n}\n/**\n * Insert the converted list item into the correct place.\n * @param convertedListElement List element that is converted from list item block\n * @param fragment Root element of that contains the converted listItemBlock\n * @param listItemBlock List item block that was converted.\n */\nfunction insertConvertedListToDoc(convertedListElement, fragment, listItemBlock) {\n    var _a;\n    if (!convertedListElement) {\n        return;\n    }\n    var insertPositionNode = listItemBlock.insertPositionNode;\n    if (insertPositionNode) {\n        var parentNode = insertPositionNode.parentNode;\n        if (parentNode) {\n            parentNode.insertBefore(convertedListElement, insertPositionNode);\n        }\n    }\n    else {\n        var parentNode = (_a = listItemBlock.startElement) === null || _a === void 0 ? void 0 : _a.parentNode;\n        if (parentNode) {\n            parentNode.appendChild(convertedListElement);\n        }\n        else {\n            fragment.appendChild(convertedListElement);\n        }\n    }\n}\nfunction getImageNodes(fragment) {\n    return fragment.querySelectorAll('.' + IMAGE_CONTAINER_ELEMENT_CLASS_NAME);\n}\n//# sourceMappingURL=convertPastedContentFromWordOnline.js.map","import { chainSanitizerCallback } from 'roosterjs-editor-dom';\nimport convertPastedContentFromWordOnline, { isWordOnlineWithList, } from './convertPastedContentFromWordOnline';\nvar WAC_IDENTIFY_SELECTOR = 'ul[class^=\"BulletListStyle\"]>.OutlineElement,ol[class^=\"NumberListStyle\"]>.OutlineElement,span.WACImageContainer';\nvar TABLE_TEMP_ELEMENTS_QUERY = [\n    'TableInsertRowGapBlank',\n    'TableColumnResizeHandle',\n    'TableCellTopBorderHandle',\n    'TableCellLeftBorderHandle',\n    'TableHoverColumnHandle',\n    'TableHoverRowHandle',\n]\n    .map(function (className) { return \".\" + className; })\n    .join(',');\n/**\n * @internal\n * Convert pasted content from Office Online\n * Once it is known that the document is from WAC\n * We need to remove the display property and margin from all the list item\n * @param event The BeforePaste event\n */\nexport default function convertPastedContentFromOfficeOnline(fragment, sanitizingOption) {\n    fragment.querySelectorAll(WAC_IDENTIFY_SELECTOR).forEach(function (el) {\n        var element = el;\n        element.style.removeProperty('display');\n        element.style.removeProperty('margin');\n    });\n    // call conversion function if the pasted content is from word online and\n    // has list element in the pasted content.\n    if (isWordOnlineWithList(fragment)) {\n        convertPastedContentFromWordOnline(fragment);\n    }\n    // Remove \"border:none\" for image to fix image resize behavior\n    // We found a problem that when paste an image with \"border:none\" then the resize border will be\n    // displayed incorrectly when resize it. So we need to drop this style\n    chainSanitizerCallback(sanitizingOption.cssStyleCallbacks, 'border', function (value, element) { return element.tagName != 'IMG' || value != 'none'; });\n    fragment\n        .querySelectorAll(TABLE_TEMP_ELEMENTS_QUERY)\n        .forEach(function (node) { var _a; return (_a = node.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(node); });\n}\n//# sourceMappingURL=convertPastedContentFromOfficeOnline.js.map","import { chainSanitizerCallback, getStyles, moveChildNodes, safeInstanceOf, } from 'roosterjs-editor-dom';\nvar MSO_COMMENT_PARENT = 'mso-comment-parent';\nvar MSO_COMMENT_REFERENCE = 'mso-comment-reference';\nvar MSO_COMMENT_DATE = 'mso-comment-date';\nvar MSO_COMMENT_ANCHOR_HREF_REGEX = /#_msocom_/;\nvar MSO_SPECIAL_CHARACTER = 'mso-special-character';\nvar MSO_SPECIAL_CHARACTER_COMMENT = 'comment';\nvar MSO_COMMENT_CONTINUATION = 'mso-comment-continuation';\nvar MSO_ELEMENT = 'mso-element';\nvar MSO_ELEMENT_COMMENT_LIST = 'comment-list';\nvar MSO_COMMENT_DONE = 'mso-comment-done';\n/**\n * @internal\n * Removes comments when pasting Word content.\n */\nexport default function commentsRemoval(elementCallbacks, styleCallbacks) {\n    // 1st Step, Remove SPAN elements added after each comment.\n    // Word adds multiple elements for comments as SPAN elements.\n    // In this step we remove these elements:\n    // Structure as of 4/18/2022\n    // 1.   <span style=\"mso-special-character:comment\">&nbsp;</span>\n    // 2.   <span style=\"mso-comment-continuation:3\">\n    //          <span>\n    //              <span style=\"font-size:8.0pt\">\n    //              <a href=\"#_msocom_2\">[RS2]</a>\n    //              <span style=\"mso-special-character:comment\">&nbsp;</span>\n    //              </span>\n    //          </span>\n    //      </span>\n    chainSanitizerCallback(elementCallbacks, 'SPAN', function (element) {\n        var _a;\n        var styles = getStyles(element);\n        if (styles[MSO_SPECIAL_CHARACTER] == MSO_SPECIAL_CHARACTER_COMMENT) {\n            (_a = element.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(element);\n        }\n        return true;\n    });\n    // 2nd Step, Modify Anchor elements.\n    // 1.   When the element was selected to add a comment in Word, the selection is converted to\n    //      an anchor element, so we change the tag to span.\n    // 2.   Word also adds some Anchor elements with the following structure:\n    //      Structure as of 4/18/2022\n    //      <a href=\"#_msocom_{number}\">[SS3]</a>\n    //      In this step we remove this Anchor elements.\n    chainSanitizerCallback(elementCallbacks, 'A', function (element) {\n        var _a;\n        if (safeInstanceOf(element, 'HTMLAnchorElement') &&\n            MSO_COMMENT_ANCHOR_HREF_REGEX.test(element.href)) {\n            (_a = element.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(element);\n        }\n        return true;\n    });\n    // 3rd Step, remove List of comments.\n    // When the document have a long thread of comments, these comments are appended\n    // at the end of the copied fragment, we also need to remove it.\n    // Structure as of 4/18/2022\n    //\n    // <div style=\"mso-element:comment-list\">\n    //   <hr width=\"33%\" size=\"1\" align=\"left\">\n    //   <div style=\"mso-element:comment\"> ... </div>\n    //   <div style=\"mso-element:comment\"> ... </div>\n    //   <div style=\"mso-element:comment\"> ... </div>\n    //   </div>\n    // </div>\n    chainSanitizerCallback(elementCallbacks, 'DIV', function (element) {\n        var styles = getStyles(element);\n        if (styles[MSO_ELEMENT] == MSO_ELEMENT_COMMENT_LIST) {\n            moveChildNodes(element);\n        }\n        return true;\n    });\n    /**\n     * Remove styles related to Office Comments that can cause unwanted behaviors\n     * depending on the user client\n     */\n    [\n        MSO_COMMENT_REFERENCE,\n        MSO_COMMENT_DATE,\n        MSO_COMMENT_PARENT,\n        MSO_COMMENT_CONTINUATION,\n        MSO_COMMENT_DONE,\n    ].forEach(function (style) { return chainSanitizerCallback(styleCallbacks, style, function () { return false; }); });\n}\n//# sourceMappingURL=commentsRemoval.js.map","/** NodeId attribute */\nvar NODE_ID_ATTRIBUTE_NAME = 'NodeId';\n/**\n * @internal\n * Create an empty WordCustomData\n */\nexport function createCustomData() {\n    return {\n        dict: {},\n        nextNodeId: 1,\n    };\n}\n/**\n * @internal\n * Sets the specified object data\n */\nexport function setObject(wordCustomData, element, key, value) {\n    // Get the id for the element\n    if (element.nodeType == 1 /* Element */) {\n        var id = getAndSetNodeId(wordCustomData, element);\n        if (id != '') {\n            // Get the values for the element\n            if (!wordCustomData.dict[id]) {\n                // First time dictionary creation\n                wordCustomData.dict[id] = {};\n            }\n            wordCustomData.dict[id][key] = value;\n        }\n    }\n}\n/**\n * @internal\n * Reads the specified object data\n */\nexport function getObject(wordCustomData, element, key) {\n    if (element.nodeType == 1 /* Element */) {\n        var id = getAndSetNodeId(wordCustomData, element);\n        if (id != '') {\n            return wordCustomData.dict[id] && wordCustomData.dict[id][key];\n        }\n    }\n    return null;\n}\n/**\n * Get the unique id for the specified node...\n */\nfunction getAndSetNodeId(wordCustomData, element) {\n    var id = element.getAttribute(NODE_ID_ATTRIBUTE_NAME);\n    if (!id) {\n        id = wordCustomData.nextNodeId.toString();\n        wordCustomData.nextNodeId++;\n        element.setAttribute(NODE_ID_ATTRIBUTE_NAME, id);\n    }\n    return id;\n}\n//# sourceMappingURL=WordCustomData.js.map","import { createLevelLists } from './LevelLists';\nimport { getObject, setObject } from './WordCustomData';\nimport { getStyles, getTagOfNode, moveChildNodes } from 'roosterjs-editor-dom';\n/** Word list metadata style name */\nvar LOOKUP_DEPTH = 5;\n/** Name for the word list id property in the custom data */\nvar UNIQUE_LIST_ID_CUSTOM_DATA = 'UniqueListId';\n/** Word list metadata style name */\nvar MSO_LIST_STYLE_NAME = 'mso-list';\n/** Regular expression to match line breaks */\nvar LINE_BREAKS = /[\\n|\\r]/gi;\n/**\n * @internal\n * Handles the pass 1: Discovery\n * During discovery, we'll parse the metadata out of the elements and store it in the list items dictionary.\n * We'll detect cases where the list items for a particular ordered list are not next to each other. Word does these\n * for numbered headers, and we don't want to convert those, because the numbering would be completely wrong.\n */\nexport function processNodesDiscovery(wordConverter) {\n    var _a;\n    var args = wordConverter.wordConverterArgs;\n    if (!args) {\n        return false;\n    }\n    while (args.currentIndex < args.nodes.length) {\n        var node = args.nodes.item(args.currentIndex);\n        // Try to get the list metadata for the specified node\n        var itemMetadata = getListItemMetadata(node);\n        if (itemMetadata) {\n            var levelInfo = args.currentListIdsByLevels[itemMetadata.level - 1] || createLevelLists();\n            args.currentListIdsByLevels[itemMetadata.level - 1] = levelInfo;\n            // We need to drop some list information if this is not an item next to another\n            if (args.lastProcessedItem && getRealPreviousSibling(node) != args.lastProcessedItem) {\n                // This list item is not next to the previous one. This means that there is some content in between them\n                // so we need to reset our list of list ids per level\n                resetCurrentLists(args);\n            }\n            // Get the list metadata for the list that will hold this item\n            var listMetadata = levelInfo.listsMetadata[itemMetadata.wordListId];\n            if (!listMetadata) {\n                // Get the first item fake bullet.. This will be used later to check what is the right type of list\n                var firstFakeBullet = getFakeBulletText(node, LOOKUP_DEPTH);\n                // This is a the first item of a list.. We'll create the list metadata using the information\n                // we already have from this first item\n                listMetadata = {\n                    numberOfItems: 0,\n                    uniqueListId: wordConverter.nextUniqueId++,\n                    firstFakeBullet: firstFakeBullet,\n                    // If the bullet we got is empty or not found, we ignore the list out.. this means\n                    // that this is not an item we need to convert of that the format doesn't match what\n                    // we are expecting\n                    ignore: !firstFakeBullet || firstFakeBullet.length == 0,\n                    // We'll use the first fake bullet to try to figure out which type of list we create. If this list has a second\n                    // item, we'll perform a better comparison, but for one item lists, this will be check that will determine the list type\n                    tagName: getFakeBulletTagName(firstFakeBullet),\n                };\n                levelInfo.listsMetadata[itemMetadata.wordListId] = listMetadata;\n                args.lists[listMetadata.uniqueListId.toString()] = listMetadata;\n            }\n            else if (!listMetadata.ignore && listMetadata.numberOfItems == 1) {\n                // This is the second item we've seen for this list.. we'll compare the 2 fake bullet\n                // items we have an decide if we create ordered or unordered lists based on this.\n                // This is the best way we can do this since we cannot read the metadata that Word\n                // puts in the head of the HTML...\n                var secondFakeBullet = getFakeBulletText(node, LOOKUP_DEPTH);\n                listMetadata.tagName =\n                    listMetadata.firstFakeBullet == secondFakeBullet ? 'UL' : 'OL';\n            }\n            // Set the unique id to the list\n            itemMetadata.uniqueListId = listMetadata.uniqueListId;\n            // Check if we need to ignore this list... we'll either know already that we need to ignore\n            // it, or we'll know it because the previous list items are not next to this one\n            if (listMetadata.ignore ||\n                (listMetadata.tagName == 'OL' &&\n                    listMetadata.numberOfItems > 0 &&\n                    levelInfo.currentUniqueListId != itemMetadata.uniqueListId)) {\n                // We need to ignore this item... and we also need to forget about the lists that\n                // are not at the root level\n                listMetadata.ignore = true;\n                args.currentListIdsByLevels[0].currentUniqueListId = -1;\n                args.currentListIdsByLevels = args.currentListIdsByLevels.slice(0, 1);\n            }\n            else {\n                // This is an item we don't need to ignore... If added lists deep under this one before\n                // we'll drop their ids from the list of ids per level.. this is because this list item\n                // breaks the deeper lists.\n                if (args.currentListIdsByLevels.length > itemMetadata.level) {\n                    args.currentListIdsByLevels = args.currentListIdsByLevels.slice(0, itemMetadata.level);\n                }\n                levelInfo.currentUniqueListId = itemMetadata.uniqueListId;\n                // Add the list item into the list of items to be processed\n                args.listItems.push(itemMetadata);\n                listMetadata.numberOfItems++;\n            }\n            args.lastProcessedItem = node;\n        }\n        else {\n            // Here, we know that this is not a list item, but we'll want to check if it is one \"no bullet\" list items...\n            // these can be created by creating a bullet and hitting delete on it it... The content will continue to be indented, but there will\n            // be no bullet and the list will continue correctly after that. Visually, it looks like the previous item has multiple lines, but\n            // the HTML generated has multiple paragraphs with the same class. We'll merge these when we find them, so the logic doesn't skips\n            // the list conversion thinking that the list items are not together...\n            var last = args.lastProcessedItem;\n            if (last &&\n                getRealPreviousSibling(node) == last &&\n                node.tagName == last.tagName &&\n                node.className == last.className) {\n                // Add 2 line breaks and move all the nodes to the last item\n                last.appendChild(last.ownerDocument.createElement('br'));\n                last.appendChild(last.ownerDocument.createElement('br'));\n                moveChildNodes(last, node, true /*keepExistingChildren*/);\n                // Remove the item that we don't need anymore\n                (_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(node);\n            }\n        }\n        // Move to the next element are return true if more elements need to be processed\n        args.currentIndex++;\n    }\n    return args.listItems.length > 0;\n}\n/**\n * @internal\n * Handles the pass 2: Conversion\n * During conversion, we'll go over the elements that belong to a list that we've marked as a list to convert, and we'll perform the\n * conversion needed\n */\nexport function processNodeConvert(wordConverter) {\n    var _a;\n    var args = wordConverter.wordConverterArgs;\n    if (args) {\n        args.currentIndex = 0;\n        while (args.currentIndex < args.listItems.length) {\n            var metadata = args.listItems[args.currentIndex];\n            var node = metadata.originalNode;\n            var listMetadata = args.lists[metadata.uniqueListId.toString()];\n            if (!listMetadata.ignore) {\n                // We have a list item that we need to convert, get or create the list\n                // that hold this item out\n                var list = getOrCreateListForNode(wordConverter, node, metadata, listMetadata);\n                if (list) {\n                    // Clean the element out.. this call gets rid of the fake bullet and unneeded nodes\n                    cleanupListIgnore(node, LOOKUP_DEPTH);\n                    // Create a new list item and transfer the children\n                    var li = node.ownerDocument.createElement('LI');\n                    if (getTagOfNode(node).startsWith('H')) {\n                        var clone = node.cloneNode(true /* deep */);\n                        clone.style.textIndent = '';\n                        clone.style.marginLeft = '';\n                        clone.style.marginRight = '';\n                        li.appendChild(clone);\n                    }\n                    else {\n                        moveChildNodes(li, node);\n                    }\n                    // Append the list item into the list\n                    list.appendChild(li);\n                    // Remove the node we just converted\n                    (_a = node.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(node);\n                    if (listMetadata.tagName == 'UL') {\n                        wordConverter.numBulletsConverted++;\n                    }\n                    else {\n                        wordConverter.numNumberedConverted++;\n                    }\n                }\n            }\n            args.currentIndex++;\n        }\n    }\n    return wordConverter.numBulletsConverted > 0 || wordConverter.numNumberedConverted > 0;\n}\n/**\n * Gets or creates the list (UL or OL) that holds this item out based on the\n * items content and the specified metadata\n */\nfunction getOrCreateListForNode(wordConverter, node, metadata, listMetadata) {\n    var _a;\n    // First get the last list next to this node under the specified level. This code\n    // path will return the list or will create lists if needed\n    var list = recurringGetOrCreateListAtNode(node, metadata.level, listMetadata);\n    // Here use the unique list ID to detect if we have the right list...\n    // it is possible to have 2 different lists next to each other with different formats, so\n    // we want to detect this an create separate lists for those cases\n    var listId = getObject(wordConverter.wordCustomData, list, UNIQUE_LIST_ID_CUSTOM_DATA);\n    // If we have a list with and ID, but the ID is different than the ID for this list item, this\n    // is a completely new list, so we'll append a new list for that\n    if ((listId && listId != metadata.uniqueListId) || (!listId && list.firstChild)) {\n        var newList = node.ownerDocument.createElement(listMetadata.tagName);\n        (_a = list.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(newList, list.nextSibling);\n        list = newList;\n    }\n    // Set the list id into the custom data\n    setObject(wordConverter.wordCustomData, list, UNIQUE_LIST_ID_CUSTOM_DATA, metadata.uniqueListId);\n    // This call will convert the list if needed to the right type of list required. This can happen\n    // on the cases where the first list item for this list is located after a deeper list. for that\n    // case, we will have created a UL for it, and we may need to convert it\n    return convertListIfNeeded(wordConverter, list, listMetadata);\n}\n/**\n * Converts the list between UL and OL if needed, by using the fake bullet and\n * information already stored in the list itself\n */\nfunction convertListIfNeeded(wordConverter, list, listMetadata) {\n    var _a, _b, _c;\n    // Check if we need to convert the list out\n    if (listMetadata.tagName != getTagOfNode(list)) {\n        // We have the wrong list type.. convert it, set the id again and transfer all the children\n        var newList = (_a = list.ownerDocument) === null || _a === void 0 ? void 0 : _a.createElement(listMetadata.tagName);\n        if (newList) {\n            setObject(wordConverter.wordCustomData, newList, UNIQUE_LIST_ID_CUSTOM_DATA, getObject(wordConverter.wordCustomData, list, UNIQUE_LIST_ID_CUSTOM_DATA));\n            moveChildNodes(newList, list);\n            (_b = list.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(newList, list);\n            (_c = list.parentNode) === null || _c === void 0 ? void 0 : _c.removeChild(list);\n            list = newList;\n        }\n    }\n    return list;\n}\n/**\n * Gets or creates the specified list\n */\nfunction recurringGetOrCreateListAtNode(node, level, listMetadata) {\n    var _a, _b;\n    var parent = null;\n    var possibleList = null;\n    if (level == 1) {\n        // Root case, we'll check if the list is the previous sibling of the node\n        possibleList = getRealPreviousSibling(node);\n    }\n    else {\n        // If we get here, we are looking for level 2 or deeper... get the upper list\n        // and check if the last element is a list\n        parent = recurringGetOrCreateListAtNode(node, level - 1, null);\n        if (parent.lastChild) {\n            possibleList = parent.lastChild;\n        }\n    }\n    // Check the element that we got and verify that it is a list\n    if (possibleList && possibleList.nodeType == 1 /* Element */) {\n        var tag = getTagOfNode(possibleList);\n        if (tag == 'UL' || tag == 'OL') {\n            // We have a list.. use it\n            return possibleList;\n        }\n    }\n    // If we get here, it means we don't have a list and we need to create one\n    // this code path will always create new lists as UL lists\n    var newList = (_a = node.ownerDocument) === null || _a === void 0 ? void 0 : _a.createElement(listMetadata ? listMetadata.tagName : 'UL');\n    if (level == 1) {\n        // For level 1, we'll insert the list before the node\n        (_b = node.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(newList, node);\n    }\n    else {\n        // Any level 2 or above, we insert the list as the last\n        // child of the upper level list\n        parent === null || parent === void 0 ? void 0 : parent.appendChild(newList);\n    }\n    return newList;\n}\n/**\n * Cleans up the node children by removing the children marked as mso-list: Ignore.\n * This nodes hold the fake bullet information that Word puts in and when\n * conversion is happening, we want to get rid of these elements\n */\nfunction cleanupListIgnore(node, levels) {\n    var nodesToRemove = [];\n    for (var child = node.firstChild; child; child = child.nextSibling) {\n        if (child) {\n            // Clean up the item internally first if we need to based on the number of levels\n            if (child && child.nodeType == 1 /* Element */ && levels > 1) {\n                cleanupListIgnore(child, levels - 1);\n            }\n            // Try to convert word comments into ignore elements if we haven't done so for this element\n            child = fixWordListComments(child, true /*removeComments*/);\n            // Check if we can remove this item out\n            if (isEmptySpan(child) || isIgnoreNode(child)) {\n                nodesToRemove.push(child);\n            }\n        }\n    }\n    nodesToRemove.forEach(function (child) { return node.removeChild(child); });\n}\n/**\n * Reads the word list meta dada out of the specified node. If the node\n * is not a Word list item, it returns null.\n */\nfunction getListItemMetadata(node) {\n    if (node.nodeType == 1 /* Element */) {\n        var listAttribute = getStyleValue(node, MSO_LIST_STYLE_NAME);\n        if (listAttribute && listAttribute.length > 0) {\n            try {\n                // Word mso-list property holds 3 space separated values in the following format: lst1 level1 lfo0\n                // Where:\n                // (0) List identified for the metadata in the &lt;head&gt; of the document. We cannot read the &lt;head&gt; meta data\n                // (1) Level of the list. This also maps to the &lt;head&gt; metadata that we cannot read, but\n                // for almost all cases, it maps to the list indentation (or level). We'll use it as the\n                // list indentation value\n                // (2) Contains a specific list identifier.\n                // Example value: \"l0 level1 lfo1\"\n                var listProps = listAttribute.split(' ');\n                if (listProps.length == 3) {\n                    return {\n                        level: parseInt(listProps[1].substr('level'.length)),\n                        wordListId: listAttribute,\n                        originalNode: node,\n                        uniqueListId: 0,\n                    };\n                }\n            }\n            catch (e) { }\n        }\n    }\n    return null;\n}\nfunction isFakeBullet(fakeBullet) {\n    return ['o', '', '', '-'].indexOf(fakeBullet) >= 0;\n}\n/** Given a fake bullet text, returns the type of list that should be used for it */\nfunction getFakeBulletTagName(fakeBullet) {\n    return isFakeBullet(fakeBullet) ? 'UL' : 'OL';\n}\n/**\n * Finds the fake bullet text out of the specified node and returns it. For images, it will return\n * a bullet string. If not found, it returns null...\n */\nfunction getFakeBulletText(node, levels) {\n    var _a, _b;\n    // Word uses the following format for their bullets:\n    // &lt;p style=\"mso-list:l1 level1 lfo2\"&gt;\n    // &lt;span style=\"...\"&gt;\n    // &lt;span style=\"mso-list:Ignore\"&gt;1.&lt;span style=\"...\"&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/span&gt;\n    // &lt;/span&gt;\n    // Content here...\n    // &lt;/p&gt;\n    //\n    // Basically, we need to locate the mso-list:Ignore SPAN, which holds either one text or image node. That\n    // text or image node will be the fake bullet we are looking for\n    var result = '';\n    var child = node.firstChild;\n    while (!result && child) {\n        // First, check if we need to convert the Word list comments into real elements\n        child = fixWordListComments(child, true /*removeComments*/);\n        // Check if this is the node that holds the fake bullets (mso-list: Ignore)\n        if (isIgnoreNode(child)) {\n            // Yes... this is the node that holds either the text or image data\n            result = (_b = (_a = child.textContent) === null || _a === void 0 ? void 0 : _a.trim()) !== null && _b !== void 0 ? _b : '';\n            // This is the case for image case\n            if (result.length == 0) {\n                result = 'o';\n            }\n        }\n        else if (child.nodeType == 1 /* Element */ && levels > 1) {\n            // If this is an element and we are not in the last level, try to get the fake bullet\n            // out of the child\n            result = getFakeBulletText(child, levels - 1);\n        }\n        child = child.nextSibling;\n    }\n    return result;\n}\n/**\n * If the specified element is a Word List comments, this code verifies and fixes\n * the markup when needed to ensure that Chrome bullet conversions work as expected\n * -----\n * We'll convert &lt;!--[if !supportLists]--&gt; and &lt;!--[endif]--&gt; comments into\n * &lt;span style=\"mso-list:Ignore\"&gt;&lt;/span&gt;... Chrome has a bug where it drops the\n * styles of the span, but we'll use these comments to recreate them out\n */\nfunction fixWordListComments(child, removeComments) {\n    var _a, _b, _c, _d;\n    if (child.nodeType == 8 /* Comment */) {\n        var value = child.data;\n        if (value && value.trim().toLowerCase() == '[if !supportlists]') {\n            // We have a list ignore start, find the end.. We know is not more than\n            // 3 nodes away, so we'll optimize our checks\n            var nextElement = child;\n            var endComment = null;\n            for (var j = 0; j < 4; j++) {\n                nextElement = getRealNextSibling(nextElement);\n                if (!nextElement) {\n                    break;\n                }\n                if (nextElement.nodeType == 8 /* Comment */) {\n                    value = nextElement.data;\n                    if (value && value.trim().toLowerCase() == '[endif]') {\n                        endComment = nextElement;\n                        break;\n                    }\n                }\n            }\n            // if we found the end node, wrap everything out\n            if (endComment) {\n                var newSpan = (_a = child.ownerDocument) === null || _a === void 0 ? void 0 : _a.createElement('span');\n                newSpan === null || newSpan === void 0 ? void 0 : newSpan.setAttribute('style', 'mso-list: ignore');\n                nextElement = getRealNextSibling(child);\n                while (nextElement != endComment) {\n                    nextElement = nextElement === null || nextElement === void 0 ? void 0 : nextElement.nextSibling;\n                    if (nextElement.previousSibling) {\n                        newSpan === null || newSpan === void 0 ? void 0 : newSpan.appendChild(nextElement.previousSibling);\n                    }\n                }\n                // Insert the element out and use that one as the current child\n                if (newSpan) {\n                    (_b = endComment.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(newSpan, endComment);\n                }\n                // Remove the comments out if the call specified it out\n                if (removeComments) {\n                    (_c = child.parentNode) === null || _c === void 0 ? void 0 : _c.removeChild(child);\n                    (_d = endComment.parentNode) === null || _d === void 0 ? void 0 : _d.removeChild(endComment);\n                }\n                // Last, make sure we return the new element out instead of the comment\n                if (newSpan) {\n                    child = newSpan;\n                }\n            }\n        }\n    }\n    return child;\n}\n/** Finds the real previous sibling, ignoring empty text nodes */\nfunction getRealPreviousSibling(node) {\n    var prevSibling = node;\n    do {\n        prevSibling = prevSibling.previousSibling;\n    } while (prevSibling && isEmptyTextNode(prevSibling));\n    return prevSibling;\n}\n/** Finds the real next sibling, ignoring empty text nodes */\nfunction getRealNextSibling(node) {\n    var nextSibling = node;\n    do {\n        nextSibling = nextSibling.nextSibling;\n    } while (nextSibling && isEmptyTextNode(nextSibling));\n    return nextSibling;\n}\n/**\n * Checks if the specified node is marked as a mso-list: Ignore. These\n * nodes need to be ignored when a list item is converted into standard\n * HTML lists\n */\nfunction isIgnoreNode(node) {\n    if (node.nodeType == 1 /* Element */) {\n        var listAttribute = getStyleValue(node, MSO_LIST_STYLE_NAME);\n        if (listAttribute &&\n            listAttribute.length > 0 &&\n            listAttribute.trim().toLowerCase() == 'ignore') {\n            return true;\n        }\n    }\n    return false;\n}\n/** Checks if the specified node is an empty span. */\nfunction isEmptySpan(node) {\n    return getTagOfNode(node) == 'SPAN' && !node.firstChild;\n}\n/** Reads the specified style value from the node */\nfunction getStyleValue(node, styleName) {\n    // Word uses non-standard names for the metadata that puts in the style of the element...\n    // Most browsers will not provide the information for those nonstandard values through the node.style\n    // property, so the only reliable way to read them is to get the attribute directly and do\n    // the required parsing..\n    return getStyles(node)[styleName] || null;\n}\n/** Checks if the node is an empty text node that can be ignored */\nfunction isEmptyTextNode(node) {\n    var _a;\n    // No node is empty\n    if (!node) {\n        return true;\n    }\n    // Empty text node is empty\n    if (node.nodeType == 3 /* Text */) {\n        var value = node.nodeValue;\n        value = (_a = value === null || value === void 0 ? void 0 : value.replace(LINE_BREAKS, '')) !== null && _a !== void 0 ? _a : '';\n        return (value === null || value === void 0 ? void 0 : value.trim().length) == 0;\n    }\n    // Span or Font with an empty child node is empty\n    var tagName = getTagOfNode(node);\n    if (node.firstChild &&\n        node.firstChild == node.lastChild &&\n        (tagName == 'SPAN' || tagName == 'FONT')) {\n        return isEmptyTextNode(node.firstChild);\n    }\n    // If not found, then this is not empty\n    return false;\n}\n/** Resets the list */\nfunction resetCurrentLists(args) {\n    for (var i = 0; i < args.currentListIdsByLevels.length; i++) {\n        var ll = args.currentListIdsByLevels[i];\n        if (ll) {\n            ll.currentUniqueListId = -1;\n        }\n    }\n}\n//# sourceMappingURL=converterUtils.js.map","import commentsRemoval from './commentsRemoval';\nimport { chainSanitizerCallback, moveChildNodes } from 'roosterjs-editor-dom';\nimport { createWordConverter } from './wordConverter';\nimport { createWordConverterArguments } from './WordConverterArguments';\nimport { processNodeConvert, processNodesDiscovery } from './converterUtils';\nvar PERCENTAGE_REGEX = /%/;\nvar DEFAULT_BROWSER_LINE_HEIGHT_PERCENTAGE = 120;\nvar LIST_ELEMENTS_SELECTOR = 'p,h1,h2,h3,h4,h5,h6';\n/**\n * @internal\n * Converts all the Word generated list items in the specified node into standard HTML UL and OL tags\n */\nexport default function convertPastedContentFromWord(event) {\n    var sanitizingOption = event.sanitizingOption, fragment = event.fragment;\n    // Preserve <o:p> when its innerHTML is \"&nbsp;\" to avoid dropping an empty line\n    chainSanitizerCallback(sanitizingOption.elementCallbacks, 'O:P', function (element) {\n        moveChildNodes(element);\n        element.appendChild(element.ownerDocument.createTextNode('\\u00A0')); // &nbsp;\n        return true;\n    });\n    var wordConverter = createWordConverter();\n    // First find all the nodes that we need to check for list item information\n    // This call will return all the p and heading elements under the root node.. These are the elements that\n    // Word uses a list items, so we'll only process them and avoid walking the whole tree.\n    var elements = fragment.querySelectorAll(LIST_ELEMENTS_SELECTOR);\n    if (elements.length > 0) {\n        wordConverter.wordConverterArgs = createWordConverterArguments(elements);\n        if (processNodesDiscovery(wordConverter)) {\n            processNodeConvert(wordConverter);\n        }\n    }\n    // If the List style contains marginBottom = 0in, the space after the list is going to be too narrow.\n    // Remove this style so the list displays correctly.\n    ['OL', 'UL'].forEach(function (tag) {\n        chainSanitizerCallback(sanitizingOption.elementCallbacks, tag, function (element) {\n            if (element.style.marginBottom == '0in') {\n                element.style.marginBottom = '';\n            }\n            return true;\n        });\n    });\n    //If the line height is less than the browser default line height, line between the text is going to be too narrow\n    chainSanitizerCallback(sanitizingOption.cssStyleCallbacks, 'line-height', function (value) {\n        var parsedLineHeight;\n        if (PERCENTAGE_REGEX.test(value) &&\n            !isNaN((parsedLineHeight = parseInt(value))) &&\n            parsedLineHeight < DEFAULT_BROWSER_LINE_HEIGHT_PERCENTAGE) {\n            return false;\n        }\n        return true;\n    });\n    commentsRemoval(sanitizingOption.elementCallbacks, sanitizingOption.cssStyleCallbacks);\n}\n//# sourceMappingURL=convertPastedContentFromWord.js.map","import { createCustomData } from './WordCustomData';\n/**\n * @internal\n * create an empty WordConverter\n */\nexport function createWordConverter() {\n    return {\n        nextUniqueId: 1,\n        numBulletsConverted: 0,\n        numNumberedConverted: 0,\n        wordConverterArgs: null,\n        wordCustomData: createCustomData(),\n    };\n}\n//# sourceMappingURL=wordConverter.js.map","import { createLevelLists } from './LevelLists';\n/**\n * @internal\n * create an empty WordConverterArguments\n */\nexport function createWordConverterArguments(nodes) {\n    return {\n        nodes: nodes,\n        currentIndex: 0,\n        lists: {},\n        listItems: [],\n        currentListIdsByLevels: [createLevelLists()],\n        lastProcessedItem: null,\n    };\n}\n//# sourceMappingURL=WordConverterArguments.js.map","/**\n * @internal\n * create an empty LevelLists\n */\nexport function createLevelLists() {\n    return {\n        listsMetadata: {},\n        currentUniqueListId: -1,\n    };\n}\n//# sourceMappingURL=LevelLists.js.map","import { changeElementTag, ContentTraverser, findClosestElementAncestor, getBlockElementAtNode, getNextLeafSibling, getPreviousLeafSibling, getTagOfNode, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Process pasted content, if there are multiple blocks that are not wrapped by a shared ancestor node,\n * change the tag of first and last node to be SPAN so that it will be merged into current block\n * @param root Root node of content to process\n */\nexport default function handleLineMerge(root) {\n    var traverser = ContentTraverser.createBodyTraverser(root);\n    var blocks = [];\n    for (var block = traverser === null || traverser === void 0 ? void 0 : traverser.currentBlockElement; block; block = traverser.getNextBlockElement()) {\n        blocks.push({\n            start: block.getStartNode(),\n            end: block.getEndNode(),\n        });\n    }\n    if (blocks.length > 0) {\n        var blocksLength = blocks.length - 1;\n        processBlock(blocks[0]);\n        processBlock(blocks[blocksLength]);\n        checkAndAddBr(root, blocks[0], true /*isFirst*/);\n        checkAndAddBr(root, blocks[blocksLength], false /*isFirst*/, blocks[0]);\n    }\n}\nfunction processBlock(block) {\n    var _a, _b, _c;\n    var start = block.start, end = block.end;\n    if (start == end && getTagOfNode(start) == 'DIV') {\n        var node = changeElementTag(start, 'SPAN');\n        block.start = node;\n        block.end = node;\n        if (node && node.lastChild && getTagOfNode(node.lastChild) == 'BR') {\n            node.removeChild(node.lastChild);\n        }\n    }\n    else if (getTagOfNode(end) == 'BR') {\n        var node = (_a = end.ownerDocument) === null || _a === void 0 ? void 0 : _a.createTextNode('');\n        if (node) {\n            (_b = end.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(node, end);\n            block.end = node;\n            (_c = end.parentNode) === null || _c === void 0 ? void 0 : _c.removeChild(end);\n        }\n    }\n}\nfunction checkAndAddBr(root, block, isFirst, firstBlock) {\n    var _a, _b, _c, _d;\n    var blockElement = getBlockElementAtNode(root, block.start);\n    var sibling = isFirst\n        ? getNextLeafSibling(root, block.end)\n        : getPreviousLeafSibling(root, block.start);\n    if (!sibling) {\n        return;\n    }\n    if (blockElement === null || blockElement === void 0 ? void 0 : blockElement.contains(sibling)) {\n        var br = (_a = block.start.ownerDocument) === null || _a === void 0 ? void 0 : _a.createElement('br');\n        if (br) {\n            var blockToUse = isFirst ? block.end : block.start;\n            (_b = blockToUse.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(br, isFirst ? block.end.nextSibling : block.start);\n        }\n    }\n    else if (firstBlock &&\n        firstBlock.end == firstBlock.start &&\n        getTagOfNode(firstBlock.end) == 'SPAN') {\n        // If the first block and the last block are Siblings, add a BR before so the only two\n        // lines that are being pasted are not merged.\n        var previousSibling = getPreviousLeafSibling(root, block.start);\n        if (firstBlock.end.contains(previousSibling) &&\n            !findClosestElementAncestor(block.start, root, 'li')) {\n            var br = (_c = block.start.ownerDocument) === null || _c === void 0 ? void 0 : _c.createElement('br');\n            if (br) {\n                (_d = block.start.parentNode) === null || _d === void 0 ? void 0 : _d.insertBefore(br, block.start);\n            }\n        }\n    }\n}\n//# sourceMappingURL=handleLineMerge.js.map","/**\n * @internal\n * List of deprecated colors that should be removed\n */\nexport var DeprecatedColorList = [\n    'activeborder',\n    'activecaption',\n    'appworkspace',\n    'background',\n    'buttonhighlight',\n    'buttonshadow',\n    'captiontext',\n    'inactiveborder',\n    'inactivecaption',\n    'inactivecaptiontext',\n    'infobackground',\n    'infotext',\n    'menu',\n    'menutext',\n    'scrollbar',\n    'threeddarkshadow',\n    'threedface',\n    'threedhighlight',\n    'threedlightshadow',\n    'threedfhadow',\n    'window',\n    'windowframe',\n    'windowtext',\n];\n//# sourceMappingURL=deprecatedColorList.js.map","import { chainSanitizerCallback } from 'roosterjs-editor-dom';\nvar SUPPORTED_PROTOCOLS = ['http:', 'https:', 'notes:', 'mailto:', 'onenote:'];\n/**\n * @internal\n * Clear local paths and remove link\n * @param sanitizingOption the sanitizingOption of BeforePasteEvent\n * */\nexport default function sanitizeLinks(sanitizingOption) {\n    chainSanitizerCallback(sanitizingOption.attributeCallbacks, 'href', function (value, element) { return validateLink(value, element); });\n}\nfunction validateLink(link, htmlElement) {\n    var url;\n    try {\n        url = new URL(link);\n    }\n    catch (_a) {\n        url = undefined;\n    }\n    /* whitelist supported protocols */\n    if (url && SUPPORTED_PROTOCOLS.indexOf(url.protocol) > -1) {\n        return link;\n    }\n    htmlElement.removeAttribute('href');\n    return '';\n}\n//# sourceMappingURL=sanitizeLinks.js.map","import convertPasteContentForSingleImage from './imageConverter/convertPasteContentForSingleImage';\nimport convertPastedContentForLI from './commonConverter/convertPastedContentForLI';\nimport convertPastedContentFromExcel from './excelConverter/convertPastedContentFromExcel';\nimport convertPastedContentFromOfficeOnline from './officeOnlineConverter/convertPastedContentFromOfficeOnline';\nimport convertPastedContentFromPowerPoint from './pptConverter/convertPastedContentFromPowerPoint';\nimport convertPastedContentFromWord from './wordConverter/convertPastedContentFromWord';\nimport handleLineMerge from './lineMerge/handleLineMerge';\nimport sanitizeHtmlColorsFromPastedContent from './sanitizeHtmlColorsFromPastedContent/sanitizeHtmlColorsFromPastedContent';\nimport sanitizeLinks from './sanitizeLinks/sanitizeLinks';\nimport { chainSanitizerCallback, getPasteSource } from 'roosterjs-editor-dom';\nvar GOOGLE_SHEET_NODE_NAME = 'google-sheets-html-origin';\n/**\n * Paste plugin, handles BeforePaste event and reformat some special content, including:\n * 1. Content copied from Word\n * 2. Content copied from Excel\n * 3. Content copied from Word Online or OneNote Online\n */\nvar Paste = /** @class */ (function () {\n    /**\n     * Construct a new instance of Paste class\n     * @param unknownTagReplacement Replace solution of unknown tags, default behavior is to replace with SPAN\n     * @param convertSingleImageBody When enabled, if clipboard HTML contains a single image, we reuse the image without modifying the src attribute.\n     *                               When disabled, pasted image src attribute will use the dataUri from clipboard data -- By Default disabled.\n     */\n    function Paste(unknownTagReplacement, convertSingleImageBody) {\n        if (unknownTagReplacement === void 0) { unknownTagReplacement = 'SPAN'; }\n        if (convertSingleImageBody === void 0) { convertSingleImageBody = false; }\n        this.unknownTagReplacement = unknownTagReplacement;\n        this.convertSingleImageBody = convertSingleImageBody;\n        this.editor = null;\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    Paste.prototype.getName = function () {\n        return 'Paste';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    Paste.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    Paste.prototype.dispose = function () {\n        this.editor = null;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    Paste.prototype.onPluginEvent = function (event) {\n        if (this.editor && event.eventType == 10 /* BeforePaste */) {\n            var fragment = event.fragment, sanitizingOption = event.sanitizingOption;\n            var trustedHTMLHandler = this.editor.getTrustedHTMLHandler();\n            switch (getPasteSource(event, this.convertSingleImageBody)) {\n                case 0 /* WordDesktop */:\n                    // Handle HTML copied from Word\n                    convertPastedContentFromWord(event);\n                    break;\n                case 1 /* ExcelDesktop */:\n                case 2 /* ExcelOnline */:\n                    if (event.pasteType === 0 /* Normal */ ||\n                        event.pasteType === 2 /* MergeFormat */) {\n                        // Handle HTML copied from Excel\n                        convertPastedContentFromExcel(event, trustedHTMLHandler);\n                    }\n                    break;\n                case 3 /* PowerPointDesktop */:\n                    convertPastedContentFromPowerPoint(event, trustedHTMLHandler);\n                    break;\n                case 5 /* WacComponents */:\n                    convertPastedContentFromOfficeOnline(fragment, sanitizingOption);\n                    break;\n                case 4 /* GoogleSheets */:\n                    sanitizingOption.additionalTagReplacements[GOOGLE_SHEET_NODE_NAME] = '*';\n                    break;\n                case 7 /* SingleImage */:\n                    convertPasteContentForSingleImage(event, trustedHTMLHandler);\n                    break;\n                case 6 /* Default */:\n                    convertPastedContentForLI(fragment);\n                    handleLineMerge(fragment);\n                    break;\n            }\n            sanitizeLinks(sanitizingOption);\n            sanitizeHtmlColorsFromPastedContent(sanitizingOption);\n            sanitizeBlockStyles(sanitizingOption);\n            // Replace unknown tags with SPAN\n            sanitizingOption.unknownTagReplacement = this.unknownTagReplacement;\n        }\n    };\n    return Paste;\n}());\nexport default Paste;\nfunction sanitizeBlockStyles(sanitizingOption) {\n    chainSanitizerCallback(sanitizingOption.cssStyleCallbacks, 'display', function (value) {\n        return value != 'flex'; // return whether we keep the style\n    });\n}\n//# sourceMappingURL=Paste.js.map","import createCellResizer from './CellResizer';\nimport createTableInserter from './TableInserter';\nimport createTableResizer from './TableResizer';\nimport createTableSelector from './TableSelector';\nimport { disposeTableEditFeature } from './TableEditorFeature';\nimport { contains, getComputedStyle, normalizeRect, Position, safeInstanceOf, VTable, } from 'roosterjs-editor-dom';\nvar INSERTER_HOVER_OFFSET = 6;\nvar TOP_OR_SIDE;\n(function (TOP_OR_SIDE) {\n    TOP_OR_SIDE[TOP_OR_SIDE[\"top\"] = 0] = \"top\";\n    TOP_OR_SIDE[TOP_OR_SIDE[\"side\"] = 1] = \"side\";\n})(TOP_OR_SIDE || (TOP_OR_SIDE = {}));\n/**\n * @internal\n *\n * A table has 6 hot areas to be resized/edited (take LTR example):\n *\n *   [6]  [                ]\n *       +[      1         ]+--------------------+\n *       |[                ]|                    |\n *      [ ]               [ ]                    |\n *      [ ]               [ ]                    |\n *      [2]               [3]                    |\n *      [ ]               [ ]                    |\n *      [ ][       4       ]|                    |\n *       +------------------+--------------------+\n *       |                  |                    |\n *       |                  |                    |\n *       |                  |                    |\n *       +------------------+--------------------+\n *                                                [5]\n *\n * 1 - Hover area to show insert column button\n * 2 - Hover area to show insert row button\n * 3 - Hover area to show vertical resizing bar\n * 4 - Hover area to show horizontal resizing bar\n * 5 - Hover area to show whole table resize button\n * 6 - Hover area to show whole table selector button\n *\n * When set a different current table or change current TD, we need to update these areas\n */\nvar TableEditor = /** @class */ (function () {\n    function TableEditor(editor, table, onChanged, onShowHelperElement, anchorContainer, contentDiv) {\n        var _this = this;\n        this.editor = editor;\n        this.table = table;\n        this.onChanged = onChanged;\n        this.onShowHelperElement = onShowHelperElement;\n        this.anchorContainer = anchorContainer;\n        this.contentDiv = contentDiv;\n        // 1, 2 - Insert a column or a row\n        this.horizontalInserter = null;\n        this.verticalInserter = null;\n        // 3, 4 - Resize a column or a row from a cell\n        this.horizontalResizer = null;\n        this.verticalResizer = null;\n        // 5 - Resize whole table\n        this.tableResizer = null;\n        // 6 - Select whole table\n        this.tableSelector = null;\n        this.start = null;\n        this.end = null;\n        this.onFinishEditing = function () {\n            _this.editor.focus();\n            if (_this.start && _this.end) {\n                _this.editor.select(_this.start, _this.end);\n            }\n            _this.editor.addUndoSnapshot(function () { }, \"Format\" /* Format */); // Pass in an empty callback to make sure ContentChangedEvent is triggered\n            _this.onChanged();\n            _this.isCurrentlyEditing = false;\n            return false;\n        };\n        this.onStartTableResize = function () {\n            _this.isCurrentlyEditing = true;\n            _this.onStartResize();\n        };\n        this.onStartCellResize = function () {\n            _this.isCurrentlyEditing = true;\n            _this.disposeTableResizer();\n            _this.onStartResize();\n        };\n        this.onInserted = function (table) {\n            _this.editor.transformToDarkColor(table);\n            _this.disposeTableResizer();\n            _this.onFinishEditing();\n        };\n        /**\n         * Public only for testing purposes\n         * @param table the table to select\n         */\n        this.onSelect = function (table) {\n            _this.editor.focus();\n            if (table) {\n                var vTable = new VTable(table);\n                if (vTable.cells) {\n                    var rows = vTable.cells.length - 1;\n                    var lastCellIndex_1 = 0;\n                    vTable.cells[rows].forEach(function (cell, index) {\n                        lastCellIndex_1 = index;\n                    });\n                    var selection = {\n                        firstCell: {\n                            x: 0,\n                            y: 0,\n                        },\n                        lastCell: {\n                            y: rows,\n                            x: lastCellIndex_1,\n                        },\n                    };\n                    _this.editor.select(table, selection);\n                }\n            }\n        };\n        this.getOnMouseOut = function (feature) {\n            return function (ev) {\n                if (feature &&\n                    ev.relatedTarget != feature &&\n                    safeInstanceOf(_this.contentDiv, 'HTMLElement') &&\n                    safeInstanceOf(ev.relatedTarget, 'HTMLElement') &&\n                    !contains(_this.contentDiv, ev.relatedTarget, true /* treatSameNodeAsContain */)) {\n                    _this.dispose();\n                }\n            };\n        };\n        this.isRTL = getComputedStyle(table, 'direction') == 'rtl';\n        this.setEditorFeatures();\n        this.isCurrentlyEditing = false;\n    }\n    TableEditor.prototype.dispose = function () {\n        this.disposeTableResizer();\n        this.disposeCellResizers();\n        this.disposeTableInserter();\n        this.disposeTableSelector();\n    };\n    TableEditor.prototype.isEditing = function () {\n        return this.isCurrentlyEditing;\n    };\n    TableEditor.prototype.isOwnedElement = function (node) {\n        return [\n            this.tableResizer,\n            this.tableSelector,\n            this.horizontalInserter,\n            this.verticalInserter,\n            this.horizontalResizer,\n            this.verticalResizer,\n        ]\n            .filter(function (feature) { return !!(feature === null || feature === void 0 ? void 0 : feature.div); })\n            .some(function (feature) { return contains(feature === null || feature === void 0 ? void 0 : feature.div, node, true /* treatSameNodeAsContain */); });\n    };\n    TableEditor.prototype.onMouseMove = function (x, y) {\n        var _a, _b;\n        //Get Cell [0,0]\n        var firstCell = (_a = this.table.rows[0]) === null || _a === void 0 ? void 0 : _a.cells[0];\n        if (!firstCell) {\n            return;\n        }\n        var firstCellRect = normalizeRect(firstCell.getBoundingClientRect());\n        if (!firstCellRect) {\n            return;\n        }\n        // Determine if cursor is on top or side\n        var topOrSide = y <= firstCellRect.top + INSERTER_HOVER_OFFSET\n            ? 0 /* top */\n            : this.isRTL\n                ? x >= firstCellRect.right - INSERTER_HOVER_OFFSET\n                    ? 1 /* side */\n                    : undefined\n                : x <= firstCellRect.left + INSERTER_HOVER_OFFSET\n                    ? 1 /* side */\n                    : undefined;\n        var topOrSideBinary = topOrSide ? 1 : 0;\n        // Get whole table rect\n        var tableRect = normalizeRect(this.table.getBoundingClientRect());\n        // i is row index, j is column index\n        for (var i = 0; i < this.table.rows.length; i++) {\n            var tr = this.table.rows[i];\n            var j = 0;\n            for (; j < tr.cells.length; j++) {\n                var td = tr.cells[j];\n                var tdRect = normalizeRect(td.getBoundingClientRect());\n                if (!tdRect || !tableRect) {\n                    continue;\n                }\n                // Determine the cell the cursor is in range of\n                // Offset is only used for first row and column\n                var lessThanBottom = y <= tdRect.bottom;\n                var lessThanRight = this.isRTL\n                    ? x <= tdRect.right + INSERTER_HOVER_OFFSET * topOrSideBinary\n                    : x <= tdRect.right;\n                var moreThanLeft = this.isRTL\n                    ? x >= tdRect.left\n                    : x >= tdRect.left - INSERTER_HOVER_OFFSET * topOrSideBinary;\n                if (lessThanBottom && lessThanRight && moreThanLeft) {\n                    var isOnLeftOrRight = this.isRTL\n                        ? tdRect.right <= tableRect.right && tdRect.right >= tableRect.right - 1\n                        : tdRect.left >= tableRect.left && tdRect.left <= tableRect.left + 1;\n                    if (i === 0 && topOrSide == 0 /* top */) {\n                        var center = (tdRect.left + tdRect.right) / 2;\n                        var isOnRightHalf = this.isRTL ? x < center : x > center;\n                        this.setInserterTd(isOnRightHalf ? td : tr.cells[j - 1], false /*isHorizontal*/);\n                    }\n                    else if (j === 0 && topOrSide == 1 /* side */ && isOnLeftOrRight) {\n                        var tdAbove = (_b = this.table.rows[i - 1]) === null || _b === void 0 ? void 0 : _b.cells[0];\n                        var tdAboveRect = tdAbove\n                            ? normalizeRect(tdAbove.getBoundingClientRect())\n                            : null;\n                        var isTdNotAboveMerged = !tdAboveRect\n                            ? null\n                            : this.isRTL\n                                ? tdAboveRect.right === tdRect.right\n                                : tdAboveRect.left === tdRect.left;\n                        this.setInserterTd(y < (tdRect.top + tdRect.bottom) / 2 && isTdNotAboveMerged\n                            ? tdAbove\n                            : td, true /*isHorizontal*/);\n                    }\n                    else {\n                        this.setInserterTd(null);\n                    }\n                    this.setResizingTd(td);\n                    //Cell found\n                    break;\n                }\n            }\n            if (j < tr.cells.length) {\n                break;\n            }\n        }\n        // Create Selector and Resizer\n        this.setEditorFeatures();\n    };\n    TableEditor.prototype.setEditorFeatures = function () {\n        if (!this.tableSelector) {\n            this.tableSelector = createTableSelector(this.table, this.editor, this.onSelect, this.getOnMouseOut, this.onShowHelperElement, this.contentDiv, this.anchorContainer);\n        }\n        if (!this.tableResizer) {\n            this.tableResizer = createTableResizer(this.table, this.editor, this.onStartTableResize, this.onFinishEditing, this.onShowHelperElement, this.contentDiv, this.anchorContainer);\n        }\n    };\n    TableEditor.prototype.setResizingTd = function (td) {\n        if (this.horizontalResizer && this.horizontalResizer.node != td) {\n            this.disposeCellResizers();\n        }\n        if (!this.horizontalResizer && td) {\n            var zoomScale = this.editor.getZoomScale();\n            this.horizontalResizer = createCellResizer(td, zoomScale, this.isRTL, true /*isHorizontal*/, this.onStartCellResize, this.onFinishEditing, this.onShowHelperElement, this.anchorContainer);\n            this.verticalResizer = createCellResizer(td, zoomScale, this.isRTL, false /*isHorizontal*/, this.onStartCellResize, this.onFinishEditing, this.onShowHelperElement, this.anchorContainer);\n        }\n    };\n    /**\n     * create or remove TableInserter\n     * @param td td to attach to, set this to null to remove inserters (both horizontal and vertical)\n     */\n    TableEditor.prototype.setInserterTd = function (td, isHorizontal) {\n        var inserter = isHorizontal ? this.horizontalInserter : this.verticalInserter;\n        if (td === null || (inserter && inserter.node != td)) {\n            this.disposeTableInserter();\n        }\n        if (!this.horizontalInserter && !this.verticalInserter && td) {\n            var newInserter = createTableInserter(this.editor, td, this.isRTL, !!isHorizontal, this.onInserted, this.getOnMouseOut, this.onShowHelperElement, this.anchorContainer);\n            if (isHorizontal) {\n                this.horizontalInserter = newInserter;\n            }\n            else {\n                this.verticalInserter = newInserter;\n            }\n        }\n    };\n    TableEditor.prototype.disposeTableResizer = function () {\n        if (this.tableResizer) {\n            disposeTableEditFeature(this.tableResizer);\n            this.tableResizer = null;\n        }\n    };\n    TableEditor.prototype.disposeTableInserter = function () {\n        if (this.horizontalInserter) {\n            disposeTableEditFeature(this.horizontalInserter);\n            this.horizontalInserter = null;\n        }\n        if (this.verticalInserter) {\n            disposeTableEditFeature(this.verticalInserter);\n            this.verticalInserter = null;\n        }\n    };\n    TableEditor.prototype.disposeCellResizers = function () {\n        if (this.horizontalResizer) {\n            disposeTableEditFeature(this.horizontalResizer);\n            this.horizontalResizer = null;\n        }\n        if (this.verticalResizer) {\n            disposeTableEditFeature(this.verticalResizer);\n            this.verticalResizer = null;\n        }\n    };\n    TableEditor.prototype.disposeTableSelector = function () {\n        if (this.tableSelector) {\n            disposeTableEditFeature(this.tableSelector);\n            this.tableSelector = null;\n        }\n    };\n    TableEditor.prototype.onStartResize = function () {\n        this.isCurrentlyEditing = true;\n        var range = this.editor.getSelectionRange();\n        if (range) {\n            this.start = Position.getStart(range);\n            this.end = Position.getEnd(range);\n        }\n        this.editor.addUndoSnapshot();\n    };\n    return TableEditor;\n}());\nexport default TableEditor;\n//# sourceMappingURL=TableEditor.js.map","import { moveChildNodes } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Convert pasted content from PowerPoint\n * @param event The BeforePaste event\n */\nexport default function convertPastedContentFromPowerPoint(event, trustedHTMLHandler) {\n    var fragment = event.fragment, clipboardData = event.clipboardData;\n    if (clipboardData.html && !clipboardData.text && clipboardData.image) {\n        // It is possible that PowerPoint copied both image and HTML but not plain text.\n        // We always prefer HTML if any.\n        var doc = new DOMParser().parseFromString(trustedHTMLHandler(clipboardData.html), 'text/html');\n        moveChildNodes(fragment, doc === null || doc === void 0 ? void 0 : doc.body);\n    }\n}\n//# sourceMappingURL=convertPastedContentFromPowerPoint.js.map","import { moveChildNodes } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Convert pasted content if there are HTML and Image data in the Clipboard\n * @param event The BeforePaste event\n */\nexport default function convertPasteContentForSingleImage(event, trustedHTMLHandler) {\n    var fragment = event.fragment, clipboardData = event.clipboardData;\n    var html = clipboardData.html, image = clipboardData.image;\n    if (html && image) {\n        //If there are Html in the clipboard, and the html body only have one img children, use the HTML\n        var doc = new DOMParser().parseFromString(trustedHTMLHandler(html), 'text/html');\n        moveChildNodes(fragment, doc === null || doc === void 0 ? void 0 : doc.body);\n    }\n}\n//# sourceMappingURL=convertPasteContentForSingleImage.js.map","import { chainSanitizerCallback } from 'roosterjs-editor-dom';\nimport { DeprecatedColorList } from './deprecatedColorList';\n/**\n * @internal\n * Remove the deprecated colors from pasted content\n * @param sanitizingOption the sanitizingOption of BeforePasteEvent\n * */\nexport default function sanitizeHtmlColorsFromPastedContent(sanitizingOption) {\n    ['color', 'background-color'].forEach(function (property) {\n        chainSanitizerCallback(sanitizingOption.cssStyleCallbacks, property, function (value) { return DeprecatedColorList.indexOf(value) < 0; });\n    });\n}\n//# sourceMappingURL=sanitizeHtmlColorsFromPastedContent.js.map","import { __extends } from \"tslib\";\nimport DragAndDropHelper from '../../../pluginUtils/DragAndDropHelper';\nimport { createElement, normalizeRect, safeInstanceOf, getComputedStyle, } from 'roosterjs-editor-dom';\nvar TABLE_SELECTOR_LENGTH = 12;\nvar TABLE_SELECTOR_ID = '_Table_Selector';\n/**\n * @internal\n */\nexport default function createTableSelector(table, editor, onFinishDragging, getOnMouseOut, onShowHelperElement, contentDiv, anchorContainer) {\n    var rect = normalizeRect(table.getBoundingClientRect());\n    if (!isTableTopVisible(editor, rect, contentDiv)) {\n        return null;\n    }\n    var zoomScale = editor.getZoomScale();\n    var document = table.ownerDocument;\n    var createElementData = {\n        tag: 'div',\n        style: 'position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080',\n    };\n    onShowHelperElement === null || onShowHelperElement === void 0 ? void 0 : onShowHelperElement(createElementData, 'TableSelector');\n    var div = createElement(createElementData, document);\n    div.id = TABLE_SELECTOR_ID;\n    div.style.width = TABLE_SELECTOR_LENGTH + \"px\";\n    div.style.height = TABLE_SELECTOR_LENGTH + \"px\";\n    (anchorContainer || document.body).appendChild(div);\n    var context = {\n        table: table,\n        zoomScale: zoomScale,\n        rect: rect,\n        isRTL: getComputedStyle(table, 'direction') == 'rtl',\n    };\n    setDivPosition(context, div);\n    var onDragEnd = function (context, event) {\n        if (event.target == div) {\n            onFinishDragging(context.table);\n        }\n        return false;\n    };\n    var featureHandler = new TableSelectorFeature(div, context, setDivPosition, {\n        onDragEnd: onDragEnd,\n    }, context.zoomScale, getOnMouseOut);\n    return { div: div, featureHandler: featureHandler, node: table };\n}\nvar TableSelectorFeature = /** @class */ (function (_super) {\n    __extends(TableSelectorFeature, _super);\n    function TableSelectorFeature(div, context, onSubmit, handler, zoomScale, getOnMouseOut, forceMobile, container) {\n        var _this = _super.call(this, div, context, onSubmit, handler, zoomScale, forceMobile) || this;\n        _this.div = div;\n        _this.onMouseOut = getOnMouseOut(div);\n        div.addEventListener('mouseout', _this.onMouseOut);\n        return _this;\n    }\n    TableSelectorFeature.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        if (this.onMouseOut) {\n            this.div.removeEventListener('mouseout', this.onMouseOut);\n        }\n        this.onMouseOut = null;\n    };\n    return TableSelectorFeature;\n}(DragAndDropHelper));\nfunction setDivPosition(context, trigger) {\n    var rect = context.rect;\n    if (rect) {\n        trigger.style.top = rect.top - TABLE_SELECTOR_LENGTH + \"px\";\n        trigger.style.left = rect.left - TABLE_SELECTOR_LENGTH - 2 + \"px\";\n    }\n}\nfunction isTableTopVisible(editor, rect, contentDiv) {\n    var visibleViewport = editor.getVisibleViewport();\n    if (contentDiv && safeInstanceOf(contentDiv, 'HTMLElement') && visibleViewport && rect) {\n        var containerRect = normalizeRect(contentDiv.getBoundingClientRect());\n        return !!containerRect && containerRect.top <= rect.top && visibleViewport.top <= rect.top;\n    }\n    return true;\n}\n//# sourceMappingURL=TableSelector.js.map","/**\n * @internal\n * Executes an action to all the cells within the selection range.\n * @param callback action to apply on each selected cell\n * @returns the amount of cells modified\n */\nexport var forEachSelectedCell = function (vTable, callback) {\n    var _a;\n    if (vTable.selection) {\n        var _b = vTable.selection, lastCell = _b.lastCell, firstCell = _b.firstCell;\n        for (var y = firstCell.y; y <= lastCell.y; y++) {\n            for (var x = firstCell.x; x <= lastCell.x; x++) {\n                if (vTable.cells && ((_a = vTable.cells[y][x]) === null || _a === void 0 ? void 0 : _a.td)) {\n                    callback(vTable.cells[y][x]);\n                }\n            }\n        }\n    }\n};\n//# sourceMappingURL=forEachSelectedCell.js.map","import { forEachSelectedCell } from './utils/forEachSelectedCell';\nimport { removeCellsOutsideSelection } from './utils/removeCellsOutsideSelection';\nimport { addRangeToSelection, createElement, extractClipboardEvent, moveChildNodes, Browser, setHtmlWithMetadata, createRange, VTable, isWholeTableSelected, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Copy and paste plugin for handling onCopy and onPaste event\n */\nvar CopyPastePlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of CopyPastePlugin\n     * @param options The editor options\n     */\n    function CopyPastePlugin(options) {\n        var _this = this;\n        this.editor = null;\n        this.disposer = null;\n        this.onPaste = function (event) {\n            var _a;\n            var range = null;\n            if (_this.editor) {\n                var editor_1 = _this.editor;\n                extractClipboardEvent(event, function (clipboardData) {\n                    if (editor_1 && !editor_1.isDisposed()) {\n                        editor_1.paste(clipboardData);\n                    }\n                }, {\n                    allowedCustomPasteType: _this.state.allowedCustomPasteType,\n                    getTempDiv: function () {\n                        var _a;\n                        range = (_a = editor_1.getSelectionRange()) !== null && _a !== void 0 ? _a : null;\n                        return _this.getTempDiv(editor_1);\n                    },\n                    removeTempDiv: function (div) {\n                        if (range) {\n                            _this.cleanUpAndRestoreSelection(div, range, false /* isCopy */);\n                        }\n                    },\n                }, (_a = _this.editor.getSelectionRange()) !== null && _a !== void 0 ? _a : undefined);\n            }\n        };\n        this.state = {\n            allowedCustomPasteType: options.allowedCustomPasteType || [],\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    CopyPastePlugin.prototype.getName = function () {\n        return 'CopyPaste';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    CopyPastePlugin.prototype.initialize = function (editor) {\n        var _this = this;\n        this.editor = editor;\n        this.disposer = this.editor.addDomEventHandler({\n            paste: function (e) { return _this.onPaste(e); },\n            copy: function (e) { return _this.onCutCopy(e, false /*isCut*/); },\n            cut: function (e) { return _this.onCutCopy(e, true /*isCut*/); },\n        });\n    };\n    /**\n     * Dispose this plugin\n     */\n    CopyPastePlugin.prototype.dispose = function () {\n        if (this.disposer) {\n            this.disposer();\n        }\n        this.disposer = null;\n        this.editor = null;\n    };\n    /**\n     * Get plugin state object\n     */\n    CopyPastePlugin.prototype.getState = function () {\n        return this.state;\n    };\n    CopyPastePlugin.prototype.onCutCopy = function (event, isCut) {\n        var _this = this;\n        if (this.editor) {\n            var selection_1 = this.editor.getSelectionRangeEx();\n            if (selection_1 && !selection_1.areAllCollapsed) {\n                var html = this.editor.getContent(2 /* RawHTMLWithSelection */);\n                var tempDiv_1 = this.getTempDiv(this.editor, true /*forceInLightMode*/);\n                var metadata = setHtmlWithMetadata(tempDiv_1, html, this.editor.getTrustedHTMLHandler());\n                var newRange = null;\n                if (selection_1.type === 1 /* TableSelection */ &&\n                    selection_1.coordinates) {\n                    var table = tempDiv_1.querySelector(\"#\" + selection_1.table.id);\n                    newRange = this.createTableRange(table, selection_1.coordinates);\n                    if (isCut) {\n                        this.deleteTableContent(this.editor, selection_1.table, selection_1.coordinates);\n                    }\n                }\n                else if (selection_1.type === 2 /* ImageSelection */) {\n                    var image = tempDiv_1.querySelector('#' + selection_1.image.id);\n                    if (image) {\n                        newRange = createRange(image);\n                        if (isCut) {\n                            this.deleteImage(this.editor, selection_1.image.id);\n                        }\n                    }\n                }\n                else {\n                    newRange =\n                        (metadata === null || metadata === void 0 ? void 0 : metadata.type) === 0 /* Normal */\n                            ? createRange(tempDiv_1, metadata.start, metadata.end)\n                            : null;\n                }\n                if (newRange) {\n                    var cutCopyEvent = this.editor.triggerPluginEvent(9 /* BeforeCutCopy */, {\n                        clonedRoot: tempDiv_1,\n                        range: newRange,\n                        rawEvent: event,\n                        isCut: isCut,\n                    });\n                    if (cutCopyEvent.range) {\n                        addRangeToSelection(newRange);\n                    }\n                    this.editor.runAsync(function (editor) {\n                        _this.cleanUpAndRestoreSelection(tempDiv_1, selection_1, !isCut /* isCopy */);\n                        if (isCut) {\n                            editor.addUndoSnapshot(function () {\n                                var position = editor.deleteSelectedContent();\n                                editor.focus();\n                                editor.select(position);\n                            }, \"Cut\" /* Cut */);\n                        }\n                    });\n                }\n            }\n        }\n    };\n    CopyPastePlugin.prototype.getTempDiv = function (editor, forceInLightMode) {\n        var div = editor.getCustomData('CopyPasteTempDiv', function () {\n            var tempDiv = createElement(3 /* CopyPasteTempDiv */, editor.getDocument());\n            editor.getDocument().body.appendChild(tempDiv);\n            return tempDiv;\n        }, function (tempDiv) { var _a; return (_a = tempDiv.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(tempDiv); });\n        if (forceInLightMode) {\n            div.style.backgroundColor = 'white';\n            div.style.color = 'black';\n        }\n        div.style.display = '';\n        div.focus();\n        return div;\n    };\n    CopyPastePlugin.prototype.cleanUpAndRestoreSelection = function (tempDiv, range, isCopy) {\n        var _a, _b, _c;\n        if (!!((_a = range) === null || _a === void 0 ? void 0 : _a.type) || range.type == 0) {\n            var selection = range;\n            switch (selection.type) {\n                case 1 /* TableSelection */:\n                case 2 /* ImageSelection */:\n                    (_b = this.editor) === null || _b === void 0 ? void 0 : _b.select(selection);\n                    break;\n                case 0 /* Normal */:\n                    var range_1 = (_c = selection.ranges) === null || _c === void 0 ? void 0 : _c[0];\n                    this.restoreRange(range_1, isCopy);\n                    break;\n            }\n        }\n        else {\n            this.restoreRange(range, isCopy);\n        }\n        tempDiv.style.backgroundColor = '';\n        tempDiv.style.color = '';\n        tempDiv.style.display = 'none';\n        moveChildNodes(tempDiv);\n    };\n    CopyPastePlugin.prototype.restoreRange = function (range, isCopy) {\n        if (range && this.editor) {\n            if (isCopy && Browser.isAndroid) {\n                range.collapse();\n            }\n            this.editor.select(range);\n        }\n    };\n    CopyPastePlugin.prototype.createTableRange = function (table, selection) {\n        var clonedVTable = new VTable(table);\n        clonedVTable.selection = selection;\n        removeCellsOutsideSelection(clonedVTable);\n        clonedVTable.writeBack();\n        return createRange(clonedVTable.table);\n    };\n    CopyPastePlugin.prototype.deleteTableContent = function (editor, table, selection) {\n        var selectedVTable = new VTable(table);\n        selectedVTable.selection = selection;\n        forEachSelectedCell(selectedVTable, function (cell) {\n            if (cell === null || cell === void 0 ? void 0 : cell.td) {\n                cell.td.innerHTML = editor.getTrustedHTMLHandler()('<br>');\n            }\n        });\n        var wholeTableSelected = isWholeTableSelected(selectedVTable, selection);\n        var isWholeColumnSelected = table.rows.length - 1 === selection.lastCell.y && selection.firstCell.y === 0;\n        if (wholeTableSelected) {\n            selectedVTable.edit(4 /* DeleteTable */);\n            selectedVTable.writeBack();\n        }\n        else if (isWholeColumnSelected) {\n            selectedVTable.edit(5 /* DeleteColumn */);\n            selectedVTable.writeBack();\n        }\n        if (wholeTableSelected || isWholeColumnSelected) {\n            table.style.removeProperty('width');\n            table.style.removeProperty('height');\n        }\n    };\n    CopyPastePlugin.prototype.deleteImage = function (editor, imageId) {\n        editor.queryElements('#' + imageId, function (node) {\n            editor.deleteNode(node);\n        });\n    };\n    return CopyPastePlugin;\n}());\nexport default CopyPastePlugin;\n//# sourceMappingURL=CopyPastePlugin.js.map","import { isWholeTableSelected } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Remove the cells outside of the selection.\n * @param vTable VTable to remove selection\n */\nexport var removeCellsOutsideSelection = function (vTable) {\n    if (vTable.selection) {\n        if (isWholeTableSelected(vTable, vTable.selection)) {\n            return;\n        }\n        vTable.table.style.removeProperty('width');\n        vTable.table.style.removeProperty('height');\n        var _a = vTable.selection, firstCell = _a.firstCell, lastCell = _a.lastCell;\n        var resultCells_1 = [];\n        var firstX_1 = firstCell.x;\n        var firstY_1 = firstCell.y;\n        var lastX_1 = lastCell.x;\n        var lastY_1 = lastCell.y;\n        if (vTable.cells) {\n            vTable.cells.forEach(function (row, y) {\n                row = row.filter(function (_, x) { return y >= firstY_1 && y <= lastY_1 && x >= firstX_1 && x <= lastX_1; });\n                if (row.length > 0) {\n                    resultCells_1.push(row);\n                }\n            });\n            vTable.cells = resultCells_1;\n        }\n    }\n};\n//# sourceMappingURL=removeCellsOutsideSelection.js.map","import { arrayPush, Browser, isCharacterValue } from 'roosterjs-editor-dom';\n/**\n * @internal\n * DOMEventPlugin handles customized DOM events, including:\n * 1. Keyboard event\n * 2. Mouse event\n * 3. IME state\n * 4. Drop event\n * 5. Focus and blur event\n * 6. Input event\n * 7. Scroll event\n * It contains special handling for Safari since Safari cannot get correct selection when onBlur event is triggered in editor.\n */\nvar DOMEventPlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of DOMEventPlugin\n     * @param options The editor options\n     * @param contentDiv The editor content DIV\n     */\n    function DOMEventPlugin(options, contentDiv) {\n        var _this = this;\n        var _a;\n        this.editor = null;\n        this.disposer = null;\n        this.onDragStart = function (e) {\n            var _a;\n            var dragEvent = e;\n            var element = (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.getElementAtCursor('*', dragEvent.target);\n            if (element && !element.isContentEditable) {\n                dragEvent.preventDefault();\n            }\n        };\n        this.onDrop = function () {\n            var _a;\n            (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.runAsync(function (editor) {\n                editor.addUndoSnapshot(function () { }, \"Drop\" /* Drop */);\n            });\n        };\n        this.onFocus = function () {\n            var _a, _b, _c;\n            if (!_this.state.skipReselectOnFocus) {\n                var _d = _this.state.tableSelectionRange || {}, table = _d.table, coordinates = _d.coordinates;\n                var image = (_this.state.imageSelectionRange || {}).image;\n                if (table && coordinates) {\n                    (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.select(table, coordinates);\n                }\n                else if (image) {\n                    (_b = _this.editor) === null || _b === void 0 ? void 0 : _b.select(image);\n                }\n                else if (_this.state.selectionRange) {\n                    (_c = _this.editor) === null || _c === void 0 ? void 0 : _c.select(_this.state.selectionRange);\n                }\n            }\n            _this.state.selectionRange = null;\n        };\n        this.onKeyDownDocument = function (event) {\n            if (event.which == 9 /* TAB */ && !event.defaultPrevented) {\n                _this.cacheSelection();\n            }\n        };\n        this.onMouseDownDocument = function (event) {\n            if (_this.editor &&\n                !_this.state.selectionRange &&\n                !_this.editor.contains(event.target)) {\n                _this.cacheSelection();\n            }\n        };\n        this.cacheSelection = function () {\n            if (!_this.state.selectionRange && _this.editor) {\n                _this.state.selectionRange = _this.editor.getSelectionRange(false /*tryGetFromCache*/);\n            }\n        };\n        this.onScroll = function (e) {\n            var _a;\n            (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.triggerPluginEvent(14 /* Scroll */, {\n                rawEvent: e,\n                scrollContainer: _this.state.scrollContainer,\n            });\n        };\n        this.onKeyboardEvent = function (event) {\n            if (isCharacterValue(event) || (event.which >= 33 /* PAGEUP */ && event.which <= 40 /* DOWN */)) {\n                // Stop propagation for Character keys and Up/Down/Left/Right/Home/End/PageUp/PageDown\n                // since editor already handles these keys and no need to propagate to parents\n                event.stopPropagation();\n            }\n        };\n        this.onInputEvent = function (event) {\n            event.stopPropagation();\n        };\n        this.onContextMenuEvent = function (event) {\n            var _a, _b;\n            var allItems = [];\n            var searcher = (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.getContentSearcherOfCursor();\n            var elementBeforeCursor = searcher === null || searcher === void 0 ? void 0 : searcher.getInlineElementBefore();\n            var eventTargetNode = event.target;\n            if (event.button != 2 && elementBeforeCursor) {\n                eventTargetNode = elementBeforeCursor.getContainerNode();\n            }\n            _this.state.contextMenuProviders.forEach(function (provider) {\n                var _a;\n                var items = (_a = provider.getContextMenuItems(eventTargetNode)) !== null && _a !== void 0 ? _a : [];\n                if ((items === null || items === void 0 ? void 0 : items.length) > 0) {\n                    if (allItems.length > 0) {\n                        allItems.push(null);\n                    }\n                    arrayPush(allItems, items);\n                }\n            });\n            (_b = _this.editor) === null || _b === void 0 ? void 0 : _b.triggerPluginEvent(16 /* ContextMenu */, {\n                rawEvent: event,\n                items: allItems,\n            });\n        };\n        this.state = {\n            isInIME: false,\n            scrollContainer: options.scrollContainer || contentDiv,\n            selectionRange: null,\n            stopPrintableKeyboardEventPropagation: !options.allowKeyboardEventPropagation,\n            contextMenuProviders: ((_a = options.plugins) === null || _a === void 0 ? void 0 : _a.filter(isContextMenuProvider)) || [],\n            tableSelectionRange: null,\n            imageSelectionRange: null,\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    DOMEventPlugin.prototype.getName = function () {\n        return 'DOMEvent';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    DOMEventPlugin.prototype.initialize = function (editor) {\n        var _a;\n        var _this = this;\n        var _b, _c, _d;\n        this.editor = editor;\n        var document = this.editor.getDocument();\n        //Record<string, DOMEventHandler>\n        var eventHandlers = (_a = {\n                // 1. Keyboard event\n                keypress: this.getEventHandler(1 /* KeyPress */),\n                keydown: this.getEventHandler(0 /* KeyDown */),\n                keyup: this.getEventHandler(2 /* KeyUp */),\n                // 2. Mouse event\n                mousedown: 5 /* MouseDown */,\n                contextmenu: this.onContextMenuEvent,\n                // 3. IME state management\n                compositionstart: function () { return (_this.state.isInIME = true); },\n                compositionend: function (rawEvent) {\n                    _this.state.isInIME = false;\n                    editor.triggerPluginEvent(4 /* CompositionEnd */, {\n                        rawEvent: rawEvent,\n                    });\n                },\n                // 4. Drag and Drop event\n                dragstart: this.onDragStart,\n                drop: this.onDrop,\n                // 5. Focus management\n                focus: this.onFocus\n            },\n            // 6. Input event\n            _a[Browser.isIE ? 'textinput' : 'input'] = this.getEventHandler(3 /* Input */),\n            _a);\n        // 7. onBlur handlers\n        if (Browser.isSafari) {\n            document.addEventListener('mousedown', this.onMouseDownDocument, true /*useCapture*/);\n            document.addEventListener('keydown', this.onKeyDownDocument);\n            (_b = document.defaultView) === null || _b === void 0 ? void 0 : _b.addEventListener('blur', this.cacheSelection);\n        }\n        else if (Browser.isIEOrEdge) {\n            eventHandlers.beforedeactivate = this.cacheSelection;\n        }\n        else {\n            eventHandlers.blur = this.cacheSelection;\n        }\n        this.disposer = editor.addDomEventHandler(eventHandlers);\n        // 8. Scroll event\n        this.state.scrollContainer.addEventListener('scroll', this.onScroll);\n        (_c = document.defaultView) === null || _c === void 0 ? void 0 : _c.addEventListener('scroll', this.onScroll);\n        (_d = document.defaultView) === null || _d === void 0 ? void 0 : _d.addEventListener('resize', this.onScroll);\n    };\n    /**\n     * Dispose this plugin\n     */\n    DOMEventPlugin.prototype.dispose = function () {\n        var _a, _b, _c, _d, _e;\n        var document = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getDocument();\n        if (document && Browser.isSafari) {\n            document.removeEventListener('mousedown', this.onMouseDownDocument, true /*useCapture*/);\n            document.removeEventListener('keydown', this.onKeyDownDocument);\n            (_b = document.defaultView) === null || _b === void 0 ? void 0 : _b.removeEventListener('blur', this.cacheSelection);\n        }\n        (_c = document === null || document === void 0 ? void 0 : document.defaultView) === null || _c === void 0 ? void 0 : _c.removeEventListener('resize', this.onScroll);\n        (_d = document === null || document === void 0 ? void 0 : document.defaultView) === null || _d === void 0 ? void 0 : _d.removeEventListener('scroll', this.onScroll);\n        this.state.scrollContainer.removeEventListener('scroll', this.onScroll);\n        (_e = this.disposer) === null || _e === void 0 ? void 0 : _e.call(this);\n        this.disposer = null;\n        this.editor = null;\n    };\n    /**\n     * Get plugin state object\n     */\n    DOMEventPlugin.prototype.getState = function () {\n        return this.state;\n    };\n    DOMEventPlugin.prototype.getEventHandler = function (eventType) {\n        var _this = this;\n        var beforeDispatch = function (event) {\n            return eventType == 3 /* Input */\n                ? _this.onInputEvent(event)\n                : _this.onKeyboardEvent(event);\n        };\n        return this.state.stopPrintableKeyboardEventPropagation\n            ? {\n                pluginEventType: eventType,\n                beforeDispatch: beforeDispatch,\n            }\n            : eventType;\n    };\n    return DOMEventPlugin;\n}());\nexport default DOMEventPlugin;\nfunction isContextMenuProvider(source) {\n    var _a;\n    return !!((_a = source) === null || _a === void 0 ? void 0 : _a.getContextMenuItems);\n}\n//# sourceMappingURL=DOMEventPlugin.js.map","import { isCtrlOrMetaPressed } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Edit Component helps handle Content edit features\n */\nvar EditPlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of EditPlugin\n     * @param options The editor options\n     */\n    function EditPlugin() {\n        this.editor = null;\n        this.state = {\n            features: {},\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    EditPlugin.prototype.getName = function () {\n        return 'Edit';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    EditPlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    EditPlugin.prototype.dispose = function () {\n        this.editor = null;\n    };\n    /**\n     * Get plugin state object\n     */\n    EditPlugin.prototype.getState = function () {\n        return this.state;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    EditPlugin.prototype.onPluginEvent = function (event) {\n        var _a;\n        var hasFunctionKey = false;\n        var features = null;\n        var ctrlOrMeta = false;\n        var isKeyDownEvent = event.eventType == 0 /* KeyDown */;\n        if (isKeyDownEvent) {\n            var rawEvent = event.rawEvent;\n            var range = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getSelectionRange();\n            ctrlOrMeta = isCtrlOrMetaPressed(rawEvent);\n            hasFunctionKey = ctrlOrMeta || rawEvent.altKey;\n            features =\n                this.state.features[rawEvent.which] ||\n                    (range && !range.collapsed && this.state.features[258 /* RANGE */]);\n        }\n        else if (event.eventType == 7 /* ContentChanged */) {\n            features = this.state.features[257 /* CONTENTCHANGED */];\n        }\n        for (var i = 0; features && i < (features === null || features === void 0 ? void 0 : features.length); i++) {\n            var feature = features[i];\n            if ((feature.allowFunctionKeys || !hasFunctionKey) &&\n                this.editor &&\n                feature.shouldHandleEvent(event, this.editor, ctrlOrMeta)) {\n                feature.handleEvent(event, this.editor);\n                if (isKeyDownEvent) {\n                    event.handledByEditFeature = true;\n                }\n                break;\n            }\n        }\n    };\n    return EditPlugin;\n}());\nexport default EditPlugin;\n//# sourceMappingURL=EditPlugin.js.map","import { addDelimiters, arrayPush, createRange, getDelimiterFromElement, getEntityFromElement, getEntitySelector, isBlockElement, isCharacterValue, matchesSelector, Position, safeInstanceOf, splitTextNode, } from 'roosterjs-editor-dom';\nvar DELIMITER_SELECTOR = '.' + \"entityDelimiterAfter\" /* DELIMITER_AFTER */ + ',.' + \"entityDelimiterBefore\" /* DELIMITER_BEFORE */;\nvar ZERO_WIDTH_SPACE = '\\u200B';\nvar INLINE_ENTITY_SELECTOR = 'span' + getEntitySelector();\nexport function inlineEntityOnPluginEvent(event, editor) {\n    switch (event.eventType) {\n        case 7 /* ContentChanged */:\n            if (event.source === \"SetContent\" /* SetContent */) {\n                normalizeDelimitersInEditor(editor);\n            }\n            break;\n        case 11 /* EditorReady */:\n            normalizeDelimitersInEditor(editor);\n            break;\n        case 10 /* BeforePaste */:\n            var fragment = event.fragment, sanitizingOption = event.sanitizingOption;\n            addDelimitersIfNeeded(fragment.querySelectorAll(INLINE_ENTITY_SELECTOR));\n            if (sanitizingOption.additionalAllowedCssClasses) {\n                arrayPush(sanitizingOption.additionalAllowedCssClasses, [\n                    \"entityDelimiterAfter\" /* DELIMITER_AFTER */,\n                    \"entityDelimiterBefore\" /* DELIMITER_BEFORE */,\n                ]);\n            }\n            break;\n        case 8 /* ExtractContentWithDom */:\n        case 9 /* BeforeCutCopy */:\n            event.clonedRoot.querySelectorAll(DELIMITER_SELECTOR).forEach(function (node) {\n                if (getDelimiterFromElement(node)) {\n                    removeNode(node);\n                }\n                else {\n                    removeDelimiterAttr(node);\n                }\n            });\n            break;\n        case 0 /* KeyDown */:\n            handleKeyDownEvent(editor, event);\n            break;\n    }\n}\nfunction preventTypeInDelimiter(delimiter) {\n    var _a, _b, _c, _d;\n    delimiter.normalize();\n    var textNode = delimiter.firstChild;\n    var index = (_b = (_a = textNode.nodeValue) === null || _a === void 0 ? void 0 : _a.indexOf(ZERO_WIDTH_SPACE)) !== null && _b !== void 0 ? _b : -1;\n    if (index >= 0) {\n        splitTextNode(textNode, index == 0 ? 1 : index, false /* returnFirstPart */);\n        var nodeToMove_1;\n        delimiter.childNodes.forEach(function (node) {\n            if (node.nodeValue !== ZERO_WIDTH_SPACE) {\n                nodeToMove_1 = node;\n            }\n        });\n        if (nodeToMove_1) {\n            (_c = delimiter.parentElement) === null || _c === void 0 ? void 0 : _c.insertBefore(nodeToMove_1, delimiter.className == \"entityDelimiterBefore\" /* DELIMITER_BEFORE */\n                ? delimiter\n                : delimiter.nextSibling);\n            var selection = (_d = nodeToMove_1.ownerDocument) === null || _d === void 0 ? void 0 : _d.getSelection();\n            if (selection) {\n                selection.setPosition(nodeToMove_1, new Position(nodeToMove_1, -1 /* End */).offset);\n            }\n        }\n    }\n}\n/**\n * @internal\n */\nexport function normalizeDelimitersInEditor(editor) {\n    removeInvalidDelimiters(editor.queryElements(DELIMITER_SELECTOR));\n    addDelimitersIfNeeded(editor.queryElements(INLINE_ENTITY_SELECTOR));\n}\nfunction addDelimitersIfNeeded(nodes) {\n    nodes.forEach(function (node) {\n        if (isEntityElement(node)) {\n            addDelimiters(node);\n        }\n    });\n}\nfunction isEntityElement(node) {\n    return !!(node &&\n        safeInstanceOf(node, 'HTMLElement') &&\n        isReadOnly(getEntityFromElement(node)));\n}\nfunction removeNode(el) {\n    var _a;\n    (_a = el === null || el === void 0 ? void 0 : el.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(el);\n}\nfunction isReadOnly(entity) {\n    return ((entity === null || entity === void 0 ? void 0 : entity.isReadonly) &&\n        !isBlockElement(entity.wrapper) &&\n        safeInstanceOf(entity.wrapper, 'HTMLElement'));\n}\nfunction removeInvalidDelimiters(nodes) {\n    nodes.forEach(function (node) {\n        if (getDelimiterFromElement(node)) {\n            var sibling = node.classList.contains(\"entityDelimiterBefore\" /* DELIMITER_BEFORE */)\n                ? node.nextElementSibling\n                : node.previousElementSibling;\n            if (!(safeInstanceOf(sibling, 'HTMLElement') && getEntityFromElement(sibling))) {\n                removeNode(node);\n            }\n        }\n        else {\n            removeDelimiterAttr(node);\n        }\n    });\n}\nfunction removeDelimiterAttr(node, checkEntity) {\n    if (checkEntity === void 0) { checkEntity = true; }\n    if (!node) {\n        return;\n    }\n    var isAfter = node.classList.contains(\"entityDelimiterAfter\" /* DELIMITER_AFTER */);\n    var entitySibling = isAfter ? node.previousElementSibling : node.nextElementSibling;\n    if (checkEntity && entitySibling && isEntityElement(entitySibling)) {\n        return;\n    }\n    node.classList.remove(\"entityDelimiterAfter\" /* DELIMITER_AFTER */, \"entityDelimiterBefore\" /* DELIMITER_BEFORE */);\n    node.normalize();\n    node.childNodes.forEach(function (cn) {\n        var _a, _b, _c;\n        var index = (_b = (_a = cn.textContent) === null || _a === void 0 ? void 0 : _a.indexOf(ZERO_WIDTH_SPACE)) !== null && _b !== void 0 ? _b : -1;\n        if (index >= 0) {\n            (_c = createRange(cn, index, cn, index + 1)) === null || _c === void 0 ? void 0 : _c.deleteContents();\n        }\n    });\n}\nfunction handleCollapsedEnter(editor, delimiter) {\n    var isAfter = delimiter.classList.contains(\"entityDelimiterAfter\" /* DELIMITER_AFTER */);\n    var entity = !isAfter ? delimiter.nextSibling : delimiter.previousSibling;\n    var block = getBlock(editor, delimiter);\n    editor.runAsync(function () {\n        if (!block) {\n            return;\n        }\n        var blockToCheck = isAfter ? block.nextSibling : block.previousSibling;\n        if (blockToCheck && safeInstanceOf(blockToCheck, 'HTMLElement')) {\n            var delimiters = blockToCheck.querySelectorAll(DELIMITER_SELECTOR);\n            // Check if the last or first delimiter still contain the delimiter class and remove it.\n            var delimiterToCheck = delimiters.item(isAfter ? 0 : delimiters.length - 1);\n            removeDelimiterAttr(delimiterToCheck);\n        }\n        if (isEntityElement(entity)) {\n            var nextElementSibling = entity.nextElementSibling, previousElementSibling = entity.previousElementSibling;\n            [nextElementSibling, previousElementSibling].forEach(function (el) {\n                // Check if after Enter the ZWS got removed but we still have a element with the class\n                // Remove the attributes of the element if it is invalid now.\n                if (el && matchesSelector(el, DELIMITER_SELECTOR) && !getDelimiterFromElement(el)) {\n                    removeDelimiterAttr(el, false /* checkEntity */);\n                }\n            });\n            // Add delimiters to the entity if needed because on Enter we can sometimes lose the ZWS of the element.\n            addDelimiters(entity);\n        }\n    });\n}\nvar getPosition = function (container) {\n    if (container && getDelimiterFromElement(container)) {\n        var isAfter = container.classList.contains(\"entityDelimiterAfter\" /* DELIMITER_AFTER */);\n        return new Position(container, isAfter ? -3 /* After */ : -2 /* Before */);\n    }\n    return undefined;\n};\nfunction getBlock(editor, element) {\n    var _a;\n    if (!element) {\n        return undefined;\n    }\n    var block = (_a = editor.getBlockElementAtNode(element)) === null || _a === void 0 ? void 0 : _a.getStartNode();\n    while (block && !isBlockElement(block)) {\n        block = editor.contains(block.parentElement) ? block.parentElement : undefined;\n    }\n    return block;\n}\nfunction handleSelectionNotCollapsed(editor, range, event) {\n    var startContainer = range.startContainer, endContainer = range.endContainer, startOffset = range.startOffset, endOffset = range.endOffset;\n    var startElement = editor.getElementAtCursor(DELIMITER_SELECTOR, startContainer);\n    var endElement = editor.getElementAtCursor(DELIMITER_SELECTOR, endContainer);\n    var startUpdate = getPosition(startElement);\n    var endUpdate = getPosition(endElement);\n    if (startUpdate || endUpdate) {\n        editor.select(startUpdate !== null && startUpdate !== void 0 ? startUpdate : new Position(startContainer, startOffset), endUpdate !== null && endUpdate !== void 0 ? endUpdate : new Position(endContainer, endOffset));\n    }\n    editor.runAsync(function (aEditor) {\n        var delimiter = aEditor.getElementAtCursor(DELIMITER_SELECTOR);\n        if (delimiter) {\n            preventTypeInDelimiter(delimiter);\n            if (event.which === 13 /* ENTER */) {\n                removeDelimiterAttr(delimiter);\n            }\n        }\n    });\n}\nfunction handleKeyDownEvent(editor, event) {\n    var _a, _b;\n    var range = editor.getSelectionRangeEx();\n    var rawEvent = event.rawEvent;\n    if (range.type != 0 /* Normal */) {\n        return;\n    }\n    if (range.areAllCollapsed && (isCharacterValue(rawEvent) || rawEvent.which === 13 /* ENTER */)) {\n        var position = (_a = editor.getFocusedPosition()) === null || _a === void 0 ? void 0 : _a.normalize();\n        if (!position) {\n            return;\n        }\n        var element = position.element, node = position.node;\n        var refNode = element == node ? element.childNodes.item(position.offset) : element;\n        var delimiter_1 = editor.getElementAtCursor(DELIMITER_SELECTOR, refNode);\n        if (!delimiter_1) {\n            return;\n        }\n        if (rawEvent.which === 13 /* ENTER */) {\n            handleCollapsedEnter(editor, delimiter_1);\n        }\n        else if (((_b = delimiter_1.firstChild) === null || _b === void 0 ? void 0 : _b.nodeType) == 3 /* Text */) {\n            editor.runAsync(function () { return preventTypeInDelimiter(delimiter_1); });\n        }\n    }\n    else if (!range.areAllCollapsed && !rawEvent.shiftKey && rawEvent.which != 16 /* SHIFT */) {\n        var currentRange = range.ranges[0];\n        if (!currentRange) {\n            return;\n        }\n        handleSelectionNotCollapsed(editor, currentRange, rawEvent);\n    }\n}\n//# sourceMappingURL=inlineEntityOnPluginEvent.js.map","import { inlineEntityOnPluginEvent, normalizeDelimitersInEditor, } from './utils/inlineEntityOnPluginEvent';\nimport { Browser, commitEntity, getEntityFromElement, getEntitySelector, isCharacterValue, toArray, arrayPush, createElement, addRangeToSelection, createRange, isBlockElement, getObjectKeys, } from 'roosterjs-editor-dom';\nvar ENTITY_ID_REGEX = /_(\\d{1,8})$/;\nvar ENTITY_CSS_REGEX = '^' + \"_Entity\" /* ENTITY_INFO_NAME */ + '$';\nvar ENTITY_ID_CSS_REGEX = '^' + \"_EId_\" /* ENTITY_ID_PREFIX */;\nvar ENTITY_TYPE_CSS_REGEX = '^' + \"_EType_\" /* ENTITY_TYPE_PREFIX */;\nvar ENTITY_READONLY_CSS_REGEX = '^' + \"_EReadonly_\" /* ENTITY_READONLY_PREFIX */;\nvar ALLOWED_CSS_CLASSES = [\n    ENTITY_CSS_REGEX,\n    ENTITY_ID_CSS_REGEX,\n    ENTITY_TYPE_CSS_REGEX,\n    ENTITY_READONLY_CSS_REGEX,\n];\nvar REMOVE_ENTITY_OPERATIONS = [\n    6 /* Overwrite */,\n    7 /* PartialOverwrite */,\n    4 /* RemoveFromStart */,\n    5 /* RemoveFromEnd */,\n];\n/**\n * @internal\n * Entity Plugin helps handle all operations related to an entity and generate entity specified events\n */\nvar EntityPlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of EntityPlugin\n     */\n    function EntityPlugin() {\n        var _this = this;\n        this.editor = null;\n        this.handleCutEvent = function (event) {\n            var _a;\n            var range = (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.getSelectionRange();\n            if (range && !range.collapsed) {\n                _this.checkRemoveEntityForRange(event);\n            }\n        };\n        this.state = {\n            entityMap: {},\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    EntityPlugin.prototype.getName = function () {\n        return 'Entity';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    EntityPlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    EntityPlugin.prototype.dispose = function () {\n        this.editor = null;\n        this.state.entityMap = {};\n    };\n    /**\n     * Get plugin state object\n     */\n    EntityPlugin.prototype.getState = function () {\n        return this.state;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    EntityPlugin.prototype.onPluginEvent = function (event) {\n        switch (event.eventType) {\n            case 6 /* MouseUp */:\n                this.handleMouseUpEvent(event);\n                break;\n            case 0 /* KeyDown */:\n                this.handleKeyDownEvent(event.rawEvent);\n                break;\n            case 9 /* BeforeCutCopy */:\n                if (event.isCut) {\n                    this.handleCutEvent(event.rawEvent);\n                }\n                break;\n            case 10 /* BeforePaste */:\n                this.handleBeforePasteEvent(event.sanitizingOption);\n                break;\n            case 7 /* ContentChanged */:\n                this.handleContentChangedEvent(event);\n                break;\n            case 11 /* EditorReady */:\n                this.handleContentChangedEvent();\n                break;\n            case 8 /* ExtractContentWithDom */:\n                this.handleExtractContentWithDomEvent(event.clonedRoot);\n                break;\n            case 16 /* ContextMenu */:\n                this.handleContextMenuEvent(event.rawEvent);\n                break;\n            case 15 /* EntityOperation */:\n                this.handleEntityOperationEvent(event);\n                break;\n        }\n        if (this.editor) {\n            inlineEntityOnPluginEvent(event, this.editor);\n        }\n    };\n    EntityPlugin.prototype.handleContextMenuEvent = function (event) {\n        var _a;\n        var node = event.target;\n        var entityElement = node && ((_a = this.editor) === null || _a === void 0 ? void 0 : _a.getElementAtCursor(getEntitySelector(), node));\n        if (entityElement) {\n            event.preventDefault();\n            this.triggerEvent(entityElement, 2 /* ContextMenu */, event);\n        }\n    };\n    EntityPlugin.prototype.handleMouseUpEvent = function (event) {\n        var rawEvent = event.rawEvent, isClicking = event.isClicking;\n        var node = rawEvent.target;\n        var entityElement;\n        if (this.editor &&\n            isClicking &&\n            node &&\n            !!(entityElement = this.editor.getElementAtCursor(getEntitySelector(), node))) {\n            this.triggerEvent(entityElement, 1 /* Click */, rawEvent);\n            workaroundSelectionIssueForIE(this.editor);\n        }\n    };\n    EntityPlugin.prototype.handleKeyDownEvent = function (event) {\n        var _a;\n        if (isCharacterValue(event) ||\n            event.which == 8 /* BACKSPACE */ ||\n            event.which == 46 /* DELETE */ ||\n            event.which == 13 /* ENTER */) {\n            var range = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getSelectionRange();\n            if (range && !range.collapsed) {\n                this.checkRemoveEntityForRange(event);\n            }\n        }\n    };\n    EntityPlugin.prototype.handleBeforePasteEvent = function (sanitizingOption) {\n        var _a;\n        var range = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getSelectionRange();\n        if (range && !range.collapsed) {\n            this.checkRemoveEntityForRange(null /*rawEvent*/);\n        }\n        if (sanitizingOption.additionalAllowedCssClasses) {\n            arrayPush(sanitizingOption.additionalAllowedCssClasses, ALLOWED_CSS_CLASSES);\n        }\n    };\n    EntityPlugin.prototype.handleContentChangedEvent = function (event) {\n        var _this = this;\n        var shouldNormalizeDelimiters = false;\n        // 1. find removed entities\n        getObjectKeys(this.state.entityMap).forEach(function (id) {\n            var item = _this.state.entityMap[id];\n            var element = item.element;\n            if (_this.editor && !item.isDeleted && !_this.editor.contains(element)) {\n                item.isDeleted = true;\n                _this.triggerEvent(element, 6 /* Overwrite */);\n                if (!shouldNormalizeDelimiters &&\n                    !element.isContentEditable &&\n                    !isBlockElement(element)) {\n                    shouldNormalizeDelimiters = true;\n                }\n            }\n        });\n        // 2. collect all new entities\n        var newEntities = (event === null || event === void 0 ? void 0 : event.source) == \"InsertEntity\" /* InsertEntity */ && event.data\n            ? [event.data]\n            : this.getExistingEntities().filter(function (entity) {\n                var item = _this.state.entityMap[entity.id];\n                return !item || item.element != entity.wrapper || item.isDeleted;\n            });\n        // 3. Add new entities to known entity list, and hydrate\n        newEntities.forEach(function (entity) {\n            var wrapper = entity.wrapper, type = entity.type, id = entity.id, isReadonly = entity.isReadonly;\n            entity.id = _this.ensureUniqueId(type, id, wrapper);\n            commitEntity(wrapper, type, isReadonly, entity.id); // Use entity.id here because it is newly updated\n            _this.handleNewEntity(entity);\n        });\n        if (shouldNormalizeDelimiters && this.editor) {\n            normalizeDelimitersInEditor(this.editor);\n        }\n    };\n    EntityPlugin.prototype.handleEntityOperationEvent = function (event) {\n        if (this.editor && REMOVE_ENTITY_OPERATIONS.indexOf(event.operation) >= 0) {\n            var item = this.state.entityMap[event.entity.id];\n            if (item) {\n                item.isDeleted = true;\n            }\n        }\n    };\n    EntityPlugin.prototype.handleExtractContentWithDomEvent = function (root) {\n        var _this = this;\n        toArray(root.querySelectorAll(getEntitySelector())).forEach(function (element) {\n            element.removeAttribute('contentEditable');\n            _this.triggerEvent(element, 8 /* ReplaceTemporaryContent */);\n        });\n    };\n    EntityPlugin.prototype.checkRemoveEntityForRange = function (event) {\n        var _this = this;\n        var _a;\n        var editableEntityElements = [];\n        var selector = getEntitySelector();\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.queryElements(selector, 1 /* OnSelection */, function (element) {\n            if (element.isContentEditable) {\n                editableEntityElements.push(element);\n            }\n            else {\n                _this.triggerEvent(element, 6 /* Overwrite */, event);\n            }\n        });\n        // For editable entities, we need to check if it is fully or partially covered by current selection,\n        // and trigger different events;\n        if (this.editor && editableEntityElements.length > 0) {\n            var inSelectionEntityElements_1 = this.editor.queryElements(selector, 2 /* InSelection */);\n            editableEntityElements.forEach(function (element) {\n                var isFullyCovered = inSelectionEntityElements_1.indexOf(element) >= 0;\n                _this.triggerEvent(element, isFullyCovered ? 6 /* Overwrite */ : 7 /* PartialOverwrite */, event);\n            });\n        }\n    };\n    EntityPlugin.prototype.triggerEvent = function (element, operation, rawEvent) {\n        var _a;\n        var entity = element && getEntityFromElement(element);\n        return entity\n            ? (_a = this.editor) === null || _a === void 0 ? void 0 : _a.triggerPluginEvent(15 /* EntityOperation */, {\n                operation: operation,\n                rawEvent: rawEvent,\n                entity: entity,\n            })\n            : null;\n    };\n    EntityPlugin.prototype.handleNewEntity = function (entity) {\n        var wrapper = entity.wrapper;\n        var event = this.triggerEvent(wrapper, 0 /* NewEntity */);\n        var newItem = {\n            element: entity.wrapper,\n        };\n        if (event === null || event === void 0 ? void 0 : event.shouldPersist) {\n            newItem.canPersist = true;\n        }\n        this.state.entityMap[entity.id] = newItem;\n    };\n    EntityPlugin.prototype.getExistingEntities = function () {\n        var _a, _b;\n        return ((_b = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.queryElements(getEntitySelector()).map(getEntityFromElement).filter(function (x) { return !!x; })) !== null && _b !== void 0 ? _b : []);\n    };\n    EntityPlugin.prototype.ensureUniqueId = function (type, id, wrapper) {\n        var match = ENTITY_ID_REGEX.exec(id);\n        var baseId = (match ? id.substr(0, id.length - match[0].length) : id) || type;\n        // Make sure entity id is unique\n        var newId = '';\n        for (var num = (match && parseInt(match[1])) || 0;; num++) {\n            newId = num > 0 ? baseId + \"_\" + num : baseId;\n            var item = this.state.entityMap[newId];\n            if (!item || item.element == wrapper) {\n                break;\n            }\n        }\n        return newId;\n    };\n    return EntityPlugin;\n}());\nexport default EntityPlugin;\n/**\n * IE will show a resize border around the readonly content within content editable DIV\n * This is a workaround to remove it by temporarily move focus out of editor\n */\nvar workaroundSelectionIssueForIE = Browser.isIE\n    ? function (editor) {\n        editor.runAsync(function (editor) {\n            var workaroundButton = editor.getCustomData('ENTITY_IE_FOCUS_BUTTON', function () {\n                var button = createElement({\n                    tag: 'button',\n                    style: 'overflow:hidden;position:fixed;width:0;height:0;top:-1000px',\n                }, editor.getDocument());\n                button.onblur = function () {\n                    button.style.display = 'none';\n                };\n                editor.insertNode(button, {\n                    position: 4 /* Outside */,\n                });\n                return button;\n            });\n            workaroundButton.style.display = '';\n            addRangeToSelection(createRange(workaroundButton, 0));\n        });\n    }\n    : function () { };\n//# sourceMappingURL=EntityPlugin.js.map","import { safeInstanceOf } from 'roosterjs-editor-dom';\nvar Escape = 'Escape';\nvar Delete = 'Delete';\nvar mouseMiddleButton = 1;\n/**\n * Detect image selection and help highlight the image\n */\nvar ImageSelection = /** @class */ (function () {\n    function ImageSelection() {\n        this.editor = null;\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    ImageSelection.prototype.getName = function () {\n        return 'ImageSelection';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    ImageSelection.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    ImageSelection.prototype.dispose = function () {\n        var _a;\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.select(null);\n        this.editor = null;\n    };\n    ImageSelection.prototype.onPluginEvent = function (event) {\n        var _a, _b;\n        if (this.editor) {\n            switch (event.eventType) {\n                case 6 /* MouseUp */:\n                    var target = event.rawEvent.target;\n                    if (safeInstanceOf(target, 'HTMLImageElement') &&\n                        target.isContentEditable &&\n                        event.rawEvent.button != mouseMiddleButton) {\n                        this.editor.select(target);\n                    }\n                    break;\n                case 5 /* MouseDown */:\n                    var mouseTarget = event.rawEvent.target;\n                    var mouseSelection = this.editor.getSelectionRangeEx();\n                    if (mouseSelection &&\n                        mouseSelection.type === 2 /* ImageSelection */ &&\n                        mouseSelection.image !== mouseTarget) {\n                        this.editor.select(null);\n                    }\n                    break;\n                case 0 /* KeyDown */:\n                    var rawEvent = event.rawEvent;\n                    var key = rawEvent.key;\n                    var keyDownSelection = this.editor.getSelectionRangeEx();\n                    if (!rawEvent.ctrlKey &&\n                        !rawEvent.altKey &&\n                        !rawEvent.shiftKey &&\n                        !rawEvent.metaKey &&\n                        keyDownSelection.type === 2 /* ImageSelection */) {\n                        var imageParent = (_a = keyDownSelection.image) === null || _a === void 0 ? void 0 : _a.parentNode;\n                        if (key === Escape && imageParent) {\n                            this.editor.select(keyDownSelection.image, -2 /* Before */);\n                            (_b = this.editor.getSelectionRange()) === null || _b === void 0 ? void 0 : _b.collapse();\n                            event.rawEvent.stopPropagation();\n                        }\n                        else if (key === Delete) {\n                            this.editor.deleteNode(keyDownSelection.image);\n                            event.rawEvent.preventDefault();\n                        }\n                        else if (imageParent) {\n                            this.editor.select(keyDownSelection.image, -2 /* Before */);\n                        }\n                    }\n                    break;\n                case 16 /* ContextMenu */:\n                    var contextMenuTarget = event.rawEvent.target;\n                    var actualSelection = this.editor.getSelectionRangeEx();\n                    if (safeInstanceOf(contextMenuTarget, 'HTMLImageElement') &&\n                        (actualSelection.type !== 2 /* ImageSelection */ ||\n                            actualSelection.image !== contextMenuTarget)) {\n                        this.editor.select(contextMenuTarget);\n                    }\n            }\n        }\n    };\n    return ImageSelection;\n}());\nexport default ImageSelection;\n//# sourceMappingURL=ImageSelection.js.map","import { __assign } from \"tslib\";\nimport { getObjectKeys, setColor } from 'roosterjs-editor-dom';\nvar CONTENT_EDITABLE_ATTRIBUTE_NAME = 'contenteditable';\nvar DARK_MODE_DEFAULT_FORMAT = {\n    backgroundColors: {\n        darkModeColor: 'rgb(51,51,51)',\n        lightModeColor: 'rgb(255,255,255)',\n    },\n    textColors: {\n        darkModeColor: 'rgb(255,255,255)',\n        lightModeColor: 'rgb(0,0,0)',\n    },\n};\n/**\n * @internal\n * Lifecycle plugin handles editor initialization and disposing\n */\nvar LifecyclePlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of LifecyclePlugin\n     * @param options The editor options\n     * @param contentDiv The editor content DIV\n     */\n    function LifecyclePlugin(options, contentDiv) {\n        var _this = this;\n        var _a, _b;\n        this.editor = null;\n        this.initializer = null;\n        this.disposer = null;\n        this.initialContent = options.initialContent || contentDiv.innerHTML || '';\n        // Make the container editable and set its selection styles\n        if (contentDiv.getAttribute(CONTENT_EDITABLE_ATTRIBUTE_NAME) === null) {\n            this.initializer = function () {\n                contentDiv.contentEditable = 'true';\n                contentDiv.style.userSelect = 'text';\n            };\n            this.disposer = function () {\n                contentDiv.style.userSelect = '';\n                contentDiv.removeAttribute(CONTENT_EDITABLE_ATTRIBUTE_NAME);\n            };\n        }\n        this.adjustColor = options.doNotAdjustEditorColor\n            ? function () { }\n            : function () {\n                var _a;\n                var textColors = DARK_MODE_DEFAULT_FORMAT.textColors, backgroundColors = DARK_MODE_DEFAULT_FORMAT.backgroundColors;\n                var isDarkMode = _this.state.isDarkMode;\n                var darkColorHandler = (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.getDarkColorHandler();\n                setColor(contentDiv, textColors, false /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n                setColor(contentDiv, backgroundColors, true /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n            };\n        var getDarkColor = (_a = options.getDarkColor) !== null && _a !== void 0 ? _a : (function (color) { return color; });\n        var defaultFormat = options.defaultFormat ? __assign({}, options.defaultFormat) : null;\n        if (defaultFormat) {\n            if (defaultFormat.textColor && !defaultFormat.textColors) {\n                defaultFormat.textColors = {\n                    lightModeColor: defaultFormat.textColor,\n                    darkModeColor: getDarkColor(defaultFormat.textColor),\n                };\n                delete defaultFormat.textColor;\n            }\n            if (defaultFormat.backgroundColor && !defaultFormat.backgroundColors) {\n                defaultFormat.backgroundColors = {\n                    lightModeColor: defaultFormat.backgroundColor,\n                    darkModeColor: getDarkColor(defaultFormat.backgroundColor),\n                };\n                delete defaultFormat.backgroundColor;\n            }\n        }\n        this.state = {\n            customData: {},\n            defaultFormat: defaultFormat,\n            isDarkMode: !!options.inDarkMode,\n            getDarkColor: getDarkColor,\n            onExternalContentTransform: (_b = options.onExternalContentTransform) !== null && _b !== void 0 ? _b : null,\n            experimentalFeatures: options.experimentalFeatures || [],\n            shadowEditFragment: null,\n            shadowEditEntities: null,\n            shadowEditSelectionPath: null,\n            shadowEditTableSelectionPath: null,\n            shadowEditImageSelectionPath: null,\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    LifecyclePlugin.prototype.getName = function () {\n        return 'Lifecycle';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    LifecyclePlugin.prototype.initialize = function (editor) {\n        var _a;\n        this.editor = editor;\n        // Ensure initial content and its format\n        this.editor.setContent(this.initialContent, false /*triggerContentChangedEvent*/);\n        // Set content DIV to be editable\n        (_a = this.initializer) === null || _a === void 0 ? void 0 : _a.call(this);\n        // Set editor background color for dark mode\n        this.adjustColor();\n        // Let other plugins know that we are ready\n        this.editor.triggerPluginEvent(11 /* EditorReady */, {}, true /*broadcast*/);\n    };\n    /**\n     * Dispose this plugin\n     */\n    LifecyclePlugin.prototype.dispose = function () {\n        var _this = this;\n        var _a;\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.triggerPluginEvent(12 /* BeforeDispose */, {}, true /*broadcast*/);\n        getObjectKeys(this.state.customData).forEach(function (key) {\n            var data = _this.state.customData[key];\n            if (data && data.disposer) {\n                data.disposer(data.value);\n            }\n            delete _this.state.customData[key];\n        });\n        if (this.disposer) {\n            this.disposer();\n            this.disposer = null;\n            this.initializer = null;\n        }\n        this.editor = null;\n    };\n    /**\n     * Get plugin state object\n     */\n    LifecyclePlugin.prototype.getState = function () {\n        return this.state;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    LifecyclePlugin.prototype.onPluginEvent = function (event) {\n        if (event.eventType == 7 /* ContentChanged */ &&\n            (event.source == \"SwitchToDarkMode\" /* SwitchToDarkMode */ ||\n                event.source == \"SwitchToLightMode\" /* SwitchToLightMode */)) {\n            this.state.isDarkMode = event.source == \"SwitchToDarkMode\" /* SwitchToDarkMode */;\n            this.adjustColor();\n        }\n    };\n    return LifecyclePlugin;\n}());\nexport default LifecyclePlugin;\n//# sourceMappingURL=LifecyclePlugin.js.map","/**\n * @internal\n * MouseUpPlugin help trigger MouseUp event even when mouse up happens outside editor\n * as long as the mouse was pressed within Editor before\n */\nvar MouseUpPlugin = /** @class */ (function () {\n    function MouseUpPlugin() {\n        var _this = this;\n        this.editor = null;\n        this.mouseUpEventListerAdded = false;\n        this.mouseDownX = null;\n        this.mouseDownY = null;\n        this.onMouseUp = function (rawEvent) {\n            if (_this.editor) {\n                _this.removeMouseUpEventListener();\n                _this.editor.triggerPluginEvent(6 /* MouseUp */, {\n                    rawEvent: rawEvent,\n                    isClicking: _this.mouseDownX == rawEvent.pageX && _this.mouseDownY == rawEvent.pageY,\n                });\n            }\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    MouseUpPlugin.prototype.getName = function () {\n        return 'MouseUp';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    MouseUpPlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    MouseUpPlugin.prototype.dispose = function () {\n        this.removeMouseUpEventListener();\n        this.editor = null;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    MouseUpPlugin.prototype.onPluginEvent = function (event) {\n        if (this.editor &&\n            event.eventType == 5 /* MouseDown */ &&\n            !this.mouseUpEventListerAdded) {\n            this.editor\n                .getDocument()\n                .addEventListener('mouseup', this.onMouseUp, true /*setCapture*/);\n            this.mouseUpEventListerAdded = true;\n            this.mouseDownX = event.rawEvent.pageX;\n            this.mouseDownY = event.rawEvent.pageY;\n        }\n    };\n    MouseUpPlugin.prototype.removeMouseUpEventListener = function () {\n        if (this.editor && this.mouseUpEventListerAdded) {\n            this.mouseUpEventListerAdded = false;\n            this.editor.getDocument().removeEventListener('mouseup', this.onMouseUp, true);\n        }\n    };\n    return MouseUpPlugin;\n}());\nexport default MouseUpPlugin;\n//# sourceMappingURL=MouseUpPlugin.js.map","import { changeElementTag, getTagOfNode, moveChildNodes, safeInstanceOf, toArray, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * TODO: Rename this plugin since it is not only for table now\n *\n * NormalizeTable plugin makes sure each table in editor has TBODY/THEAD/TFOOT tag around TR tags\n *\n * When we retrieve HTML content using innerHTML, browser will always add TBODY around TR nodes if there is not.\n * This causes some issue when we restore the HTML content with selection path since the selection path is\n * deeply coupled with DOM structure. So we need to always make sure there is already TBODY tag whenever\n * new table is inserted, to make sure the selection path we created is correct.\n */\nvar NormalizeTablePlugin = /** @class */ (function () {\n    function NormalizeTablePlugin() {\n        this.editor = null;\n    }\n    /**\n     * Get a friendly name of this plugin\n     */\n    NormalizeTablePlugin.prototype.getName = function () {\n        return 'NormalizeTable';\n    };\n    /**\n     * The first method that editor will call to a plugin when editor is initializing.\n     * It will pass in the editor instance, plugin should take this chance to save the\n     * editor reference so that it can call to any editor method or format API later.\n     * @param editor The editor object\n     */\n    NormalizeTablePlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * The last method that editor will call to a plugin before it is disposed.\n     * Plugin can take this chance to clear the reference to editor. After this method is\n     * called, plugin should not call to any editor method since it will result in error.\n     */\n    NormalizeTablePlugin.prototype.dispose = function () {\n        this.editor = null;\n    };\n    /**\n     * Core method for a plugin. Once an event happens in editor, editor will call this\n     * method of each plugin to handle the event as long as the event is not handled\n     * exclusively by another plugin.\n     * @param event The event to handle:\n     */\n    NormalizeTablePlugin.prototype.onPluginEvent = function (event) {\n        switch (event.eventType) {\n            case 11 /* EditorReady */:\n            case 7 /* ContentChanged */:\n                if (this.editor) {\n                    this.normalizeTables(this.editor.queryElements('table'));\n                }\n                break;\n            case 10 /* BeforePaste */:\n                this.normalizeTables(toArray(event.fragment.querySelectorAll('table')));\n                break;\n            case 5 /* MouseDown */:\n                this.normalizeTableFromEvent(event.rawEvent);\n                break;\n            case 0 /* KeyDown */:\n                if (event.rawEvent.shiftKey) {\n                    this.normalizeTableFromEvent(event.rawEvent);\n                }\n                break;\n            case 8 /* ExtractContentWithDom */:\n                normalizeListsForExport(event.clonedRoot);\n                break;\n        }\n    };\n    NormalizeTablePlugin.prototype.normalizeTableFromEvent = function (event) {\n        var _a;\n        var table = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getElementAtCursor('table', event.target);\n        if (table) {\n            this.normalizeTables([table]);\n        }\n    };\n    NormalizeTablePlugin.prototype.normalizeTables = function (tables) {\n        if (this.editor && tables.length > 0) {\n            var rangeEx = this.editor.getSelectionRangeEx();\n            var _a = ((rangeEx === null || rangeEx === void 0 ? void 0 : rangeEx.type) == 0 /* Normal */ && rangeEx.ranges[0]) || {}, startContainer = _a.startContainer, endContainer = _a.endContainer, startOffset = _a.startOffset, endOffset = _a.endOffset;\n            var isChanged = normalizeTables(tables);\n            if (isChanged) {\n                if (startContainer &&\n                    endContainer &&\n                    typeof startOffset === 'number' &&\n                    typeof endOffset === 'number') {\n                    this.editor.select(startContainer, startOffset, endContainer, endOffset);\n                }\n                else if ((rangeEx === null || rangeEx === void 0 ? void 0 : rangeEx.type) == 1 /* TableSelection */ &&\n                    rangeEx.coordinates) {\n                    this.editor.select(rangeEx.table, rangeEx.coordinates);\n                }\n            }\n        }\n    };\n    return NormalizeTablePlugin;\n}());\nexport default NormalizeTablePlugin;\nfunction normalizeTables(tables) {\n    var isDOMChanged = false;\n    tables.forEach(function (table) {\n        var _a;\n        var tbody = null;\n        for (var child = table.firstChild; child; child = child.nextSibling) {\n            var tag = getTagOfNode(child);\n            switch (tag) {\n                case 'TR':\n                    if (!tbody) {\n                        tbody = table.ownerDocument.createElement('tbody');\n                        table.insertBefore(tbody, child);\n                    }\n                    tbody.appendChild(child);\n                    child = tbody;\n                    isDOMChanged = true;\n                    break;\n                case 'TBODY':\n                    if (tbody) {\n                        moveChildNodes(tbody, child, true /*keepExistingChildren*/);\n                        (_a = child.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(child);\n                        child = tbody;\n                        isDOMChanged = true;\n                    }\n                    else {\n                        tbody = child;\n                    }\n                    break;\n                default:\n                    tbody = null;\n                    break;\n            }\n        }\n        var colgroups = table.querySelectorAll('colgroup');\n        var thead = table.querySelector('thead');\n        if (thead) {\n            colgroups.forEach(function (colgroup) {\n                if (!thead.contains(colgroup)) {\n                    thead.appendChild(colgroup);\n                }\n            });\n        }\n    });\n    return isDOMChanged;\n}\nfunction normalizeListsForExport(root) {\n    toArray(root.querySelectorAll('li')).forEach(function (li) {\n        var prevElement = li.previousSibling;\n        if (li.style.display == 'block' && safeInstanceOf(prevElement, 'HTMLLIElement')) {\n            li.style.removeProperty('display');\n            prevElement.appendChild(changeElementTag(li, 'div'));\n        }\n    });\n}\n//# sourceMappingURL=NormalizeTablePlugin.js.map","import { isCharacterValue, Position, setColor } from 'roosterjs-editor-dom';\nvar ZERO_WIDTH_SPACE = '\\u200B';\n/**\n * @internal\n * PendingFormatStatePlugin handles pending format state management\n */\nvar PendingFormatStatePlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of PendingFormatStatePlugin\n     * @param options The editor options\n     * @param contentDiv The editor content DIV\n     */\n    function PendingFormatStatePlugin() {\n        this.editor = null;\n        this.state = {\n            pendableFormatPosition: null,\n            pendableFormatState: null,\n            pendableFormatSpan: null,\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    PendingFormatStatePlugin.prototype.getName = function () {\n        return 'PendingFormatState';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    PendingFormatStatePlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    PendingFormatStatePlugin.prototype.dispose = function () {\n        this.editor = null;\n        this.clear();\n    };\n    /**\n     * Get plugin state object\n     */\n    PendingFormatStatePlugin.prototype.getState = function () {\n        return this.state;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    PendingFormatStatePlugin.prototype.onPluginEvent = function (event) {\n        switch (event.eventType) {\n            case 13 /* PendingFormatStateChanged */:\n                // Got PendingFormatStateChanged event, cache current position and pending format if a format is passed in\n                // otherwise clear existing pending format.\n                if (event.formatState) {\n                    this.state.pendableFormatPosition = this.getCurrentPosition();\n                    this.state.pendableFormatState = event.formatState;\n                    this.state.pendableFormatSpan = event.formatCallback\n                        ? this.createPendingFormatSpan(event.formatCallback)\n                        : null;\n                }\n                else {\n                    this.clear();\n                }\n                break;\n            case 0 /* KeyDown */:\n            case 5 /* MouseDown */:\n            case 7 /* ContentChanged */:\n                var currentPosition = null;\n                if (this.editor &&\n                    event.eventType == 0 /* KeyDown */ &&\n                    isCharacterValue(event.rawEvent) &&\n                    this.state.pendableFormatSpan) {\n                    this.state.pendableFormatSpan.removeAttribute('contentEditable');\n                    this.editor.insertNode(this.state.pendableFormatSpan);\n                    this.editor.select(this.state.pendableFormatSpan, 0 /* Begin */, this.state.pendableFormatSpan, -1 /* End */);\n                    this.clear();\n                }\n                else if ((event.eventType == 0 /* KeyDown */ &&\n                    event.rawEvent.which >= 33 /* PAGEUP */ &&\n                    event.rawEvent.which <= 40 /* DOWN */) ||\n                    (this.state.pendableFormatPosition &&\n                        (currentPosition = this.getCurrentPosition()) &&\n                        !this.state.pendableFormatPosition.equalTo(currentPosition)) ||\n                    (event.eventType == 7 /* ContentChanged */ &&\n                        (event.source == \"SwitchToDarkMode\" /* SwitchToDarkMode */ ||\n                            event.source == \"SwitchToLightMode\" /* SwitchToLightMode */))) {\n                    // If content or position is changed (by keyboard, mouse, or code),\n                    // check if current position is still the same with the cached one (if exist),\n                    // and clear cached format if position is changed since it is out-of-date now\n                    this.clear();\n                }\n                break;\n        }\n    };\n    PendingFormatStatePlugin.prototype.clear = function () {\n        this.state.pendableFormatPosition = null;\n        this.state.pendableFormatState = null;\n        this.state.pendableFormatSpan = null;\n    };\n    PendingFormatStatePlugin.prototype.getCurrentPosition = function () {\n        var _a, _b;\n        var range = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getSelectionRange();\n        return (_b = (range && Position.getStart(range).normalize())) !== null && _b !== void 0 ? _b : null;\n    };\n    PendingFormatStatePlugin.prototype.createPendingFormatSpan = function (callback) {\n        var _a, _b;\n        var span = this.state.pendableFormatSpan;\n        if (!span && this.editor) {\n            var currentStyle = this.editor.getStyleBasedFormatState();\n            var doc = this.editor.getDocument();\n            var isDarkMode = this.editor.isDarkMode();\n            span = doc.createElement('span');\n            span.contentEditable = 'true';\n            span.appendChild(doc.createTextNode(ZERO_WIDTH_SPACE));\n            span.style.setProperty('font-family', (_a = currentStyle.fontName) !== null && _a !== void 0 ? _a : null);\n            span.style.setProperty('font-size', (_b = currentStyle.fontSize) !== null && _b !== void 0 ? _b : null);\n            var darkColorHandler = this.editor.getDarkColorHandler();\n            if (currentStyle.textColors || currentStyle.textColor) {\n                setColor(span, (currentStyle.textColors || currentStyle.textColor), false /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n            }\n            if (currentStyle.backgroundColors || currentStyle.backgroundColor) {\n                setColor(span, (currentStyle.backgroundColors || currentStyle.backgroundColor), true /*isBackground*/, isDarkMode, false /*shouldAdaptFontColor*/, darkColorHandler);\n            }\n        }\n        if (span) {\n            callback(span);\n        }\n        return span;\n    };\n    return PendingFormatStatePlugin;\n}());\nexport default PendingFormatStatePlugin;\n//# sourceMappingURL=PendingFormatStatePlugin.js.map","var _a, _b;\nimport { getObjectKeys, parseColor, setColor } from 'roosterjs-editor-dom';\nvar VARIABLE_REGEX = /^\\s*var\\(\\s*(\\-\\-[a-zA-Z0-9\\-_]+)\\s*(?:,\\s*(.*))?\\)\\s*$/;\nvar VARIABLE_PREFIX = 'var(';\nvar COLOR_VAR_PREFIX = 'darkColor';\nvar ColorAttributeEnum;\n(function (ColorAttributeEnum) {\n    ColorAttributeEnum[ColorAttributeEnum[\"CssColor\"] = 0] = \"CssColor\";\n    ColorAttributeEnum[ColorAttributeEnum[\"HtmlColor\"] = 1] = \"HtmlColor\";\n})(ColorAttributeEnum || (ColorAttributeEnum = {}));\nvar ColorAttributeName = [\n    (_a = {},\n        _a[0 /* CssColor */] = 'color',\n        _a[1 /* HtmlColor */] = 'color',\n        _a),\n    (_b = {},\n        _b[0 /* CssColor */] = 'background-color',\n        _b[1 /* HtmlColor */] = 'bgcolor',\n        _b),\n];\n/**\n * @internal\n */\nvar DarkColorHandlerImpl = /** @class */ (function () {\n    function DarkColorHandlerImpl(contentDiv, getDarkColor) {\n        this.contentDiv = contentDiv;\n        this.getDarkColor = getDarkColor;\n        this.knownColors = {};\n    }\n    /**\n     * Get a copy of known colors\n     * @returns\n     */\n    DarkColorHandlerImpl.prototype.getKnownColorsCopy = function () {\n        return Object.values(this.knownColors);\n    };\n    /**\n     * Given a light mode color value and an optional dark mode color value, register this color\n     * so that editor can handle it, then return the CSS color value for current color mode.\n     * @param lightModeColor Light mode color value\n     * @param isDarkMode Whether current color mode is dark mode\n     * @param darkModeColor Optional dark mode color value. If not passed, we will calculate one.\n     */\n    DarkColorHandlerImpl.prototype.registerColor = function (lightModeColor, isDarkMode, darkModeColor) {\n        var parsedColor = this.parseColorValue(lightModeColor);\n        var colorKey;\n        if (parsedColor) {\n            lightModeColor = parsedColor.lightModeColor;\n            darkModeColor = parsedColor.darkModeColor || darkModeColor;\n            colorKey = parsedColor.key;\n        }\n        if (isDarkMode && lightModeColor) {\n            colorKey =\n                colorKey || \"--\" + COLOR_VAR_PREFIX + \"_\" + lightModeColor.replace(/[^\\d\\w]/g, '_');\n            if (!this.knownColors[colorKey]) {\n                darkModeColor = darkModeColor || this.getDarkColor(lightModeColor);\n                this.knownColors[colorKey] = { lightModeColor: lightModeColor, darkModeColor: darkModeColor };\n                this.contentDiv.style.setProperty(colorKey, darkModeColor);\n            }\n            return \"var(\" + colorKey + \", \" + lightModeColor + \")\";\n        }\n        else {\n            return lightModeColor;\n        }\n    };\n    /**\n     * Reset known color record, clean up registered color variables.\n     */\n    DarkColorHandlerImpl.prototype.reset = function () {\n        var _this = this;\n        getObjectKeys(this.knownColors).forEach(function (key) { return _this.contentDiv.style.removeProperty(key); });\n        this.knownColors = {};\n    };\n    /**\n     * Parse an existing color value, if it is in variable-based color format, extract color key,\n     * light color and query related dark color if any\n     * @param color The color string to parse\n     * @param isInDarkMode Whether current content is in dark mode. When set to true, if the color value is not in dark var format,\n     * we will treat is as a dark mode color and try to find a matched dark mode color.\n     */\n    DarkColorHandlerImpl.prototype.parseColorValue = function (color, isInDarkMode) {\n        var _a;\n        var key;\n        var lightModeColor = '';\n        var darkModeColor;\n        if (color) {\n            var match = color.startsWith(VARIABLE_PREFIX) ? VARIABLE_REGEX.exec(color) : null;\n            if (match) {\n                if (match[2]) {\n                    key = match[1];\n                    lightModeColor = match[2];\n                    darkModeColor = (_a = this.knownColors[key]) === null || _a === void 0 ? void 0 : _a.darkModeColor;\n                }\n                else {\n                    lightModeColor = '';\n                }\n            }\n            else if (isInDarkMode) {\n                // If editor is in dark mode but the color is not in dark color format, it is possible the color was inserted from external code\n                // without any light color info. So we first try to see if there is a known dark color can match this color, and use its related\n                // light color as light mode color. Otherwise we need to drop this color to avoid show \"white on white\" content.\n                lightModeColor = this.findLightColorFromDarkColor(color) || '';\n                if (lightModeColor) {\n                    darkModeColor = color;\n                }\n            }\n            else {\n                lightModeColor = color;\n            }\n        }\n        return { key: key, lightModeColor: lightModeColor, darkModeColor: darkModeColor };\n    };\n    /**\n     * Find related light mode color from dark mode color.\n     * @param darkColor The existing dark color\n     */\n    DarkColorHandlerImpl.prototype.findLightColorFromDarkColor = function (darkColor) {\n        var _this = this;\n        var rgbSearch = parseColor(darkColor);\n        if (rgbSearch) {\n            var key = getObjectKeys(this.knownColors).find(function (key) {\n                var rgbCurrent = parseColor(_this.knownColors[key].darkModeColor);\n                return (rgbCurrent &&\n                    rgbCurrent[0] == rgbSearch[0] &&\n                    rgbCurrent[1] == rgbSearch[1] &&\n                    rgbCurrent[2] == rgbSearch[2]);\n            });\n            if (key) {\n                return this.knownColors[key].lightModeColor;\n            }\n        }\n        return null;\n    };\n    /**\n     * Transform element color, from dark to light or from light to dark\n     * @param element The element to transform color\n     * @param fromDarkMode Whether this is transforming color from dark mode\n     * @param toDarkMode Whether this is transforming color to dark mode\n     */\n    DarkColorHandlerImpl.prototype.transformElementColor = function (element, fromDarkMode, toDarkMode) {\n        var _this = this;\n        ColorAttributeName.forEach(function (names, i) {\n            var color = _this.parseColorValue(element.style.getPropertyValue(names[0 /* CssColor */]) ||\n                element.getAttribute(names[1 /* HtmlColor */]), !!fromDarkMode).lightModeColor;\n            element.style.setProperty(names[0 /* CssColor */], null);\n            element.removeAttribute(names[1 /* HtmlColor */]);\n            if (color && color != 'inherit') {\n                setColor(element, color, i != 0, toDarkMode, false /*shouldAdaptFontColor*/, _this);\n            }\n        });\n    };\n    return DarkColorHandlerImpl;\n}());\nexport default DarkColorHandlerImpl;\n//# sourceMappingURL=DarkColorHandlerImpl.js.map","import { Browser, findClosestElementAncestor, getTagOfNode, isCtrlOrMetaPressed, Position, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Typing Component helps to ensure typing is always happening under a DOM container\n */\nvar TypeInContainerPlugin = /** @class */ (function () {\n    function TypeInContainerPlugin() {\n        this.editor = null;\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    TypeInContainerPlugin.prototype.getName = function () {\n        return 'TypeInContainer';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    TypeInContainerPlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    TypeInContainerPlugin.prototype.dispose = function () {\n        this.editor = null;\n    };\n    TypeInContainerPlugin.prototype.isRangeEmpty = function (range) {\n        if (range.collapsed &&\n            range.startContainer.nodeType === Node.ELEMENT_NODE &&\n            getTagOfNode(range.startContainer) == 'DIV' &&\n            !range.startContainer.firstChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    TypeInContainerPlugin.prototype.onPluginEvent = function (event) {\n        var _this = this;\n        var _a;\n        // We need to check if the ctrl key or the meta key is pressed,\n        // browsers like Safari fire the \"keypress\" event when the meta key is pressed.\n        if (event.eventType == 1 /* KeyPress */ &&\n            this.editor &&\n            !(event.rawEvent && isCtrlOrMetaPressed(event.rawEvent))) {\n            // If normalization was not possible before the keypress,\n            // check again after the keyboard event has been processed by browser native behavior.\n            //\n            // This handles the case where the keyboard event that first inserts content happens when\n            // there is already content under the selection (e.g. Ctrl+a -> type new content).\n            //\n            // Only schedule when the range is not collapsed to catch this edge case.\n            var range = this.editor.getSelectionRange();\n            var styledAncestor = range &&\n                findClosestElementAncestor(range.startContainer, undefined /* root */, '[style]');\n            if (!range || (!this.isRangeEmpty(range) && this.editor.contains(styledAncestor))) {\n                return;\n            }\n            if (range.collapsed) {\n                this.editor.ensureTypeInContainer(Position.getStart(range), event.rawEvent);\n            }\n            else {\n                var callback = function () {\n                    var _a, _b;\n                    var focusedPosition = (_a = _this.editor) === null || _a === void 0 ? void 0 : _a.getFocusedPosition();\n                    if (focusedPosition) {\n                        (_b = _this.editor) === null || _b === void 0 ? void 0 : _b.ensureTypeInContainer(focusedPosition, event.rawEvent);\n                    }\n                };\n                if (Browser.isMobileOrTablet) {\n                    (_a = this.editor.getDocument().defaultView) === null || _a === void 0 ? void 0 : _a.setTimeout(callback, 100);\n                }\n                else {\n                    this.editor.runAsync(callback);\n                }\n            }\n        }\n    };\n    return TypeInContainerPlugin;\n}());\nexport default TypeInContainerPlugin;\n//# sourceMappingURL=TypeInContainerPlugin.js.map","import { addSnapshotV2, canMoveCurrentSnapshot, clearProceedingSnapshotsV2, createSnapshots, isCtrlOrMetaPressed, moveCurrentSnapshot, canUndoAutoComplete, } from 'roosterjs-editor-dom';\n// Max stack size that cannot be exceeded. When exceeded, old undo history will be dropped\n// to keep size under limit. This is kept at 10MB\nvar MAX_SIZE_LIMIT = 1e7;\n/**\n * @internal\n * Provides snapshot based undo service for Editor\n */\nvar UndoPlugin = /** @class */ (function () {\n    /**\n     * Construct a new instance of UndoPlugin\n     * @param options The wrapper of the state object\n     */\n    function UndoPlugin(options) {\n        this.editor = null;\n        this.lastKeyPress = null;\n        this.state = {\n            snapshotsService: options.undoMetadataSnapshotService ||\n                createUndoSnapshotServiceBridge(options.undoSnapshotService) ||\n                createUndoSnapshots(),\n            isRestoring: false,\n            hasNewContent: false,\n            isNested: false,\n            autoCompletePosition: null,\n        };\n    }\n    /**\n     * Get a friendly name of  this plugin\n     */\n    UndoPlugin.prototype.getName = function () {\n        return 'Undo';\n    };\n    /**\n     * Initialize this plugin. This should only be called from Editor\n     * @param editor Editor instance\n     */\n    UndoPlugin.prototype.initialize = function (editor) {\n        this.editor = editor;\n    };\n    /**\n     * Dispose this plugin\n     */\n    UndoPlugin.prototype.dispose = function () {\n        this.editor = null;\n    };\n    /**\n     * Get plugin state object\n     */\n    UndoPlugin.prototype.getState = function () {\n        return this.state;\n    };\n    /**\n     * Check if the plugin should handle the given event exclusively.\n     * @param event The event to check\n     */\n    UndoPlugin.prototype.willHandleEventExclusively = function (event) {\n        return (event.eventType == 0 /* KeyDown */ &&\n            event.rawEvent.which == 8 /* BACKSPACE */ &&\n            !event.rawEvent.ctrlKey &&\n            this.canUndoAutoComplete());\n    };\n    /**\n     * Handle events triggered from editor\n     * @param event PluginEvent object\n     */\n    UndoPlugin.prototype.onPluginEvent = function (event) {\n        // if editor is in IME, don't do anything\n        if (!this.editor || this.editor.isInIME()) {\n            return;\n        }\n        switch (event.eventType) {\n            case 11 /* EditorReady */:\n                var undoState = this.editor.getUndoState();\n                if (!undoState.canUndo && !undoState.canRedo) {\n                    // Only add initial snapshot when there is no existing snapshot\n                    // Otherwise preserved undo/redo state may be ruined\n                    this.addUndoSnapshot();\n                }\n                break;\n            case 0 /* KeyDown */:\n                this.onKeyDown(event.rawEvent);\n                break;\n            case 1 /* KeyPress */:\n                this.onKeyPress(event.rawEvent);\n                break;\n            case 4 /* CompositionEnd */:\n                this.clearRedoForInput();\n                this.addUndoSnapshot();\n                break;\n            case 7 /* ContentChanged */:\n                this.onContentChanged(event);\n                break;\n            case 23 /* BeforeKeyboardEditing */:\n                this.onBeforeKeyboardEditing(event.rawEvent);\n                break;\n        }\n    };\n    UndoPlugin.prototype.onKeyDown = function (evt) {\n        var _a, _b;\n        // Handle backspace/delete when there is a selection to take a snapshot\n        // since we want the state prior to deletion restorable\n        // Ignore if keycombo is ALT+BACKSPACE\n        if ((evt.which == 8 /* BACKSPACE */ && !evt.altKey) || evt.which == 46 /* DELETE */) {\n            if (evt.which == 8 /* BACKSPACE */ && !evt.ctrlKey && this.canUndoAutoComplete()) {\n                evt.preventDefault();\n                (_a = this.editor) === null || _a === void 0 ? void 0 : _a.undo();\n                this.state.autoCompletePosition = null;\n                this.lastKeyPress = evt.which;\n            }\n            else if (!evt.defaultPrevented) {\n                var selectionRange = (_b = this.editor) === null || _b === void 0 ? void 0 : _b.getSelectionRange();\n                // Add snapshot when\n                // 1. Something has been selected (not collapsed), or\n                // 2. It has a different key code from the last keyDown event (to prevent adding too many snapshot when keeping press the same key), or\n                // 3. Ctrl/Meta key is pressed so that a whole word will be deleted\n                if (selectionRange &&\n                    (!selectionRange.collapsed ||\n                        this.lastKeyPress != evt.which ||\n                        isCtrlOrMetaPressed(evt))) {\n                    this.addUndoSnapshot();\n                }\n                // Since some content is deleted, always set hasNewContent to true so that we will take undo snapshot next time\n                this.state.hasNewContent = true;\n                this.lastKeyPress = evt.which;\n            }\n        }\n        else if (evt.which >= 33 /* PAGEUP */ && evt.which <= 40 /* DOWN */) {\n            // PageUp, PageDown, Home, End, Left, Right, Up, Down\n            if (this.state.hasNewContent) {\n                this.addUndoSnapshot();\n            }\n            this.lastKeyPress = 0;\n        }\n        else if (this.lastKeyPress == 8 /* BACKSPACE */ || this.lastKeyPress == 46 /* DELETE */) {\n            if (this.state.hasNewContent) {\n                this.addUndoSnapshot();\n            }\n        }\n    };\n    UndoPlugin.prototype.onKeyPress = function (evt) {\n        var _a;\n        if (evt.metaKey) {\n            // if metaKey is pressed, simply return since no actual effect will be taken on the editor.\n            // this is to prevent changing hasNewContent to true when meta + v to paste on Safari.\n            return;\n        }\n        var range = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getSelectionRange();\n        if ((range && !range.collapsed) ||\n            (evt.which == 32 /* SPACE */ && this.lastKeyPress != 32 /* SPACE */) ||\n            evt.which == 13 /* ENTER */) {\n            this.addUndoSnapshot();\n            if (evt.which == 13 /* ENTER */) {\n                // Treat ENTER as new content so if there is no input after ENTER and undo,\n                // we restore the snapshot before ENTER\n                this.state.hasNewContent = true;\n            }\n        }\n        else {\n            this.clearRedoForInput();\n        }\n        this.lastKeyPress = evt.which;\n    };\n    UndoPlugin.prototype.onBeforeKeyboardEditing = function (event) {\n        // For keyboard event (triggered from Content Model), we can get its keycode from event.data\n        // And when user is keep pressing the same key, mark editor with \"hasNewContent\" so that next time user\n        // do some other action or press a different key, we will add undo snapshot\n        if (event.which != this.lastKeyPress) {\n            this.addUndoSnapshot();\n        }\n        this.lastKeyPress = event.which;\n        this.state.hasNewContent = true;\n    };\n    UndoPlugin.prototype.onContentChanged = function (event) {\n        if (!(this.state.isRestoring ||\n            event.source == \"SwitchToDarkMode\" /* SwitchToDarkMode */ ||\n            event.source == \"SwitchToLightMode\" /* SwitchToLightMode */ ||\n            event.source == \"Keyboard\" /* Keyboard */)) {\n            this.clearRedoForInput();\n        }\n    };\n    UndoPlugin.prototype.clearRedoForInput = function () {\n        this.state.snapshotsService.clearRedo();\n        this.lastKeyPress = 0;\n        this.state.hasNewContent = true;\n    };\n    UndoPlugin.prototype.canUndoAutoComplete = function () {\n        var _a, _b;\n        var focusedPosition = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.getFocusedPosition();\n        return (this.state.snapshotsService.canUndoAutoComplete() &&\n            !!focusedPosition &&\n            !!((_b = this.state.autoCompletePosition) === null || _b === void 0 ? void 0 : _b.equalTo(focusedPosition)));\n    };\n    UndoPlugin.prototype.addUndoSnapshot = function () {\n        var _a;\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.addUndoSnapshot();\n        this.state.autoCompletePosition = null;\n    };\n    return UndoPlugin;\n}());\nexport default UndoPlugin;\nfunction createUndoSnapshots() {\n    var snapshots = createSnapshots(MAX_SIZE_LIMIT);\n    return {\n        canMove: function (delta) { return canMoveCurrentSnapshot(snapshots, delta); },\n        move: function (delta) { return moveCurrentSnapshot(snapshots, delta); },\n        addSnapshot: function (snapshot, isAutoCompleteSnapshot) {\n            return addSnapshotV2(snapshots, snapshot, isAutoCompleteSnapshot);\n        },\n        clearRedo: function () { return clearProceedingSnapshotsV2(snapshots); },\n        canUndoAutoComplete: function () { return canUndoAutoComplete(snapshots); },\n    };\n}\nfunction createUndoSnapshotServiceBridge(service) {\n    var html;\n    return service\n        ? {\n            canMove: function (delta) { return service.canMove(delta); },\n            move: function (delta) {\n                return (html = service.move(delta)) ? { html: html, metadata: null, knownColors: [] } : null;\n            },\n            addSnapshot: function (snapshot, isAutoCompleteSnapshot) {\n                return service.addSnapshot(snapshot.html +\n                    (snapshot.metadata ? \"<!--\" + JSON.stringify(snapshot.metadata) + \"-->\" : ''), isAutoCompleteSnapshot);\n            },\n            clearRedo: function () { return service.clearRedo(); },\n            canUndoAutoComplete: function () { return service.canUndoAutoComplete(); },\n        }\n        : undefined;\n}\n//# sourceMappingURL=UndoPlugin.js.map","/**\n * Create initial snapshots\n * @param maxSize max size of all snapshots\n */\nexport default function createSnapshots(maxSize) {\n    return {\n        snapshots: [],\n        totalSize: 0,\n        currentIndex: -1,\n        autoCompleteIndex: -1,\n        maxSize: maxSize,\n    };\n}\n//# sourceMappingURL=createSnapshots.js.map","import canMoveCurrentSnapshot from './canMoveCurrentSnapshot';\n/**\n * Move current snapshot with the given step if can move this step. Otherwise no action and return null\n * @param snapshots The snapshots data structure to move\n * @param step The step to move\n * @returns If can move with the given step, returns the snapshot after move, otherwise null\n */\nexport default function moveCurrentSnapshot(snapshots, step) {\n    if (canMoveCurrentSnapshot(snapshots, step)) {\n        snapshots.currentIndex += step;\n        snapshots.autoCompleteIndex = -1;\n        return snapshots.snapshots[snapshots.currentIndex];\n    }\n    else {\n        return null;\n    }\n}\n/**\n * @deprecated\n * For backward compatibility only\n */\nexport var moveCurrentSnapsnot = moveCurrentSnapshot;\n//# sourceMappingURL=moveCurrentSnapshot.js.map","/**\n * Whether there is a snapshot added before auto complete and it can be undone now\n */\nexport default function canUndoAutoComplete(snapshots) {\n    return (snapshots.autoCompleteIndex >= 0 &&\n        snapshots.currentIndex - snapshots.autoCompleteIndex == 1);\n}\n//# sourceMappingURL=canUndoAutoComplete.js.map","import { __assign } from \"tslib\";\nimport { getSelectionPath, Position } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Call an editing callback with adding undo snapshots around, and trigger a ContentChanged event if change source is specified.\n * Undo snapshot will not be added if this call is nested inside another addUndoSnapshot() call.\n * @param core The EditorCore object\n * @param callback The editing callback, accepting current selection start and end position, returns an optional object used as the data field of ContentChangedEvent.\n * @param changeSource The ChangeSource string of ContentChangedEvent. @default ChangeSource.Format. Set to null to avoid triggering ContentChangedEvent\n * @param canUndoByBackspace True if this action can be undone when user press Backspace key (aka Auto Complete).\n * @param additionalData @optional parameter to provide additional data related to the ContentChanged Event.\n */\nexport var addUndoSnapshot = function (core, callback, changeSource, canUndoByBackspace, additionalData) {\n    var _a, _b;\n    var undoState = core.undo;\n    var isNested = undoState.isNested;\n    var data;\n    if (!isNested) {\n        undoState.isNested = true;\n        // When there is getEntityState, it means this is triggered by an entity change.\n        // So if HTML content is not changed (hasNewContent is false), no need to add another snapshot before change\n        if (core.undo.hasNewContent || !(additionalData === null || additionalData === void 0 ? void 0 : additionalData.getEntityState) || !callback) {\n            addUndoSnapshotInternal(core, canUndoByBackspace, (_a = additionalData === null || additionalData === void 0 ? void 0 : additionalData.getEntityState) === null || _a === void 0 ? void 0 : _a.call(additionalData));\n        }\n    }\n    try {\n        if (callback) {\n            var range = core.api.getSelectionRange(core, true /*tryGetFromCache*/);\n            data = callback(range && Position.getStart(range).normalize(), range && Position.getEnd(range).normalize());\n            if (!isNested) {\n                var entityStates = (_b = additionalData === null || additionalData === void 0 ? void 0 : additionalData.getEntityState) === null || _b === void 0 ? void 0 : _b.call(additionalData);\n                addUndoSnapshotInternal(core, false /*isAutoCompleteSnapshot*/, entityStates);\n            }\n        }\n    }\n    finally {\n        if (!isNested) {\n            undoState.isNested = false;\n        }\n    }\n    if (callback && changeSource) {\n        var event_1 = {\n            eventType: 7 /* ContentChanged */,\n            source: changeSource,\n            data: data,\n            additionalData: additionalData,\n        };\n        core.api.triggerEvent(core, event_1, true /*broadcast*/);\n    }\n    if (canUndoByBackspace) {\n        var range = core.api.getSelectionRange(core, false /*tryGetFromCache*/);\n        if (range) {\n            core.undo.hasNewContent = false;\n            core.undo.autoCompletePosition = Position.getStart(range);\n        }\n    }\n};\nfunction addUndoSnapshotInternal(core, canUndoByBackspace, entityStates) {\n    var _a;\n    if (!core.lifecycle.shadowEditFragment) {\n        var rangeEx = core.api.getSelectionRangeEx(core);\n        var isDarkMode = core.lifecycle.isDarkMode;\n        var metadata = createContentMetadata(core.contentDiv, rangeEx, isDarkMode) || null;\n        core.undo.snapshotsService.addSnapshot({\n            html: core.contentDiv.innerHTML,\n            metadata: metadata,\n            knownColors: ((_a = core.darkColorHandler) === null || _a === void 0 ? void 0 : _a.getKnownColorsCopy()) || [],\n            entityStates: entityStates,\n        }, canUndoByBackspace);\n        core.undo.hasNewContent = false;\n    }\n}\nfunction createContentMetadata(root, rangeEx, isDarkMode) {\n    switch (rangeEx === null || rangeEx === void 0 ? void 0 : rangeEx.type) {\n        case 1 /* TableSelection */:\n            return __assign({ type: 1 /* TableSelection */, tableId: rangeEx.table.id, isDarkMode: !!isDarkMode }, rangeEx.coordinates);\n        case 2 /* ImageSelection */:\n            return {\n                type: 2 /* ImageSelection */,\n                imageId: rangeEx.image.id,\n                isDarkMode: !!isDarkMode,\n            };\n        case 0 /* Normal */:\n            return __assign({ type: 0 /* Normal */, isDarkMode: !!isDarkMode, start: [], end: [] }, (getSelectionPath(root, rangeEx.ranges[0]) || {}));\n    }\n}\n//# sourceMappingURL=addUndoSnapshot.js.map","import { contains, getObjectKeys, getTagOfNode, Position } from 'roosterjs-editor-dom';\n/**\n * @internal\n * @param core The EditorCore object\n * @param forceGetStateFromDOM If set to true, will force get the format state from DOM tree.\n * @returns The cached format state if it exists. If the cached position do not exist, search for pendable elements in the DOM tree and return the pendable format state.\n */\nexport var getPendableFormatState = function (core, forceGetStateFromDOM) {\n    var _a;\n    var range = core.api.getSelectionRange(core, true /* tryGetFromCache*/);\n    var cachedPendableFormatState = core.pendingFormatState.pendableFormatState;\n    var cachedPosition = (_a = core.pendingFormatState.pendableFormatPosition) === null || _a === void 0 ? void 0 : _a.normalize();\n    var currentPosition = range && Position.getStart(range).normalize();\n    var isSamePosition = currentPosition &&\n        cachedPosition &&\n        range.collapsed &&\n        currentPosition.equalTo(cachedPosition);\n    if (range && cachedPendableFormatState && isSamePosition && !forceGetStateFromDOM) {\n        return cachedPendableFormatState;\n    }\n    else {\n        return currentPosition ? queryCommandStateFromDOM(core, currentPosition) : {};\n    }\n};\nvar PendableStyleCheckers = {\n    isBold: function (tag, style) {\n        return tag == 'B' ||\n            tag == 'STRONG' ||\n            tag == 'H1' ||\n            tag == 'H2' ||\n            tag == 'H3' ||\n            tag == 'H4' ||\n            tag == 'H5' ||\n            tag == 'H6' ||\n            parseInt(style.fontWeight) >= 700 ||\n            ['bold', 'bolder'].indexOf(style.fontWeight) >= 0;\n    },\n    isUnderline: function (tag, style) { return tag == 'U' || style.textDecoration.indexOf('underline') >= 0; },\n    isItalic: function (tag, style) { return tag == 'I' || tag == 'EM' || style.fontStyle === 'italic'; },\n    isSubscript: function (tag, style) { return tag == 'SUB' || style.verticalAlign === 'sub'; },\n    isSuperscript: function (tag, style) { return tag == 'SUP' || style.verticalAlign === 'super'; },\n    isStrikeThrough: function (tag, style) {\n        return tag == 'S' || tag == 'STRIKE' || style.textDecoration.indexOf('line-through') >= 0;\n    },\n};\n/**\n * CssFalsyCheckers checks for non pendable format that might overlay a pendable format, then it can prevent getPendableFormatState return falsy pendable format states.\n */\nvar CssFalsyCheckers = {\n    isBold: function (style) {\n        return (style.fontWeight !== '' && parseInt(style.fontWeight) < 700) ||\n            style.fontWeight === 'normal';\n    },\n    isUnderline: function (style) {\n        return style.textDecoration !== '' && style.textDecoration.indexOf('underline') < 0;\n    },\n    isItalic: function (style) { return style.fontStyle !== '' && style.fontStyle !== 'italic'; },\n    isSubscript: function (style) { return style.verticalAlign !== '' && style.verticalAlign !== 'sub'; },\n    isSuperscript: function (style) { return style.verticalAlign !== '' && style.verticalAlign !== 'super'; },\n    isStrikeThrough: function (style) {\n        return style.textDecoration !== '' && style.textDecoration.indexOf('line-through') < 0;\n    },\n};\nfunction queryCommandStateFromDOM(core, currentPosition) {\n    var node = currentPosition.node;\n    var formatState = {};\n    var pendableKeys = [];\n    var _loop_1 = function () {\n        var tag = getTagOfNode(node);\n        var style = node.nodeType == 1 /* Element */ && node.style;\n        if (tag && style) {\n            getObjectKeys(PendableStyleCheckers).forEach(function (key) {\n                if (!(pendableKeys.indexOf(key) >= 0)) {\n                    formatState[key] = formatState[key] || PendableStyleCheckers[key](tag, style);\n                    if (CssFalsyCheckers[key](style)) {\n                        pendableKeys.push(key);\n                    }\n                }\n            });\n        }\n        node = node.parentNode;\n    };\n    while (node && contains(core.contentDiv, node)) {\n        _loop_1();\n    }\n    return formatState;\n}\n//# sourceMappingURL=getPendableFormatState.js.map","import { contains, createRange, findClosestElementAncestor } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Get current or cached selection range\n * @param core The EditorCore object\n * @returns A Range object of the selection range\n */\nexport var getSelectionRangeEx = function (core) {\n    var _a, _b, _c;\n    var result = null;\n    if (core.lifecycle.shadowEditFragment) {\n        var _d = core.lifecycle, shadowEditTableSelectionPath = _d.shadowEditTableSelectionPath, shadowEditSelectionPath = _d.shadowEditSelectionPath, shadowEditImageSelectionPath = _d.shadowEditImageSelectionPath;\n        if (((shadowEditTableSelectionPath === null || shadowEditTableSelectionPath === void 0 ? void 0 : shadowEditTableSelectionPath.length) || 0) > 0) {\n            var ranges = core.lifecycle.shadowEditTableSelectionPath.map(function (path) {\n                return createRange(core.contentDiv, path.start, path.end);\n            });\n            return {\n                type: 1 /* TableSelection */,\n                ranges: ranges,\n                areAllCollapsed: checkAllCollapsed(ranges),\n                table: findClosestElementAncestor(ranges[0].startContainer, core.contentDiv, 'table'),\n                coordinates: undefined,\n            };\n        }\n        else if (((shadowEditImageSelectionPath === null || shadowEditImageSelectionPath === void 0 ? void 0 : shadowEditImageSelectionPath.length) || 0) > 0) {\n            var ranges = core.lifecycle.shadowEditImageSelectionPath.map(function (path) {\n                return createRange(core.contentDiv, path.start, path.end);\n            });\n            return {\n                type: 2 /* ImageSelection */,\n                ranges: ranges,\n                areAllCollapsed: checkAllCollapsed(ranges),\n                image: findClosestElementAncestor(ranges[0].startContainer, core.contentDiv, 'img'),\n                imageId: undefined,\n            };\n        }\n        else {\n            var shadowRange = shadowEditSelectionPath &&\n                createRange(core.contentDiv, shadowEditSelectionPath.start, shadowEditSelectionPath.end);\n            return createNormalSelectionEx(shadowRange ? [shadowRange] : []);\n        }\n    }\n    else {\n        if (core.api.hasFocus(core)) {\n            if (core.domEvent.tableSelectionRange) {\n                return core.domEvent.tableSelectionRange;\n            }\n            if (core.domEvent.imageSelectionRange) {\n                return core.domEvent.imageSelectionRange;\n            }\n            var selection = (_a = core.contentDiv.ownerDocument.defaultView) === null || _a === void 0 ? void 0 : _a.getSelection();\n            if (!result && selection && selection.rangeCount > 0) {\n                var range = selection.getRangeAt(0);\n                if (contains(core.contentDiv, range)) {\n                    return createNormalSelectionEx([range]);\n                }\n            }\n        }\n        return ((_c = (_b = core.domEvent.tableSelectionRange) !== null && _b !== void 0 ? _b : core.domEvent.imageSelectionRange) !== null && _c !== void 0 ? _c : createNormalSelectionEx(core.domEvent.selectionRange ? [core.domEvent.selectionRange] : []));\n    }\n};\nfunction createNormalSelectionEx(ranges) {\n    return {\n        type: 0 /* Normal */,\n        ranges: ranges,\n        areAllCollapsed: checkAllCollapsed(ranges),\n    };\n}\nfunction checkAllCollapsed(ranges) {\n    return ranges.filter(function (range) { return range === null || range === void 0 ? void 0 : range.collapsed; }).length == ranges.length;\n}\n//# sourceMappingURL=getSelectionRangeEx.js.map","import { contains, getComputedStyles } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Get style based format state from current selection, including font name/size and colors\n * @param core The EditorCore objects\n * @param node The node to get style from\n */\nexport var getStyleBasedFormatState = function (core, node) {\n    if (!node) {\n        return {};\n    }\n    var override = [];\n    var pendableFormatSpan = core.pendingFormatState.pendableFormatSpan;\n    if (pendableFormatSpan) {\n        override = [\n            pendableFormatSpan.style.fontFamily,\n            pendableFormatSpan.style.fontSize,\n            pendableFormatSpan.style.color,\n            pendableFormatSpan.style.backgroundColor,\n        ];\n    }\n    var styles = node\n        ? getComputedStyles(node, [\n            'font-family',\n            'font-size',\n            'color',\n            'background-color',\n            'line-height',\n            'margin-top',\n            'margin-bottom',\n            'text-align',\n            'direction',\n            'font-weight',\n        ])\n        : [];\n    var contentDiv = core.contentDiv, darkColorHandler = core.darkColorHandler;\n    var styleTextColor;\n    var styleBackColor;\n    while (node &&\n        contains(contentDiv, node, true /*treatSameNodeAsContain*/) &&\n        !(styleTextColor && styleBackColor)) {\n        if (node.nodeType == 1 /* Element */) {\n            var element = node;\n            styleTextColor = styleTextColor || element.style.getPropertyValue('color');\n            styleBackColor = styleBackColor || element.style.getPropertyValue('background-color');\n        }\n        node = node.parentNode;\n    }\n    if (!core.lifecycle.isDarkMode && node == core.contentDiv) {\n        styleTextColor = styleTextColor || styles[2];\n        styleBackColor = styleBackColor || styles[3];\n    }\n    var textColor = darkColorHandler.parseColorValue(override[2] || styleTextColor);\n    var backColor = darkColorHandler.parseColorValue(override[3] || styleBackColor);\n    return {\n        fontName: override[0] || styles[0],\n        fontSize: override[1] || styles[1],\n        textColor: textColor.lightModeColor,\n        backgroundColor: backColor.lightModeColor,\n        textColors: textColor.darkModeColor\n            ? {\n                lightModeColor: textColor.lightModeColor,\n                darkModeColor: textColor.darkModeColor,\n            }\n            : undefined,\n        backgroundColors: backColor.darkModeColor\n            ? {\n                lightModeColor: backColor.lightModeColor,\n                darkModeColor: backColor.darkModeColor,\n            }\n            : undefined,\n        lineHeight: styles[4],\n        marginTop: styles[5],\n        marginBottom: styles[6],\n        textAlign: styles[7],\n        direction: styles[8],\n        fontWeight: styles[9],\n    };\n};\n//# sourceMappingURL=getStyleBasedFormatState.js.map","import { contains } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Check if the editor has focus now\n * @param core The EditorCore object\n * @returns True if the editor has focus, otherwise false\n */\nexport var hasFocus = function (core) {\n    var activeElement = core.contentDiv.ownerDocument.activeElement;\n    return !!(activeElement && contains(core.contentDiv, activeElement, true /*treatSameNodeAsContain*/));\n};\n//# sourceMappingURL=hasFocus.js.map","/**\n * Add an unique id to element and ensure that is unique\n * @param el The HTMLElement that will receive the id\n * @param idPrefix The prefix that will antecede the id (Ex: tableSelected01)\n */\nexport default function addUniqueId(el, idPrefix) {\n    var doc = el.ownerDocument;\n    if (!el.id) {\n        applyId(el, idPrefix, doc);\n    }\n    else {\n        var elements = doc.querySelectorAll(\"#\" + el.id);\n        if (elements.length > 1) {\n            el.removeAttribute('id');\n            applyId(el, idPrefix, doc);\n        }\n    }\n}\nfunction applyId(el, idPrefix, doc) {\n    var cont = 0;\n    var getElement = function () { return doc.getElementById(idPrefix + cont); };\n    //Ensure that there are no elements with the same ID\n    var element = getElement();\n    while (element) {\n        cont++;\n        element = getElement();\n    }\n    el.id = idPrefix + cont;\n}\n//# sourceMappingURL=addUniqueId.js.map","import addUniqueId from './utils/addUniqueId';\nimport { createRange, Position, removeGlobalCssStyle, removeImportantStyleRule, setGlobalCssStyles, } from 'roosterjs-editor-dom';\nvar IMAGE_ID = 'imageSelected';\nvar CONTENT_DIV_ID = 'contentDiv_';\nvar STYLE_ID = 'imageStyle';\nvar DEFAULT_SELECTION_BORDER_COLOR = '#DB626C';\n/**\n * @internal\n * Select a image and save data of the selected range\n * @param image Image to select\n * @returns Selected image information\n */\nexport var selectImage = function (core, image) {\n    unselect(core);\n    var selection = null;\n    if (image) {\n        var range = createRange(image);\n        addUniqueId(image, IMAGE_ID);\n        addUniqueId(core.contentDiv, CONTENT_DIV_ID);\n        core.api.selectRange(core, createRange(new Position(image, -3 /* After */)));\n        select(core, image);\n        selection = {\n            type: 2 /* ImageSelection */,\n            ranges: [range],\n            image: image,\n            areAllCollapsed: range.collapsed,\n        };\n    }\n    return selection;\n};\nvar select = function (core, image) {\n    removeImportantStyleRule(image, ['border', 'margin']);\n    var borderCSS = buildBorderCSS(core, image.id);\n    setGlobalCssStyles(core.contentDiv.ownerDocument, borderCSS, STYLE_ID + core.contentDiv.id);\n};\nvar buildBorderCSS = function (core, imageId) {\n    var divId = core.contentDiv.id;\n    var color = core.imageSelectionBorderColor || DEFAULT_SELECTION_BORDER_COLOR;\n    return \"#\" + divId + \" #\" + imageId + \" {outline-style: auto!important;outline-color: \" + color + \"!important;caret-color: transparent!important;}\";\n};\nvar unselect = function (core) {\n    var doc = core.contentDiv.ownerDocument;\n    removeGlobalCssStyle(doc, STYLE_ID + core.contentDiv.id);\n};\n//# sourceMappingURL=selectImage.js.map","import addUniqueId from './utils/addUniqueId';\nimport { createRange, getTagOfNode, isWholeTableSelected, Position, removeGlobalCssStyle, removeImportantStyleRule, setGlobalCssStyles, toArray, VTable, } from 'roosterjs-editor-dom';\nvar TABLE_ID = 'tableSelected';\nvar CONTENT_DIV_ID = 'contentDiv_';\nvar STYLE_ID = 'tableStyle';\nvar SELECTED_CSS_RULE = '{background-color: rgb(198,198,198) !important; caret-color: transparent}';\nvar MAX_RULE_SELECTOR_LENGTH = 9000;\n/**\n * @internal\n * Select a table and save data of the selected range\n * @param core The EditorCore object\n * @param table table to select\n * @param coordinates first and last cell of the selection, if this parameter is null, instead of\n * selecting, will unselect the table.\n * @returns true if successful\n */\nexport var selectTable = function (core, table, coordinates) {\n    var _a;\n    unselect(core);\n    if (areValidCoordinates(coordinates) && table) {\n        addUniqueId(table, TABLE_ID);\n        addUniqueId(core.contentDiv, CONTENT_DIV_ID);\n        var _b = select(core, table, coordinates), ranges = _b.ranges, isWholeTableSelected_1 = _b.isWholeTableSelected;\n        if (!isMergedCell(table, coordinates)) {\n            var cellToSelect = (_a = table.rows\n                .item(coordinates.firstCell.y)) === null || _a === void 0 ? void 0 : _a.cells.item(coordinates.firstCell.x);\n            if (cellToSelect) {\n                core.api.selectRange(core, createRange(new Position(cellToSelect, 0 /* Begin */)));\n            }\n        }\n        return {\n            type: 1 /* TableSelection */,\n            ranges: ranges,\n            table: table,\n            areAllCollapsed: ranges.filter(function (range) { return range === null || range === void 0 ? void 0 : range.collapsed; }).length == ranges.length,\n            coordinates: coordinates,\n            isWholeTableSelected: isWholeTableSelected_1,\n        };\n    }\n    return null;\n};\nfunction buildCss(table, coordinates, contentDivSelector) {\n    var _a;\n    var ranges = [];\n    var selectors = [];\n    var vTable = new VTable(table);\n    var isAllTableSelected = isWholeTableSelected(vTable, coordinates);\n    if (isAllTableSelected) {\n        handleAllTableSelected(contentDivSelector, vTable, selectors, ranges);\n    }\n    else {\n        handleTableSelected(coordinates, vTable, contentDivSelector, selectors, ranges);\n    }\n    var cssRules = [];\n    var currentRules = '';\n    while (selectors.length > 0) {\n        currentRules += (currentRules.length > 0 ? ',' : '') + selectors.shift() || '';\n        if (currentRules.length + (((_a = selectors[0]) === null || _a === void 0 ? void 0 : _a.length) || 0) > MAX_RULE_SELECTOR_LENGTH ||\n            selectors.length == 0) {\n            cssRules.push(currentRules + ' ' + SELECTED_CSS_RULE);\n            currentRules = '';\n        }\n    }\n    return { cssRules: cssRules, ranges: ranges, isWholeTableSelected: isAllTableSelected };\n}\nfunction handleAllTableSelected(contentDivSelector, vTable, selectors, ranges) {\n    var table = vTable.table;\n    var tableSelector = contentDivSelector + ' #' + table.id;\n    selectors.push(tableSelector, tableSelector + \" *\");\n    var tableRange = new Range();\n    tableRange.selectNode(table);\n    ranges.push(tableRange);\n}\nfunction handleTableSelected(coordinates, vTable, contentDivSelector, selectors, ranges) {\n    var _a;\n    var tr1 = coordinates.firstCell.y;\n    var td1 = coordinates.firstCell.x;\n    var tr2 = coordinates.lastCell.y;\n    var td2 = coordinates.lastCell.x;\n    var table = vTable.table;\n    var firstSelected = null;\n    var lastSelected = null;\n    // Get whether table has thead, tbody or tfoot.\n    var tableChildren = toArray(table.childNodes).filter(function (node) { return ['THEAD', 'TBODY', 'TFOOT'].indexOf(getTagOfNode(node)) > -1; });\n    // Set the start and end of each of the table children, so we can build the selector according the element between the table and the row.\n    var cont = 0;\n    var indexes = tableChildren.map(function (node) {\n        var result = {\n            el: getTagOfNode(node),\n            start: cont,\n            end: node.childNodes.length + cont,\n        };\n        cont = result.end;\n        return result;\n    });\n    (_a = vTable.cells) === null || _a === void 0 ? void 0 : _a.forEach(function (row, rowIndex) {\n        var tdCount = 0;\n        firstSelected = null;\n        lastSelected = null;\n        //Get current TBODY/THEAD/TFOOT\n        var midElement = indexes.filter(function (ind) { return ind.start <= rowIndex && ind.end > rowIndex; })[0];\n        var middleElSelector = midElement ? '>' + midElement.el + '>' : '>';\n        var currentRow = midElement && rowIndex + 1 >= midElement.start\n            ? rowIndex + 1 - midElement.start\n            : rowIndex + 1;\n        for (var cellIndex = 0; cellIndex < row.length; cellIndex++) {\n            var cell = row[cellIndex].td;\n            if (cell) {\n                tdCount++;\n                if (rowIndex >= tr1 && rowIndex <= tr2 && cellIndex >= td1 && cellIndex <= td2) {\n                    removeImportant(cell);\n                    var selector = generateCssFromCell(contentDivSelector, table.id, middleElSelector, currentRow, getTagOfNode(cell), tdCount);\n                    var elementsSelector = selector + ' *';\n                    selectors.push(selector, elementsSelector);\n                    firstSelected = firstSelected || table.querySelector(selector);\n                    lastSelected = table.querySelector(selector);\n                }\n            }\n        }\n        if (firstSelected && lastSelected) {\n            var rowRange = new Range();\n            rowRange.setStartBefore(firstSelected);\n            rowRange.setEndAfter(lastSelected);\n            ranges.push(rowRange);\n        }\n    });\n}\nfunction select(core, table, coordinates) {\n    var contentDivSelector = '#' + core.contentDiv.id;\n    var _a = buildCss(table, coordinates, contentDivSelector), cssRules = _a.cssRules, ranges = _a.ranges, isWholeTableSelected = _a.isWholeTableSelected;\n    cssRules.forEach(function (css) {\n        return setGlobalCssStyles(core.contentDiv.ownerDocument, css, STYLE_ID + core.contentDiv.id);\n    });\n    return { ranges: ranges, isWholeTableSelected: isWholeTableSelected };\n}\nvar unselect = function (core) {\n    var doc = core.contentDiv.ownerDocument;\n    removeGlobalCssStyle(doc, STYLE_ID + core.contentDiv.id);\n};\nfunction generateCssFromCell(contentDivSelector, tableId, middleElSelector, rowIndex, cellTag, index) {\n    return (contentDivSelector +\n        ' #' +\n        tableId +\n        middleElSelector +\n        ' tr:nth-child(' +\n        rowIndex +\n        ')>' +\n        cellTag +\n        ':nth-child(' +\n        index +\n        ')');\n}\nfunction removeImportant(cell) {\n    if (cell) {\n        removeImportantStyleRule(cell, ['background-color', 'background']);\n    }\n}\nfunction areValidCoordinates(input) {\n    if (input) {\n        var _a = input || {}, firstCell = _a.firstCell, lastCell = _a.lastCell;\n        if (firstCell && lastCell) {\n            var handler = function (coordinate) {\n                return isValidCoordinate(coordinate.x) && isValidCoordinate(coordinate.y);\n            };\n            return handler(firstCell) && handler(lastCell);\n        }\n    }\n    return false;\n}\nfunction isValidCoordinate(input) {\n    return (!!input || input == 0) && input > -1;\n}\nfunction isMergedCell(table, coordinates) {\n    var _a;\n    var firstCell = coordinates.firstCell;\n    return !(table.rows.item(firstCell.y) && ((_a = table.rows.item(firstCell.y)) === null || _a === void 0 ? void 0 : _a.cells.item(firstCell.x)));\n}\n//# sourceMappingURL=selectTable.js.map","/**\n * @internal\n * Edit and transform color of elements between light mode and dark mode\n * @param core The EditorCore object\n * @param rootNode The root HTML elements to transform\n * @param includeSelf True to transform the root node as well, otherwise false\n * @param callback The callback function to invoke before do color transformation\n * @param direction To specify the transform direction, light to dark, or dark to light\n * @param forceTransform By default this function will only work when editor core is in dark mode.\n * Pass true to this value to force do color transformation even editor core is in light mode\n */\nexport var transformColor = function (core, rootNode, includeSelf, callback, direction, forceTransform, fromDarkMode) {\n    if (fromDarkMode === void 0) { fromDarkMode = false; }\n    var darkColorHandler = core.darkColorHandler, onExternalContentTransform = core.lifecycle.onExternalContentTransform;\n    var toDarkMode = direction == 0 /* LightToDark */;\n    if (rootNode && (forceTransform || core.lifecycle.isDarkMode)) {\n        var transformer = onExternalContentTransform\n            ? function (element) {\n                onExternalContentTransform(element, fromDarkMode, toDarkMode, darkColorHandler);\n            }\n            : function (element) {\n                darkColorHandler.transformElementColor(element, fromDarkMode, toDarkMode);\n            };\n        iterateElements(rootNode, transformer, includeSelf);\n    }\n    callback === null || callback === void 0 ? void 0 : callback();\n};\nfunction iterateElements(root, transformer, includeSelf) {\n    if (includeSelf && isHTMLElement(root)) {\n        transformer(root);\n    }\n    for (var child = root.firstChild; child; child = child.nextSibling) {\n        if (isHTMLElement(child)) {\n            transformer(child);\n        }\n        iterateElements(child, transformer);\n    }\n}\n// This is not a strict check, we just need to make sure this element has style so that we can set style to it\n// We don't use safeInstanceOf() here since this function will be called very frequently when extract html content\n// in dark mode, so we need to make sure this check is fast enough\nfunction isHTMLElement(node) {\n    var htmlElement = node;\n    return node.nodeType == Node.ELEMENT_NODE && !!htmlElement.style;\n}\n//# sourceMappingURL=transformColor.js.map","var allowedEventsInShadowEdit = [\n    11 /* EditorReady */,\n    12 /* BeforeDispose */,\n    8 /* ExtractContentWithDom */,\n    21 /* ZoomChanged */,\n];\n/**\n * @internal\n * Trigger a plugin event\n * @param core The EditorCore object\n * @param pluginEvent The event object to trigger\n * @param broadcast Set to true to skip the shouldHandleEventExclusively check\n */\nexport var triggerEvent = function (core, pluginEvent, broadcast) {\n    if ((!core.lifecycle.shadowEditFragment ||\n        allowedEventsInShadowEdit.indexOf(pluginEvent.eventType) >= 0) &&\n        (broadcast || !core.plugins.some(function (plugin) { return handledExclusively(pluginEvent, plugin); }))) {\n        core.plugins.forEach(function (plugin) {\n            if (plugin.onPluginEvent) {\n                plugin.onPluginEvent(pluginEvent);\n            }\n        });\n    }\n};\nfunction handledExclusively(event, plugin) {\n    var _a;\n    if (plugin.onPluginEvent && ((_a = plugin.willHandleEventExclusively) === null || _a === void 0 ? void 0 : _a.call(plugin, event))) {\n        plugin.onPluginEvent(event);\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=triggerEvent.js.map","import { addUndoSnapshot } from './addUndoSnapshot';\nimport { attachDomEvent } from './attachDomEvent';\nimport { createPasteFragment } from './createPasteFragment';\nimport { ensureTypeInContainer } from './ensureTypeInContainer';\nimport { focus } from './focus';\nimport { getContent } from './getContent';\nimport { getPendableFormatState } from './getPendableFormatState';\nimport { getSelectionRange } from './getSelectionRange';\nimport { getSelectionRangeEx } from './getSelectionRangeEx';\nimport { getStyleBasedFormatState } from './getStyleBasedFormatState';\nimport { hasFocus } from './hasFocus';\nimport { insertNode } from './insertNode';\nimport { restoreUndoSnapshot } from './restoreUndoSnapshot';\nimport { select } from './select';\nimport { selectImage } from './selectImage';\nimport { selectRange } from './selectRange';\nimport { selectTable } from './selectTable';\nimport { setContent } from './setContent';\nimport { switchShadowEdit } from './switchShadowEdit';\nimport { transformColor } from './transformColor';\nimport { triggerEvent } from './triggerEvent';\n/**\n * @internal\n */\nexport var coreApiMap = {\n    attachDomEvent: attachDomEvent,\n    addUndoSnapshot: addUndoSnapshot,\n    createPasteFragment: createPasteFragment,\n    ensureTypeInContainer: ensureTypeInContainer,\n    focus: focus,\n    getContent: getContent,\n    getSelectionRange: getSelectionRange,\n    getSelectionRangeEx: getSelectionRangeEx,\n    getStyleBasedFormatState: getStyleBasedFormatState,\n    getPendableFormatState: getPendableFormatState,\n    hasFocus: hasFocus,\n    insertNode: insertNode,\n    restoreUndoSnapshot: restoreUndoSnapshot,\n    select: select,\n    selectRange: selectRange,\n    setContent: setContent,\n    switchShadowEdit: switchShadowEdit,\n    transformColor: transformColor,\n    triggerEvent: triggerEvent,\n    selectTable: selectTable,\n    selectImage: selectImage,\n};\n//# sourceMappingURL=coreApiMap.js.map","import { getObjectKeys } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Attach a DOM event to the editor content DIV\n * @param core The EditorCore object\n * @param eventName The DOM event name\n * @param pluginEventType Optional event type. When specified, editor will trigger a plugin event with this name when the DOM event is triggered\n * @param beforeDispatch Optional callback function to be invoked when the DOM event is triggered before trigger plugin event\n */\nexport var attachDomEvent = function (core, eventMap) {\n    var disposers = getObjectKeys(eventMap || {}).map(function (key) {\n        var _a = extractHandler(eventMap[key]), pluginEventType = _a.pluginEventType, beforeDispatch = _a.beforeDispatch;\n        var eventName = key;\n        var onEvent = function (event) {\n            if (beforeDispatch) {\n                beforeDispatch(event);\n            }\n            if (pluginEventType != null) {\n                core.api.triggerEvent(core, {\n                    eventType: pluginEventType,\n                    rawEvent: event,\n                }, false /*broadcast*/);\n            }\n        };\n        core.contentDiv.addEventListener(eventName, onEvent);\n        return function () {\n            core.contentDiv.removeEventListener(eventName, onEvent);\n        };\n    });\n    return function () { return disposers.forEach(function (disposers) { return disposers(); }); };\n};\nfunction extractHandler(handlerObj) {\n    var result = {\n        pluginEventType: null,\n        beforeDispatch: null,\n    };\n    if (typeof handlerObj === 'number') {\n        result.pluginEventType = handlerObj;\n    }\n    else if (typeof handlerObj === 'function') {\n        result.beforeDispatch = handlerObj;\n    }\n    else if (typeof handlerObj === 'object') {\n        result = handlerObj;\n    }\n    return result;\n}\n//# sourceMappingURL=attachDomEvent.js.map","import { applyFormat, applyTextStyle, createDefaultHtmlSanitizerOptions, getPasteType, handleImagePaste, handleTextPaste, moveChildNodes, retrieveMetadataFromClipboard, sanitizePasteContent, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Create a DocumentFragment for paste from a ClipboardData\n * @param core The EditorCore object.\n * @param clipboardData Clipboard data retrieved from clipboard\n * @param position The position to paste to\n * @param pasteAsText True to force use plain text as the content to paste, false to choose HTML or Image if any\n * @param applyCurrentStyle True if apply format of current selection to the pasted content,\n * false to keep original format\n * @param pasteAsImage True if the image should be pasted as image\n */\nexport var createPasteFragment = function (core, clipboardData, position, pasteAsText, applyCurrentStyle, pasteAsImage) {\n    if (pasteAsImage === void 0) { pasteAsImage = false; }\n    if (!clipboardData) {\n        return null;\n    }\n    var pasteType = getPasteType(pasteAsText, applyCurrentStyle, pasteAsImage);\n    // Step 1: Prepare BeforePasteEvent object\n    var event = createBeforePasteEvent(core, clipboardData, pasteType);\n    return createFragmentFromClipboardData(core, clipboardData, position, pasteAsText, applyCurrentStyle, pasteAsImage, event);\n};\nfunction createBeforePasteEvent(core, clipboardData, pasteType) {\n    var options = createDefaultHtmlSanitizerOptions();\n    // Remove \"caret-color\" style generated by Safari to make sure caret shows in right color after paste\n    options.cssStyleCallbacks['caret-color'] = function () { return false; };\n    return {\n        eventType: 10 /* BeforePaste */,\n        clipboardData: clipboardData,\n        fragment: core.contentDiv.ownerDocument.createDocumentFragment(),\n        sanitizingOption: options,\n        htmlBefore: '',\n        htmlAfter: '',\n        htmlAttributes: {},\n        pasteType: pasteType,\n    };\n}\n/**\n * Create a DocumentFragment for paste from a ClipboardData\n * @param core The EditorCore object.\n * @param clipboardData Clipboard data retrieved from clipboard\n * @param position The position to paste to\n * @param pasteAsText True to force use plain text as the content to paste, false to choose HTML or Image if any\n * @param applyCurrentStyle True if apply format of current selection to the pasted content,\n * @param pasteAsImage Whether to force paste as image\n * @param event Event to trigger.\n * false to keep original format\n */\nfunction createFragmentFromClipboardData(core, clipboardData, position, pasteAsText, applyCurrentStyle, pasteAsImage, event) {\n    var fragment = event.fragment;\n    var rawHtml = clipboardData.rawHtml, text = clipboardData.text, imageDataUri = clipboardData.imageDataUri;\n    var doc = rawHtml\n        ? new DOMParser().parseFromString(core.trustedHTMLHandler(rawHtml), 'text/html')\n        : undefined;\n    // Step 2: Retrieve Metadata from Html and the Html that was copied.\n    retrieveMetadataFromClipboard(doc, event, core.trustedHTMLHandler);\n    // Step 3: Fill the BeforePasteEvent object, especially the fragment for paste\n    if ((pasteAsImage && imageDataUri) || (!pasteAsText && !text && imageDataUri)) {\n        // Paste image\n        handleImagePaste(imageDataUri, fragment);\n    }\n    else if (!pasteAsText && rawHtml && doc ? doc.body : false) {\n        moveChildNodes(fragment, doc === null || doc === void 0 ? void 0 : doc.body);\n        if (applyCurrentStyle && position) {\n            var format_1 = getCurrentFormat(core, position.node);\n            applyTextStyle(fragment, function (node) { return applyFormat(node, format_1); });\n        }\n    }\n    else if (text) {\n        // Paste text\n        handleTextPaste(text, position, fragment);\n    }\n    // Step 4: Trigger BeforePasteEvent so that plugins can do proper change before paste, when the type of paste is different than Plain Text\n    if (event.pasteType !== 1 /* AsPlainText */) {\n        core.api.triggerEvent(core, event, true /*broadcast*/);\n    }\n    // Step 5. Sanitize the fragment before paste to make sure the content is safe\n    sanitizePasteContent(event, position);\n    return fragment;\n}\nfunction getCurrentFormat(core, node) {\n    var pendableFormat = core.api.getPendableFormatState(core, true /** forceGetStateFromDOM*/);\n    var styleBasedFormat = core.api.getStyleBasedFormatState(core, node);\n    return {\n        fontFamily: styleBasedFormat.fontName,\n        fontSize: styleBasedFormat.fontSize,\n        textColor: styleBasedFormat.textColor,\n        backgroundColor: styleBasedFormat.backgroundColor,\n        textColors: styleBasedFormat.textColors,\n        backgroundColors: styleBasedFormat.backgroundColors,\n        bold: pendableFormat.isBold,\n        italic: pendableFormat.isItalic,\n        underline: pendableFormat.isUnderline,\n    };\n}\n//# sourceMappingURL=createPasteFragment.js.map","/**\n * Get the paste type that will be used corresponding to the configuration\n * @param pasteAsText Whether to paste as Text\n * @param applyCurrentStyle Whether to apply the current format to the content\n * @param pasteAsImage Whether to only paste the image\n * @returns\n */\nexport default function getPasteType(pasteAsText, applyCurrentStyle, pasteAsImage) {\n    if (pasteAsText) {\n        return 1 /* AsPlainText */;\n    }\n    else if (applyCurrentStyle) {\n        return 2 /* MergeFormat */;\n    }\n    else if (pasteAsImage) {\n        return 3 /* AsImage */;\n    }\n    else {\n        return 0 /* Normal */;\n    }\n}\n//# sourceMappingURL=getPasteType.js.map","/**\n * Create default value of HtmlSanitizerOptions with every property set\n */\nexport default function createDefaultHtmlSanitizerOptions() {\n    return {\n        elementCallbacks: {},\n        attributeCallbacks: {},\n        cssStyleCallbacks: {},\n        additionalTagReplacements: {},\n        additionalAllowedAttributes: [],\n        additionalAllowedCssClasses: [],\n        additionalDefaultStyleValues: {},\n        additionalGlobalStyleNodes: [],\n        additionalPredefinedCssForElement: {},\n        preserveHtmlComments: false,\n        unknownTagReplacement: null,\n    };\n}\n//# sourceMappingURL=createDefaultHtmlSanitizerOptions.js.map","/**\n * Handles the content when using the Image Paste Option\n * @param imageDataUri the image uri to use for the image\n * @param fragment fragment that will contain the content to paste.\n */\nexport default function handleImagePaste(imageDataUri, fragment) {\n    var img = fragment.ownerDocument.createElement('img');\n    img.style.maxWidth = '100%';\n    img.src = imageDataUri;\n    fragment.appendChild(img);\n}\n//# sourceMappingURL=handleImagePaste.js.map","import getInheritableStyles from '../htmlSanitizer/getInheritableStyles';\nimport HtmlSanitizer from '../htmlSanitizer/HtmlSanitizer';\n/**\n * Sanitize the content from the pasted content\n * @param event The before paste event\n * @param position the position of the cursor\n */\nexport default function sanitizePasteContent(event, position) {\n    var fragment = event.fragment;\n    var sanitizer = new HtmlSanitizer(event.sanitizingOption);\n    sanitizer.convertGlobalCssToInlineCss(fragment);\n    sanitizer.sanitize(fragment, position ? getInheritableStyles(position.element) : undefined);\n}\n//# sourceMappingURL=sanitizePasteContent.js.map","import { applyFormat, createElement, createRange, findClosestElementAncestor, getBlockElementAtNode, isNodeEmpty, Position, safeInstanceOf, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * When typing goes directly under content div, many things can go wrong\n * We fix it by wrapping it with a div and reposition cursor within the div\n */\nexport var ensureTypeInContainer = function (core, position, keyboardEvent) {\n    var table = findClosestElementAncestor(position.node, core.contentDiv, 'table');\n    var td;\n    if (table && (td = table.querySelector('td,th'))) {\n        position = new Position(td, 0 /* Begin */);\n    }\n    position = position.normalize();\n    var block = getBlockElementAtNode(core.contentDiv, position.node);\n    var formatNode;\n    if (block) {\n        formatNode = block.collapseToSingleElement();\n        if (isNodeEmpty(formatNode, false /* trimContent */, true /* shouldCountBrAsVisible */)) {\n            var brEl = formatNode.ownerDocument.createElement('br');\n            formatNode.append(brEl);\n        }\n        // if the block is empty, apply default format\n        // Otherwise, leave it as it is as we don't want to change the style for existing data\n        // unless the block was just created by the keyboard event (e.g. ctrl+a & start typing)\n        var shouldSetNodeStyles = isNodeEmpty(formatNode) ||\n            (keyboardEvent && wasNodeJustCreatedByKeyboardEvent(keyboardEvent, formatNode));\n        formatNode = formatNode && shouldSetNodeStyles ? formatNode : null;\n    }\n    else {\n        // Only reason we don't get the selection block is that we have an empty content div\n        // which can happen when users removes everything (i.e. select all and DEL, or backspace from very end to begin)\n        // The fix is to add a DIV wrapping, apply default format and move cursor over\n        formatNode = createElement(1 /* EmptyLine */, core.contentDiv.ownerDocument);\n        core.api.insertNode(core, formatNode, {\n            position: 1 /* End */,\n            updateCursor: false,\n            replaceSelection: false,\n            insertOnNewLine: false,\n        });\n        // element points to a wrapping node we added \"<div><br></div>\". We should move the selection left to <br>\n        position = new Position(formatNode, 0 /* Begin */);\n    }\n    if (formatNode && core.lifecycle.defaultFormat) {\n        applyFormat(formatNode, core.lifecycle.defaultFormat, core.lifecycle.isDarkMode, core.darkColorHandler);\n    }\n    // If this is triggered by a keyboard event, let's select the new position\n    if (keyboardEvent) {\n        core.api.selectRange(core, createRange(new Position(position)));\n    }\n};\nfunction wasNodeJustCreatedByKeyboardEvent(event, formatNode) {\n    return (safeInstanceOf(event.target, 'Node') &&\n        event.target.contains(formatNode) &&\n        event.key === formatNode.innerText);\n}\n//# sourceMappingURL=ensureTypeInContainer.js.map","import { createRange, getFirstLeafNode } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Focus to editor. If there is a cached selection range, use it as current selection\n * @param core The EditorCore object\n */\nexport var focus = function (core) {\n    if (!core.lifecycle.shadowEditFragment) {\n        if (!core.api.hasFocus(core) ||\n            !core.api.getSelectionRange(core, false /*tryGetFromCache*/)) {\n            // Focus (document.activeElement indicates) and selection are mostly in sync, but could be out of sync in some extreme cases.\n            // i.e. if you programmatically change window selection to point to a non-focusable DOM element (i.e. tabindex=-1 etc.).\n            // On Chrome/Firefox, it does not change document.activeElement. On Edge/IE, it change document.activeElement to be body\n            // Although on Chrome/Firefox, document.activeElement points to editor, you cannot really type which we don't want (no cursor).\n            // So here we always do a live selection pull on DOM and make it point in Editor. The pitfall is, the cursor could be reset\n            // to very begin to of editor since we don't really have last saved selection (created on blur which does not fire in this case).\n            // It should be better than the case you cannot type\n            if (!core.domEvent.selectionRange ||\n                !core.api.selectRange(core, core.domEvent.selectionRange, true /*skipSameRange*/)) {\n                var node = getFirstLeafNode(core.contentDiv) || core.contentDiv;\n                core.api.selectRange(core, createRange(node, 0 /* Begin */), true /*skipSameRange*/);\n            }\n        }\n        // remember to clear cached selection range\n        core.domEvent.selectionRange = null;\n        // This is more a fallback to ensure editor gets focus if it didn't manage to move focus to editor\n        if (!core.api.hasFocus(core)) {\n            core.contentDiv.focus();\n        }\n    }\n};\n//# sourceMappingURL=focus.js.map","import { createRange, getHtmlWithSelectionPath, getSelectionPath, getTextContent, safeInstanceOf, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Get current editor content as HTML string\n * @param core The EditorCore object\n * @param mode specify what kind of HTML content to retrieve\n * @returns HTML string representing current editor content\n */\nexport var getContent = function (core, mode) {\n    var content = '';\n    var triggerExtractContentEvent = mode == 0 /* CleanHTML */;\n    var includeSelectionMarker = mode == 2 /* RawHTMLWithSelection */;\n    // When there is fragment for shadow edit, always use the cached fragment as document since HTML node in editor\n    // has been changed by uncommitted shadow edit which should be ignored.\n    var root = core.lifecycle.shadowEditFragment || core.contentDiv;\n    if (mode == 4 /* PlainTextFast */) {\n        content = root.textContent;\n    }\n    else if (mode == 3 /* PlainText */) {\n        content = getTextContent(root);\n    }\n    else {\n        var clonedRoot = cloneNode(root);\n        clonedRoot.normalize();\n        var originalRange = core.api.getSelectionRange(core, true /*tryGetFromCache*/);\n        var path = !includeSelectionMarker\n            ? null\n            : core.lifecycle.shadowEditFragment\n                ? core.lifecycle.shadowEditSelectionPath\n                : originalRange\n                    ? getSelectionPath(core.contentDiv, originalRange)\n                    : null;\n        var range = path && createRange(clonedRoot, path.start, path.end);\n        core.api.transformColor(core, clonedRoot, false /*includeSelf*/, null /*callback*/, 1 /* DarkToLight */, true /*forceTransform*/, core.lifecycle.isDarkMode);\n        if (triggerExtractContentEvent) {\n            core.api.triggerEvent(core, {\n                eventType: 8 /* ExtractContentWithDom */,\n                clonedRoot: clonedRoot,\n            }, true /*broadcast*/);\n            content = clonedRoot.innerHTML;\n        }\n        else if (range) {\n            // range is not null, which means we want to include a selection path in the content\n            content = getHtmlWithSelectionPath(clonedRoot, range);\n        }\n        else {\n            content = clonedRoot.innerHTML;\n        }\n    }\n    return content !== null && content !== void 0 ? content : '';\n};\nfunction cloneNode(node) {\n    var clonedNode;\n    if (safeInstanceOf(node, 'DocumentFragment')) {\n        clonedNode = node.ownerDocument.createElement('div');\n        clonedNode.appendChild(node.cloneNode(true /*deep*/));\n    }\n    else {\n        clonedNode = node.cloneNode(true /*deep*/);\n    }\n    return clonedNode;\n}\n//# sourceMappingURL=getContent.js.map","import ContentTraverser from '../contentTraverser/ContentTraverser';\n/**\n * get block element's text content.\n * @param rootNode Root node that the get the textContent of.\n * @returns text content of given text content.\n */\nexport default function getTextContent(rootNode) {\n    var traverser = ContentTraverser.createBodyTraverser(rootNode);\n    var block = traverser && traverser.currentBlockElement;\n    var textContent = [];\n    while (block) {\n        textContent.push(block.getTextContent());\n        block = traverser.getNextBlockElement();\n    }\n    return textContent.join('\\n');\n}\n//# sourceMappingURL=getTextContent.js.map","import { contains, createRange } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Get current or cached selection range\n * @param core The EditorCore object\n * @param tryGetFromCache Set to true to retrieve the selection range from cache if editor doesn't own the focus now\n * @returns A Range object of the selection range\n */\nexport var getSelectionRange = function (core, tryGetFromCache) {\n    var _a;\n    var result = null;\n    if (core.lifecycle.shadowEditFragment) {\n        result =\n            core.lifecycle.shadowEditSelectionPath &&\n                createRange(core.contentDiv, core.lifecycle.shadowEditSelectionPath.start, core.lifecycle.shadowEditSelectionPath.end);\n        return result;\n    }\n    else {\n        if (!tryGetFromCache || core.api.hasFocus(core)) {\n            var selection = (_a = core.contentDiv.ownerDocument.defaultView) === null || _a === void 0 ? void 0 : _a.getSelection();\n            if (selection && selection.rangeCount > 0) {\n                var range = selection.getRangeAt(0);\n                if (contains(core.contentDiv, range)) {\n                    result = range;\n                }\n            }\n        }\n        if (!result && tryGetFromCache) {\n            result = core.domEvent.selectionRange;\n        }\n        return result;\n    }\n};\n//# sourceMappingURL=getSelectionRange.js.map","import { createRange, getBlockElementAtNode, getFirstLastBlockElement, isBlockElement, isVoidHtmlElement, Position, safeInstanceOf, toArray, wrap, adjustInsertPosition, getRegionsFromRange, splitTextNode, splitParentNode, } from 'roosterjs-editor-dom';\nfunction getInitialRange(core, option) {\n    // Selection start replaces based on the current selection.\n    // Range inserts based on a provided range.\n    // Both have the potential to use the current selection to restore cursor position\n    // So in both cases we need to store the selection state.\n    var range = core.api.getSelectionRange(core, true /*tryGetFromCache*/);\n    var rangeToRestore = null;\n    if (option.position == 5 /* Range */) {\n        rangeToRestore = range;\n        range = option.range;\n    }\n    else if (range) {\n        rangeToRestore = range.cloneRange();\n    }\n    return { range: range, rangeToRestore: rangeToRestore };\n}\n/**\n * @internal\n * Insert a DOM node into editor content\n * @param core The EditorCore object. No op if null.\n * @param option An insert option object to specify how to insert the node\n */\nexport var insertNode = function (core, node, option) {\n    var _a;\n    option = option || {\n        position: 3 /* SelectionStart */,\n        insertOnNewLine: false,\n        updateCursor: true,\n        replaceSelection: true,\n        insertToRegionRoot: false,\n    };\n    var contentDiv = core.contentDiv;\n    if (option.updateCursor) {\n        core.api.focus(core);\n    }\n    if (option.position == 4 /* Outside */) {\n        (_a = contentDiv.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(node, contentDiv.nextSibling);\n        return true;\n    }\n    core.api.transformColor(core, node, true /*includeSelf*/, function () {\n        var _a, _b;\n        if (!option) {\n            return;\n        }\n        switch (option.position) {\n            case 0 /* Begin */:\n            case 1 /* End */: {\n                var isBegin = option.position == 0 /* Begin */;\n                var block = getFirstLastBlockElement(contentDiv, isBegin);\n                var insertedNode_1;\n                if (block) {\n                    var refNode = isBegin ? block.getStartNode() : block.getEndNode();\n                    if (option.insertOnNewLine ||\n                        refNode.nodeType == 3 /* Text */ ||\n                        isVoidHtmlElement(refNode)) {\n                        // For insert on new line, or refNode is text or void html element (HR, BR etc.)\n                        // which cannot have children, i.e. <div>hello<br>world</div>. 'hello', 'world' are the\n                        // first and last node. Insert before 'hello' or after 'world', but still inside DIV\n                        if (safeInstanceOf(node, 'DocumentFragment')) {\n                            // if the node to be inserted is DocumentFragment, use its childNodes as insertedNode\n                            // because insertBefore() returns an empty DocumentFragment\n                            insertedNode_1 = toArray(node.childNodes);\n                            (_a = refNode.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(node, isBegin ? refNode : refNode.nextSibling);\n                        }\n                        else {\n                            insertedNode_1 = (_b = refNode.parentNode) === null || _b === void 0 ? void 0 : _b.insertBefore(node, isBegin ? refNode : refNode.nextSibling);\n                        }\n                    }\n                    else {\n                        // if the refNode can have child, use appendChild (which is like to insert as first/last child)\n                        // i.e. <div>hello</div>, the content will be inserted before/after hello\n                        insertedNode_1 = refNode.insertBefore(node, isBegin ? refNode.firstChild : null);\n                    }\n                }\n                else {\n                    // No first block, this can happen when editor is empty. Use appendChild to insert the content in contentDiv\n                    insertedNode_1 = contentDiv.appendChild(node);\n                }\n                // Final check to see if the inserted node is a block. If not block and the ask is to insert on new line,\n                // add a DIV wrapping\n                if (insertedNode_1 && option.insertOnNewLine) {\n                    var nodes = Array.isArray(insertedNode_1) ? insertedNode_1 : [insertedNode_1];\n                    if (!isBlockElement(nodes[0]) || !isBlockElement(nodes[nodes.length - 1])) {\n                        wrap(nodes);\n                    }\n                }\n                break;\n            }\n            case 2 /* DomEnd */:\n                // Use appendChild to insert the node at the end of the content div.\n                var insertedNode = contentDiv.appendChild(node);\n                // Final check to see if the inserted node is a block. If not block and the ask is to insert on new line,\n                // add a DIV wrapping\n                if (insertedNode && option.insertOnNewLine && !isBlockElement(insertedNode)) {\n                    wrap(insertedNode);\n                }\n                break;\n            case 5 /* Range */:\n            case 3 /* SelectionStart */:\n                var _c = getInitialRange(core, option), range = _c.range, rangeToRestore = _c.rangeToRestore;\n                if (!range) {\n                    return;\n                }\n                // if to replace the selection and the selection is not collapsed, remove the the content at selection first\n                if (option.replaceSelection && !range.collapsed) {\n                    range.deleteContents();\n                }\n                var pos = Position.getStart(range);\n                var blockElement = void 0;\n                if (option.insertOnNewLine && option.insertToRegionRoot) {\n                    pos = adjustInsertPositionRegionRoot(core, range, pos);\n                }\n                else if (option.insertOnNewLine &&\n                    (blockElement = getBlockElementAtNode(contentDiv, pos.normalize().node))) {\n                    pos = adjustInsertPositionNewLine(blockElement, core, pos);\n                }\n                else {\n                    pos = adjustInsertPosition(contentDiv, node, pos, range);\n                }\n                var nodeForCursor = node.nodeType == 11 /* DocumentFragment */ ? node.lastChild : node;\n                range = createRange(pos);\n                range.insertNode(node);\n                if (option.updateCursor && nodeForCursor) {\n                    rangeToRestore = createRange(new Position(nodeForCursor, -3 /* After */).normalize());\n                }\n                if (rangeToRestore) {\n                    core.api.selectRange(core, rangeToRestore);\n                }\n                break;\n        }\n    }, 0 /* LightToDark */);\n    return true;\n};\nfunction adjustInsertPositionRegionRoot(core, range, position) {\n    var region = getRegionsFromRange(core.contentDiv, range, 0 /* Table */)[0];\n    var node = position.node;\n    if (region) {\n        if (node.nodeType == 3 /* Text */ && !position.isAtEnd) {\n            node = splitTextNode(node, position.offset, true /*returnFirstPart*/);\n        }\n        if (node != region.rootNode) {\n            while (node && node.parentNode != region.rootNode) {\n                splitParentNode(node, false /*splitBefore*/);\n                node = node.parentNode;\n            }\n        }\n        if (node) {\n            position = new Position(node, -3 /* After */);\n        }\n    }\n    return position;\n}\nfunction adjustInsertPositionNewLine(blockElement, core, pos) {\n    var tempPos = new Position(blockElement.getEndNode(), -3 /* After */);\n    if (safeInstanceOf(tempPos.node, 'HTMLTableRowElement')) {\n        var div = core.contentDiv.ownerDocument.createElement('div');\n        var range = createRange(pos);\n        range.insertNode(div);\n        tempPos = new Position(div, 0 /* Begin */);\n    }\n    return tempPos;\n}\n//# sourceMappingURL=insertNode.js.map","import { getEntityFromElement, getEntitySelector, queryElements } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Restore an undo snapshot into editor\n * @param core The editor core object\n * @param step Steps to move, can be 0, positive or negative\n */\nexport var restoreUndoSnapshot = function (core, step) {\n    var _a, _b;\n    if (core.undo.hasNewContent && step < 0) {\n        core.api.addUndoSnapshot(core, null /*callback*/, null /*changeSource*/, false /*canUndoByBackspace*/);\n    }\n    var snapshot = core.undo.snapshotsService.move(step);\n    if (snapshot && snapshot.html != null) {\n        try {\n            core.undo.isRestoring = true;\n            core.api.setContent(core, snapshot.html, true /*triggerContentChangedEvent*/, (_a = snapshot.metadata) !== null && _a !== void 0 ? _a : undefined);\n            var darkColorHandler_1 = core.darkColorHandler;\n            var isDarkModel_1 = core.lifecycle.isDarkMode;\n            snapshot.knownColors.forEach(function (color) {\n                darkColorHandler_1.registerColor(color.lightModeColor, isDarkModel_1, color.darkModeColor);\n            });\n            (_b = snapshot.entityStates) === null || _b === void 0 ? void 0 : _b.forEach(function (entityState) {\n                var type = entityState.type, id = entityState.id, state = entityState.state;\n                var wrapper = queryElements(core.contentDiv, getEntitySelector(type, id))[0];\n                var entity = wrapper && getEntityFromElement(wrapper);\n                if (entity) {\n                    core.api.triggerEvent(core, {\n                        eventType: 15 /* EntityOperation */,\n                        operation: 11 /* UpdateEntityState */,\n                        entity: entity,\n                        state: state,\n                    }, false);\n                }\n            });\n        }\n        finally {\n            core.undo.isRestoring = false;\n        }\n    }\n};\n//# sourceMappingURL=restoreUndoSnapshot.js.map","import { contains, createRange, safeInstanceOf } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Select content according to the given information.\n * There are a bunch of allowed combination of parameters. See IEditor.select for more details\n * @param core The editor core object\n * @param arg1 A DOM Range, or SelectionRangeEx, or NodePosition, or Node, or Selection Path\n * @param arg2 (optional) A NodePosition, or an offset number, or a PositionType, or a TableSelection\n * @param arg3 (optional) A Node\n * @param arg4 (optional) An offset number, or a PositionType\n */\nexport var select = function (core, arg1, arg2, arg3, arg4) {\n    var rangeEx = buildRangeEx(core, arg1, arg2, arg3, arg4);\n    if (rangeEx) {\n        var skipReselectOnFocus = core.domEvent.skipReselectOnFocus;\n        // We are applying a new selection, so we don't need to apply cached selection in DOMEventPlugin.\n        // Set skipReselectOnFocus to skip this behavior\n        core.domEvent.skipReselectOnFocus = true;\n        try {\n            applyRangeEx(core, rangeEx);\n        }\n        finally {\n            core.domEvent.skipReselectOnFocus = skipReselectOnFocus;\n        }\n    }\n    else {\n        core.domEvent.tableSelectionRange = core.api.selectTable(core, null);\n        core.domEvent.imageSelectionRange = core.api.selectImage(core, null);\n    }\n    return !!rangeEx;\n};\nfunction buildRangeEx(core, arg1, arg2, arg3, arg4) {\n    var rangeEx = null;\n    if (isSelectionRangeEx(arg1)) {\n        rangeEx = arg1;\n    }\n    else if (safeInstanceOf(arg1, 'HTMLTableElement') && isTableSelectionOrNull(arg2)) {\n        rangeEx = {\n            type: 1 /* TableSelection */,\n            ranges: [],\n            areAllCollapsed: false,\n            table: arg1,\n            coordinates: arg2 !== null && arg2 !== void 0 ? arg2 : undefined,\n        };\n    }\n    else if (safeInstanceOf(arg1, 'HTMLImageElement') && typeof arg2 == 'undefined') {\n        rangeEx = {\n            type: 2 /* ImageSelection */,\n            ranges: [],\n            areAllCollapsed: false,\n            image: arg1,\n        };\n    }\n    else {\n        var range = !arg1\n            ? null\n            : safeInstanceOf(arg1, 'Range')\n                ? arg1\n                : isSelectionPath(arg1)\n                    ? createRange(core.contentDiv, arg1.start, arg1.end)\n                    : isNodePosition(arg1) || safeInstanceOf(arg1, 'Node')\n                        ? createRange(arg1, arg2, arg3, arg4)\n                        : null;\n        rangeEx = range\n            ? {\n                type: 0 /* Normal */,\n                ranges: [range],\n                areAllCollapsed: range.collapsed,\n            }\n            : null;\n    }\n    return rangeEx;\n}\nfunction applyRangeEx(core, rangeEx) {\n    switch (rangeEx === null || rangeEx === void 0 ? void 0 : rangeEx.type) {\n        case 1 /* TableSelection */:\n            if (contains(core.contentDiv, rangeEx.table)) {\n                core.domEvent.imageSelectionRange = core.api.selectImage(core, null);\n                core.domEvent.tableSelectionRange = core.api.selectTable(core, rangeEx.table, rangeEx.coordinates);\n                rangeEx = core.domEvent.tableSelectionRange;\n            }\n            break;\n        case 2 /* ImageSelection */:\n            if (contains(core.contentDiv, rangeEx.image)) {\n                core.domEvent.tableSelectionRange = core.api.selectTable(core, null);\n                core.domEvent.imageSelectionRange = core.api.selectImage(core, rangeEx.image);\n                rangeEx = core.domEvent.imageSelectionRange;\n            }\n            break;\n        case 0 /* Normal */:\n            core.domEvent.tableSelectionRange = core.api.selectTable(core, null);\n            core.domEvent.imageSelectionRange = core.api.selectImage(core, null);\n            if (contains(core.contentDiv, rangeEx.ranges[0])) {\n                core.api.selectRange(core, rangeEx.ranges[0]);\n            }\n            else {\n                rangeEx = null;\n            }\n            break;\n    }\n    core.api.triggerEvent(core, {\n        eventType: 22 /* SelectionChanged */,\n        selectionRangeEx: rangeEx,\n    }, true /** broadcast **/);\n}\nfunction isSelectionRangeEx(obj) {\n    var rangeEx = obj;\n    return (rangeEx &&\n        typeof rangeEx == 'object' &&\n        typeof rangeEx.type == 'number' &&\n        Array.isArray(rangeEx.ranges));\n}\nfunction isTableSelectionOrNull(obj) {\n    var selection = obj;\n    return (selection === null ||\n        (selection &&\n            typeof selection == 'object' &&\n            typeof selection.firstCell == 'object' &&\n            typeof selection.lastCell == 'object'));\n}\nfunction isSelectionPath(obj) {\n    var path = obj;\n    return path && typeof path == 'object' && Array.isArray(path.start) && Array.isArray(path.end);\n}\nfunction isNodePosition(obj) {\n    var pos = obj;\n    return (pos &&\n        typeof pos == 'object' &&\n        typeof pos.node == 'object' &&\n        typeof pos.offset == 'number');\n}\n//# sourceMappingURL=select.js.map","import { hasFocus } from './hasFocus';\nimport { contains, getPendableFormatState, Position, PendableFormatCommandMap, addRangeToSelection, getObjectKeys, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Change the editor selection to the given range\n * @param core The EditorCore object\n * @param range The range to select\n * @param skipSameRange When set to true, do nothing if the given range is the same with current selection\n * in editor, otherwise it will always remove current selection range and set to the given one.\n * This parameter is always treat as true in Edge to avoid some weird runtime exception.\n */\nexport var selectRange = function (core, range, skipSameRange) {\n    if (!core.lifecycle.shadowEditSelectionPath && contains(core.contentDiv, range)) {\n        addRangeToSelection(range, skipSameRange);\n        if (!hasFocus(core)) {\n            core.domEvent.selectionRange = range;\n        }\n        if (range.collapsed) {\n            // If selected, and current selection is collapsed,\n            // need to restore pending format state if exists.\n            restorePendingFormatState(core);\n        }\n        return true;\n    }\n    else {\n        return false;\n    }\n};\n/**\n * Restore cached pending format state (if exist) to current selection\n */\nfunction restorePendingFormatState(core) {\n    var contentDiv = core.contentDiv, pendingFormatState = core.pendingFormatState, getSelectionRange = core.api.getSelectionRange;\n    if (pendingFormatState.pendableFormatState) {\n        var document_1 = contentDiv.ownerDocument;\n        var formatState_1 = getPendableFormatState(document_1);\n        getObjectKeys(PendableFormatCommandMap).forEach(function (key) {\n            var _a;\n            if (!!((_a = pendingFormatState.pendableFormatState) === null || _a === void 0 ? void 0 : _a[key]) != formatState_1[key]) {\n                document_1.execCommand(PendableFormatCommandMap[key], false /* showUI */, undefined /* value */);\n            }\n        });\n        var range = getSelectionRange(core, true /*tryGetFromCache*/);\n        var position = range && Position.getStart(range);\n        if (position) {\n            pendingFormatState.pendableFormatPosition = position;\n        }\n    }\n}\n//# sourceMappingURL=selectRange.js.map","import { createRange, extractContentMetadata, queryElements, restoreContentWithEntityPlaceholder, } from 'roosterjs-editor-dom';\n/**\n * @internal\n * Set HTML content to this editor. All existing content will be replaced. A ContentChanged event will be triggered\n * if triggerContentChangedEvent is set to true\n * @param core The EditorCore object\n * @param content HTML content to set in\n * @param triggerContentChangedEvent True to trigger a ContentChanged event. Default value is true\n * @param metadata @optional Metadata of the content that helps editor know the selection and color mode.\n * If not passed, we will treat content as in light mode without selection\n */\nexport var setContent = function (core, content, triggerContentChangedEvent, metadata) {\n    var _a, _b;\n    var contentChanged = false;\n    if (core.contentDiv.innerHTML != content) {\n        core.api.triggerEvent(core, {\n            eventType: 20 /* BeforeSetContent */,\n            newContent: content,\n        }, true /*broadcast*/);\n        var entities = core.entity.entityMap;\n        var html = content || '';\n        var body = new DOMParser().parseFromString((_b = (_a = core.trustedHTMLHandler) === null || _a === void 0 ? void 0 : _a.call(core, html)) !== null && _b !== void 0 ? _b : html, 'text/html').body;\n        restoreContentWithEntityPlaceholder(body, core.contentDiv, entities);\n        var metadataFromContent = extractContentMetadata(core.contentDiv);\n        metadata = metadata || metadataFromContent;\n        selectContentMetadata(core, metadata);\n        contentChanged = true;\n    }\n    var isDarkMode = core.lifecycle.isDarkMode;\n    if ((!metadata && isDarkMode) || (metadata && !!metadata.isDarkMode != !!isDarkMode)) {\n        core.api.transformColor(core, core.contentDiv, false /*includeSelf*/, null /*callback*/, isDarkMode ? 0 /* LightToDark */ : 1 /* DarkToLight */, true /*forceTransform*/, metadata === null || metadata === void 0 ? void 0 : metadata.isDarkMode);\n        contentChanged = true;\n    }\n    if (triggerContentChangedEvent && contentChanged) {\n        core.api.triggerEvent(core, {\n            eventType: 7 /* ContentChanged */,\n            source: \"SetContent\" /* SetContent */,\n        }, false /*broadcast*/);\n    }\n};\nfunction selectContentMetadata(core, metadata) {\n    if (!core.lifecycle.shadowEditSelectionPath && metadata) {\n        core.domEvent.tableSelectionRange = null;\n        core.domEvent.imageSelectionRange = null;\n        core.domEvent.selectionRange = null;\n        switch (metadata.type) {\n            case 0 /* Normal */:\n                core.api.selectTable(core, null);\n                core.api.selectImage(core, null);\n                var range = createRange(core.contentDiv, metadata.start, metadata.end);\n                core.api.selectRange(core, range);\n                break;\n            case 1 /* TableSelection */:\n                var table = queryElements(core.contentDiv, '#' + metadata.tableId)[0];\n                if (table) {\n                    core.domEvent.tableSelectionRange = core.api.selectTable(core, table, metadata);\n                }\n                break;\n            case 2 /* ImageSelection */:\n                var image = queryElements(core.contentDiv, '#' + metadata.imageId)[0];\n                if (image) {\n                    core.domEvent.imageSelectionRange = core.api.selectImage(core, image);\n                }\n                break;\n        }\n    }\n}\n//# sourceMappingURL=setContent.js.map","import { createRange, getSelectionPath, moveContentWithEntityPlaceholders, restoreContentWithEntityPlaceholder, } from 'roosterjs-editor-dom';\n/**\n * @internal\n */\nexport var switchShadowEdit = function (core, isOn) {\n    var lifecycle = core.lifecycle, contentDiv = core.contentDiv;\n    var shadowEditEntities = lifecycle.shadowEditEntities, shadowEditFragment = lifecycle.shadowEditFragment, shadowEditSelectionPath = lifecycle.shadowEditSelectionPath, shadowEditTableSelectionPath = lifecycle.shadowEditTableSelectionPath, shadowEditImageSelectionPath = lifecycle.shadowEditImageSelectionPath;\n    var wasInShadowEdit = !!shadowEditFragment;\n    var getShadowEditSelectionPath = function (selectionType, shadowEditSelection) {\n        return (((shadowEditSelection === null || shadowEditSelection === void 0 ? void 0 : shadowEditSelection.type) == selectionType &&\n            shadowEditSelection.ranges\n                .map(function (range) { return getSelectionPath(contentDiv, range); })\n                .map(function (w) { return w; })) ||\n            null);\n    };\n    if (isOn) {\n        if (!wasInShadowEdit) {\n            var selection = core.api.getSelectionRangeEx(core);\n            var range = core.api.getSelectionRange(core, true /*tryGetFromCache*/);\n            shadowEditSelectionPath = range && getSelectionPath(contentDiv, range);\n            shadowEditTableSelectionPath = getShadowEditSelectionPath(1 /* TableSelection */, selection);\n            shadowEditImageSelectionPath = getShadowEditSelectionPath(2 /* ImageSelection */, selection);\n            shadowEditEntities = {};\n            shadowEditFragment = moveContentWithEntityPlaceholders(contentDiv, shadowEditEntities);\n            core.api.triggerEvent(core, {\n                eventType: 17 /* EnteredShadowEdit */,\n                fragment: shadowEditFragment,\n                selectionPath: shadowEditSelectionPath,\n            }, false /*broadcast*/);\n            lifecycle.shadowEditFragment = shadowEditFragment;\n            lifecycle.shadowEditSelectionPath = shadowEditSelectionPath;\n            lifecycle.shadowEditTableSelectionPath = shadowEditTableSelectionPath;\n            lifecycle.shadowEditImageSelectionPath = shadowEditImageSelectionPath;\n            lifecycle.shadowEditEntities = shadowEditEntities;\n        }\n        if (lifecycle.shadowEditFragment) {\n            restoreContentWithEntityPlaceholder(lifecycle.shadowEditFragment, contentDiv, lifecycle.shadowEditEntities, true /*insertClonedNode*/);\n        }\n    }\n    else {\n        lifecycle.shadowEditFragment = null;\n        lifecycle.shadowEditSelectionPath = null;\n        lifecycle.shadowEditEntities = null;\n        if (wasInShadowEdit) {\n            core.api.triggerEvent(core, {\n                eventType: 18 /* LeavingShadowEdit */,\n            }, false /*broadcast*/);\n            if (shadowEditFragment) {\n                restoreContentWithEntityPlaceholder(shadowEditFragment, contentDiv, shadowEditEntities);\n            }\n            if (shadowEditSelectionPath) {\n                core.domEvent.selectionRange = createRange(contentDiv, shadowEditSelectionPath.start, shadowEditSelectionPath.end);\n            }\n        }\n    }\n};\n//# sourceMappingURL=switchShadowEdit.js.map","import { __assign } from \"tslib\";\nimport createCorePlugins, { getPluginState } from '../corePlugins/createCorePlugins';\nimport DarkColorHandlerImpl from './DarkColorHandlerImpl';\nimport { arrayPush, getIntersectedRect, getObjectKeys } from 'roosterjs-editor-dom';\nimport { coreApiMap } from '../coreApi/coreApiMap';\n/**\n * Create a new instance of Editor Core\n * @param contentDiv The DIV HTML element which will be the container element of editor\n * @param options An optional options object to customize the editor\n */\nexport var createEditorCore = function (contentDiv, options) {\n    var _a;\n    var corePlugins = createCorePlugins(contentDiv, options);\n    var plugins = [];\n    getObjectKeys(corePlugins).forEach(function (name) {\n        if (name == '_placeholder') {\n            if (options.plugins) {\n                arrayPush(plugins, options.plugins);\n            }\n        }\n        else {\n            plugins.push(corePlugins[name]);\n        }\n    });\n    var pluginState = getPluginState(corePlugins);\n    var zoomScale = ((_a = options.zoomScale) !== null && _a !== void 0 ? _a : -1) > 0 ? options.zoomScale : 1;\n    var getVisibleViewport = options.getVisibleViewport ||\n        (function () {\n            var scrollContainer = pluginState.domEvent.scrollContainer;\n            return getIntersectedRect(scrollContainer == core.contentDiv\n                ? [scrollContainer]\n                : [scrollContainer, core.contentDiv]);\n        });\n    var core = __assign(__assign({ contentDiv: contentDiv, api: __assign(__assign({}, coreApiMap), (options.coreApiOverride || {})), originalApi: coreApiMap, plugins: plugins.filter(function (x) { return !!x; }) }, pluginState), { trustedHTMLHandler: options.trustedHTMLHandler || (function (html) { return html; }), zoomScale: zoomScale, sizeTransformer: options.sizeTransformer || (function (size) { return size / zoomScale; }), getVisibleViewport: getVisibleViewport, imageSelectionBorderColor: options.imageSelectionBorderColor, darkColorHandler: new DarkColorHandlerImpl(contentDiv, pluginState.lifecycle.getDarkColor), disposeErrorHandler: options.disposeErrorHandler });\n    return core;\n};\n//# sourceMappingURL=createEditorCore.js.map","import CopyPastePlugin from './CopyPastePlugin';\nimport DOMEventPlugin from './DOMEventPlugin';\nimport EditPlugin from './EditPlugin';\nimport EntityPlugin from './EntityPlugin';\nimport ImageSelection from './ImageSelection';\nimport LifecyclePlugin from './LifecyclePlugin';\nimport MouseUpPlugin from './MouseUpPlugin';\nimport NormalizeTablePlugin from './NormalizeTablePlugin';\nimport PendingFormatStatePlugin from './PendingFormatStatePlugin';\nimport TypeInContainerPlugin from './TypeInContainerPlugin';\nimport UndoPlugin from './UndoPlugin';\n/**\n * @internal\n * Create Core Plugins\n * @param contentDiv Content DIV of editor\n * @param options Editor options\n */\nexport default function createCorePlugins(contentDiv, options) {\n    var map = options.corePluginOverride || {};\n    // The order matters, some plugin needs to be put before/after others to make sure event\n    // can be handled in right order\n    return {\n        typeInContainer: map.typeInContainer || new TypeInContainerPlugin(),\n        edit: map.edit || new EditPlugin(),\n        pendingFormatState: map.pendingFormatState || new PendingFormatStatePlugin(),\n        _placeholder: null,\n        typeAfterLink: null,\n        undo: map.undo || new UndoPlugin(options),\n        domEvent: map.domEvent || new DOMEventPlugin(options, contentDiv),\n        mouseUp: map.mouseUp || new MouseUpPlugin(),\n        copyPaste: map.copyPaste || new CopyPastePlugin(options),\n        entity: map.entity || new EntityPlugin(),\n        imageSelection: map.imageSelection || new ImageSelection(),\n        normalizeTable: map.normalizeTable || new NormalizeTablePlugin(),\n        lifecycle: map.lifecycle || new LifecyclePlugin(options, contentDiv),\n    };\n}\n/**\n * @internal\n * Get plugin state of core plugins\n * @param corePlugins CorePlugins object\n */\nexport function getPluginState(corePlugins) {\n    return {\n        domEvent: corePlugins.domEvent.getState(),\n        pendingFormatState: corePlugins.pendingFormatState.getState(),\n        edit: corePlugins.edit.getState(),\n        lifecycle: corePlugins.lifecycle.getState(),\n        undo: corePlugins.undo.getState(),\n        entity: corePlugins.entity.getState(),\n        copyPaste: corePlugins.copyPaste.getState(),\n    };\n}\n//# sourceMappingURL=createCorePlugins.js.map","import { __read, __spreadArray } from \"tslib\";\nimport normalizeRect from './normalizeRect';\n/**\n * Get the intersected Rect of elements provided\n *\n * @example\n * The result of the following Elements Rects would be:\n    {\n        top: Element2.top,\n        bottom: Element1.bottom,\n        left: Element2.left,\n        right: Element2.right\n    }\n    +-------------------------+\n    | Element 1               |\n    |   +-----------------+   |\n    |   | Element2        |   |\n    |   |                 |   |\n    |   |                 |   |\n    +-------------------------+\n        |                 |\n        +-----------------+\n\n * @param elements Elements to use.\n * @param additionalRects additional rects to use\n * @returns If the Rect is valid return the rect, if not, return null.\n */\nexport default function getIntersectedRect(elements, additionalRects) {\n    if (additionalRects === void 0) { additionalRects = []; }\n    var rects = elements\n        .map(function (element) { return normalizeRect(element.getBoundingClientRect()); })\n        .concat(additionalRects)\n        .filter(function (element) { return !!element; });\n    var result = {\n        top: Math.max.apply(Math, __spreadArray([], __read(rects.map(function (r) { return r.top; })), false)),\n        bottom: Math.min.apply(Math, __spreadArray([], __read(rects.map(function (r) { return r.bottom; })), false)),\n        left: Math.max.apply(Math, __spreadArray([], __read(rects.map(function (r) { return r.left; })), false)),\n        right: Math.min.apply(Math, __spreadArray([], __read(rects.map(function (r) { return r.right; })), false)),\n    };\n    return result.top < result.bottom && result.left < result.right ? result : null;\n}\n//# sourceMappingURL=getIntersectedRect.js.map","import { __assign, __read, __spreadArray } from \"tslib\";\nimport { isFeatureEnabled } from './isFeatureEnabled';\nimport { cacheGetEventData, collapseNodes, contains, ContentTraverser, deleteSelectedContent, getRegionsFromRange, findClosestElementAncestor, getBlockElementAtNode, getSelectionPath, getTagOfNode, isNodeEmpty, Position, PositionContentSearcher, queryElements, wrap, isPositionAtBeginningOf, toArray, } from 'roosterjs-editor-dom';\n/**\n * Base class of editor\n */\nvar EditorBase = /** @class */ (function () {\n    //#region Lifecycle\n    /**\n     * Creates an instance of EditorBase\n     * @param contentDiv The DIV HTML element which will be the container element of editor\n     * @param options An optional options object to customize the editor\n     */\n    function EditorBase(contentDiv, options, coreCreator) {\n        var _this = this;\n        this.core = null;\n        // 1. Make sure all parameters are valid\n        if (getTagOfNode(contentDiv) != 'DIV') {\n            throw new Error('contentDiv must be an HTML DIV element');\n        }\n        // 2. Create editor core\n        this.core = coreCreator(contentDiv, options);\n        // 3. Initialize plugins\n        this.core.plugins.forEach(function (plugin) { return plugin.initialize(_this); });\n        // 4. Ensure user will type in a container node, not the editor content DIV\n        this.ensureTypeInContainer(new Position(this.core.contentDiv, 0 /* Begin */).normalize());\n    }\n    /**\n     * Dispose this editor, dispose all plugins and custom data\n     */\n    EditorBase.prototype.dispose = function () {\n        var _a;\n        var core = this.getCore();\n        for (var i = core.plugins.length - 1; i >= 0; i--) {\n            var plugin = core.plugins[i];\n            try {\n                plugin.dispose();\n            }\n            catch (e) {\n                // Cache the error and pass it out, then keep going since dispose should always succeed\n                (_a = core.disposeErrorHandler) === null || _a === void 0 ? void 0 : _a.call(core, plugin, e);\n            }\n        }\n        core.darkColorHandler.reset();\n        this.core = null;\n    };\n    /**\n     * Get whether this editor is disposed\n     * @returns True if editor is disposed, otherwise false\n     */\n    EditorBase.prototype.isDisposed = function () {\n        return !this.core;\n    };\n    //#endregion\n    //#region Node API\n    /**\n     * Insert node into editor\n     * @param node The node to insert\n     * @param option Insert options. Default value is:\n     *  position: ContentPosition.SelectionStart\n     *  updateCursor: true\n     *  replaceSelection: true\n     *  insertOnNewLine: false\n     * @returns true if node is inserted. Otherwise false\n     */\n    EditorBase.prototype.insertNode = function (node, option) {\n        var core = this.getCore();\n        return node ? core.api.insertNode(core, node, option !== null && option !== void 0 ? option : null) : false;\n    };\n    /**\n     * Delete a node from editor content\n     * @param node The node to delete\n     * @returns true if node is deleted. Otherwise false\n     */\n    EditorBase.prototype.deleteNode = function (node) {\n        // Only remove the node when it falls within editor\n        if (node && this.contains(node) && node.parentNode) {\n            node.parentNode.removeChild(node);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Replace a node in editor content with another node\n     * @param existingNode The existing node to be replaced\n     * @param toNode node to replace to\n     * @param transformColorForDarkMode (optional) Whether to transform new node to dark mode. Default is false\n     * @returns true if node is replaced. Otherwise false\n     */\n    EditorBase.prototype.replaceNode = function (existingNode, toNode, transformColorForDarkMode) {\n        var core = this.getCore();\n        // Only replace the node when it falls within editor\n        if (this.contains(existingNode) && toNode) {\n            core.api.transformColor(core, transformColorForDarkMode ? toNode : null, true /*includeSelf*/, function () { var _a; return (_a = existingNode.parentNode) === null || _a === void 0 ? void 0 : _a.replaceChild(toNode, existingNode); }, 0 /* LightToDark */);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Get BlockElement at given node\n     * @param node The node to create InlineElement\n     * @returns The BlockElement result\n     */\n    EditorBase.prototype.getBlockElementAtNode = function (node) {\n        return getBlockElementAtNode(this.getCore().contentDiv, node);\n    };\n    EditorBase.prototype.contains = function (arg) {\n        if (!arg) {\n            return false;\n        }\n        return contains(this.getCore().contentDiv, arg);\n    };\n    EditorBase.prototype.queryElements = function (selector, scopeOrCallback, callback) {\n        if (scopeOrCallback === void 0) { scopeOrCallback = 0 /* Body */; }\n        var core = this.getCore();\n        var result = [];\n        var scope = scopeOrCallback instanceof Function ? 0 /* Body */ : scopeOrCallback;\n        callback = scopeOrCallback instanceof Function ? scopeOrCallback : callback;\n        var selectionEx = scope == 0 /* Body */ ? null : this.getSelectionRangeEx();\n        if (selectionEx) {\n            selectionEx.ranges.forEach(function (range) {\n                result.push.apply(result, __spreadArray([], __read(queryElements(core.contentDiv, selector, callback, scope, range)), false));\n            });\n        }\n        else {\n            return queryElements(core.contentDiv, selector, callback, scope, undefined /* range */);\n        }\n        return result;\n    };\n    /**\n     * Collapse nodes within the given start and end nodes to their common ancestor node,\n     * split parent nodes if necessary\n     * @param start The start node\n     * @param end The end node\n     * @param canSplitParent True to allow split parent node there are nodes before start or after end under the same parent\n     * and the returned nodes will be all nodes from start through end after splitting\n     * False to disallow split parent\n     * @returns When canSplitParent is true, returns all node from start through end after splitting,\n     * otherwise just return start and end\n     */\n    EditorBase.prototype.collapseNodes = function (start, end, canSplitParent) {\n        return collapseNodes(this.getCore().contentDiv, start, end, canSplitParent);\n    };\n    //#endregion\n    //#region Content API\n    /**\n     * Check whether the editor contains any visible content\n     * @param trim Whether trim the content string before check. Default is false\n     * @returns True if there's no visible content, otherwise false\n     */\n    EditorBase.prototype.isEmpty = function (trim) {\n        return isNodeEmpty(this.getCore().contentDiv, trim);\n    };\n    /**\n     * Get current editor content as HTML string\n     * @param mode specify what kind of HTML content to retrieve\n     * @returns HTML string representing current editor content\n     */\n    EditorBase.prototype.getContent = function (mode) {\n        if (mode === void 0) { mode = 0 /* CleanHTML */; }\n        var core = this.getCore();\n        return core.api.getContent(core, mode);\n    };\n    /**\n     * Set HTML content to this editor. All existing content will be replaced. A ContentChanged event will be triggered\n     * @param content HTML content to set in\n     * @param triggerContentChangedEvent True to trigger a ContentChanged event. Default value is true\n     */\n    EditorBase.prototype.setContent = function (content, triggerContentChangedEvent) {\n        if (triggerContentChangedEvent === void 0) { triggerContentChangedEvent = true; }\n        var core = this.getCore();\n        core.api.setContent(core, content, triggerContentChangedEvent);\n    };\n    /**\n     * Insert HTML content into editor\n     * @param HTML content to insert\n     * @param option Insert options. Default value is:\n     *  position: ContentPosition.SelectionStart\n     *  updateCursor: true\n     *  replaceSelection: true\n     *  insertOnNewLine: false\n     */\n    EditorBase.prototype.insertContent = function (content, option) {\n        var _a;\n        if (content) {\n            var doc = this.getDocument();\n            var body = (_a = new DOMParser().parseFromString(this.getCore().trustedHTMLHandler(content), 'text/html')) === null || _a === void 0 ? void 0 : _a.body;\n            var allNodes = (body === null || body === void 0 ? void 0 : body.childNodes) ? toArray(body.childNodes) : [];\n            // If it is to insert on new line, and there are more than one node in the collection, wrap all nodes with\n            // a parent DIV before calling insertNode on each top level sub node. Otherwise, every sub node may get wrapped\n            // separately to show up on its own line\n            if (option && option.insertOnNewLine && allNodes.length > 1) {\n                allNodes = [wrap(allNodes)];\n            }\n            var fragment_1 = doc.createDocumentFragment();\n            allNodes.forEach(function (node) { return fragment_1.appendChild(node); });\n            this.insertNode(fragment_1, option);\n        }\n    };\n    /**\n     * Delete selected content\n     */\n    EditorBase.prototype.deleteSelectedContent = function () {\n        var range = this.getSelectionRange();\n        if (range && !range.collapsed) {\n            return deleteSelectedContent(this.getCore().contentDiv, range);\n        }\n        return null;\n    };\n    /**\n     * Paste into editor using a clipboardData object\n     * @param clipboardData Clipboard data retrieved from clipboard\n     * @param pasteAsText Force pasting as plain text. Default value is false\n     * @param applyCurrentStyle True if apply format of current selection to the pasted content,\n     * false to keep original format.  Default value is false. When pasteAsText is true, this parameter is ignored\n     * @param pasteAsImage: When set to true, if the clipboardData contains a imageDataUri will paste the image to the editor\n     */\n    EditorBase.prototype.paste = function (clipboardData, pasteAsText, applyCurrentFormat, pasteAsImage) {\n        var _this = this;\n        if (pasteAsText === void 0) { pasteAsText = false; }\n        if (applyCurrentFormat === void 0) { applyCurrentFormat = false; }\n        if (pasteAsImage === void 0) { pasteAsImage = false; }\n        var core = this.getCore();\n        if (!clipboardData) {\n            return;\n        }\n        if (clipboardData.snapshotBeforePaste) {\n            // Restore original content before paste a new one\n            this.setContent(clipboardData.snapshotBeforePaste);\n        }\n        else {\n            clipboardData.snapshotBeforePaste = this.getContent(2 /* RawHTMLWithSelection */);\n        }\n        var range = this.getSelectionRange();\n        var pos = range && Position.getStart(range);\n        var fragment = core.api.createPasteFragment(core, clipboardData, pos, pasteAsText, applyCurrentFormat, pasteAsImage);\n        if (fragment) {\n            this.addUndoSnapshot(function () {\n                _this.insertNode(fragment);\n                return clipboardData;\n            }, \"Paste\" /* Paste */);\n        }\n    };\n    //#endregion\n    //#region Focus and Selection\n    /**\n     * Get current selection range from Editor.\n     * It does a live pull on the selection, if nothing retrieved, return whatever we have in cache.\n     * @param tryGetFromCache Set to true to retrieve the selection range from cache if editor doesn't own the focus now.\n     * Default value is true\n     * @returns current selection range, or null if editor never got focus before\n     */\n    EditorBase.prototype.getSelectionRange = function (tryGetFromCache) {\n        if (tryGetFromCache === void 0) { tryGetFromCache = true; }\n        var core = this.getCore();\n        return core.api.getSelectionRange(core, tryGetFromCache);\n    };\n    /**\n     * Get current selection range from Editor.\n     * It does a live pull on the selection, if nothing retrieved, return whatever we have in cache.\n     * @param tryGetFromCache Set to true to retrieve the selection range from cache if editor doesn't own the focus now.\n     * Default value is true\n     * @returns current selection range, or null if editor never got focus before\n     */\n    EditorBase.prototype.getSelectionRangeEx = function () {\n        var core = this.getCore();\n        return core.api.getSelectionRangeEx(core);\n    };\n    /**\n     * Get current selection in a serializable format\n     * It does a live pull on the selection, if nothing retrieved, return whatever we have in cache.\n     * @returns current selection path, or null if editor never got focus before\n     */\n    EditorBase.prototype.getSelectionPath = function () {\n        var range = this.getSelectionRange();\n        return range && getSelectionPath(this.getCore().contentDiv, range);\n    };\n    /**\n     * Check if focus is in editor now\n     * @returns true if focus is in editor, otherwise false\n     */\n    EditorBase.prototype.hasFocus = function () {\n        var core = this.getCore();\n        return core.api.hasFocus(core);\n    };\n    /**\n     * Focus to this editor, the selection was restored to where it was before, no unexpected scroll.\n     */\n    EditorBase.prototype.focus = function () {\n        var core = this.getCore();\n        core.api.focus(core);\n    };\n    EditorBase.prototype.select = function (arg1, arg2, arg3, arg4) {\n        var core = this.getCore();\n        return core.api.select(core, arg1, arg2, arg3, arg4);\n    };\n    /**\n     * Get current focused position. Return null if editor doesn't have focus at this time.\n     */\n    EditorBase.prototype.getFocusedPosition = function () {\n        var _a;\n        var sel = (_a = this.getDocument().defaultView) === null || _a === void 0 ? void 0 : _a.getSelection();\n        if ((sel === null || sel === void 0 ? void 0 : sel.focusNode) && this.contains(sel.focusNode)) {\n            return new Position(sel.focusNode, sel.focusOffset);\n        }\n        var range = this.getSelectionRange();\n        if (range) {\n            return Position.getStart(range);\n        }\n        return null;\n    };\n    /**\n     * Get an HTML element from current cursor position.\n     * When expectedTags is not specified, return value is the current node (if it is HTML element)\n     * or its parent node (if current node is a Text node).\n     * When expectedTags is specified, return value is the first ancestor of current node which has\n     * one of the expected tags.\n     * If no element found within editor by the given tag, return null.\n     * @param selector Optional, an HTML selector to find HTML element with.\n     * @param startFrom Start search from this node. If not specified, start from current focused position\n     * @param event Optional, if specified, editor will try to get cached result from the event object first.\n     * If it is not cached before, query from DOM and cache the result into the event object\n     */\n    EditorBase.prototype.getElementAtCursor = function (selector, startFrom, event) {\n        var _this = this;\n        var _a;\n        event = startFrom ? undefined : event; // Only use cache when startFrom is not specified, for different start position can have different result\n        return ((_a = cacheGetEventData(event !== null && event !== void 0 ? event : null, 'GET_ELEMENT_AT_CURSOR_' + selector, function () {\n            if (!startFrom) {\n                var position = _this.getFocusedPosition();\n                startFrom = position === null || position === void 0 ? void 0 : position.node;\n            }\n            return (startFrom &&\n                findClosestElementAncestor(startFrom, _this.getCore().contentDiv, selector));\n        })) !== null && _a !== void 0 ? _a : null);\n    };\n    /**\n     * Check if this position is at beginning of the editor.\n     * This will return true if all nodes between the beginning of target node and the position are empty.\n     * @param position The position to check\n     * @returns True if position is at beginning of the editor, otherwise false\n     */\n    EditorBase.prototype.isPositionAtBeginning = function (position) {\n        return isPositionAtBeginningOf(position, this.getCore().contentDiv);\n    };\n    /**\n     * Get impacted regions from selection\n     */\n    EditorBase.prototype.getSelectedRegions = function (type) {\n        if (type === void 0) { type = 0 /* Table */; }\n        var selection = this.getSelectionRangeEx();\n        var result = [];\n        var contentDiv = this.getCore().contentDiv;\n        selection.ranges.forEach(function (range) {\n            result.push.apply(result, __spreadArray([], __read((range ? getRegionsFromRange(contentDiv, range, type) : [])), false));\n        });\n        return result.filter(function (value, index, self) {\n            return self.indexOf(value) === index;\n        });\n    };\n    //#endregion\n    //#region EVENT API\n    EditorBase.prototype.addDomEventHandler = function (nameOrMap, handler) {\n        var _a;\n        var eventsToMap = typeof nameOrMap == 'string' ? (_a = {}, _a[nameOrMap] = handler, _a) : nameOrMap;\n        var core = this.getCore();\n        return core.api.attachDomEvent(core, eventsToMap);\n    };\n    /**\n     * Trigger an event to be dispatched to all plugins\n     * @param eventType Type of the event\n     * @param data data of the event with given type, this is the rest part of PluginEvent with the given type\n     * @param broadcast indicates if the event needs to be dispatched to all plugins\n     * True means to all, false means to allow exclusive handling from one plugin unless no one wants that\n     * @returns the event object which is really passed into plugins. Some plugin may modify the event object so\n     * the result of this function provides a chance to read the modified result\n     */\n    EditorBase.prototype.triggerPluginEvent = function (eventType, data, broadcast) {\n        if (broadcast === void 0) { broadcast = false; }\n        var core = this.getCore();\n        var event = __assign({ eventType: eventType }, data);\n        core.api.triggerEvent(core, event, broadcast);\n        return event;\n    };\n    /**\n     * Trigger a ContentChangedEvent\n     * @param source Source of this event, by default is 'SetContent'\n     * @param data additional data for this event\n     */\n    EditorBase.prototype.triggerContentChangedEvent = function (source, data) {\n        if (source === void 0) { source = \"SetContent\" /* SetContent */; }\n        this.triggerPluginEvent(7 /* ContentChanged */, {\n            source: source,\n            data: data,\n        });\n    };\n    //#endregion\n    //#region Undo API\n    /**\n     * Undo last edit operation\n     */\n    EditorBase.prototype.undo = function () {\n        this.focus();\n        var core = this.getCore();\n        core.api.restoreUndoSnapshot(core, -1 /*step*/);\n    };\n    /**\n     * Redo next edit operation\n     */\n    EditorBase.prototype.redo = function () {\n        this.focus();\n        var core = this.getCore();\n        core.api.restoreUndoSnapshot(core, 1 /*step*/);\n    };\n    /**\n     * Add undo snapshot, and execute a format callback function, then add another undo snapshot, then trigger\n     * ContentChangedEvent with given change source.\n     * If this function is called nested, undo snapshot will only be added in the outside one\n     * @param callback The callback function to perform formatting, returns a data object which will be used as\n     * the data field in ContentChangedEvent if changeSource is not null.\n     * @param changeSource The change source to use when fire ContentChangedEvent. When the value is not null,\n     * a ContentChangedEvent will be fired with change source equal to this value\n     * @param canUndoByBackspace True if this action can be undone when user press Backspace key (aka Auto Complete).\n     */\n    EditorBase.prototype.addUndoSnapshot = function (callback, changeSource, canUndoByBackspace, additionalData) {\n        var core = this.getCore();\n        core.api.addUndoSnapshot(core, callback !== null && callback !== void 0 ? callback : null, changeSource !== null && changeSource !== void 0 ? changeSource : null, canUndoByBackspace !== null && canUndoByBackspace !== void 0 ? canUndoByBackspace : false, additionalData);\n    };\n    /**\n     * Whether there is an available undo/redo snapshot\n     */\n    EditorBase.prototype.getUndoState = function () {\n        var _a = this.getCore().undo, hasNewContent = _a.hasNewContent, snapshotsService = _a.snapshotsService;\n        return {\n            canUndo: hasNewContent || snapshotsService.canMove(-1 /*previousSnapshot*/),\n            canRedo: snapshotsService.canMove(1 /*nextSnapshot*/),\n        };\n    };\n    //#endregion\n    //#region Misc\n    /**\n     * Get document which contains this editor\n     * @returns The HTML document which contains this editor\n     */\n    EditorBase.prototype.getDocument = function () {\n        return this.getCore().contentDiv.ownerDocument;\n    };\n    /**\n     * Get the scroll container of the editor\n     */\n    EditorBase.prototype.getScrollContainer = function () {\n        return this.getCore().domEvent.scrollContainer;\n    };\n    /**\n     * Get custom data related to this editor\n     * @param key Key of the custom data\n     * @param getter Getter function. If custom data for the given key doesn't exist,\n     * call this function to get one and store it if it is specified. Otherwise return undefined\n     * @param disposer An optional disposer function to dispose this custom data when\n     * dispose editor.\n     */\n    EditorBase.prototype.getCustomData = function (key, getter, disposer) {\n        var core = this.getCore();\n        return (core.lifecycle.customData[key] = core.lifecycle.customData[key] || {\n            value: getter ? getter() : undefined,\n            disposer: disposer,\n        }).value;\n    };\n    /**\n     * Check if editor is in IME input sequence\n     * @returns True if editor is in IME input sequence, otherwise false\n     */\n    EditorBase.prototype.isInIME = function () {\n        return this.getCore().domEvent.isInIME;\n    };\n    /**\n     * Get default format of this editor\n     * @returns Default format object of this editor\n     */\n    EditorBase.prototype.getDefaultFormat = function () {\n        var _a;\n        return (_a = this.getCore().lifecycle.defaultFormat) !== null && _a !== void 0 ? _a : {};\n    };\n    /**\n     * Get a content traverser for the whole editor\n     * @param startNode The node to start from. If not passed, it will start from the beginning of the body\n     */\n    EditorBase.prototype.getBodyTraverser = function (startNode) {\n        return ContentTraverser.createBodyTraverser(this.getCore().contentDiv, startNode);\n    };\n    /**\n     * Get a content traverser for current selection\n     * @returns A content traverser, or null if editor never got focus before\n     */\n    EditorBase.prototype.getSelectionTraverser = function (range) {\n        var _a;\n        range = (_a = range !== null && range !== void 0 ? range : this.getSelectionRange()) !== null && _a !== void 0 ? _a : undefined;\n        return range\n            ? ContentTraverser.createSelectionTraverser(this.getCore().contentDiv, range)\n            : null;\n    };\n    /**\n     * Get a content traverser for current block element start from specified position\n     * @param startFrom Start position of the traverser. Default value is ContentPosition.SelectionStart\n     * @returns A content traverser, or null if editor never got focus before\n     */\n    EditorBase.prototype.getBlockTraverser = function (startFrom) {\n        if (startFrom === void 0) { startFrom = 3 /* SelectionStart */; }\n        var range = this.getSelectionRange();\n        return range\n            ? ContentTraverser.createBlockTraverser(this.getCore().contentDiv, range, startFrom)\n            : null;\n    };\n    /**\n     * Get a text traverser of current selection\n     * @param event Optional, if specified, editor will try to get cached result from the event object first.\n     * If it is not cached before, query from DOM and cache the result into the event object\n     * @returns A content traverser, or null if editor never got focus before\n     */\n    EditorBase.prototype.getContentSearcherOfCursor = function (event) {\n        var _this = this;\n        return cacheGetEventData(event !== null && event !== void 0 ? event : null, 'ContentSearcher', function () {\n            var range = _this.getSelectionRange();\n            return (range &&\n                new PositionContentSearcher(_this.getCore().contentDiv, Position.getStart(range)));\n        });\n    };\n    /**\n     * Run a callback function asynchronously\n     * @param callback The callback function to run\n     * @returns a function to cancel this async run\n     */\n    EditorBase.prototype.runAsync = function (callback) {\n        var _this = this;\n        var win = this.getCore().contentDiv.ownerDocument.defaultView || window;\n        var handle = win.requestAnimationFrame(function () {\n            if (!_this.isDisposed() && callback) {\n                callback(_this);\n            }\n        });\n        return function () {\n            win.cancelAnimationFrame(handle);\n        };\n    };\n    /**\n     * Set DOM attribute of editor content DIV\n     * @param name Name of the attribute\n     * @param value Value of the attribute\n     */\n    EditorBase.prototype.setEditorDomAttribute = function (name, value) {\n        if (value === null) {\n            this.getCore().contentDiv.removeAttribute(name);\n        }\n        else {\n            this.getCore().contentDiv.setAttribute(name, value);\n        }\n    };\n    /**\n     * Get DOM attribute of editor content DIV, null if there is no such attribute.\n     * @param name Name of the attribute\n     */\n    EditorBase.prototype.getEditorDomAttribute = function (name) {\n        return this.getCore().contentDiv.getAttribute(name);\n    };\n    /**\n     * @deprecated Use getVisibleViewport() instead.\n     *\n     * Get current relative distance from top-left corner of the given element to top-left corner of editor content DIV.\n     * @param element The element to calculate from. If the given element is not in editor, return value will be null\n     * @param addScroll When pass true, The return value will also add scrollLeft and scrollTop if any. So the value\n     * may be different than what user is seeing from the view. When pass false, scroll position will be ignored.\n     * @returns An [x, y] array which contains the left and top distances, or null if the given element is not in editor.\n     */\n    EditorBase.prototype.getRelativeDistanceToEditor = function (element, addScroll) {\n        if (this.contains(element)) {\n            var contentDiv = this.getCore().contentDiv;\n            var editorRect = contentDiv.getBoundingClientRect();\n            var elementRect = element.getBoundingClientRect();\n            if (editorRect && elementRect) {\n                var x = elementRect.left - (editorRect === null || editorRect === void 0 ? void 0 : editorRect.left);\n                var y = elementRect.top - (editorRect === null || editorRect === void 0 ? void 0 : editorRect.top);\n                if (addScroll) {\n                    x += contentDiv.scrollLeft;\n                    y += contentDiv.scrollTop;\n                }\n                return [x, y];\n            }\n        }\n        return null;\n    };\n    /**\n     * Add a Content Edit feature.\n     * @param feature The feature to add\n     */\n    EditorBase.prototype.addContentEditFeature = function (feature) {\n        var core = this.getCore();\n        feature === null || feature === void 0 ? void 0 : feature.keys.forEach(function (key) {\n            var array = core.edit.features[key] || [];\n            array.push(feature);\n            core.edit.features[key] = array;\n        });\n    };\n    /**\n     * Remove a Content Edit feature.\n     * @param feature The feature to remove\n     */\n    EditorBase.prototype.removeContentEditFeature = function (feature) {\n        var core = this.getCore();\n        feature === null || feature === void 0 ? void 0 : feature.keys.forEach(function (key) {\n            var _a;\n            var featureSet = core.edit.features[key];\n            var index = (_a = featureSet === null || featureSet === void 0 ? void 0 : featureSet.indexOf(feature)) !== null && _a !== void 0 ? _a : -1;\n            if (index >= 0) {\n                core.edit.features[key].splice(index, 1);\n                if (core.edit.features[key].length < 1) {\n                    delete core.edit.features[key];\n                }\n            }\n        });\n    };\n    /**\n     * Get style based format state from current selection, including font name/size and colors\n     */\n    EditorBase.prototype.getStyleBasedFormatState = function (node) {\n        var _a;\n        if (!node) {\n            var range = this.getSelectionRange();\n            node = (_a = (range && Position.getStart(range).normalize().node)) !== null && _a !== void 0 ? _a : undefined;\n        }\n        var core = this.getCore();\n        return core.api.getStyleBasedFormatState(core, node !== null && node !== void 0 ? node : null);\n    };\n    /**\n     * Get the pendable format such as underline and bold\n     * @param forceGetStateFromDOM If set to true, will force get the format state from DOM tree.\n     * @returns The pending format state\n     */\n    EditorBase.prototype.getPendableFormatState = function (forceGetStateFromDOM) {\n        if (forceGetStateFromDOM === void 0) { forceGetStateFromDOM = false; }\n        var core = this.getCore();\n        return core.api.getPendableFormatState(core, forceGetStateFromDOM);\n    };\n    /**\n     * Ensure user will type into a container element rather than into the editor content DIV directly\n     * @param position The position that user is about to type to\n     * @param keyboardEvent Optional keyboard event object\n     */\n    EditorBase.prototype.ensureTypeInContainer = function (position, keyboardEvent) {\n        var core = this.getCore();\n        core.api.ensureTypeInContainer(core, position, keyboardEvent);\n    };\n    //#endregion\n    //#region Dark mode APIs\n    /**\n     * Set the dark mode state and transforms the content to match the new state.\n     * @param nextDarkMode The next status of dark mode. True if the editor should be in dark mode, false if not.\n     */\n    EditorBase.prototype.setDarkModeState = function (nextDarkMode) {\n        var isDarkMode = this.isDarkMode();\n        if (isDarkMode == !!nextDarkMode) {\n            return;\n        }\n        var core = this.getCore();\n        core.api.transformColor(core, core.contentDiv, false /*includeSelf*/, null /*callback*/, nextDarkMode\n            ? 0 /* LightToDark */\n            : 1 /* DarkToLight */, true /*forceTransform*/, isDarkMode);\n        this.triggerContentChangedEvent(nextDarkMode ? \"SwitchToDarkMode\" /* SwitchToDarkMode */ : \"SwitchToLightMode\" /* SwitchToLightMode */);\n    };\n    /**\n     * Check if the editor is in dark mode\n     * @returns True if the editor is in dark mode, otherwise false\n     */\n    EditorBase.prototype.isDarkMode = function () {\n        return this.getCore().lifecycle.isDarkMode;\n    };\n    /**\n     * Transform the given node and all its child nodes to dark mode color if editor is in dark mode\n     * @param node The node to transform\n     * @param direction The transform direction. @default ColorTransformDirection.LightToDark\n     */\n    EditorBase.prototype.transformToDarkColor = function (node, direction) {\n        if (direction === void 0) { direction = 0 /* LightToDark */; }\n        var core = this.getCore();\n        core.api.transformColor(core, node, true /*includeSelf*/, null /*callback*/, direction);\n    };\n    /**\n     * Get a darkColorHandler object for this editor.\n     */\n    EditorBase.prototype.getDarkColorHandler = function () {\n        return this.getCore().darkColorHandler;\n    };\n    /**\n     * Make the editor in \"Shadow Edit\" mode.\n     * In Shadow Edit mode, all format change will finally be ignored.\n     * This can be used for building a live preview feature for format button, to allow user\n     * see format result without really apply it.\n     * This function can be called repeated. If editor is already in shadow edit mode, we can still\n     * use this function to do more shadow edit operation.\n     */\n    EditorBase.prototype.startShadowEdit = function () {\n        var core = this.getCore();\n        core.api.switchShadowEdit(core, true /*isOn*/);\n    };\n    /**\n     * Leave \"Shadow Edit\" mode, all changes made during shadow edit will be discarded\n     */\n    EditorBase.prototype.stopShadowEdit = function () {\n        var core = this.getCore();\n        core.api.switchShadowEdit(core, false /*isOn*/);\n    };\n    /**\n     * Check if editor is in Shadow Edit mode\n     */\n    EditorBase.prototype.isInShadowEdit = function () {\n        return !!this.getCore().lifecycle.shadowEditFragment;\n    };\n    /**\n     * Check if the given experimental feature is enabled\n     * @param feature The feature to check\n     */\n    EditorBase.prototype.isFeatureEnabled = function (feature) {\n        return isFeatureEnabled(this.getCore().lifecycle.experimentalFeatures, feature);\n    };\n    /**\n     * Get a function to convert HTML string to trusted HTML string.\n     * By default it will just return the input HTML directly. To override this behavior,\n     * pass your own trusted HTML handler to EditorOptions.trustedHTMLHandler\n     * See https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/trusted-types\n     */\n    EditorBase.prototype.getTrustedHTMLHandler = function () {\n        return this.getCore().trustedHTMLHandler;\n    };\n    /**\n     * @deprecated Use getZoomScale() instead\n     */\n    EditorBase.prototype.getSizeTransformer = function () {\n        return this.getCore().sizeTransformer;\n    };\n    /**\n     * Get current zoom scale, default value is 1\n     * When editor is put under a zoomed container, need to pass the zoom scale number using EditorOptions.zoomScale\n     * to let editor behave correctly especially for those mouse drag/drop behaviors\n     * @returns current zoom scale number\n     */\n    EditorBase.prototype.getZoomScale = function () {\n        return this.getCore().zoomScale;\n    };\n    /**\n     * Set current zoom scale, default value is 1\n     * When editor is put under a zoomed container, need to pass the zoom scale number using EditorOptions.zoomScale\n     * to let editor behave correctly especially for those mouse drag/drop behaviors\n     * @param scale The new scale number to set. It should be positive number and no greater than 10, otherwise it will be ignored.\n     */\n    EditorBase.prototype.setZoomScale = function (scale) {\n        var core = this.getCore();\n        if (scale > 0 && scale <= 10) {\n            var oldValue = core.zoomScale;\n            core.zoomScale = scale;\n            if (oldValue != scale) {\n                this.triggerPluginEvent(21 /* ZoomChanged */, {\n                    oldZoomScale: oldValue,\n                    newZoomScale: scale,\n                }, true /*broadcast*/);\n            }\n        }\n    };\n    /**\n     * Retrieves the rect of the visible viewport of the editor.\n     */\n    EditorBase.prototype.getVisibleViewport = function () {\n        return this.getCore().getVisibleViewport();\n    };\n    /**\n     * @returns the current EditorCore object\n     * @throws a standard Error if there's no core object\n     */\n    EditorBase.prototype.getCore = function () {\n        if (!this.core) {\n            throw new Error('Editor is already disposed');\n        }\n        return this.core;\n    };\n    return EditorBase;\n}());\nexport { EditorBase };\n//# sourceMappingURL=EditorBase.js.map","/**\n * Check if the given experimental feature is enabled\n * @param featureSet All enabled features\n * @param feature The feature to check\n * @returns True if the given feature is enabled, otherwise false\n */\nexport function isFeatureEnabled(featureSet, feature) {\n    return (featureSet || []).indexOf(feature) >= 0;\n}\n//# sourceMappingURL=isFeatureEnabled.js.map","import { __extends } from \"tslib\";\nimport { createEditorCore } from './createEditorCore';\nimport { EditorBase } from './EditorBase';\n/**\n * RoosterJs core editor class\n */\nvar Editor = /** @class */ (function (_super) {\n    __extends(Editor, _super);\n    /**\n     * Creates an instance of EditorBase\n     * @param contentDiv The DIV HTML element which will be the container element of editor\n     * @param options An optional options object to customize the editor\n     */\n    function Editor(contentDiv, options) {\n        if (options === void 0) { options = {}; }\n        return _super.call(this, contentDiv, options, createEditorCore) || this;\n    }\n    return Editor;\n}(EditorBase));\nexport default Editor;\n//# sourceMappingURL=Editor.js.map","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","'use strict';\n\nvar isArrayish = require('is-arrayish');\n\nvar concat = Array.prototype.concat;\nvar slice = Array.prototype.slice;\n\nvar swizzle = module.exports = function swizzle(args) {\n\tvar results = [];\n\n\tfor (var i = 0, len = args.length; i < len; i++) {\n\t\tvar arg = args[i];\n\n\t\tif (isArrayish(arg)) {\n\t\t\t// http://jsperf.com/javascript-array-concat-vs-push/98\n\t\t\tresults = concat.call(results, slice.call(arg));\n\t\t} else {\n\t\t\tresults.push(arg);\n\t\t}\n\t}\n\n\treturn results;\n};\n\nswizzle.wrap = function (fn) {\n\treturn function () {\n\t\treturn fn(swizzle(arguments));\n\t};\n};\n","module.exports = function isArrayish(obj) {\n\tif (!obj || typeof obj === 'string') {\n\t\treturn false;\n\t}\n\n\treturn obj instanceof Array || Array.isArray(obj) ||\n\t\t(obj.length >= 0 && (obj.splice instanceof Function ||\n\t\t\t(Object.getOwnPropertyDescriptor(obj, (obj.length - 1)) && obj.constructor.name !== 'String')));\n};\n","/* MIT license */\nvar colorNames = require('color-name');\nvar swizzle = require('simple-swizzle');\nvar hasOwnProperty = Object.hasOwnProperty;\n\nvar reverseNames = Object.create(null);\n\n// create a list of reverse color names\nfor (var name in colorNames) {\n\tif (hasOwnProperty.call(colorNames, name)) {\n\t\treverseNames[colorNames[name]] = name;\n\t}\n}\n\nvar cs = module.exports = {\n\tto: {},\n\tget: {}\n};\n\ncs.get = function (string) {\n\tvar prefix = string.substring(0, 3).toLowerCase();\n\tvar val;\n\tvar model;\n\tswitch (prefix) {\n\t\tcase 'hsl':\n\t\t\tval = cs.get.hsl(string);\n\t\t\tmodel = 'hsl';\n\t\t\tbreak;\n\t\tcase 'hwb':\n\t\t\tval = cs.get.hwb(string);\n\t\t\tmodel = 'hwb';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tval = cs.get.rgb(string);\n\t\t\tmodel = 'rgb';\n\t\t\tbreak;\n\t}\n\n\tif (!val) {\n\t\treturn null;\n\t}\n\n\treturn {model: model, value: val};\n};\n\ncs.get.rgb = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar abbr = /^#([a-f0-9]{3,4})$/i;\n\tvar hex = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i;\n\tvar rgba = /^rgba?\\(\\s*([+-]?\\d+)(?=[\\s,])\\s*(?:,\\s*)?([+-]?\\d+)(?=[\\s,])\\s*(?:,\\s*)?([+-]?\\d+)\\s*(?:[,|\\/]\\s*([+-]?[\\d\\.]+)(%?)\\s*)?\\)$/;\n\tvar per = /^rgba?\\(\\s*([+-]?[\\d\\.]+)\\%\\s*,?\\s*([+-]?[\\d\\.]+)\\%\\s*,?\\s*([+-]?[\\d\\.]+)\\%\\s*(?:[,|\\/]\\s*([+-]?[\\d\\.]+)(%?)\\s*)?\\)$/;\n\tvar keyword = /^(\\w+)$/;\n\n\tvar rgb = [0, 0, 0, 1];\n\tvar match;\n\tvar i;\n\tvar hexAlpha;\n\n\tif (match = string.match(hex)) {\n\t\thexAlpha = match[2];\n\t\tmatch = match[1];\n\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\t// https://jsperf.com/slice-vs-substr-vs-substring-methods-long-string/19\n\t\t\tvar i2 = i * 2;\n\t\t\trgb[i] = parseInt(match.slice(i2, i2 + 2), 16);\n\t\t}\n\n\t\tif (hexAlpha) {\n\t\t\trgb[3] = parseInt(hexAlpha, 16) / 255;\n\t\t}\n\t} else if (match = string.match(abbr)) {\n\t\tmatch = match[1];\n\t\thexAlpha = match[3];\n\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = parseInt(match[i] + match[i], 16);\n\t\t}\n\n\t\tif (hexAlpha) {\n\t\t\trgb[3] = parseInt(hexAlpha + hexAlpha, 16) / 255;\n\t\t}\n\t} else if (match = string.match(rgba)) {\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = parseInt(match[i + 1], 0);\n\t\t}\n\n\t\tif (match[4]) {\n\t\t\tif (match[5]) {\n\t\t\t\trgb[3] = parseFloat(match[4]) * 0.01;\n\t\t\t} else {\n\t\t\t\trgb[3] = parseFloat(match[4]);\n\t\t\t}\n\t\t}\n\t} else if (match = string.match(per)) {\n\t\tfor (i = 0; i < 3; i++) {\n\t\t\trgb[i] = Math.round(parseFloat(match[i + 1]) * 2.55);\n\t\t}\n\n\t\tif (match[4]) {\n\t\t\tif (match[5]) {\n\t\t\t\trgb[3] = parseFloat(match[4]) * 0.01;\n\t\t\t} else {\n\t\t\t\trgb[3] = parseFloat(match[4]);\n\t\t\t}\n\t\t}\n\t} else if (match = string.match(keyword)) {\n\t\tif (match[1] === 'transparent') {\n\t\t\treturn [0, 0, 0, 0];\n\t\t}\n\n\t\tif (!hasOwnProperty.call(colorNames, match[1])) {\n\t\t\treturn null;\n\t\t}\n\n\t\trgb = colorNames[match[1]];\n\t\trgb[3] = 1;\n\n\t\treturn rgb;\n\t} else {\n\t\treturn null;\n\t}\n\n\tfor (i = 0; i < 3; i++) {\n\t\trgb[i] = clamp(rgb[i], 0, 255);\n\t}\n\trgb[3] = clamp(rgb[3], 0, 1);\n\n\treturn rgb;\n};\n\ncs.get.hsl = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar hsl = /^hsla?\\(\\s*([+-]?(?:\\d{0,3}\\.)?\\d+)(?:deg)?\\s*,?\\s*([+-]?[\\d\\.]+)%\\s*,?\\s*([+-]?[\\d\\.]+)%\\s*(?:[,|\\/]\\s*([+-]?(?=\\.\\d|\\d)(?:0|[1-9]\\d*)?(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)\\s*)?\\)$/;\n\tvar match = string.match(hsl);\n\n\tif (match) {\n\t\tvar alpha = parseFloat(match[4]);\n\t\tvar h = ((parseFloat(match[1]) % 360) + 360) % 360;\n\t\tvar s = clamp(parseFloat(match[2]), 0, 100);\n\t\tvar l = clamp(parseFloat(match[3]), 0, 100);\n\t\tvar a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);\n\n\t\treturn [h, s, l, a];\n\t}\n\n\treturn null;\n};\n\ncs.get.hwb = function (string) {\n\tif (!string) {\n\t\treturn null;\n\t}\n\n\tvar hwb = /^hwb\\(\\s*([+-]?\\d{0,3}(?:\\.\\d+)?)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?(?=\\.\\d|\\d)(?:0|[1-9]\\d*)?(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)\\s*)?\\)$/;\n\tvar match = string.match(hwb);\n\n\tif (match) {\n\t\tvar alpha = parseFloat(match[4]);\n\t\tvar h = ((parseFloat(match[1]) % 360) + 360) % 360;\n\t\tvar w = clamp(parseFloat(match[2]), 0, 100);\n\t\tvar b = clamp(parseFloat(match[3]), 0, 100);\n\t\tvar a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);\n\t\treturn [h, w, b, a];\n\t}\n\n\treturn null;\n};\n\ncs.to.hex = function () {\n\tvar rgba = swizzle(arguments);\n\n\treturn (\n\t\t'#' +\n\t\thexDouble(rgba[0]) +\n\t\thexDouble(rgba[1]) +\n\t\thexDouble(rgba[2]) +\n\t\t(rgba[3] < 1\n\t\t\t? (hexDouble(Math.round(rgba[3] * 255)))\n\t\t\t: '')\n\t);\n};\n\ncs.to.rgb = function () {\n\tvar rgba = swizzle(arguments);\n\n\treturn rgba.length < 4 || rgba[3] === 1\n\t\t? 'rgb(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ')'\n\t\t: 'rgba(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ', ' + rgba[3] + ')';\n};\n\ncs.to.rgb.percent = function () {\n\tvar rgba = swizzle(arguments);\n\n\tvar r = Math.round(rgba[0] / 255 * 100);\n\tvar g = Math.round(rgba[1] / 255 * 100);\n\tvar b = Math.round(rgba[2] / 255 * 100);\n\n\treturn rgba.length < 4 || rgba[3] === 1\n\t\t? 'rgb(' + r + '%, ' + g + '%, ' + b + '%)'\n\t\t: 'rgba(' + r + '%, ' + g + '%, ' + b + '%, ' + rgba[3] + ')';\n};\n\ncs.to.hsl = function () {\n\tvar hsla = swizzle(arguments);\n\treturn hsla.length < 4 || hsla[3] === 1\n\t\t? 'hsl(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%)'\n\t\t: 'hsla(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%, ' + hsla[3] + ')';\n};\n\n// hwb is a bit different than rgb(a) & hsl(a) since there is no alpha specific syntax\n// (hwb have alpha optional & 1 is default value)\ncs.to.hwb = function () {\n\tvar hwba = swizzle(arguments);\n\n\tvar a = '';\n\tif (hwba.length >= 4 && hwba[3] !== 1) {\n\t\ta = ', ' + hwba[3];\n\t}\n\n\treturn 'hwb(' + hwba[0] + ', ' + hwba[1] + '%, ' + hwba[2] + '%' + a + ')';\n};\n\ncs.to.keyword = function (rgb) {\n\treturn reverseNames[rgb.slice(0, 3)];\n};\n\n// helpers\nfunction clamp(num, min, max) {\n\treturn Math.min(Math.max(min, num), max);\n}\n\nfunction hexDouble(num) {\n\tvar str = Math.round(num).toString(16).toUpperCase();\n\treturn (str.length < 2) ? '0' + str : str;\n}\n","/* MIT license */\nvar cssKeywords = require('color-name');\n\n// NOTE: conversions should only return primitive values (i.e. arrays, or\n//       values that give correct `typeof` results).\n//       do not use box values types (i.e. Number(), String(), etc.)\n\nvar reverseKeywords = {};\nfor (var key in cssKeywords) {\n\tif (cssKeywords.hasOwnProperty(key)) {\n\t\treverseKeywords[cssKeywords[key]] = key;\n\t}\n}\n\nvar convert = module.exports = {\n\trgb: {channels: 3, labels: 'rgb'},\n\thsl: {channels: 3, labels: 'hsl'},\n\thsv: {channels: 3, labels: 'hsv'},\n\thwb: {channels: 3, labels: 'hwb'},\n\tcmyk: {channels: 4, labels: 'cmyk'},\n\txyz: {channels: 3, labels: 'xyz'},\n\tlab: {channels: 3, labels: 'lab'},\n\tlch: {channels: 3, labels: 'lch'},\n\thex: {channels: 1, labels: ['hex']},\n\tkeyword: {channels: 1, labels: ['keyword']},\n\tansi16: {channels: 1, labels: ['ansi16']},\n\tansi256: {channels: 1, labels: ['ansi256']},\n\thcg: {channels: 3, labels: ['h', 'c', 'g']},\n\tapple: {channels: 3, labels: ['r16', 'g16', 'b16']},\n\tgray: {channels: 1, labels: ['gray']}\n};\n\n// hide .channels and .labels properties\nfor (var model in convert) {\n\tif (convert.hasOwnProperty(model)) {\n\t\tif (!('channels' in convert[model])) {\n\t\t\tthrow new Error('missing channels property: ' + model);\n\t\t}\n\n\t\tif (!('labels' in convert[model])) {\n\t\t\tthrow new Error('missing channel labels property: ' + model);\n\t\t}\n\n\t\tif (convert[model].labels.length !== convert[model].channels) {\n\t\t\tthrow new Error('channel and label counts mismatch: ' + model);\n\t\t}\n\n\t\tvar channels = convert[model].channels;\n\t\tvar labels = convert[model].labels;\n\t\tdelete convert[model].channels;\n\t\tdelete convert[model].labels;\n\t\tObject.defineProperty(convert[model], 'channels', {value: channels});\n\t\tObject.defineProperty(convert[model], 'labels', {value: labels});\n\t}\n}\n\nconvert.rgb.hsl = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar min = Math.min(r, g, b);\n\tvar max = Math.max(r, g, b);\n\tvar delta = max - min;\n\tvar h;\n\tvar s;\n\tvar l;\n\n\tif (max === min) {\n\t\th = 0;\n\t} else if (r === max) {\n\t\th = (g - b) / delta;\n\t} else if (g === max) {\n\t\th = 2 + (b - r) / delta;\n\t} else if (b === max) {\n\t\th = 4 + (r - g) / delta;\n\t}\n\n\th = Math.min(h * 60, 360);\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tl = (min + max) / 2;\n\n\tif (max === min) {\n\t\ts = 0;\n\t} else if (l <= 0.5) {\n\t\ts = delta / (max + min);\n\t} else {\n\t\ts = delta / (2 - max - min);\n\t}\n\n\treturn [h, s * 100, l * 100];\n};\n\nconvert.rgb.hsv = function (rgb) {\n\tvar rdif;\n\tvar gdif;\n\tvar bdif;\n\tvar h;\n\tvar s;\n\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar v = Math.max(r, g, b);\n\tvar diff = v - Math.min(r, g, b);\n\tvar diffc = function (c) {\n\t\treturn (v - c) / 6 / diff + 1 / 2;\n\t};\n\n\tif (diff === 0) {\n\t\th = s = 0;\n\t} else {\n\t\ts = diff / v;\n\t\trdif = diffc(r);\n\t\tgdif = diffc(g);\n\t\tbdif = diffc(b);\n\n\t\tif (r === v) {\n\t\t\th = bdif - gdif;\n\t\t} else if (g === v) {\n\t\t\th = (1 / 3) + rdif - bdif;\n\t\t} else if (b === v) {\n\t\t\th = (2 / 3) + gdif - rdif;\n\t\t}\n\t\tif (h < 0) {\n\t\t\th += 1;\n\t\t} else if (h > 1) {\n\t\t\th -= 1;\n\t\t}\n\t}\n\n\treturn [\n\t\th * 360,\n\t\ts * 100,\n\t\tv * 100\n\t];\n};\n\nconvert.rgb.hwb = function (rgb) {\n\tvar r = rgb[0];\n\tvar g = rgb[1];\n\tvar b = rgb[2];\n\tvar h = convert.rgb.hsl(rgb)[0];\n\tvar w = 1 / 255 * Math.min(r, Math.min(g, b));\n\n\tb = 1 - 1 / 255 * Math.max(r, Math.max(g, b));\n\n\treturn [h, w * 100, b * 100];\n};\n\nconvert.rgb.cmyk = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar c;\n\tvar m;\n\tvar y;\n\tvar k;\n\n\tk = Math.min(1 - r, 1 - g, 1 - b);\n\tc = (1 - r - k) / (1 - k) || 0;\n\tm = (1 - g - k) / (1 - k) || 0;\n\ty = (1 - b - k) / (1 - k) || 0;\n\n\treturn [c * 100, m * 100, y * 100, k * 100];\n};\n\n/**\n * See https://en.m.wikipedia.org/wiki/Euclidean_distance#Squared_Euclidean_distance\n * */\nfunction comparativeDistance(x, y) {\n\treturn (\n\t\tMath.pow(x[0] - y[0], 2) +\n\t\tMath.pow(x[1] - y[1], 2) +\n\t\tMath.pow(x[2] - y[2], 2)\n\t);\n}\n\nconvert.rgb.keyword = function (rgb) {\n\tvar reversed = reverseKeywords[rgb];\n\tif (reversed) {\n\t\treturn reversed;\n\t}\n\n\tvar currentClosestDistance = Infinity;\n\tvar currentClosestKeyword;\n\n\tfor (var keyword in cssKeywords) {\n\t\tif (cssKeywords.hasOwnProperty(keyword)) {\n\t\t\tvar value = cssKeywords[keyword];\n\n\t\t\t// Compute comparative distance\n\t\t\tvar distance = comparativeDistance(rgb, value);\n\n\t\t\t// Check if its less, if so set as closest\n\t\t\tif (distance < currentClosestDistance) {\n\t\t\t\tcurrentClosestDistance = distance;\n\t\t\t\tcurrentClosestKeyword = keyword;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn currentClosestKeyword;\n};\n\nconvert.keyword.rgb = function (keyword) {\n\treturn cssKeywords[keyword];\n};\n\nconvert.rgb.xyz = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\n\t// assume sRGB\n\tr = r > 0.04045 ? Math.pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? Math.pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? Math.pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n\tvar x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tvar y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tvar z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n\n\treturn [x * 100, y * 100, z * 100];\n};\n\nconvert.rgb.lab = function (rgb) {\n\tvar xyz = convert.rgb.xyz(rgb);\n\tvar x = xyz[0];\n\tvar y = xyz[1];\n\tvar z = xyz[2];\n\tvar l;\n\tvar a;\n\tvar b;\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? Math.pow(x, 1 / 3) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? Math.pow(y, 1 / 3) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? Math.pow(z, 1 / 3) : (7.787 * z) + (16 / 116);\n\n\tl = (116 * y) - 16;\n\ta = 500 * (x - y);\n\tb = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.hsl.rgb = function (hsl) {\n\tvar h = hsl[0] / 360;\n\tvar s = hsl[1] / 100;\n\tvar l = hsl[2] / 100;\n\tvar t1;\n\tvar t2;\n\tvar t3;\n\tvar rgb;\n\tvar val;\n\n\tif (s === 0) {\n\t\tval = l * 255;\n\t\treturn [val, val, val];\n\t}\n\n\tif (l < 0.5) {\n\t\tt2 = l * (1 + s);\n\t} else {\n\t\tt2 = l + s - l * s;\n\t}\n\n\tt1 = 2 * l - t2;\n\n\trgb = [0, 0, 0];\n\tfor (var i = 0; i < 3; i++) {\n\t\tt3 = h + 1 / 3 * -(i - 1);\n\t\tif (t3 < 0) {\n\t\t\tt3++;\n\t\t}\n\t\tif (t3 > 1) {\n\t\t\tt3--;\n\t\t}\n\n\t\tif (6 * t3 < 1) {\n\t\t\tval = t1 + (t2 - t1) * 6 * t3;\n\t\t} else if (2 * t3 < 1) {\n\t\t\tval = t2;\n\t\t} else if (3 * t3 < 2) {\n\t\t\tval = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n\t\t} else {\n\t\t\tval = t1;\n\t\t}\n\n\t\trgb[i] = val * 255;\n\t}\n\n\treturn rgb;\n};\n\nconvert.hsl.hsv = function (hsl) {\n\tvar h = hsl[0];\n\tvar s = hsl[1] / 100;\n\tvar l = hsl[2] / 100;\n\tvar smin = s;\n\tvar lmin = Math.max(l, 0.01);\n\tvar sv;\n\tvar v;\n\n\tl *= 2;\n\ts *= (l <= 1) ? l : 2 - l;\n\tsmin *= lmin <= 1 ? lmin : 2 - lmin;\n\tv = (l + s) / 2;\n\tsv = l === 0 ? (2 * smin) / (lmin + smin) : (2 * s) / (l + s);\n\n\treturn [h, sv * 100, v * 100];\n};\n\nconvert.hsv.rgb = function (hsv) {\n\tvar h = hsv[0] / 60;\n\tvar s = hsv[1] / 100;\n\tvar v = hsv[2] / 100;\n\tvar hi = Math.floor(h) % 6;\n\n\tvar f = h - Math.floor(h);\n\tvar p = 255 * v * (1 - s);\n\tvar q = 255 * v * (1 - (s * f));\n\tvar t = 255 * v * (1 - (s * (1 - f)));\n\tv *= 255;\n\n\tswitch (hi) {\n\t\tcase 0:\n\t\t\treturn [v, t, p];\n\t\tcase 1:\n\t\t\treturn [q, v, p];\n\t\tcase 2:\n\t\t\treturn [p, v, t];\n\t\tcase 3:\n\t\t\treturn [p, q, v];\n\t\tcase 4:\n\t\t\treturn [t, p, v];\n\t\tcase 5:\n\t\t\treturn [v, p, q];\n\t}\n};\n\nconvert.hsv.hsl = function (hsv) {\n\tvar h = hsv[0];\n\tvar s = hsv[1] / 100;\n\tvar v = hsv[2] / 100;\n\tvar vmin = Math.max(v, 0.01);\n\tvar lmin;\n\tvar sl;\n\tvar l;\n\n\tl = (2 - s) * v;\n\tlmin = (2 - s) * vmin;\n\tsl = s * vmin;\n\tsl /= (lmin <= 1) ? lmin : 2 - lmin;\n\tsl = sl || 0;\n\tl /= 2;\n\n\treturn [h, sl * 100, l * 100];\n};\n\n// http://dev.w3.org/csswg/css-color/#hwb-to-rgb\nconvert.hwb.rgb = function (hwb) {\n\tvar h = hwb[0] / 360;\n\tvar wh = hwb[1] / 100;\n\tvar bl = hwb[2] / 100;\n\tvar ratio = wh + bl;\n\tvar i;\n\tvar v;\n\tvar f;\n\tvar n;\n\n\t// wh + bl cant be > 1\n\tif (ratio > 1) {\n\t\twh /= ratio;\n\t\tbl /= ratio;\n\t}\n\n\ti = Math.floor(6 * h);\n\tv = 1 - bl;\n\tf = 6 * h - i;\n\n\tif ((i & 0x01) !== 0) {\n\t\tf = 1 - f;\n\t}\n\n\tn = wh + f * (v - wh); // linear interpolation\n\n\tvar r;\n\tvar g;\n\tvar b;\n\tswitch (i) {\n\t\tdefault:\n\t\tcase 6:\n\t\tcase 0: r = v; g = n; b = wh; break;\n\t\tcase 1: r = n; g = v; b = wh; break;\n\t\tcase 2: r = wh; g = v; b = n; break;\n\t\tcase 3: r = wh; g = n; b = v; break;\n\t\tcase 4: r = n; g = wh; b = v; break;\n\t\tcase 5: r = v; g = wh; b = n; break;\n\t}\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.cmyk.rgb = function (cmyk) {\n\tvar c = cmyk[0] / 100;\n\tvar m = cmyk[1] / 100;\n\tvar y = cmyk[2] / 100;\n\tvar k = cmyk[3] / 100;\n\tvar r;\n\tvar g;\n\tvar b;\n\n\tr = 1 - Math.min(1, c * (1 - k) + k);\n\tg = 1 - Math.min(1, m * (1 - k) + k);\n\tb = 1 - Math.min(1, y * (1 - k) + k);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.rgb = function (xyz) {\n\tvar x = xyz[0] / 100;\n\tvar y = xyz[1] / 100;\n\tvar z = xyz[2] / 100;\n\tvar r;\n\tvar g;\n\tvar b;\n\n\tr = (x * 3.2406) + (y * -1.5372) + (z * -0.4986);\n\tg = (x * -0.9689) + (y * 1.8758) + (z * 0.0415);\n\tb = (x * 0.0557) + (y * -0.2040) + (z * 1.0570);\n\n\t// assume sRGB\n\tr = r > 0.0031308\n\t\t? ((1.055 * Math.pow(r, 1.0 / 2.4)) - 0.055)\n\t\t: r * 12.92;\n\n\tg = g > 0.0031308\n\t\t? ((1.055 * Math.pow(g, 1.0 / 2.4)) - 0.055)\n\t\t: g * 12.92;\n\n\tb = b > 0.0031308\n\t\t? ((1.055 * Math.pow(b, 1.0 / 2.4)) - 0.055)\n\t\t: b * 12.92;\n\n\tr = Math.min(Math.max(0, r), 1);\n\tg = Math.min(Math.max(0, g), 1);\n\tb = Math.min(Math.max(0, b), 1);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.lab = function (xyz) {\n\tvar x = xyz[0];\n\tvar y = xyz[1];\n\tvar z = xyz[2];\n\tvar l;\n\tvar a;\n\tvar b;\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? Math.pow(x, 1 / 3) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? Math.pow(y, 1 / 3) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? Math.pow(z, 1 / 3) : (7.787 * z) + (16 / 116);\n\n\tl = (116 * y) - 16;\n\ta = 500 * (x - y);\n\tb = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.lab.xyz = function (lab) {\n\tvar l = lab[0];\n\tvar a = lab[1];\n\tvar b = lab[2];\n\tvar x;\n\tvar y;\n\tvar z;\n\n\ty = (l + 16) / 116;\n\tx = a / 500 + y;\n\tz = y - b / 200;\n\n\tvar y2 = Math.pow(y, 3);\n\tvar x2 = Math.pow(x, 3);\n\tvar z2 = Math.pow(z, 3);\n\ty = y2 > 0.008856 ? y2 : (y - 16 / 116) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16 / 116) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16 / 116) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100;\n\tz *= 108.883;\n\n\treturn [x, y, z];\n};\n\nconvert.lab.lch = function (lab) {\n\tvar l = lab[0];\n\tvar a = lab[1];\n\tvar b = lab[2];\n\tvar hr;\n\tvar h;\n\tvar c;\n\n\thr = Math.atan2(b, a);\n\th = hr * 360 / 2 / Math.PI;\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tc = Math.sqrt(a * a + b * b);\n\n\treturn [l, c, h];\n};\n\nconvert.lch.lab = function (lch) {\n\tvar l = lch[0];\n\tvar c = lch[1];\n\tvar h = lch[2];\n\tvar a;\n\tvar b;\n\tvar hr;\n\n\thr = h / 360 * 2 * Math.PI;\n\ta = c * Math.cos(hr);\n\tb = c * Math.sin(hr);\n\n\treturn [l, a, b];\n};\n\nconvert.rgb.ansi16 = function (args) {\n\tvar r = args[0];\n\tvar g = args[1];\n\tvar b = args[2];\n\tvar value = 1 in arguments ? arguments[1] : convert.rgb.hsv(args)[2]; // hsv -> ansi16 optimization\n\n\tvalue = Math.round(value / 50);\n\n\tif (value === 0) {\n\t\treturn 30;\n\t}\n\n\tvar ansi = 30\n\t\t+ ((Math.round(b / 255) << 2)\n\t\t| (Math.round(g / 255) << 1)\n\t\t| Math.round(r / 255));\n\n\tif (value === 2) {\n\t\tansi += 60;\n\t}\n\n\treturn ansi;\n};\n\nconvert.hsv.ansi16 = function (args) {\n\t// optimization here; we already know the value and don't need to get\n\t// it converted for us.\n\treturn convert.rgb.ansi16(convert.hsv.rgb(args), args[2]);\n};\n\nconvert.rgb.ansi256 = function (args) {\n\tvar r = args[0];\n\tvar g = args[1];\n\tvar b = args[2];\n\n\t// we use the extended greyscale palette here, with the exception of\n\t// black and white. normal palette only has 4 greyscale shades.\n\tif (r === g && g === b) {\n\t\tif (r < 8) {\n\t\t\treturn 16;\n\t\t}\n\n\t\tif (r > 248) {\n\t\t\treturn 231;\n\t\t}\n\n\t\treturn Math.round(((r - 8) / 247) * 24) + 232;\n\t}\n\n\tvar ansi = 16\n\t\t+ (36 * Math.round(r / 255 * 5))\n\t\t+ (6 * Math.round(g / 255 * 5))\n\t\t+ Math.round(b / 255 * 5);\n\n\treturn ansi;\n};\n\nconvert.ansi16.rgb = function (args) {\n\tvar color = args % 10;\n\n\t// handle greyscale\n\tif (color === 0 || color === 7) {\n\t\tif (args > 50) {\n\t\t\tcolor += 3.5;\n\t\t}\n\n\t\tcolor = color / 10.5 * 255;\n\n\t\treturn [color, color, color];\n\t}\n\n\tvar mult = (~~(args > 50) + 1) * 0.5;\n\tvar r = ((color & 1) * mult) * 255;\n\tvar g = (((color >> 1) & 1) * mult) * 255;\n\tvar b = (((color >> 2) & 1) * mult) * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.ansi256.rgb = function (args) {\n\t// handle greyscale\n\tif (args >= 232) {\n\t\tvar c = (args - 232) * 10 + 8;\n\t\treturn [c, c, c];\n\t}\n\n\targs -= 16;\n\n\tvar rem;\n\tvar r = Math.floor(args / 36) / 5 * 255;\n\tvar g = Math.floor((rem = args % 36) / 6) / 5 * 255;\n\tvar b = (rem % 6) / 5 * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hex = function (args) {\n\tvar integer = ((Math.round(args[0]) & 0xFF) << 16)\n\t\t+ ((Math.round(args[1]) & 0xFF) << 8)\n\t\t+ (Math.round(args[2]) & 0xFF);\n\n\tvar string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.hex.rgb = function (args) {\n\tvar match = args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);\n\tif (!match) {\n\t\treturn [0, 0, 0];\n\t}\n\n\tvar colorString = match[0];\n\n\tif (match[0].length === 3) {\n\t\tcolorString = colorString.split('').map(function (char) {\n\t\t\treturn char + char;\n\t\t}).join('');\n\t}\n\n\tvar integer = parseInt(colorString, 16);\n\tvar r = (integer >> 16) & 0xFF;\n\tvar g = (integer >> 8) & 0xFF;\n\tvar b = integer & 0xFF;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hcg = function (rgb) {\n\tvar r = rgb[0] / 255;\n\tvar g = rgb[1] / 255;\n\tvar b = rgb[2] / 255;\n\tvar max = Math.max(Math.max(r, g), b);\n\tvar min = Math.min(Math.min(r, g), b);\n\tvar chroma = (max - min);\n\tvar grayscale;\n\tvar hue;\n\n\tif (chroma < 1) {\n\t\tgrayscale = min / (1 - chroma);\n\t} else {\n\t\tgrayscale = 0;\n\t}\n\n\tif (chroma <= 0) {\n\t\thue = 0;\n\t} else\n\tif (max === r) {\n\t\thue = ((g - b) / chroma) % 6;\n\t} else\n\tif (max === g) {\n\t\thue = 2 + (b - r) / chroma;\n\t} else {\n\t\thue = 4 + (r - g) / chroma + 4;\n\t}\n\n\thue /= 6;\n\thue %= 1;\n\n\treturn [hue * 360, chroma * 100, grayscale * 100];\n};\n\nconvert.hsl.hcg = function (hsl) {\n\tvar s = hsl[1] / 100;\n\tvar l = hsl[2] / 100;\n\tvar c = 1;\n\tvar f = 0;\n\n\tif (l < 0.5) {\n\t\tc = 2.0 * s * l;\n\t} else {\n\t\tc = 2.0 * s * (1.0 - l);\n\t}\n\n\tif (c < 1.0) {\n\t\tf = (l - 0.5 * c) / (1.0 - c);\n\t}\n\n\treturn [hsl[0], c * 100, f * 100];\n};\n\nconvert.hsv.hcg = function (hsv) {\n\tvar s = hsv[1] / 100;\n\tvar v = hsv[2] / 100;\n\n\tvar c = s * v;\n\tvar f = 0;\n\n\tif (c < 1.0) {\n\t\tf = (v - c) / (1 - c);\n\t}\n\n\treturn [hsv[0], c * 100, f * 100];\n};\n\nconvert.hcg.rgb = function (hcg) {\n\tvar h = hcg[0] / 360;\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\n\tif (c === 0.0) {\n\t\treturn [g * 255, g * 255, g * 255];\n\t}\n\n\tvar pure = [0, 0, 0];\n\tvar hi = (h % 1) * 6;\n\tvar v = hi % 1;\n\tvar w = 1 - v;\n\tvar mg = 0;\n\n\tswitch (Math.floor(hi)) {\n\t\tcase 0:\n\t\t\tpure[0] = 1; pure[1] = v; pure[2] = 0; break;\n\t\tcase 1:\n\t\t\tpure[0] = w; pure[1] = 1; pure[2] = 0; break;\n\t\tcase 2:\n\t\t\tpure[0] = 0; pure[1] = 1; pure[2] = v; break;\n\t\tcase 3:\n\t\t\tpure[0] = 0; pure[1] = w; pure[2] = 1; break;\n\t\tcase 4:\n\t\t\tpure[0] = v; pure[1] = 0; pure[2] = 1; break;\n\t\tdefault:\n\t\t\tpure[0] = 1; pure[1] = 0; pure[2] = w;\n\t}\n\n\tmg = (1.0 - c) * g;\n\n\treturn [\n\t\t(c * pure[0] + mg) * 255,\n\t\t(c * pure[1] + mg) * 255,\n\t\t(c * pure[2] + mg) * 255\n\t];\n};\n\nconvert.hcg.hsv = function (hcg) {\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\n\tvar v = c + g * (1.0 - c);\n\tvar f = 0;\n\n\tif (v > 0.0) {\n\t\tf = c / v;\n\t}\n\n\treturn [hcg[0], f * 100, v * 100];\n};\n\nconvert.hcg.hsl = function (hcg) {\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\n\tvar l = g * (1.0 - c) + 0.5 * c;\n\tvar s = 0;\n\n\tif (l > 0.0 && l < 0.5) {\n\t\ts = c / (2 * l);\n\t} else\n\tif (l >= 0.5 && l < 1.0) {\n\t\ts = c / (2 * (1 - l));\n\t}\n\n\treturn [hcg[0], s * 100, l * 100];\n};\n\nconvert.hcg.hwb = function (hcg) {\n\tvar c = hcg[1] / 100;\n\tvar g = hcg[2] / 100;\n\tvar v = c + g * (1.0 - c);\n\treturn [hcg[0], (v - c) * 100, (1 - v) * 100];\n};\n\nconvert.hwb.hcg = function (hwb) {\n\tvar w = hwb[1] / 100;\n\tvar b = hwb[2] / 100;\n\tvar v = 1 - b;\n\tvar c = v - w;\n\tvar g = 0;\n\n\tif (c < 1) {\n\t\tg = (v - c) / (1 - c);\n\t}\n\n\treturn [hwb[0], c * 100, g * 100];\n};\n\nconvert.apple.rgb = function (apple) {\n\treturn [(apple[0] / 65535) * 255, (apple[1] / 65535) * 255, (apple[2] / 65535) * 255];\n};\n\nconvert.rgb.apple = function (rgb) {\n\treturn [(rgb[0] / 255) * 65535, (rgb[1] / 255) * 65535, (rgb[2] / 255) * 65535];\n};\n\nconvert.gray.rgb = function (args) {\n\treturn [args[0] / 100 * 255, args[0] / 100 * 255, args[0] / 100 * 255];\n};\n\nconvert.gray.hsl = convert.gray.hsv = function (args) {\n\treturn [0, 0, args[0]];\n};\n\nconvert.gray.hwb = function (gray) {\n\treturn [0, 100, gray[0]];\n};\n\nconvert.gray.cmyk = function (gray) {\n\treturn [0, 0, 0, gray[0]];\n};\n\nconvert.gray.lab = function (gray) {\n\treturn [gray[0], 0, 0];\n};\n\nconvert.gray.hex = function (gray) {\n\tvar val = Math.round(gray[0] / 100 * 255) & 0xFF;\n\tvar integer = (val << 16) + (val << 8) + val;\n\n\tvar string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.rgb.gray = function (rgb) {\n\tvar val = (rgb[0] + rgb[1] + rgb[2]) / 3;\n\treturn [val / 255 * 100];\n};\n","var conversions = require('./conversions');\n\n/*\n\tthis function routes a model to all other models.\n\n\tall functions that are routed have a property `.conversion` attached\n\tto the returned synthetic function. This property is an array\n\tof strings, each with the steps in between the 'from' and 'to'\n\tcolor models (inclusive).\n\n\tconversions that are not possible simply are not included.\n*/\n\nfunction buildGraph() {\n\tvar graph = {};\n\t// https://jsperf.com/object-keys-vs-for-in-with-closure/3\n\tvar models = Object.keys(conversions);\n\n\tfor (var len = models.length, i = 0; i < len; i++) {\n\t\tgraph[models[i]] = {\n\t\t\t// http://jsperf.com/1-vs-infinity\n\t\t\t// micro-opt, but this is simple.\n\t\t\tdistance: -1,\n\t\t\tparent: null\n\t\t};\n\t}\n\n\treturn graph;\n}\n\n// https://en.wikipedia.org/wiki/Breadth-first_search\nfunction deriveBFS(fromModel) {\n\tvar graph = buildGraph();\n\tvar queue = [fromModel]; // unshift -> queue -> pop\n\n\tgraph[fromModel].distance = 0;\n\n\twhile (queue.length) {\n\t\tvar current = queue.pop();\n\t\tvar adjacents = Object.keys(conversions[current]);\n\n\t\tfor (var len = adjacents.length, i = 0; i < len; i++) {\n\t\t\tvar adjacent = adjacents[i];\n\t\t\tvar node = graph[adjacent];\n\n\t\t\tif (node.distance === -1) {\n\t\t\t\tnode.distance = graph[current].distance + 1;\n\t\t\t\tnode.parent = current;\n\t\t\t\tqueue.unshift(adjacent);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn graph;\n}\n\nfunction link(from, to) {\n\treturn function (args) {\n\t\treturn to(from(args));\n\t};\n}\n\nfunction wrapConversion(toModel, graph) {\n\tvar path = [graph[toModel].parent, toModel];\n\tvar fn = conversions[graph[toModel].parent][toModel];\n\n\tvar cur = graph[toModel].parent;\n\twhile (graph[cur].parent) {\n\t\tpath.unshift(graph[cur].parent);\n\t\tfn = link(conversions[graph[cur].parent][cur], fn);\n\t\tcur = graph[cur].parent;\n\t}\n\n\tfn.conversion = path;\n\treturn fn;\n}\n\nmodule.exports = function (fromModel) {\n\tvar graph = deriveBFS(fromModel);\n\tvar conversion = {};\n\n\tvar models = Object.keys(graph);\n\tfor (var len = models.length, i = 0; i < len; i++) {\n\t\tvar toModel = models[i];\n\t\tvar node = graph[toModel];\n\n\t\tif (node.parent === null) {\n\t\t\t// no possible conversion, or this node is the source model.\n\t\t\tcontinue;\n\t\t}\n\n\t\tconversion[toModel] = wrapConversion(toModel, graph);\n\t}\n\n\treturn conversion;\n};\n\n","var conversions = require('./conversions');\nvar route = require('./route');\n\nvar convert = {};\n\nvar models = Object.keys(conversions);\n\nfunction wrapRaw(fn) {\n\tvar wrappedFn = function (args) {\n\t\tif (args === undefined || args === null) {\n\t\t\treturn args;\n\t\t}\n\n\t\tif (arguments.length > 1) {\n\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t}\n\n\t\treturn fn(args);\n\t};\n\n\t// preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nfunction wrapRounded(fn) {\n\tvar wrappedFn = function (args) {\n\t\tif (args === undefined || args === null) {\n\t\t\treturn args;\n\t\t}\n\n\t\tif (arguments.length > 1) {\n\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t}\n\n\t\tvar result = fn(args);\n\n\t\t// we're assuming the result is an array here.\n\t\t// see notice in conversions.js; don't use box types\n\t\t// in conversion functions.\n\t\tif (typeof result === 'object') {\n\t\t\tfor (var len = result.length, i = 0; i < len; i++) {\n\t\t\t\tresult[i] = Math.round(result[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\t// preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nmodels.forEach(function (fromModel) {\n\tconvert[fromModel] = {};\n\n\tObject.defineProperty(convert[fromModel], 'channels', {value: conversions[fromModel].channels});\n\tObject.defineProperty(convert[fromModel], 'labels', {value: conversions[fromModel].labels});\n\n\tvar routes = route(fromModel);\n\tvar routeModels = Object.keys(routes);\n\n\trouteModels.forEach(function (toModel) {\n\t\tvar fn = routes[toModel];\n\n\t\tconvert[fromModel][toModel] = wrapRounded(fn);\n\t\tconvert[fromModel][toModel].raw = wrapRaw(fn);\n\t});\n});\n\nmodule.exports = convert;\n","'use strict';\n\nvar colorString = require('color-string');\nvar convert = require('color-convert');\n\nvar _slice = [].slice;\n\nvar skippedModels = [\n\t// to be honest, I don't really feel like keyword belongs in color convert, but eh.\n\t'keyword',\n\n\t// gray conflicts with some method names, and has its own method defined.\n\t'gray',\n\n\t// shouldn't really be in color-convert either...\n\t'hex'\n];\n\nvar hashedModelKeys = {};\nObject.keys(convert).forEach(function (model) {\n\thashedModelKeys[_slice.call(convert[model].labels).sort().join('')] = model;\n});\n\nvar limiters = {};\n\nfunction Color(obj, model) {\n\tif (!(this instanceof Color)) {\n\t\treturn new Color(obj, model);\n\t}\n\n\tif (model && model in skippedModels) {\n\t\tmodel = null;\n\t}\n\n\tif (model && !(model in convert)) {\n\t\tthrow new Error('Unknown model: ' + model);\n\t}\n\n\tvar i;\n\tvar channels;\n\n\tif (obj == null) { // eslint-disable-line no-eq-null,eqeqeq\n\t\tthis.model = 'rgb';\n\t\tthis.color = [0, 0, 0];\n\t\tthis.valpha = 1;\n\t} else if (obj instanceof Color) {\n\t\tthis.model = obj.model;\n\t\tthis.color = obj.color.slice();\n\t\tthis.valpha = obj.valpha;\n\t} else if (typeof obj === 'string') {\n\t\tvar result = colorString.get(obj);\n\t\tif (result === null) {\n\t\t\tthrow new Error('Unable to parse color from string: ' + obj);\n\t\t}\n\n\t\tthis.model = result.model;\n\t\tchannels = convert[this.model].channels;\n\t\tthis.color = result.value.slice(0, channels);\n\t\tthis.valpha = typeof result.value[channels] === 'number' ? result.value[channels] : 1;\n\t} else if (obj.length) {\n\t\tthis.model = model || 'rgb';\n\t\tchannels = convert[this.model].channels;\n\t\tvar newArr = _slice.call(obj, 0, channels);\n\t\tthis.color = zeroArray(newArr, channels);\n\t\tthis.valpha = typeof obj[channels] === 'number' ? obj[channels] : 1;\n\t} else if (typeof obj === 'number') {\n\t\t// this is always RGB - can be converted later on.\n\t\tobj &= 0xFFFFFF;\n\t\tthis.model = 'rgb';\n\t\tthis.color = [\n\t\t\t(obj >> 16) & 0xFF,\n\t\t\t(obj >> 8) & 0xFF,\n\t\t\tobj & 0xFF\n\t\t];\n\t\tthis.valpha = 1;\n\t} else {\n\t\tthis.valpha = 1;\n\n\t\tvar keys = Object.keys(obj);\n\t\tif ('alpha' in obj) {\n\t\t\tkeys.splice(keys.indexOf('alpha'), 1);\n\t\t\tthis.valpha = typeof obj.alpha === 'number' ? obj.alpha : 0;\n\t\t}\n\n\t\tvar hashedKeys = keys.sort().join('');\n\t\tif (!(hashedKeys in hashedModelKeys)) {\n\t\t\tthrow new Error('Unable to parse color from object: ' + JSON.stringify(obj));\n\t\t}\n\n\t\tthis.model = hashedModelKeys[hashedKeys];\n\n\t\tvar labels = convert[this.model].labels;\n\t\tvar color = [];\n\t\tfor (i = 0; i < labels.length; i++) {\n\t\t\tcolor.push(obj[labels[i]]);\n\t\t}\n\n\t\tthis.color = zeroArray(color);\n\t}\n\n\t// perform limitations (clamping, etc.)\n\tif (limiters[this.model]) {\n\t\tchannels = convert[this.model].channels;\n\t\tfor (i = 0; i < channels; i++) {\n\t\t\tvar limit = limiters[this.model][i];\n\t\t\tif (limit) {\n\t\t\t\tthis.color[i] = limit(this.color[i]);\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.valpha = Math.max(0, Math.min(1, this.valpha));\n\n\tif (Object.freeze) {\n\t\tObject.freeze(this);\n\t}\n}\n\nColor.prototype = {\n\ttoString: function () {\n\t\treturn this.string();\n\t},\n\n\ttoJSON: function () {\n\t\treturn this[this.model]();\n\t},\n\n\tstring: function (places) {\n\t\tvar self = this.model in colorString.to ? this : this.rgb();\n\t\tself = self.round(typeof places === 'number' ? places : 1);\n\t\tvar args = self.valpha === 1 ? self.color : self.color.concat(this.valpha);\n\t\treturn colorString.to[self.model](args);\n\t},\n\n\tpercentString: function (places) {\n\t\tvar self = this.rgb().round(typeof places === 'number' ? places : 1);\n\t\tvar args = self.valpha === 1 ? self.color : self.color.concat(this.valpha);\n\t\treturn colorString.to.rgb.percent(args);\n\t},\n\n\tarray: function () {\n\t\treturn this.valpha === 1 ? this.color.slice() : this.color.concat(this.valpha);\n\t},\n\n\tobject: function () {\n\t\tvar result = {};\n\t\tvar channels = convert[this.model].channels;\n\t\tvar labels = convert[this.model].labels;\n\n\t\tfor (var i = 0; i < channels; i++) {\n\t\t\tresult[labels[i]] = this.color[i];\n\t\t}\n\n\t\tif (this.valpha !== 1) {\n\t\t\tresult.alpha = this.valpha;\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tunitArray: function () {\n\t\tvar rgb = this.rgb().color;\n\t\trgb[0] /= 255;\n\t\trgb[1] /= 255;\n\t\trgb[2] /= 255;\n\n\t\tif (this.valpha !== 1) {\n\t\t\trgb.push(this.valpha);\n\t\t}\n\n\t\treturn rgb;\n\t},\n\n\tunitObject: function () {\n\t\tvar rgb = this.rgb().object();\n\t\trgb.r /= 255;\n\t\trgb.g /= 255;\n\t\trgb.b /= 255;\n\n\t\tif (this.valpha !== 1) {\n\t\t\trgb.alpha = this.valpha;\n\t\t}\n\n\t\treturn rgb;\n\t},\n\n\tround: function (places) {\n\t\tplaces = Math.max(places || 0, 0);\n\t\treturn new Color(this.color.map(roundToPlace(places)).concat(this.valpha), this.model);\n\t},\n\n\talpha: function (val) {\n\t\tif (arguments.length) {\n\t\t\treturn new Color(this.color.concat(Math.max(0, Math.min(1, val))), this.model);\n\t\t}\n\n\t\treturn this.valpha;\n\t},\n\n\t// rgb\n\tred: getset('rgb', 0, maxfn(255)),\n\tgreen: getset('rgb', 1, maxfn(255)),\n\tblue: getset('rgb', 2, maxfn(255)),\n\n\thue: getset(['hsl', 'hsv', 'hsl', 'hwb', 'hcg'], 0, function (val) { return ((val % 360) + 360) % 360; }), // eslint-disable-line brace-style\n\n\tsaturationl: getset('hsl', 1, maxfn(100)),\n\tlightness: getset('hsl', 2, maxfn(100)),\n\n\tsaturationv: getset('hsv', 1, maxfn(100)),\n\tvalue: getset('hsv', 2, maxfn(100)),\n\n\tchroma: getset('hcg', 1, maxfn(100)),\n\tgray: getset('hcg', 2, maxfn(100)),\n\n\twhite: getset('hwb', 1, maxfn(100)),\n\twblack: getset('hwb', 2, maxfn(100)),\n\n\tcyan: getset('cmyk', 0, maxfn(100)),\n\tmagenta: getset('cmyk', 1, maxfn(100)),\n\tyellow: getset('cmyk', 2, maxfn(100)),\n\tblack: getset('cmyk', 3, maxfn(100)),\n\n\tx: getset('xyz', 0, maxfn(100)),\n\ty: getset('xyz', 1, maxfn(100)),\n\tz: getset('xyz', 2, maxfn(100)),\n\n\tl: getset('lab', 0, maxfn(100)),\n\ta: getset('lab', 1),\n\tb: getset('lab', 2),\n\n\tkeyword: function (val) {\n\t\tif (arguments.length) {\n\t\t\treturn new Color(val);\n\t\t}\n\n\t\treturn convert[this.model].keyword(this.color);\n\t},\n\n\thex: function (val) {\n\t\tif (arguments.length) {\n\t\t\treturn new Color(val);\n\t\t}\n\n\t\treturn colorString.to.hex(this.rgb().round().color);\n\t},\n\n\trgbNumber: function () {\n\t\tvar rgb = this.rgb().color;\n\t\treturn ((rgb[0] & 0xFF) << 16) | ((rgb[1] & 0xFF) << 8) | (rgb[2] & 0xFF);\n\t},\n\n\tluminosity: function () {\n\t\t// http://www.w3.org/TR/WCAG20/#relativeluminancedef\n\t\tvar rgb = this.rgb().color;\n\n\t\tvar lum = [];\n\t\tfor (var i = 0; i < rgb.length; i++) {\n\t\t\tvar chan = rgb[i] / 255;\n\t\t\tlum[i] = (chan <= 0.03928) ? chan / 12.92 : Math.pow(((chan + 0.055) / 1.055), 2.4);\n\t\t}\n\n\t\treturn 0.2126 * lum[0] + 0.7152 * lum[1] + 0.0722 * lum[2];\n\t},\n\n\tcontrast: function (color2) {\n\t\t// http://www.w3.org/TR/WCAG20/#contrast-ratiodef\n\t\tvar lum1 = this.luminosity();\n\t\tvar lum2 = color2.luminosity();\n\n\t\tif (lum1 > lum2) {\n\t\t\treturn (lum1 + 0.05) / (lum2 + 0.05);\n\t\t}\n\n\t\treturn (lum2 + 0.05) / (lum1 + 0.05);\n\t},\n\n\tlevel: function (color2) {\n\t\tvar contrastRatio = this.contrast(color2);\n\t\tif (contrastRatio >= 7.1) {\n\t\t\treturn 'AAA';\n\t\t}\n\n\t\treturn (contrastRatio >= 4.5) ? 'AA' : '';\n\t},\n\n\tisDark: function () {\n\t\t// YIQ equation from http://24ways.org/2010/calculating-color-contrast\n\t\tvar rgb = this.rgb().color;\n\t\tvar yiq = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;\n\t\treturn yiq < 128;\n\t},\n\n\tisLight: function () {\n\t\treturn !this.isDark();\n\t},\n\n\tnegate: function () {\n\t\tvar rgb = this.rgb();\n\t\tfor (var i = 0; i < 3; i++) {\n\t\t\trgb.color[i] = 255 - rgb.color[i];\n\t\t}\n\t\treturn rgb;\n\t},\n\n\tlighten: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[2] += hsl.color[2] * ratio;\n\t\treturn hsl;\n\t},\n\n\tdarken: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[2] -= hsl.color[2] * ratio;\n\t\treturn hsl;\n\t},\n\n\tsaturate: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[1] += hsl.color[1] * ratio;\n\t\treturn hsl;\n\t},\n\n\tdesaturate: function (ratio) {\n\t\tvar hsl = this.hsl();\n\t\thsl.color[1] -= hsl.color[1] * ratio;\n\t\treturn hsl;\n\t},\n\n\twhiten: function (ratio) {\n\t\tvar hwb = this.hwb();\n\t\thwb.color[1] += hwb.color[1] * ratio;\n\t\treturn hwb;\n\t},\n\n\tblacken: function (ratio) {\n\t\tvar hwb = this.hwb();\n\t\thwb.color[2] += hwb.color[2] * ratio;\n\t\treturn hwb;\n\t},\n\n\tgrayscale: function () {\n\t\t// http://en.wikipedia.org/wiki/Grayscale#Converting_color_to_grayscale\n\t\tvar rgb = this.rgb().color;\n\t\tvar val = rgb[0] * 0.3 + rgb[1] * 0.59 + rgb[2] * 0.11;\n\t\treturn Color.rgb(val, val, val);\n\t},\n\n\tfade: function (ratio) {\n\t\treturn this.alpha(this.valpha - (this.valpha * ratio));\n\t},\n\n\topaquer: function (ratio) {\n\t\treturn this.alpha(this.valpha + (this.valpha * ratio));\n\t},\n\n\trotate: function (degrees) {\n\t\tvar hsl = this.hsl();\n\t\tvar hue = hsl.color[0];\n\t\thue = (hue + degrees) % 360;\n\t\thue = hue < 0 ? 360 + hue : hue;\n\t\thsl.color[0] = hue;\n\t\treturn hsl;\n\t},\n\n\tmix: function (mixinColor, weight) {\n\t\t// ported from sass implementation in C\n\t\t// https://github.com/sass/libsass/blob/0e6b4a2850092356aa3ece07c6b249f0221caced/functions.cpp#L209\n\t\tif (!mixinColor || !mixinColor.rgb) {\n\t\t\tthrow new Error('Argument to \"mix\" was not a Color instance, but rather an instance of ' + typeof mixinColor);\n\t\t}\n\t\tvar color1 = mixinColor.rgb();\n\t\tvar color2 = this.rgb();\n\t\tvar p = weight === undefined ? 0.5 : weight;\n\n\t\tvar w = 2 * p - 1;\n\t\tvar a = color1.alpha() - color2.alpha();\n\n\t\tvar w1 = (((w * a === -1) ? w : (w + a) / (1 + w * a)) + 1) / 2.0;\n\t\tvar w2 = 1 - w1;\n\n\t\treturn Color.rgb(\n\t\t\t\tw1 * color1.red() + w2 * color2.red(),\n\t\t\t\tw1 * color1.green() + w2 * color2.green(),\n\t\t\t\tw1 * color1.blue() + w2 * color2.blue(),\n\t\t\t\tcolor1.alpha() * p + color2.alpha() * (1 - p));\n\t}\n};\n\n// model conversion methods and static constructors\nObject.keys(convert).forEach(function (model) {\n\tif (skippedModels.indexOf(model) !== -1) {\n\t\treturn;\n\t}\n\n\tvar channels = convert[model].channels;\n\n\t// conversion methods\n\tColor.prototype[model] = function () {\n\t\tif (this.model === model) {\n\t\t\treturn new Color(this);\n\t\t}\n\n\t\tif (arguments.length) {\n\t\t\treturn new Color(arguments, model);\n\t\t}\n\n\t\tvar newAlpha = typeof arguments[channels] === 'number' ? channels : this.valpha;\n\t\treturn new Color(assertArray(convert[this.model][model].raw(this.color)).concat(newAlpha), model);\n\t};\n\n\t// 'static' construction methods\n\tColor[model] = function (color) {\n\t\tif (typeof color === 'number') {\n\t\t\tcolor = zeroArray(_slice.call(arguments), channels);\n\t\t}\n\t\treturn new Color(color, model);\n\t};\n});\n\nfunction roundTo(num, places) {\n\treturn Number(num.toFixed(places));\n}\n\nfunction roundToPlace(places) {\n\treturn function (num) {\n\t\treturn roundTo(num, places);\n\t};\n}\n\nfunction getset(model, channel, modifier) {\n\tmodel = Array.isArray(model) ? model : [model];\n\n\tmodel.forEach(function (m) {\n\t\t(limiters[m] || (limiters[m] = []))[channel] = modifier;\n\t});\n\n\tmodel = model[0];\n\n\treturn function (val) {\n\t\tvar result;\n\n\t\tif (arguments.length) {\n\t\t\tif (modifier) {\n\t\t\t\tval = modifier(val);\n\t\t\t}\n\n\t\t\tresult = this[model]();\n\t\t\tresult.color[channel] = val;\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = this[model]().color[channel];\n\t\tif (modifier) {\n\t\t\tresult = modifier(result);\n\t\t}\n\n\t\treturn result;\n\t};\n}\n\nfunction maxfn(max) {\n\treturn function (v) {\n\t\treturn Math.max(0, Math.min(max, v));\n\t};\n}\n\nfunction assertArray(val) {\n\treturn Array.isArray(val) ? val : [val];\n}\n\nfunction zeroArray(arr, length) {\n\tfor (var i = 0; i < length; i++) {\n\t\tif (typeof arr[i] !== 'number') {\n\t\t\tarr[i] = 0;\n\t\t}\n\t}\n\n\treturn arr;\n}\n\nmodule.exports = Color;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Color = require(\"color\");\nvar DefaultBaseLValue = 21.247; // L-value of #333333\n/**\n * Get dark mode color for a given color\n * @param color The color to calculate from\n * @param baseLValue The Light value for base dark color in LAB format. @default the Light value for #333333\n */\nfunction getDarkColor(color, baseLValue) {\n    if (baseLValue === void 0) { baseLValue = DefaultBaseLValue; }\n    try {\n        var computedColor = Color(color || undefined);\n        var colorLab = computedColor.lab().array();\n        var newLValue = (100 - colorLab[0]) * ((100 - baseLValue) / 100) + baseLValue;\n        color = Color.lab(newLValue, colorLab[1], colorLab[2])\n            .rgb()\n            .alpha(computedColor.alpha())\n            .toString();\n    }\n    catch (_a) { }\n    return color;\n}\nexports.default = getDarkColor;\n//# sourceMappingURL=getDarkColor.js.map","/**\n * Known announce strings\n */\nexport var KnownAnnounceStrings;\n(function (KnownAnnounceStrings) {\n    /**\n     * String announced for a list item in a OL List\n     * @example\n     * Auto corrected, &lcub;0&rcub;\n     * Where &lcub0&rcub is the new list item bullet\n     */\n    KnownAnnounceStrings[KnownAnnounceStrings[\"AnnounceListItemNumbering\"] = 1] = \"AnnounceListItemNumbering\";\n    /**\n     * String announced for a list item in a UL List\n     * @example\n     * Auto corrected bullet\n     */\n    KnownAnnounceStrings[KnownAnnounceStrings[\"AnnounceListItemBullet\"] = 2] = \"AnnounceListItemBullet\";\n    /**\n     * String announced when cursor is moved to the last cell in a table\n     */\n    KnownAnnounceStrings[KnownAnnounceStrings[\"AnnounceOnFocusLastCell\"] = 3] = \"AnnounceOnFocusLastCell\";\n})(KnownAnnounceStrings || (KnownAnnounceStrings = {}));\n//# sourceMappingURL=KnownAnnounceStrings.js.map","/**\n * Command strings for Document.execCommand() API\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n */\nexport var DocumentCommand;\n(function (DocumentCommand) {\n    /**\n     * Changes the browser auto-link behavior (Internet Explorer only)\n     */\n    DocumentCommand[\"AutoUrlDetect\"] = \"AutoUrlDetect\";\n    /**\n     * Changes the document background color. In styleWithCss mode, it affects the background color of the containing block instead.\n     * This requires a &lt;color&gt; value string to be passed in as a value argument. Note that Internet Explorer uses this to set the\n     * text background color.\n     */\n    DocumentCommand[\"BackColor\"] = \"backColor\";\n    /**\n     * Toggles bold on/off for the selection or at the insertion point. Internet Explorer uses the &lt;strong&gt; tag instead of &lt;b&gt;.\n     */\n    DocumentCommand[\"Bold\"] = \"bold\";\n    /**\n     * Clears all authentication credentials from the cache.\n     */\n    DocumentCommand[\"ClearAuthenticationCache\"] = \"ClearAuthenticationCache\";\n    /**\n     * Makes the content document either read-only or editable. This requires a boolean true/false as the value argument.\n     * (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"ContentReadOnly\"] = \"contentReadOnly\";\n    /**\n     * Copies the current selection to the clipboard. Conditions of having this behavior enabled vary from one browser to another,\n     * and have evolved over time. Check the compatibility table to determine if you can use it in your case.\n     */\n    DocumentCommand[\"Copy\"] = \"copy\";\n    /**\n     * Creates an hyperlink from the selection, but only if there is a selection. Requires a URI string as a value argument for the\n     * hyperlink's href. The URI must contain at least a single character, which may be whitespace.\n     * (Internet Explorer will create a link with a null value.)\n     */\n    DocumentCommand[\"CreateLink\"] = \"createLink\";\n    /**\n     * Removes the current selection and copies it to the clipboard. When this behavior is enabled varies between browsers,\n     * and its conditions have evolved over time. Check the compatibility table for usage details.\n     */\n    DocumentCommand[\"Cut\"] = \"cut\";\n    /**\n     * Adds a &lt;small&gt; tag around the selection or at the insertion point. (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"DecreaseFontSize\"] = \"decreaseFontSize\";\n    /**\n     * Changes the paragraph separator used when new paragraphs are created in editable text regions. See Differences in markup\n     * generation for more details.\n     */\n    DocumentCommand[\"DefaultParagraphSeparator\"] = \"defaultParagraphSeparator\";\n    /**\n     * Deletes the current selection.\n     */\n    DocumentCommand[\"Delete\"] = \"delete\";\n    /**\n     * Enables or disables the table row/column insertion and deletion controls. (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"EnableInlineTableEditing\"] = \"enableInlineTableEditing\";\n    /**\n     * Enables or disables the resize handles on images and other resizable objects. (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"EnableObjectResizing\"] = \"enableObjectResizing\";\n    /**\n     * Changes the font name for the selection or at the insertion point. This requires a font name string (like \"Arial\")\n     * as a value argument.\n     */\n    DocumentCommand[\"FontName\"] = \"fontName\";\n    /**\n     * Changes the font size for the selection or at the insertion point. This requires an integer from 1-7 as a value argument.\n     */\n    DocumentCommand[\"FontSize\"] = \"fontSize\";\n    /**\n     * Changes a font color for the selection or at the insertion point. This requires a hexadecimal color value string\n     * as a value argument.\n     */\n    DocumentCommand[\"ForeColor\"] = \"foreColor\";\n    /**\n     * Adds an HTML block-level element around the line containing the current selection, replacing the block element containing\n     * the line if one exists (in Firefox, &lt;blockquote&gt; is the exception  it will wrap any containing block element).\n     * Requires a tag-name string as a value argument. Virtually all block-level elements can be used.\n     * (Internet Explorer supports only heading tags H1H6, ADDRESS, and PRE, which must be wrapped in angle brackets, such as \"&lt;H1&gt;\".)\n     */\n    DocumentCommand[\"FormatBlock\"] = \"formatBlock\";\n    /**\n     * Deletes the character ahead of the cursor's position, identical to hitting the Delete key on a Windows keyboard.\n     */\n    DocumentCommand[\"ForwardDelete\"] = \"forwardDelete\";\n    /**\n     * Adds a heading element around a selection or insertion point line. Requires the tag-name strings a value argument (i.e. \"H1\", \"H6\").\n     * (Not supported by Internet Explorer and Safari.)\n     */\n    DocumentCommand[\"Heading\"] = \"heading\";\n    /**\n     * Changes the background color for the selection or at the insertion point. Requires a color value string as a value argument.\n     * useCSS must be true for this to function. (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"HiliteColor\"] = \"hiliteColor\";\n    /**\n     * Adds a &lt;big&gt; tag around the selection or at the insertion point. (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"IncreaseFontSize\"] = \"increaseFontSize\";\n    /**\n     * Indents the line containing the selection or insertion point. In Firefox, if the selection spans multiple lines at different\n     * levels of indentation, only the least indented lines in the selection will be indented.\n     */\n    DocumentCommand[\"Indent\"] = \"indent\";\n    /**\n     * Controls whether the Enter key inserts a &lt;br&gt; element, or splits the current block element into two.\n     * (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"InsertBrOnReturn\"] = \"insertBrOnReturn\";\n    /**\n     * Inserts a &lt;hr&gt; element at the insertion point, or replaces the selection with it.\n     */\n    DocumentCommand[\"InsertHorizontalRule\"] = \"insertHorizontalRule\";\n    /**\n     * Inserts an HTML string at the insertion point (deletes selection). Requires a valid HTML string as a value argument.\n     * (Not supported by Internet Explorer.)\n     */\n    DocumentCommand[\"InsertHTML\"] = \"insertHTML\";\n    /**\n     * Inserts an image at the insertion point (deletes selection). Requires a URL string for the image's src as a value argument.\n     * The requirements for this string are the same as createLink.\n     */\n    DocumentCommand[\"InsertImage\"] = \"insertImage\";\n    /**\n     * Creates a numbered ordered list for the selection or at the insertion point.\n     */\n    DocumentCommand[\"InsertOrderedList\"] = \"insertOrderedList\";\n    /**\n     * Creates a bulleted unordered list for the selection or at the insertion point.\n     */\n    DocumentCommand[\"InsertUnorderedList\"] = \"insertUnorderedList\";\n    /**\n     * Inserts a paragraph around the selection or the current line.\n     * (Internet Explorer inserts a paragraph at the insertion point and deletes the selection.)\n     */\n    DocumentCommand[\"InsertParagraph\"] = \"insertParagraph\";\n    /**\n     * Inserts the given plain text at the insertion point (deletes selection).\n     */\n    DocumentCommand[\"InsertText\"] = \"insertText\";\n    /**\n     * Toggles italics on/off for the selection or at the insertion point.\n     * (Internet Explorer uses the &lt;em&gt; element instead of &lt;i&gt;.)\n     */\n    DocumentCommand[\"Italic\"] = \"italic\";\n    /**\n     * Centers the selection or insertion point.\n     */\n    DocumentCommand[\"JustifyCenter\"] = \"justifyCenter\";\n    /**\n     * Justifies the selection or insertion point.\n     */\n    DocumentCommand[\"JustifyFull\"] = \"justifyFull\";\n    /**\n     * Justifies the selection or insertion point to the left.\n     */\n    DocumentCommand[\"JustifyLeft\"] = \"justifyLeft\";\n    /**\n     * Right-justifies the selection or the insertion point.\n     */\n    DocumentCommand[\"JustifyRight\"] = \"justifyRight\";\n    /**\n     * Outdents the line containing the selection or insertion point.\n     */\n    DocumentCommand[\"Outdent\"] = \"outdent\";\n    /**\n     * Pastes the clipboard contents at the insertion point (replaces current selection). Disabled for web content. See [1].\n     */\n    DocumentCommand[\"Paste\"] = \"paste\";\n    /**\n     * Redoes the previous undo command.\n     */\n    DocumentCommand[\"Redo\"] = \"redo\";\n    /**\n     * Removes all formatting from the current selection.\n     */\n    DocumentCommand[\"RemoveFormat\"] = \"removeFormat\";\n    /**\n     * Selects all of the content of the editable region.\n     */\n    DocumentCommand[\"SelectAll\"] = \"selectAll\";\n    /**\n     * Toggles strikethrough on/off for the selection or at the insertion point.\n     */\n    DocumentCommand[\"StrikeThrough\"] = \"strikeThrough\";\n    /**\n     * Toggles subscript on/off for the selection or at the insertion point.\n     */\n    DocumentCommand[\"Subscript\"] = \"subscript\";\n    /**\n     * Toggles superscript on/off for the selection or at the insertion point.\n     */\n    DocumentCommand[\"Superscript\"] = \"superscript\";\n    /**\n     * Toggles underline on/off for the selection or at the insertion point.\n     */\n    DocumentCommand[\"Underline\"] = \"underline\";\n    /**\n     * Undoes the last executed command.\n     */\n    DocumentCommand[\"Undo\"] = \"undo\";\n    /**\n     * Removes the anchor element from a selected hyperlink.\n     */\n    DocumentCommand[\"Unlink\"] = \"unlink\";\n    /**\n     * Replaces the useCSS command. true modifies/generates style attributes in markup, false generates presentational elements.\n     */\n    DocumentCommand[\"StyleWithCSS\"] = \"styleWithCSS\";\n})(DocumentCommand || (DocumentCommand = {}));\n//# sourceMappingURL=DocumentCommand.js.map","/**\n * The is essentially an enum representing result from browser compareDocumentPosition API\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n */\nexport var DocumentPosition;\n(function (DocumentPosition) {\n    /**\n     * Same node\n     */\n    DocumentPosition[DocumentPosition[\"Same\"] = 0] = \"Same\";\n    /**\n     * Node is disconnected from document\n     */\n    DocumentPosition[DocumentPosition[\"Disconnected\"] = 1] = \"Disconnected\";\n    /**\n     * Node is preceding the comparing node\n     */\n    DocumentPosition[DocumentPosition[\"Preceding\"] = 2] = \"Preceding\";\n    /**\n     * Node is following the comparing node\n     */\n    DocumentPosition[DocumentPosition[\"Following\"] = 4] = \"Following\";\n    /**\n     * Node contains the comparing node\n     */\n    DocumentPosition[DocumentPosition[\"Contains\"] = 8] = \"Contains\";\n    /**\n     * Node is contained by the comparing node\n     */\n    DocumentPosition[DocumentPosition[\"ContainedBy\"] = 16] = \"ContainedBy\";\n})(DocumentPosition || (DocumentPosition = {}));\n//# sourceMappingURL=DocumentPosition.js.map","/**\n * Key numbers common used keys\n */\nexport var Keys;\n(function (Keys) {\n    Keys[Keys[\"NULL\"] = 0] = \"NULL\";\n    Keys[Keys[\"BACKSPACE\"] = 8] = \"BACKSPACE\";\n    Keys[Keys[\"TAB\"] = 9] = \"TAB\";\n    Keys[Keys[\"ENTER\"] = 13] = \"ENTER\";\n    Keys[Keys[\"SHIFT\"] = 16] = \"SHIFT\";\n    Keys[Keys[\"CTRL_LEFT\"] = 17] = \"CTRL_LEFT\";\n    Keys[Keys[\"ALT\"] = 18] = \"ALT\";\n    Keys[Keys[\"ESCAPE\"] = 27] = \"ESCAPE\";\n    Keys[Keys[\"SPACE\"] = 32] = \"SPACE\";\n    Keys[Keys[\"PAGEUP\"] = 33] = \"PAGEUP\";\n    Keys[Keys[\"END\"] = 35] = \"END\";\n    Keys[Keys[\"HOME\"] = 36] = \"HOME\";\n    Keys[Keys[\"LEFT\"] = 37] = \"LEFT\";\n    Keys[Keys[\"UP\"] = 38] = \"UP\";\n    Keys[Keys[\"RIGHT\"] = 39] = \"RIGHT\";\n    Keys[Keys[\"DOWN\"] = 40] = \"DOWN\";\n    Keys[Keys[\"PRINT_SCREEN\"] = 44] = \"PRINT_SCREEN\";\n    Keys[Keys[\"DELETE\"] = 46] = \"DELETE\";\n    /**\n     * @deprecated Just for backward compatibility\n     */\n    Keys[Keys[\"EIGHT_ASTIRISK\"] = 56] = \"EIGHT_ASTIRISK\";\n    Keys[Keys[\"EIGHT_ASTERISK\"] = 56] = \"EIGHT_ASTERISK\";\n    Keys[Keys[\"B\"] = 66] = \"B\";\n    Keys[Keys[\"I\"] = 73] = \"I\";\n    Keys[Keys[\"U\"] = 85] = \"U\";\n    Keys[Keys[\"Y\"] = 89] = \"Y\";\n    Keys[Keys[\"Z\"] = 90] = \"Z\";\n    Keys[Keys[\"META_LEFT\"] = 91] = \"META_LEFT\";\n    Keys[Keys[\"COMMA\"] = 188] = \"COMMA\";\n    Keys[Keys[\"DASH_UNDERSCORE\"] = 189] = \"DASH_UNDERSCORE\";\n    Keys[Keys[\"PERIOD\"] = 190] = \"PERIOD\";\n    /**\n     * @deprecated Just for backward compatibility\n     */\n    Keys[Keys[\"FORWARDSLASH\"] = 191] = \"FORWARDSLASH\";\n    Keys[Keys[\"FORWARD_SLASH\"] = 191] = \"FORWARD_SLASH\";\n    Keys[Keys[\"GRAVE_TILDE\"] = 192] = \"GRAVE_TILDE\";\n    /**\n     * Keys below are non-standard, and should be used in ContentEditFeatures only\n     */\n    Keys[Keys[\"CONTENTCHANGED\"] = 257] = \"CONTENTCHANGED\";\n    Keys[Keys[\"RANGE\"] = 258] = \"RANGE\";\n    Keys[Keys[\"Ctrl\"] = 4096] = \"Ctrl\";\n    Keys[Keys[\"Meta\"] = 8192] = \"Meta\";\n    Keys[Keys[\"Shift\"] = 16384] = \"Shift\";\n})(Keys || (Keys = {}));\n//# sourceMappingURL=Keys.js.map","/**\n * The is essentially an enum represents the type of the node\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n * Values not listed here are deprecated.\n */\nexport var NodeType;\n(function (NodeType) {\n    /**\n     * An Element node such as &lt;p&gt; or &lt;div&gt;.\n     */\n    NodeType[NodeType[\"Element\"] = 1] = \"Element\";\n    /**\n     * An Attribute node such as name=\"value\".\n     */\n    NodeType[NodeType[\"Attribute\"] = 2] = \"Attribute\";\n    /**\n     * The actual Text of Element or Attr.\n     */\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    /**\n     * A ProcessingInstruction of an XML document such as &lt;?xml-stylesheet ... ?&gt; declaration.\n     */\n    NodeType[NodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    /**\n     * A Comment node.\n     */\n    NodeType[NodeType[\"Comment\"] = 8] = \"Comment\";\n    /**\n     * A Document node.\n     */\n    NodeType[NodeType[\"Document\"] = 9] = \"Document\";\n    /**\n     * A DocumentType node e.g. &lt;!DOCTYPE html&gt; for HTML5 documents.\n     */\n    NodeType[NodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    /**\n     * A DocumentFragment node.\n     */\n    NodeType[NodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n})(NodeType || (NodeType = {}));\n//# sourceMappingURL=NodeType.js.map","/**\n * Prefix of content types\n */\nexport var ContentTypePrefix;\n(function (ContentTypePrefix) {\n    /**\n     * Text type prefix\n     */\n    ContentTypePrefix[\"Text\"] = \"text/\";\n    /**\n     * Image type prefix\n     */\n    ContentTypePrefix[\"Image\"] = \"image/\";\n})(ContentTypePrefix || (ContentTypePrefix = {}));\n/**\n * Known content types\n */\nexport var ContentType;\n(function (ContentType) {\n    /**\n     * Plain text content type\n     */\n    ContentType[\"PlainText\"] = \"text/plain\";\n    /**\n     * HTML content type\n     */\n    ContentType[\"HTML\"] = \"text/html\";\n})(ContentType || (ContentType = {}));\n//# sourceMappingURL=ContentType.js.map","/**\n * enum for setting block alignment, used by setAlignment API\n */\nexport var Alignment;\n(function (Alignment) {\n    /**\n     * Align left\n     */\n    Alignment[Alignment[\"Left\"] = 0] = \"Left\";\n    /**\n     * Align center\n     */\n    Alignment[Alignment[\"Center\"] = 1] = \"Center\";\n    /**\n     * Align right\n     */\n    Alignment[Alignment[\"Right\"] = 2] = \"Right\";\n})(Alignment || (Alignment = {}));\n//# sourceMappingURL=Alignment.js.map","/**\n * Possible change sources. Here are the predefined sources.\n * It can also be other string if the change source can't fall into these sources.\n */\nexport var ChangeSource;\n(function (ChangeSource) {\n    /**\n     * Content changed by auto link\n     */\n    ChangeSource[\"AutoLink\"] = \"AutoLink\";\n    /**\n     * Content changed by create link\n     */\n    ChangeSource[\"CreateLink\"] = \"CreateLink\";\n    /**\n     * Content changed by format\n     */\n    ChangeSource[\"Format\"] = \"Format\";\n    /**\n     * Content changed by image resize\n     */\n    ChangeSource[\"ImageResize\"] = \"ImageResize\";\n    /**\n     * Content changed by paste\n     */\n    ChangeSource[\"Paste\"] = \"Paste\";\n    /**\n     * Content changed by setContent API\n     */\n    ChangeSource[\"SetContent\"] = \"SetContent\";\n    /**\n     * Content changed by cut operation\n     */\n    ChangeSource[\"Cut\"] = \"Cut\";\n    /**\n     * Content changed by drag & drop operation\n     */\n    ChangeSource[\"Drop\"] = \"Drop\";\n    /**\n     * Insert a new entity into editor\n     */\n    ChangeSource[\"InsertEntity\"] = \"InsertEntity\";\n    /**\n     * Editor is switched to dark mode, content color is changed\n     */\n    ChangeSource[\"SwitchToDarkMode\"] = \"SwitchToDarkMode\";\n    /**\n     * Editor is switched to light mode, content color is changed\n     */\n    ChangeSource[\"SwitchToLightMode\"] = \"SwitchToLightMode\";\n    /**\n     * List chain reorganized numbers of lists\n     */\n    ChangeSource[\"ListChain\"] = \"ListChain\";\n    /**\n     * Keyboard event, used by Content Model.\n     * Data of this event will be the key code number\n     */\n    ChangeSource[\"Keyboard\"] = \"Keyboard\";\n})(ChangeSource || (ChangeSource = {}));\n//# sourceMappingURL=ChangeSource.js.map","/**\n * Represents the mode of color transformation\n */\nexport var ColorTransformDirection;\n(function (ColorTransformDirection) {\n    /**\n     * Transform from light to dark\n     */\n    ColorTransformDirection[ColorTransformDirection[\"LightToDark\"] = 0] = \"LightToDark\";\n    /**\n     * Transform from dark to light\n     */\n    ColorTransformDirection[ColorTransformDirection[\"DarkToLight\"] = 1] = \"DarkToLight\";\n})(ColorTransformDirection || (ColorTransformDirection = {}));\n//# sourceMappingURL=ColorTransformDirection.js.map","/**\n * The position. Mostly used for content insertion and traversing\n * On insertion, we will need to specify where we want the content to be placed (begin, end, selection or outside)\n * On content traversing, we will need to specify the start position of traversing\n */\nexport var ContentPosition;\n(function (ContentPosition) {\n    /**\n     * Begin of the container\n     */\n    ContentPosition[ContentPosition[\"Begin\"] = 0] = \"Begin\";\n    /**\n     * End of the container\n     */\n    ContentPosition[ContentPosition[\"End\"] = 1] = \"End\";\n    /**\n     * End of the content div domain.\n     */\n    ContentPosition[ContentPosition[\"DomEnd\"] = 2] = \"DomEnd\";\n    /**\n     * Selection start\n     */\n    ContentPosition[ContentPosition[\"SelectionStart\"] = 3] = \"SelectionStart\";\n    /**\n     * Outside of editor\n     */\n    ContentPosition[ContentPosition[\"Outside\"] = 4] = \"Outside\";\n    /**\n     * Manually defined range\n     */\n    ContentPosition[ContentPosition[\"Range\"] = 5] = \"Range\";\n})(ContentPosition || (ContentPosition = {}));\n//# sourceMappingURL=ContentPosition.js.map","/**\n * @deprecated\n * Constants string for dataset names used by dark mode\n */\nexport var DarkModeDatasetNames;\n(function (DarkModeDatasetNames) {\n    /**\n     * Original style text color\n     */\n    DarkModeDatasetNames[\"OriginalStyleColor\"] = \"ogsc\";\n    /**\n     * Original style background color\n     */\n    DarkModeDatasetNames[\"OriginalStyleBackgroundColor\"] = \"ogsb\";\n    /**\n     * Original attribute text color\n     */\n    DarkModeDatasetNames[\"OriginalAttributeColor\"] = \"ogac\";\n    /**\n     * Original attribute background color\n     */\n    DarkModeDatasetNames[\"OriginalAttributeBackgroundColor\"] = \"ogab\";\n})(DarkModeDatasetNames || (DarkModeDatasetNames = {}));\n//# sourceMappingURL=DarkModeDatasetNames.js.map","/**\n * Class names for Delimiter\n */\nexport var DelimiterClasses;\n(function (DelimiterClasses) {\n    /**\n     * Class name to specify this delimiter is before an entity\n     */\n    DelimiterClasses[\"DELIMITER_BEFORE\"] = \"entityDelimiterBefore\";\n    /**\n     *  Class name to specify this delimiter is after an entity\n     */\n    DelimiterClasses[\"DELIMITER_AFTER\"] = \"entityDelimiterAfter\";\n})(DelimiterClasses || (DelimiterClasses = {}));\n//# sourceMappingURL=DelimiterClasses.js.map","/**\n * enum for setting block direction, used by setDirection API\n */\nexport var Direction;\n(function (Direction) {\n    /**\n     * Left to right\n     */\n    Direction[Direction[\"LeftToRight\"] = 0] = \"LeftToRight\";\n    /**\n     * Right to left\n     */\n    Direction[Direction[\"RightToLeft\"] = 1] = \"RightToLeft\";\n})(Direction || (Direction = {}));\n//# sourceMappingURL=Direction.js.map","/**\n * CSS Class names for Entity\n */\nexport var EntityClasses;\n(function (EntityClasses) {\n    /**\n     * Class name to specify this is an entity\n     */\n    EntityClasses[\"ENTITY_INFO_NAME\"] = \"_Entity\";\n    /**\n     * Class name to specify the type of an entity\n     */\n    EntityClasses[\"ENTITY_TYPE_PREFIX\"] = \"_EType_\";\n    /**\n     * Class name to specify the ID of an entity\n     */\n    EntityClasses[\"ENTITY_ID_PREFIX\"] = \"_EId_\";\n    /**\n     * Class name to specify if the entity is readonly\n     */\n    EntityClasses[\"ENTITY_READONLY_PREFIX\"] = \"_EReadonly_\";\n})(EntityClasses || (EntityClasses = {}));\n//# sourceMappingURL=EntityClasses.js.map","/**\n * Define possible operations to an entity\n */\nexport var EntityOperation;\n(function (EntityOperation) {\n    /**\n     * Notify plugins that there is a new plugin was added into editor.\n     * Plugin can handle this event to entity hydration.\n     * This event will be only fired once for each entity DOM node.\n     * After undo, or copy/paste, since new DOM nodes were added, this event will be fired\n     * for those entities represented by newly added nodes.\n     */\n    EntityOperation[EntityOperation[\"NewEntity\"] = 0] = \"NewEntity\";\n    /**\n     * Notify plugins that user is clicking target to an entity\n     */\n    EntityOperation[EntityOperation[\"Click\"] = 1] = \"Click\";\n    /**\n     * Notify plugins that user is triggering context menu to an entity\n     */\n    EntityOperation[EntityOperation[\"ContextMenu\"] = 2] = \"ContextMenu\";\n    /**\n     * Notify plugins that user is escaping from an entity by pressing ESC key\n     */\n    EntityOperation[EntityOperation[\"Escape\"] = 3] = \"Escape\";\n    /**\n     * Notify plugins that user is removing an entity from its start position using DELETE key\n     */\n    EntityOperation[EntityOperation[\"RemoveFromStart\"] = 4] = \"RemoveFromStart\";\n    /**\n     * Notify plugins that user is remove an entity from its end position using BACKSPACE key\n     */\n    EntityOperation[EntityOperation[\"RemoveFromEnd\"] = 5] = \"RemoveFromEnd\";\n    /**\n     * Notify plugins that an entity is being overwritten.\n     * This can be caused by key in, cut, paste, delete, backspace ... on a selection\n     * which contains some entities.\n     */\n    EntityOperation[EntityOperation[\"Overwrite\"] = 6] = \"Overwrite\";\n    /**\n     * Notify plugins that an entity is being partially overwritten.\n     * This happens when user selected part of the entity then do key press, or cut, paste, delete, backspace, ...\n     */\n    EntityOperation[EntityOperation[\"PartialOverwrite\"] = 7] = \"PartialOverwrite\";\n    /**\n     * Notify plugins that editor is generating HTML content for save.\n     * Plugin should use this event to remove any temporary content, and only leave DOM nodes that\n     * should be saved as HTML string.\n     * This event will provide a cloned DOM tree for each entity, do NOT compare the DOM nodes with cached nodes\n     * because it will always return false.\n     */\n    EntityOperation[EntityOperation[\"ReplaceTemporaryContent\"] = 8] = \"ReplaceTemporaryContent\";\n    /**\n     * @deprecated\n     */\n    EntityOperation[EntityOperation[\"AddShadowRoot\"] = 9] = \"AddShadowRoot\";\n    /**\n     * @deprecated\n     */\n    EntityOperation[EntityOperation[\"RemoveShadowRoot\"] = 10] = \"RemoveShadowRoot\";\n    /**\n     * Notify plugins that a new entity state need to be updated to an entity.\n     * This is normally happened when user undo/redo the content with an entity snapshot added by a plugin that handles entity\n     */\n    EntityOperation[EntityOperation[\"UpdateEntityState\"] = 11] = \"UpdateEntityState\";\n})(EntityOperation || (EntityOperation = {}));\n//# sourceMappingURL=EntityOperation.js.map","/**\n * Experimental feature flags\n */\nexport var ExperimentalFeatures;\n(function (ExperimentalFeatures) {\n    // #region Graduated and deprecated features.\n    // These features will be removed in next major release\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"NewIndentation\"] = \"NewIndentation\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"NewBullet\"] = \"NewBullet\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"NewNumbering\"] = \"NewNumbering\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"ListChain\"] = \"ListChain\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"MergePastedLine\"] = \"MergePastedLine\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"SingleDirectionResize\"] = \"SingleDirectionResize\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"PasteWithLinkPreview\"] = \"PasteWithLinkPreview\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"ImageRotate\"] = \"ImageRotate\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    ExperimentalFeatures[\"ImageCrop\"] = \"ImageCrop\";\n    /**\n     * @deprecated This feature is always enabled\n     * Check if the element has a style attribute, if not, apply the default format\n     */\n    ExperimentalFeatures[\"AlwaysApplyDefaultFormat\"] = \"AlwaysApplyDefaultFormat\";\n    /**\n     * @deprecated This feature can be enabled/disabled using Paste Plugin contructor param\n     * Paste the Html instead of the Img when the Html Body only have one IMG Child node\n     */\n    ExperimentalFeatures[\"ConvertSingleImageBody\"] = \"ConvertSingleImageBody\";\n    /**\n     * @deprecated This feature is always enabled\n     * Align table elements to left, center and right using setAlignment API\n     */\n    ExperimentalFeatures[\"TableAlignment\"] = \"TableAlignment\";\n    /**\n     * @deprecated this feature is always enabled\n     * Provide a circular resize handles that adaptive the number od handles to the size of the image\n     */\n    ExperimentalFeatures[\"AdaptiveHandlesResizer\"] = \"AdaptiveHandlesResizer\";\n    /**\n     * @deprecated this feature is always disabled\n     * Automatically transform -- into hyphen, if typed between two words.\n     */\n    ExperimentalFeatures[\"AutoHyphen\"] = \"AutoHyphen\";\n    /**\n     * @deprecated this feature is always disabled\n     * Use pending format strategy to do style based format, e.g. Font size, Color.\n     * With this feature enabled, we don't need to insert temp ZeroWidthSpace character to hold pending format\n     * when selection is collapsed. Instead, we will hold the pending format in memory and only apply it when type something\n     */\n    ExperimentalFeatures[\"PendingStyleBasedFormat\"] = \"PendingStyleBasedFormat\";\n    /**\n     * @deprecated this feature is always disabled\n     * Normalize list to make sure it can be displayed correctly in other client\n     * e.g. We will move list items with \"display: block\" into previous list item and change tag to be DIV\n     */\n    ExperimentalFeatures[\"NormalizeList\"] = \"NormalizeList\";\n    /**\n     * @deprecated this feature is always enabled\n     * When a html image is selected, the selected image data will be stored by editor core.\n     */\n    ExperimentalFeatures[\"ImageSelection\"] = \"ImageSelection\";\n    /**\n     * @deprecated this feature is always enabled\n     * Use variable-based dark mode solution rather than dataset-based solution.\n     * When enable this feature, need to pass in a DarkModelHandler object to each call of setColor and applyFormat\n     * if you need them work for dark mode\n     */\n    ExperimentalFeatures[\"VariableBasedDarkColor\"] = \"VariableBasedDarkColor\";\n    /**\n     * @deprecated this feature is always enabled\n     * Align list elements elements to left, center and right using setAlignment API\n     */\n    ExperimentalFeatures[\"ListItemAlignment\"] = \"ListItemAlignment\";\n    /**\n     * @deprecated\n     */\n    ExperimentalFeatures[\"DefaultFormatInSpan\"] = \"DefaultFormatInSpan\";\n    /**\n     * @deprecated\n     */\n    ExperimentalFeatures[\"DefaultFormatOnContainer\"] = \"DefaultFormatOnContainer\";\n    /**\n     * @deprecated This feature is always enabled\n     * Reuse existing DOM structure if possible when convert Content Model back to DOM tree\n     */\n    ExperimentalFeatures[\"ReusableContentModel\"] = \"ReusableContentModel\";\n    /**\n     * @deprecated This feature is always enabled\n     * Handle keyboard editing event with Content Model\n     */\n    ExperimentalFeatures[\"EditWithContentModel\"] = \"EditWithContentModel\";\n    /**\n     * @deprecated This feature is always enabled\n     * Trigger formatting by a especial characters. Ex: (A), 1. i).\n     */\n    ExperimentalFeatures[\"AutoFormatList\"] = \"AutoFormatList\";\n    /**\n     * @deprecated This feature is always enabled\n     * Add entities around a Read Only  Inline entity to prevent cursor to be hidden when cursor is next of it.\n     */\n    ExperimentalFeatures[\"InlineEntityReadOnlyDelimiters\"] = \"InlineEntityReadOnlyDelimiters\";\n    /**\n     * @deprecated This feature is always enabled\n     * Paste with Content model\n     */\n    ExperimentalFeatures[\"ContentModelPaste\"] = \"ContentModelPaste\";\n    //#endregion\n    /**\n     * Provide additional Tab Key Features. Requires Text Features Content Editable Features\n     */\n    ExperimentalFeatures[\"TabKeyTextFeatures\"] = \"TabKeyTextFeatures\";\n    /**\n     * With this feature enabled, when writing back a list item we will re-use all\n     * ancestor list elements, even if they don't match the types currently in the\n     * listTypes array for that item. The only list that we will ensure is correct\n     * is the one closest to the item.\n     */\n    ExperimentalFeatures[\"ReuseAllAncestorListElements\"] = \"ReuseAllAncestorListElements\";\n    /**\n     * Delete table with Backspace key with the whole was selected with table selector\n     */\n    ExperimentalFeatures[\"DeleteTableWithBackspace\"] = \"DeleteTableWithBackspace\";\n    /**\n     * Disable list chain functionality\n     */\n    ExperimentalFeatures[\"DisableListChain\"] = \"DisableListChain\";\n})(ExperimentalFeatures || (ExperimentalFeatures = {}));\n//# sourceMappingURL=ExperimentalFeatures.js.map","/**\n * The enum used for increase or decrease font size\n * Used by setFontSize API\n */\nexport var FontSizeChange;\n(function (FontSizeChange) {\n    /**\n     * Increase font size\n     */\n    FontSizeChange[FontSizeChange[\"Increase\"] = 0] = \"Increase\";\n    /**\n     * Decrease font size\n     */\n    FontSizeChange[FontSizeChange[\"Decrease\"] = 1] = \"Decrease\";\n})(FontSizeChange || (FontSizeChange = {}));\n//# sourceMappingURL=FontSizeChange.js.map","/**\n * Represents a mode number to indicate what kind of content to retrieve when call Editor.getContent()\n */\nexport var GetContentMode;\n(function (GetContentMode) {\n    /**\n     * The clean content without any temporary content only for editor.\n     * This is the default value. Call to Editor.getContent() with trigger an ExtractContentWithDom event\n     * so that plugins can remove their temporary content, and will return the HTML content\n     * which is ready for save to storage.\n     */\n    GetContentMode[GetContentMode[\"CleanHTML\"] = 0] = \"CleanHTML\";\n    /**\n     * Retrieve the raw HTML string in current editor. Temporary content will be included.\n     */\n    GetContentMode[GetContentMode[\"RawHTMLOnly\"] = 1] = \"RawHTMLOnly\";\n    /**\n     * Retrieve the raw HTML string in current editor with a selection marker. This can be used for\n     * save current editor state and call to SetContent with this result can fully restore editor state\n     * including current selection\n     */\n    GetContentMode[GetContentMode[\"RawHTMLWithSelection\"] = 2] = \"RawHTMLWithSelection\";\n    /**\n     * Get plain text content only, all format will be ignored\n     */\n    GetContentMode[GetContentMode[\"PlainText\"] = 3] = \"PlainText\";\n    /**\n     * A fast way to get plain text content, the line-end positions may not be exactly same with HTML content,\n     * but the text content should be the same. This is used for quickly retrieve text content and check\n     * text only\n     */\n    GetContentMode[GetContentMode[\"PlainTextFast\"] = 4] = \"PlainTextFast\";\n})(GetContentMode || (GetContentMode = {}));\n//# sourceMappingURL=GetContentMode.js.map","/**\n * The enum used for increase or decrease indentation of a block\n * Used by setIndentation API\n */\nexport var Indentation;\n(function (Indentation) {\n    /**\n     * Increase indentation\n     */\n    Indentation[Indentation[\"Increase\"] = 0] = \"Increase\";\n    /**\n     * Decrease indentation\n     */\n    Indentation[Indentation[\"Decrease\"] = 1] = \"Decrease\";\n})(Indentation || (Indentation = {}));\n//# sourceMappingURL=Indentation.js.map","/**\n * The enum used for controlling the capitalization of text.\n * Used by changeCapitalization API\n */\nexport var Capitalization;\n(function (Capitalization) {\n    /**\n     * Transforms the first character after punctuation mark followed by space\n     * to uppercase and the rest of characters to lowercase.\n     */\n    Capitalization[\"Sentence\"] = \"sentence\";\n    /**\n     * Transforms all characters to lowercase\n     */\n    Capitalization[\"Lowercase\"] = \"lowercase\";\n    /**\n     * Transforms all characters to uppercase\n     */\n    Capitalization[\"Uppercase\"] = \"uppercase\";\n    /**\n     * Transforms the first character of each word to uppercase\n     */\n    Capitalization[\"CapitalizeEachWord\"] = \"capitalize\";\n})(Capitalization || (Capitalization = {}));\n//# sourceMappingURL=Capitalization.js.map","/**\n * Type of list (numbering or bullet)\n */\nexport var ListType;\n(function (ListType) {\n    /**\n     * None list type\n     * It means this is not a list\n     */\n    ListType[ListType[\"None\"] = 0] = \"None\";\n    /**\n     * Ordered List type (numbering list)\n     * Represented by \"OL\" tag\n     */\n    ListType[ListType[\"Ordered\"] = 1] = \"Ordered\";\n    /**\n     * Unordered List type (bullet list)\n     * Represented by \"UL\" tag\n     */\n    ListType[ListType[\"Unordered\"] = 2] = \"Unordered\";\n})(ListType || (ListType = {}));\n//# sourceMappingURL=ListType.js.map","/**\n * Represent the type of a position\n */\nexport var PositionType;\n(function (PositionType) {\n    /**\n     * At the beginning of a node\n     */\n    PositionType[PositionType[\"Begin\"] = 0] = \"Begin\";\n    /**\n     * At the end of a node\n     */\n    PositionType[PositionType[\"End\"] = -1] = \"End\";\n    /**\n     * Before a node\n     */\n    PositionType[PositionType[\"Before\"] = -2] = \"Before\";\n    /**\n     * After a node\n     */\n    PositionType[PositionType[\"After\"] = -3] = \"After\";\n})(PositionType || (PositionType = {}));\n//# sourceMappingURL=PositionType.js.map","/**\n * Query scope for queryElements() API\n */\nexport var QueryScope;\n(function (QueryScope) {\n    /**\n     * Query from the whole body of root node. This is default value.\n     */\n    QueryScope[QueryScope[\"Body\"] = 0] = \"Body\";\n    /**\n     * Query elements on a given selection (intersect)\n     * The result element can contain the selection, contain part of selection, or inside selection\n     */\n    QueryScope[QueryScope[\"OnSelection\"] = 1] = \"OnSelection\";\n    /**\n     * Query elements inside a given selection only\n     */\n    QueryScope[QueryScope[\"InSelection\"] = 2] = \"InSelection\";\n})(QueryScope || (QueryScope = {}));\n//# sourceMappingURL=QueryScope.js.map","/**\n * Type of all possible regions. Currently we only support region of Table\n */\nexport var RegionType;\n(function (RegionType) {\n    /**\n     * Region split by Table\n     */\n    RegionType[RegionType[\"Table\"] = 0] = \"Table\";\n})(RegionType || (RegionType = {}));\n//# sourceMappingURL=RegionType.js.map","/**\n * Operations used by editTable() API\n */\nexport var TableOperation;\n(function (TableOperation) {\n    /**\n     * Insert a row above current row\n     */\n    TableOperation[TableOperation[\"InsertAbove\"] = 0] = \"InsertAbove\";\n    /**\n     * Insert a row below current row\n     */\n    TableOperation[TableOperation[\"InsertBelow\"] = 1] = \"InsertBelow\";\n    /**\n     * Insert a column on the left of current column\n     */\n    TableOperation[TableOperation[\"InsertLeft\"] = 2] = \"InsertLeft\";\n    /**\n     * Insert a column on the right of current column\n     */\n    TableOperation[TableOperation[\"InsertRight\"] = 3] = \"InsertRight\";\n    /**\n     * Delete the whole table\n     */\n    TableOperation[TableOperation[\"DeleteTable\"] = 4] = \"DeleteTable\";\n    /**\n     * Delete current column\n     */\n    TableOperation[TableOperation[\"DeleteColumn\"] = 5] = \"DeleteColumn\";\n    /**\n     * Delete current row\n     */\n    TableOperation[TableOperation[\"DeleteRow\"] = 6] = \"DeleteRow\";\n    /**\n     * Merge current row with the row above\n     */\n    TableOperation[TableOperation[\"MergeAbove\"] = 7] = \"MergeAbove\";\n    /**\n     * Merge current row with the row below\n     */\n    TableOperation[TableOperation[\"MergeBelow\"] = 8] = \"MergeBelow\";\n    /**\n     * Merge current column with the column on the left\n     */\n    TableOperation[TableOperation[\"MergeLeft\"] = 9] = \"MergeLeft\";\n    /**\n     * Merge current column with the column on the right\n     */\n    TableOperation[TableOperation[\"MergeRight\"] = 10] = \"MergeRight\";\n    /**\n     * Merge all selected cells\n     */\n    TableOperation[TableOperation[\"MergeCells\"] = 11] = \"MergeCells\";\n    /**\n     * Split current table cell horizontally\n     */\n    TableOperation[TableOperation[\"SplitHorizontally\"] = 12] = \"SplitHorizontally\";\n    /**\n     * Split current table cell vertically\n     */\n    TableOperation[TableOperation[\"SplitVertically\"] = 13] = \"SplitVertically\";\n    /**\n     * Align current table at the center\n     */\n    TableOperation[TableOperation[\"AlignCenter\"] = 14] = \"AlignCenter\";\n    /**\n     * Align current table at the left\n     */\n    TableOperation[TableOperation[\"AlignLeft\"] = 15] = \"AlignLeft\";\n    /**\n     * Align current table at the right\n     */\n    TableOperation[TableOperation[\"AlignRight\"] = 16] = \"AlignRight\";\n    /**\n     * Align current content table cell at the left\n     */\n    TableOperation[TableOperation[\"AlignCellLeft\"] = 17] = \"AlignCellLeft\";\n    /**\n     * Align current content table cell at the center\n     */\n    TableOperation[TableOperation[\"AlignCellCenter\"] = 18] = \"AlignCellCenter\";\n    /**\n     * Align current content table cell at the right\n     */\n    TableOperation[TableOperation[\"AlignCellRight\"] = 19] = \"AlignCellRight\";\n    /**\n     * Align current content table cell at the top\n     */\n    TableOperation[TableOperation[\"AlignCellTop\"] = 20] = \"AlignCellTop\";\n    /**\n     * Align current table cell at the middle\n     */\n    TableOperation[TableOperation[\"AlignCellMiddle\"] = 21] = \"AlignCellMiddle\";\n    /**\n     * Align current table cell at the bottom\n     */\n    TableOperation[TableOperation[\"AlignCellBottom\"] = 22] = \"AlignCellBottom\";\n})(TableOperation || (TableOperation = {}));\n//# sourceMappingURL=TableOperation.js.map","/**\n * Operation flags for ImageEdit plugin\n */\nexport var ImageEditOperation;\n(function (ImageEditOperation) {\n    /**\n     * No operation\n     */\n    ImageEditOperation[ImageEditOperation[\"None\"] = 0] = \"None\";\n    /**\n     * Resize image from corner ( horizontal and vertical resize)\n     */\n    ImageEditOperation[ImageEditOperation[\"CornerResize\"] = 1] = \"CornerResize\";\n    /**\n     * Resize image from side ( either horizontal or vertical resize)\n     */\n    ImageEditOperation[ImageEditOperation[\"SideResize\"] = 2] = \"SideResize\";\n    /**\n     * Image resize\n     */\n    ImageEditOperation[ImageEditOperation[\"Resize\"] = 3] = \"Resize\";\n    /**\n     * Image rotate\n     */\n    ImageEditOperation[ImageEditOperation[\"Rotate\"] = 4] = \"Rotate\";\n    /**\n     * Image resize and rotate\n     */\n    ImageEditOperation[ImageEditOperation[\"ResizeAndRotate\"] = 7] = \"ResizeAndRotate\";\n    /**\n     * Image crop\n     */\n    ImageEditOperation[ImageEditOperation[\"Crop\"] = 8] = \"Crop\";\n    /**\n     * All operations\n     */\n    ImageEditOperation[ImageEditOperation[\"All\"] = 15] = \"All\";\n})(ImageEditOperation || (ImageEditOperation = {}));\n//# sourceMappingURL=ImageEditOperation.js.map","/**\n * Represents the strategy to clear the format of the current editor selection\n */\nexport var ClearFormatMode;\n(function (ClearFormatMode) {\n    /**\n     * Inline format. Remove text format.\n     */\n    ClearFormatMode[ClearFormatMode[\"Inline\"] = 0] = \"Inline\";\n    /**\n     * BLock format. Remove text and structure format of the block.\n     */\n    ClearFormatMode[ClearFormatMode[\"Block\"] = 1] = \"Block\";\n    /**\n     * Detect Inline or Block format based on the current editor selector.\n     */\n    ClearFormatMode[ClearFormatMode[\"AutoDetect\"] = 2] = \"AutoDetect\";\n})(ClearFormatMode || (ClearFormatMode = {}));\n//# sourceMappingURL=ClearFormatMode.js.map","/**\n * Index of known CreateElementData used by createElement function\n */\nexport var KnownCreateElementDataIndex;\n(function (KnownCreateElementDataIndex) {\n    /**\n     * Set a none value to help createElement function ignore falsy value\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"None\"] = 0] = \"None\";\n    /**\n     * An empty line without format\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"EmptyLine\"] = 1] = \"EmptyLine\";\n    /**\n     * Wrapper for blockquote\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"BlockquoteWrapper\"] = 2] = \"BlockquoteWrapper\";\n    /**\n     * Temp DIV for copy/paste\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"CopyPasteTempDiv\"] = 3] = \"CopyPasteTempDiv\";\n    /**\n     * ListItem with block style\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"BlockListItem\"] = 4] = \"BlockListItem\";\n    /**\n     * Wrapper element for context menu\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"ContextMenuWrapper\"] = 5] = \"ContextMenuWrapper\";\n    /**\n     * Wrapper element for image edit\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"ImageEditWrapper\"] = 6] = \"ImageEditWrapper\";\n    /**\n     * @deprecated\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"TableHorizontalResizer\"] = 7] = \"TableHorizontalResizer\";\n    /**\n     * @deprecated\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"TableVerticalResizer\"] = 8] = \"TableVerticalResizer\";\n    /**\n     * @deprecated\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"TableResizerLTR\"] = 9] = \"TableResizerLTR\";\n    /**\n     * @deprecated\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"TableResizerRTL\"] = 10] = \"TableResizerRTL\";\n    /**\n     * @deprecated\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"TableSelector\"] = 11] = \"TableSelector\";\n    /**\n     * @deprecated\n     */\n    KnownCreateElementDataIndex[KnownCreateElementDataIndex[\"EmptyLineFormatInSpan\"] = 12] = \"EmptyLineFormatInSpan\";\n})(KnownCreateElementDataIndex || (KnownCreateElementDataIndex = {}));\n//# sourceMappingURL=KnownCreateElementDataIndex.js.map","/**\n * Represent the types of sources to handle in the Paste Plugin\n */\nexport var KnownPasteSourceType;\n(function (KnownPasteSourceType) {\n    KnownPasteSourceType[KnownPasteSourceType[\"WordDesktop\"] = 0] = \"WordDesktop\";\n    KnownPasteSourceType[KnownPasteSourceType[\"ExcelDesktop\"] = 1] = \"ExcelDesktop\";\n    KnownPasteSourceType[KnownPasteSourceType[\"ExcelOnline\"] = 2] = \"ExcelOnline\";\n    KnownPasteSourceType[KnownPasteSourceType[\"PowerPointDesktop\"] = 3] = \"PowerPointDesktop\";\n    KnownPasteSourceType[KnownPasteSourceType[\"GoogleSheets\"] = 4] = \"GoogleSheets\";\n    KnownPasteSourceType[KnownPasteSourceType[\"WacComponents\"] = 5] = \"WacComponents\";\n    KnownPasteSourceType[KnownPasteSourceType[\"Default\"] = 6] = \"Default\";\n    KnownPasteSourceType[KnownPasteSourceType[\"SingleImage\"] = 7] = \"SingleImage\";\n})(KnownPasteSourceType || (KnownPasteSourceType = {}));\n//# sourceMappingURL=KnownPasteSourceType.js.map","/**\n * Table format border\n */\nexport var TableBorderFormat;\n(function (TableBorderFormat) {\n    /**\n     * All border of the table are displayed\n     *  __ __ __\n     * |__|__|__|\n     * |__|__|__|\n     * |__|__|__|\n     */\n    TableBorderFormat[TableBorderFormat[\"DEFAULT\"] = 0] = \"DEFAULT\";\n    /**\n     * Middle vertical border are not displayed\n     *  __ __ __\n     * |__ __ __|\n     * |__ __ __|\n     * |__ __ __|\n     */\n    TableBorderFormat[TableBorderFormat[\"LIST_WITH_SIDE_BORDERS\"] = 1] = \"LIST_WITH_SIDE_BORDERS\";\n    /**\n     * All borders except header rows borders are displayed\n     *  __ __ __\n     *  __|__|__\n     *  __|__|__\n     */\n    TableBorderFormat[TableBorderFormat[\"NO_HEADER_BORDERS\"] = 2] = \"NO_HEADER_BORDERS\";\n    /**\n     * The left and right border of the table are not displayed\n     *  __ __ __\n     *  __|__|__\n     *  __|__|__\n     *  __|__|__\n     */\n    TableBorderFormat[TableBorderFormat[\"NO_SIDE_BORDERS\"] = 3] = \"NO_SIDE_BORDERS\";\n    /**\n     * Only the borders that divides the header row, first column and externals are displayed\n     *  __ __ __\n     * |__ __ __|\n     * |  |     |\n     * |__|__ __|\n     */\n    TableBorderFormat[TableBorderFormat[\"FIRST_COLUMN_HEADER_EXTERNAL\"] = 4] = \"FIRST_COLUMN_HEADER_EXTERNAL\";\n    /**\n     * The header row has no vertical border, except for the first one\n     * The first column has no horizontal border, except for the first one\n     *  __ __ __\n     * |__ __ __\n     * |  |__|__|\n     * |  |__|__|\n     */\n    TableBorderFormat[TableBorderFormat[\"ESPECIAL_TYPE_1\"] = 5] = \"ESPECIAL_TYPE_1\";\n    /**\n     * The header row has no vertical border, except for the first one\n     * The only horizontal border of the table is the top and bottom of header row\n     *  __ __ __\n     * |__ __ __\n     * |  |     |\n     * |  |     |\n     */\n    TableBorderFormat[TableBorderFormat[\"ESPECIAL_TYPE_2\"] = 6] = \"ESPECIAL_TYPE_2\";\n    /**\n     * The only borders are the bottom of header row and the right border of first column\n     *  __ __ __\n     *    |\n     *    |\n     */\n    TableBorderFormat[TableBorderFormat[\"ESPECIAL_TYPE_3\"] = 7] = \"ESPECIAL_TYPE_3\";\n    /**\n     * No border\n     */\n    TableBorderFormat[TableBorderFormat[\"CLEAR\"] = 8] = \"CLEAR\";\n})(TableBorderFormat || (TableBorderFormat = {}));\n//# sourceMappingURL=TableBorderFormat.js.map","/**\n * Editor plugin event type\n */\nexport var PluginEventType;\n(function (PluginEventType) {\n    /**\n     * HTML KeyDown event\n     */\n    PluginEventType[PluginEventType[\"KeyDown\"] = 0] = \"KeyDown\";\n    /**\n     * HTML KeyPress event\n     */\n    PluginEventType[PluginEventType[\"KeyPress\"] = 1] = \"KeyPress\";\n    /**\n     * HTML KeyUp event\n     */\n    PluginEventType[PluginEventType[\"KeyUp\"] = 2] = \"KeyUp\";\n    /**\n     * HTML Input / TextInput event\n     */\n    PluginEventType[PluginEventType[\"Input\"] = 3] = \"Input\";\n    /**\n     * HTML CompositionEnd event\n     */\n    PluginEventType[PluginEventType[\"CompositionEnd\"] = 4] = \"CompositionEnd\";\n    /**\n     * HTML MouseDown event\n     */\n    PluginEventType[PluginEventType[\"MouseDown\"] = 5] = \"MouseDown\";\n    /**\n     * HTML MouseUp event\n     */\n    PluginEventType[PluginEventType[\"MouseUp\"] = 6] = \"MouseUp\";\n    /**\n     * Content changed event\n     */\n    PluginEventType[PluginEventType[\"ContentChanged\"] = 7] = \"ContentChanged\";\n    /**\n     * Extract Content with a DOM tree event\n     * This event is triggered when getContent() is called with triggerExtractContentEvent = true\n     * Plugin can handle this event to remove the UI only markups to return clean HTML\n     * by operating on a cloned DOM tree\n     */\n    PluginEventType[PluginEventType[\"ExtractContentWithDom\"] = 8] = \"ExtractContentWithDom\";\n    /**\n     * Before Paste event, provide a chance to change copied content\n     */\n    PluginEventType[PluginEventType[\"BeforeCutCopy\"] = 9] = \"BeforeCutCopy\";\n    /**\n     * Before Paste event, provide a chance to change paste content\n     */\n    PluginEventType[PluginEventType[\"BeforePaste\"] = 10] = \"BeforePaste\";\n    /**\n     * Let plugin know editor is ready now\n     */\n    PluginEventType[PluginEventType[\"EditorReady\"] = 11] = \"EditorReady\";\n    /**\n     * Let plugin know editor is about to dispose\n     */\n    PluginEventType[PluginEventType[\"BeforeDispose\"] = 12] = \"BeforeDispose\";\n    /**\n     * Pending format state (bold, italic, underline, ... with collapsed selection) is changed\n     */\n    PluginEventType[PluginEventType[\"PendingFormatStateChanged\"] = 13] = \"PendingFormatStateChanged\";\n    /**\n     * Scroll event triggered by scroll container\n     */\n    PluginEventType[PluginEventType[\"Scroll\"] = 14] = \"Scroll\";\n    /**\n     * Operating on an entity. See enum EntityOperation for more details about each operation\n     */\n    PluginEventType[PluginEventType[\"EntityOperation\"] = 15] = \"EntityOperation\";\n    /**\n     * HTML ContextMenu event\n     */\n    PluginEventType[PluginEventType[\"ContextMenu\"] = 16] = \"ContextMenu\";\n    /**\n     * Editor has entered shadow edit mode\n     */\n    PluginEventType[PluginEventType[\"EnteredShadowEdit\"] = 17] = \"EnteredShadowEdit\";\n    /**\n     * Editor is about to leave shadow edit mode\n     */\n    PluginEventType[PluginEventType[\"LeavingShadowEdit\"] = 18] = \"LeavingShadowEdit\";\n    /**\n     * Content of image is being changed from client side\n     */\n    PluginEventType[PluginEventType[\"EditImage\"] = 19] = \"EditImage\";\n    /**\n     * Content of editor is about to be cleared by SetContent API, handle this event to cache anything you need\n     * before it is gone\n     */\n    PluginEventType[PluginEventType[\"BeforeSetContent\"] = 20] = \"BeforeSetContent\";\n    /**\n     * Zoom scale value is changed, triggered by Editor.setZoomScale() when set a different scale number\n     */\n    PluginEventType[PluginEventType[\"ZoomChanged\"] = 21] = \"ZoomChanged\";\n    /**\n     * EXPERIMENTAL FEATURE\n     * Editor changed the selection.\n     */\n    PluginEventType[PluginEventType[\"SelectionChanged\"] = 22] = \"SelectionChanged\";\n    /**\n     * EXPERIMENTAL FEATURE\n     * Editor content is about to be changed by keyboard event.\n     * This is only used by Content Model editing\n     */\n    PluginEventType[PluginEventType[\"BeforeKeyboardEditing\"] = 23] = \"BeforeKeyboardEditing\";\n})(PluginEventType || (PluginEventType = {}));\n//# sourceMappingURL=PluginEventType.js.map","/**\n * Types of Selection Ranges that the SelectionRangeEx can return\n */\nexport var SelectionRangeTypes;\n(function (SelectionRangeTypes) {\n    /**\n     * Normal selection range provided by browser.\n     */\n    SelectionRangeTypes[SelectionRangeTypes[\"Normal\"] = 0] = \"Normal\";\n    /**\n     * Selection made inside of a single table.\n     */\n    SelectionRangeTypes[SelectionRangeTypes[\"TableSelection\"] = 1] = \"TableSelection\";\n    /**\n     * Selection made in a image.\n     */\n    SelectionRangeTypes[SelectionRangeTypes[\"ImageSelection\"] = 2] = \"ImageSelection\";\n})(SelectionRangeTypes || (SelectionRangeTypes = {}));\n//# sourceMappingURL=SelectionRangeTypes.js.map","/**\n *  Enum used to control the different types of numbering list\n */\nexport var NumberingListType;\n(function (NumberingListType) {\n    /**\n     * Minimum value of the enum\n     */\n    NumberingListType[NumberingListType[\"Min\"] = 1] = \"Min\";\n    /**\n     * Numbering triggered by 1.\n     */\n    NumberingListType[NumberingListType[\"Decimal\"] = 1] = \"Decimal\";\n    /**\n     * Numbering triggered by 1-\n     */\n    NumberingListType[NumberingListType[\"DecimalDash\"] = 2] = \"DecimalDash\";\n    /**\n     * Numbering triggered by 1)\n     */\n    NumberingListType[NumberingListType[\"DecimalParenthesis\"] = 3] = \"DecimalParenthesis\";\n    /**\n     * Numbering triggered by (1)\n     */\n    NumberingListType[NumberingListType[\"DecimalDoubleParenthesis\"] = 4] = \"DecimalDoubleParenthesis\";\n    /**\n     * Numbering triggered by a.\n     */\n    NumberingListType[NumberingListType[\"LowerAlpha\"] = 5] = \"LowerAlpha\";\n    /**\n     * Numbering triggered by a)\n     */\n    NumberingListType[NumberingListType[\"LowerAlphaParenthesis\"] = 6] = \"LowerAlphaParenthesis\";\n    /**\n     * Numbering triggered by (a)\n     */\n    NumberingListType[NumberingListType[\"LowerAlphaDoubleParenthesis\"] = 7] = \"LowerAlphaDoubleParenthesis\";\n    /**\n     * Numbering triggered by a-\n     */\n    NumberingListType[NumberingListType[\"LowerAlphaDash\"] = 8] = \"LowerAlphaDash\";\n    /**\n     * Numbering triggered by A.\n     */\n    NumberingListType[NumberingListType[\"UpperAlpha\"] = 9] = \"UpperAlpha\";\n    /**\n     * Numbering triggered by A)\n     */\n    NumberingListType[NumberingListType[\"UpperAlphaParenthesis\"] = 10] = \"UpperAlphaParenthesis\";\n    /**\n     * Numbering triggered by (A)\n     */\n    NumberingListType[NumberingListType[\"UpperAlphaDoubleParenthesis\"] = 11] = \"UpperAlphaDoubleParenthesis\";\n    /**\n     * Numbering triggered by A-\n     */\n    NumberingListType[NumberingListType[\"UpperAlphaDash\"] = 12] = \"UpperAlphaDash\";\n    /**\n     * Numbering triggered by i.\n     */\n    NumberingListType[NumberingListType[\"LowerRoman\"] = 13] = \"LowerRoman\";\n    /**\n     * Numbering triggered by i)\n     */\n    NumberingListType[NumberingListType[\"LowerRomanParenthesis\"] = 14] = \"LowerRomanParenthesis\";\n    /**\n     * Numbering triggered by (i)\n     */\n    NumberingListType[NumberingListType[\"LowerRomanDoubleParenthesis\"] = 15] = \"LowerRomanDoubleParenthesis\";\n    /**\n     * Numbering triggered by i-\n     */\n    NumberingListType[NumberingListType[\"LowerRomanDash\"] = 16] = \"LowerRomanDash\";\n    /**\n     * Numbering triggered by I.\n     */\n    NumberingListType[NumberingListType[\"UpperRoman\"] = 17] = \"UpperRoman\";\n    /**\n     * Numbering triggered by I)\n     */\n    NumberingListType[NumberingListType[\"UpperRomanParenthesis\"] = 18] = \"UpperRomanParenthesis\";\n    /**\n     * Numbering triggered by (I)\n     */\n    NumberingListType[NumberingListType[\"UpperRomanDoubleParenthesis\"] = 19] = \"UpperRomanDoubleParenthesis\";\n    /**\n     * Numbering triggered by I-\n     */\n    NumberingListType[NumberingListType[\"UpperRomanDash\"] = 20] = \"UpperRomanDash\";\n    /**\n     * Maximum value of the enum\n     */\n    NumberingListType[NumberingListType[\"Max\"] = 20] = \"Max\";\n})(NumberingListType || (NumberingListType = {}));\n//# sourceMappingURL=NumberingListType.js.map","/**\n *  Enum used to control the different types of bullet list\n */\nexport var BulletListType;\n(function (BulletListType) {\n    /**\n     * Minimum value of the enum\n     */\n    BulletListType[BulletListType[\"Min\"] = 1] = \"Min\";\n    /**\n     * Bullet triggered by *\n     */\n    BulletListType[BulletListType[\"Disc\"] = 1] = \"Disc\";\n    /**\n     * Bullet triggered by -\n     */\n    BulletListType[BulletListType[\"Dash\"] = 2] = \"Dash\";\n    /**\n     * Bullet triggered by --\n     */\n    BulletListType[BulletListType[\"Square\"] = 3] = \"Square\";\n    /**\n     * Bullet triggered by >\n     */\n    BulletListType[BulletListType[\"ShortArrow\"] = 4] = \"ShortArrow\";\n    /**\n     * Bullet triggered by ->\n     */\n    BulletListType[BulletListType[\"LongArrow\"] = 5] = \"LongArrow\";\n    /**\n     * Bullet triggered by =>\n     */\n    BulletListType[BulletListType[\"UnfilledArrow\"] = 6] = \"UnfilledArrow\";\n    /**\n     * Bullet triggered by \n     */\n    BulletListType[BulletListType[\"Hyphen\"] = 7] = \"Hyphen\";\n    /**\n     * Bullet triggered by -->\n     */\n    BulletListType[BulletListType[\"DoubleLongArrow\"] = 8] = \"DoubleLongArrow\";\n    /**\n     * Bullet type circle\n     */\n    BulletListType[BulletListType[\"Circle\"] = 9] = \"Circle\";\n    /**\n     * Maximum value of the enum\n     */\n    BulletListType[BulletListType[\"Max\"] = 9] = \"Max\";\n})(BulletListType || (BulletListType = {}));\n//# sourceMappingURL=BulletListType.js.map","/**\n * Types of definitions, used by Definition type\n */\nexport var DefinitionType;\n(function (DefinitionType) {\n    /**\n     * Boolean type definition, represents a boolean type value\n     */\n    DefinitionType[DefinitionType[\"Boolean\"] = 0] = \"Boolean\";\n    /**\n     * Number type definition, represents a number type value\n     */\n    DefinitionType[DefinitionType[\"Number\"] = 1] = \"Number\";\n    /**\n     * String type definition, represents a string type value\n     */\n    DefinitionType[DefinitionType[\"String\"] = 2] = \"String\";\n    /**\n     * Array type definition, represents an array with a given item type\n     */\n    DefinitionType[DefinitionType[\"Array\"] = 3] = \"Array\";\n    /**\n     * Object type definition, represents an object with the given property types\n     */\n    DefinitionType[DefinitionType[\"Object\"] = 4] = \"Object\";\n    /**\n     * Customize type definition, represents a customized type with a validator function\n     */\n    DefinitionType[DefinitionType[\"Customize\"] = 5] = \"Customize\";\n})(DefinitionType || (DefinitionType = {}));\n//# sourceMappingURL=DefinitionType.js.map","/**\n * Enum for paste options\n */\nexport var PasteType;\n(function (PasteType) {\n    /**\n     * Default paste behavior\n     */\n    PasteType[PasteType[\"Normal\"] = 0] = \"Normal\";\n    /**\n     * Paste only the plain text\n     */\n    PasteType[PasteType[\"AsPlainText\"] = 1] = \"AsPlainText\";\n    /**\n     * Apply the current style to pasted content\n     */\n    PasteType[PasteType[\"MergeFormat\"] = 2] = \"MergeFormat\";\n    /**\n     * If there is a image uri in the clipboard, paste the content as image element\n     */\n    PasteType[PasteType[\"AsImage\"] = 3] = \"AsImage\";\n})(PasteType || (PasteType = {}));\n//# sourceMappingURL=PasteType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getDarkColor = void 0;\nvar getDarkColor_1 = require(\"./utils/getDarkColor\");\nObject.defineProperty(exports, \"getDarkColor\", { enumerable: true, get: function () { return getDarkColor_1.default; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleAlignment = void 0;\n/**\n * enum for setting block alignment, used by setAlignment API\n */\nvar CompatibleAlignment;\n(function (CompatibleAlignment) {\n    /**\n     * Align left\n     */\n    CompatibleAlignment[CompatibleAlignment[\"Left\"] = 0] = \"Left\";\n    /**\n     * Align center\n     */\n    CompatibleAlignment[CompatibleAlignment[\"Center\"] = 1] = \"Center\";\n    /**\n     * Align right\n     */\n    CompatibleAlignment[CompatibleAlignment[\"Right\"] = 2] = \"Right\";\n})(CompatibleAlignment = exports.CompatibleAlignment || (exports.CompatibleAlignment = {}));\n//# sourceMappingURL=Alignment.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleBulletListType = void 0;\n/**\n *  Enum used to control the different types of bullet list\n */\nvar CompatibleBulletListType;\n(function (CompatibleBulletListType) {\n    /**\n     * Minimum value of the enum\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Min\"] = 1] = \"Min\";\n    /**\n     * Bullet triggered by *\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Disc\"] = 1] = \"Disc\";\n    /**\n     * Bullet triggered by -\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Dash\"] = 2] = \"Dash\";\n    /**\n     * Bullet triggered by --\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Square\"] = 3] = \"Square\";\n    /**\n     * Bullet triggered by >\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"ShortArrow\"] = 4] = \"ShortArrow\";\n    /**\n     * Bullet triggered by ->\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"LongArrow\"] = 5] = \"LongArrow\";\n    /**\n     * Bullet triggered by =>\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"UnfilledArrow\"] = 6] = \"UnfilledArrow\";\n    /**\n     * Bullet triggered by \n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Hyphen\"] = 7] = \"Hyphen\";\n    /**\n     * Bullet triggered by -->\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"DoubleLongArrow\"] = 8] = \"DoubleLongArrow\";\n    /**\n     * Bullet type circle\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Circle\"] = 9] = \"Circle\";\n    /**\n     * Maximum value of the enum\n     */\n    CompatibleBulletListType[CompatibleBulletListType[\"Max\"] = 9] = \"Max\";\n})(CompatibleBulletListType = exports.CompatibleBulletListType || (exports.CompatibleBulletListType = {}));\n//# sourceMappingURL=BulletListType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleCapitalization = void 0;\n/**\n * The enum used for controlling the capitalization of text.\n * Used by changeCapitalization API\n */\nvar CompatibleCapitalization;\n(function (CompatibleCapitalization) {\n    /**\n     * Transforms the first character after punctuation mark followed by space\n     * to uppercase and the rest of characters to lowercase.\n     */\n    CompatibleCapitalization[\"Sentence\"] = \"sentence\";\n    /**\n     * Transforms all characters to lowercase\n     */\n    CompatibleCapitalization[\"Lowercase\"] = \"lowercase\";\n    /**\n     * Transforms all characters to uppercase\n     */\n    CompatibleCapitalization[\"Uppercase\"] = \"uppercase\";\n    /**\n     * Transforms the first character of each word to uppercase\n     */\n    CompatibleCapitalization[\"CapitalizeEachWord\"] = \"capitalize\";\n})(CompatibleCapitalization = exports.CompatibleCapitalization || (exports.CompatibleCapitalization = {}));\n//# sourceMappingURL=Capitalization.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleChangeSource = void 0;\n/**\n * Possible change sources. Here are the predefined sources.\n * It can also be other string if the change source can't fall into these sources.\n */\nvar CompatibleChangeSource;\n(function (CompatibleChangeSource) {\n    /**\n     * Content changed by auto link\n     */\n    CompatibleChangeSource[\"AutoLink\"] = \"AutoLink\";\n    /**\n     * Content changed by create link\n     */\n    CompatibleChangeSource[\"CreateLink\"] = \"CreateLink\";\n    /**\n     * Content changed by format\n     */\n    CompatibleChangeSource[\"Format\"] = \"Format\";\n    /**\n     * Content changed by image resize\n     */\n    CompatibleChangeSource[\"ImageResize\"] = \"ImageResize\";\n    /**\n     * Content changed by paste\n     */\n    CompatibleChangeSource[\"Paste\"] = \"Paste\";\n    /**\n     * Content changed by setContent API\n     */\n    CompatibleChangeSource[\"SetContent\"] = \"SetContent\";\n    /**\n     * Content changed by cut operation\n     */\n    CompatibleChangeSource[\"Cut\"] = \"Cut\";\n    /**\n     * Content changed by drag & drop operation\n     */\n    CompatibleChangeSource[\"Drop\"] = \"Drop\";\n    /**\n     * Insert a new entity into editor\n     */\n    CompatibleChangeSource[\"InsertEntity\"] = \"InsertEntity\";\n    /**\n     * Editor is switched to dark mode, content color is changed\n     */\n    CompatibleChangeSource[\"SwitchToDarkMode\"] = \"SwitchToDarkMode\";\n    /**\n     * Editor is switched to light mode, content color is changed\n     */\n    CompatibleChangeSource[\"SwitchToLightMode\"] = \"SwitchToLightMode\";\n    /**\n     * List chain reorganized numbers of lists\n     */\n    CompatibleChangeSource[\"ListChain\"] = \"ListChain\";\n    /**\n     * Keyboard event, used by Content Model.\n     * Data of this event will be the key code number\n     */\n    CompatibleChangeSource[\"Keyboard\"] = \"Keyboard\";\n})(CompatibleChangeSource = exports.CompatibleChangeSource || (exports.CompatibleChangeSource = {}));\n//# sourceMappingURL=ChangeSource.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleClearFormatMode = void 0;\n/**\n * Represents the strategy to clear the format of the current editor selection\n */\nvar CompatibleClearFormatMode;\n(function (CompatibleClearFormatMode) {\n    /**\n     * Inline format. Remove text format.\n     */\n    CompatibleClearFormatMode[CompatibleClearFormatMode[\"Inline\"] = 0] = \"Inline\";\n    /**\n     * BLock format. Remove text and structure format of the block.\n     */\n    CompatibleClearFormatMode[CompatibleClearFormatMode[\"Block\"] = 1] = \"Block\";\n    /**\n     * Detect Inline or Block format based on the current editor selector.\n     */\n    CompatibleClearFormatMode[CompatibleClearFormatMode[\"AutoDetect\"] = 2] = \"AutoDetect\";\n})(CompatibleClearFormatMode = exports.CompatibleClearFormatMode || (exports.CompatibleClearFormatMode = {}));\n//# sourceMappingURL=ClearFormatMode.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleColorTransformDirection = void 0;\n/**\n * Represents the mode of color transformation\n */\nvar CompatibleColorTransformDirection;\n(function (CompatibleColorTransformDirection) {\n    /**\n     * Transform from light to dark\n     */\n    CompatibleColorTransformDirection[CompatibleColorTransformDirection[\"LightToDark\"] = 0] = \"LightToDark\";\n    /**\n     * Transform from dark to light\n     */\n    CompatibleColorTransformDirection[CompatibleColorTransformDirection[\"DarkToLight\"] = 1] = \"DarkToLight\";\n})(CompatibleColorTransformDirection = exports.CompatibleColorTransformDirection || (exports.CompatibleColorTransformDirection = {}));\n//# sourceMappingURL=ColorTransformDirection.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleContentPosition = void 0;\n/**\n * The position. Mostly used for content insertion and traversing\n * On insertion, we will need to specify where we want the content to be placed (begin, end, selection or outside)\n * On content traversing, we will need to specify the start position of traversing\n */\nvar CompatibleContentPosition;\n(function (CompatibleContentPosition) {\n    /**\n     * Begin of the container\n     */\n    CompatibleContentPosition[CompatibleContentPosition[\"Begin\"] = 0] = \"Begin\";\n    /**\n     * End of the container\n     */\n    CompatibleContentPosition[CompatibleContentPosition[\"End\"] = 1] = \"End\";\n    /**\n     * End of the content div domain.\n     */\n    CompatibleContentPosition[CompatibleContentPosition[\"DomEnd\"] = 2] = \"DomEnd\";\n    /**\n     * Selection start\n     */\n    CompatibleContentPosition[CompatibleContentPosition[\"SelectionStart\"] = 3] = \"SelectionStart\";\n    /**\n     * Outside of editor\n     */\n    CompatibleContentPosition[CompatibleContentPosition[\"Outside\"] = 4] = \"Outside\";\n    /**\n     * Manually defined range\n     */\n    CompatibleContentPosition[CompatibleContentPosition[\"Range\"] = 5] = \"Range\";\n})(CompatibleContentPosition = exports.CompatibleContentPosition || (exports.CompatibleContentPosition = {}));\n//# sourceMappingURL=ContentPosition.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleContentType = exports.CompatibleContentTypePrefix = void 0;\n/**\n * Prefix of content types\n */\nvar CompatibleContentTypePrefix;\n(function (CompatibleContentTypePrefix) {\n    /**\n     * Text type prefix\n     */\n    CompatibleContentTypePrefix[\"Text\"] = \"text/\";\n    /**\n     * Image type prefix\n     */\n    CompatibleContentTypePrefix[\"Image\"] = \"image/\";\n})(CompatibleContentTypePrefix = exports.CompatibleContentTypePrefix || (exports.CompatibleContentTypePrefix = {}));\n/**\n * Known content types\n */\nvar CompatibleContentType;\n(function (CompatibleContentType) {\n    /**\n     * Plain text content type\n     */\n    CompatibleContentType[\"PlainText\"] = \"text/plain\";\n    /**\n     * HTML content type\n     */\n    CompatibleContentType[\"HTML\"] = \"text/html\";\n})(CompatibleContentType = exports.CompatibleContentType || (exports.CompatibleContentType = {}));\n//# sourceMappingURL=ContentType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleDarkModeDatasetNames = void 0;\n/**\n * @deprecated\n * Constants string for dataset names used by dark mode\n */\nvar CompatibleDarkModeDatasetNames;\n(function (CompatibleDarkModeDatasetNames) {\n    /**\n     * Original style text color\n     */\n    CompatibleDarkModeDatasetNames[\"OriginalStyleColor\"] = \"ogsc\";\n    /**\n     * Original style background color\n     */\n    CompatibleDarkModeDatasetNames[\"OriginalStyleBackgroundColor\"] = \"ogsb\";\n    /**\n     * Original attribute text color\n     */\n    CompatibleDarkModeDatasetNames[\"OriginalAttributeColor\"] = \"ogac\";\n    /**\n     * Original attribute background color\n     */\n    CompatibleDarkModeDatasetNames[\"OriginalAttributeBackgroundColor\"] = \"ogab\";\n})(CompatibleDarkModeDatasetNames = exports.CompatibleDarkModeDatasetNames || (exports.CompatibleDarkModeDatasetNames = {}));\n//# sourceMappingURL=DarkModeDatasetNames.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleDefinitionType = void 0;\n/**\n * Types of definitions, used by Definition type\n */\nvar CompatibleDefinitionType;\n(function (CompatibleDefinitionType) {\n    /**\n     * Boolean type definition, represents a boolean type value\n     */\n    CompatibleDefinitionType[CompatibleDefinitionType[\"Boolean\"] = 0] = \"Boolean\";\n    /**\n     * Number type definition, represents a number type value\n     */\n    CompatibleDefinitionType[CompatibleDefinitionType[\"Number\"] = 1] = \"Number\";\n    /**\n     * String type definition, represents a string type value\n     */\n    CompatibleDefinitionType[CompatibleDefinitionType[\"String\"] = 2] = \"String\";\n    /**\n     * Array type definition, represents an array with a given item type\n     */\n    CompatibleDefinitionType[CompatibleDefinitionType[\"Array\"] = 3] = \"Array\";\n    /**\n     * Object type definition, represents an object with the given property types\n     */\n    CompatibleDefinitionType[CompatibleDefinitionType[\"Object\"] = 4] = \"Object\";\n    /**\n     * Customize type definition, represents a customized type with a validator function\n     */\n    CompatibleDefinitionType[CompatibleDefinitionType[\"Customize\"] = 5] = \"Customize\";\n})(CompatibleDefinitionType = exports.CompatibleDefinitionType || (exports.CompatibleDefinitionType = {}));\n//# sourceMappingURL=DefinitionType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleDelimiterClasses = void 0;\n/**\n * Class names for Delimiter\n */\nvar CompatibleDelimiterClasses;\n(function (CompatibleDelimiterClasses) {\n    /**\n     * Class name to specify this delimiter is before an entity\n     */\n    CompatibleDelimiterClasses[\"DELIMITER_BEFORE\"] = \"entityDelimiterBefore\";\n    /**\n     *  Class name to specify this delimiter is after an entity\n     */\n    CompatibleDelimiterClasses[\"DELIMITER_AFTER\"] = \"entityDelimiterAfter\";\n})(CompatibleDelimiterClasses = exports.CompatibleDelimiterClasses || (exports.CompatibleDelimiterClasses = {}));\n//# sourceMappingURL=DelimiterClasses.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleDirection = void 0;\n/**\n * enum for setting block direction, used by setDirection API\n */\nvar CompatibleDirection;\n(function (CompatibleDirection) {\n    /**\n     * Left to right\n     */\n    CompatibleDirection[CompatibleDirection[\"LeftToRight\"] = 0] = \"LeftToRight\";\n    /**\n     * Right to left\n     */\n    CompatibleDirection[CompatibleDirection[\"RightToLeft\"] = 1] = \"RightToLeft\";\n})(CompatibleDirection = exports.CompatibleDirection || (exports.CompatibleDirection = {}));\n//# sourceMappingURL=Direction.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleDocumentCommand = void 0;\n/**\n * Command strings for Document.execCommand() API\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand\n */\nvar CompatibleDocumentCommand;\n(function (CompatibleDocumentCommand) {\n    /**\n     * Changes the browser auto-link behavior (Internet Explorer only)\n     */\n    CompatibleDocumentCommand[\"AutoUrlDetect\"] = \"AutoUrlDetect\";\n    /**\n     * Changes the document background color. In styleWithCss mode, it affects the background color of the containing block instead.\n     * This requires a &lt;color&gt; value string to be passed in as a value argument. Note that Internet Explorer uses this to set the\n     * text background color.\n     */\n    CompatibleDocumentCommand[\"BackColor\"] = \"backColor\";\n    /**\n     * Toggles bold on/off for the selection or at the insertion point. Internet Explorer uses the &lt;strong&gt; tag instead of &lt;b&gt;.\n     */\n    CompatibleDocumentCommand[\"Bold\"] = \"bold\";\n    /**\n     * Clears all authentication credentials from the cache.\n     */\n    CompatibleDocumentCommand[\"ClearAuthenticationCache\"] = \"ClearAuthenticationCache\";\n    /**\n     * Makes the content document either read-only or editable. This requires a boolean true/false as the value argument.\n     * (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"ContentReadOnly\"] = \"contentReadOnly\";\n    /**\n     * Copies the current selection to the clipboard. Conditions of having this behavior enabled vary from one browser to another,\n     * and have evolved over time. Check the compatibility table to determine if you can use it in your case.\n     */\n    CompatibleDocumentCommand[\"Copy\"] = \"copy\";\n    /**\n     * Creates an hyperlink from the selection, but only if there is a selection. Requires a URI string as a value argument for the\n     * hyperlink's href. The URI must contain at least a single character, which may be whitespace.\n     * (Internet Explorer will create a link with a null value.)\n     */\n    CompatibleDocumentCommand[\"CreateLink\"] = \"createLink\";\n    /**\n     * Removes the current selection and copies it to the clipboard. When this behavior is enabled varies between browsers,\n     * and its conditions have evolved over time. Check the compatibility table for usage details.\n     */\n    CompatibleDocumentCommand[\"Cut\"] = \"cut\";\n    /**\n     * Adds a &lt;small&gt; tag around the selection or at the insertion point. (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"DecreaseFontSize\"] = \"decreaseFontSize\";\n    /**\n     * Changes the paragraph separator used when new paragraphs are created in editable text regions. See Differences in markup\n     * generation for more details.\n     */\n    CompatibleDocumentCommand[\"DefaultParagraphSeparator\"] = \"defaultParagraphSeparator\";\n    /**\n     * Deletes the current selection.\n     */\n    CompatibleDocumentCommand[\"Delete\"] = \"delete\";\n    /**\n     * Enables or disables the table row/column insertion and deletion controls. (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"EnableInlineTableEditing\"] = \"enableInlineTableEditing\";\n    /**\n     * Enables or disables the resize handles on images and other resizable objects. (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"EnableObjectResizing\"] = \"enableObjectResizing\";\n    /**\n     * Changes the font name for the selection or at the insertion point. This requires a font name string (like \"Arial\")\n     * as a value argument.\n     */\n    CompatibleDocumentCommand[\"FontName\"] = \"fontName\";\n    /**\n     * Changes the font size for the selection or at the insertion point. This requires an integer from 1-7 as a value argument.\n     */\n    CompatibleDocumentCommand[\"FontSize\"] = \"fontSize\";\n    /**\n     * Changes a font color for the selection or at the insertion point. This requires a hexadecimal color value string\n     * as a value argument.\n     */\n    CompatibleDocumentCommand[\"ForeColor\"] = \"foreColor\";\n    /**\n     * Adds an HTML block-level element around the line containing the current selection, replacing the block element containing\n     * the line if one exists (in Firefox, &lt;blockquote&gt; is the exception  it will wrap any containing block element).\n     * Requires a tag-name string as a value argument. Virtually all block-level elements can be used.\n     * (Internet Explorer supports only heading tags H1H6, ADDRESS, and PRE, which must be wrapped in angle brackets, such as \"&lt;H1&gt;\".)\n     */\n    CompatibleDocumentCommand[\"FormatBlock\"] = \"formatBlock\";\n    /**\n     * Deletes the character ahead of the cursor's position, identical to hitting the Delete key on a Windows keyboard.\n     */\n    CompatibleDocumentCommand[\"ForwardDelete\"] = \"forwardDelete\";\n    /**\n     * Adds a heading element around a selection or insertion point line. Requires the tag-name strings a value argument (i.e. \"H1\", \"H6\").\n     * (Not supported by Internet Explorer and Safari.)\n     */\n    CompatibleDocumentCommand[\"Heading\"] = \"heading\";\n    /**\n     * Changes the background color for the selection or at the insertion point. Requires a color value string as a value argument.\n     * useCSS must be true for this to function. (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"HiliteColor\"] = \"hiliteColor\";\n    /**\n     * Adds a &lt;big&gt; tag around the selection or at the insertion point. (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"IncreaseFontSize\"] = \"increaseFontSize\";\n    /**\n     * Indents the line containing the selection or insertion point. In Firefox, if the selection spans multiple lines at different\n     * levels of indentation, only the least indented lines in the selection will be indented.\n     */\n    CompatibleDocumentCommand[\"Indent\"] = \"indent\";\n    /**\n     * Controls whether the Enter key inserts a &lt;br&gt; element, or splits the current block element into two.\n     * (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"InsertBrOnReturn\"] = \"insertBrOnReturn\";\n    /**\n     * Inserts a &lt;hr&gt; element at the insertion point, or replaces the selection with it.\n     */\n    CompatibleDocumentCommand[\"InsertHorizontalRule\"] = \"insertHorizontalRule\";\n    /**\n     * Inserts an HTML string at the insertion point (deletes selection). Requires a valid HTML string as a value argument.\n     * (Not supported by Internet Explorer.)\n     */\n    CompatibleDocumentCommand[\"InsertHTML\"] = \"insertHTML\";\n    /**\n     * Inserts an image at the insertion point (deletes selection). Requires a URL string for the image's src as a value argument.\n     * The requirements for this string are the same as createLink.\n     */\n    CompatibleDocumentCommand[\"InsertImage\"] = \"insertImage\";\n    /**\n     * Creates a numbered ordered list for the selection or at the insertion point.\n     */\n    CompatibleDocumentCommand[\"InsertOrderedList\"] = \"insertOrderedList\";\n    /**\n     * Creates a bulleted unordered list for the selection or at the insertion point.\n     */\n    CompatibleDocumentCommand[\"InsertUnorderedList\"] = \"insertUnorderedList\";\n    /**\n     * Inserts a paragraph around the selection or the current line.\n     * (Internet Explorer inserts a paragraph at the insertion point and deletes the selection.)\n     */\n    CompatibleDocumentCommand[\"InsertParagraph\"] = \"insertParagraph\";\n    /**\n     * Inserts the given plain text at the insertion point (deletes selection).\n     */\n    CompatibleDocumentCommand[\"InsertText\"] = \"insertText\";\n    /**\n     * Toggles italics on/off for the selection or at the insertion point.\n     * (Internet Explorer uses the &lt;em&gt; element instead of &lt;i&gt;.)\n     */\n    CompatibleDocumentCommand[\"Italic\"] = \"italic\";\n    /**\n     * Centers the selection or insertion point.\n     */\n    CompatibleDocumentCommand[\"JustifyCenter\"] = \"justifyCenter\";\n    /**\n     * Justifies the selection or insertion point.\n     */\n    CompatibleDocumentCommand[\"JustifyFull\"] = \"justifyFull\";\n    /**\n     * Justifies the selection or insertion point to the left.\n     */\n    CompatibleDocumentCommand[\"JustifyLeft\"] = \"justifyLeft\";\n    /**\n     * Right-justifies the selection or the insertion point.\n     */\n    CompatibleDocumentCommand[\"JustifyRight\"] = \"justifyRight\";\n    /**\n     * Outdents the line containing the selection or insertion point.\n     */\n    CompatibleDocumentCommand[\"Outdent\"] = \"outdent\";\n    /**\n     * Pastes the clipboard contents at the insertion point (replaces current selection). Disabled for web content. See [1].\n     */\n    CompatibleDocumentCommand[\"Paste\"] = \"paste\";\n    /**\n     * Redoes the previous undo command.\n     */\n    CompatibleDocumentCommand[\"Redo\"] = \"redo\";\n    /**\n     * Removes all formatting from the current selection.\n     */\n    CompatibleDocumentCommand[\"RemoveFormat\"] = \"removeFormat\";\n    /**\n     * Selects all of the content of the editable region.\n     */\n    CompatibleDocumentCommand[\"SelectAll\"] = \"selectAll\";\n    /**\n     * Toggles strikethrough on/off for the selection or at the insertion point.\n     */\n    CompatibleDocumentCommand[\"StrikeThrough\"] = \"strikeThrough\";\n    /**\n     * Toggles subscript on/off for the selection or at the insertion point.\n     */\n    CompatibleDocumentCommand[\"Subscript\"] = \"subscript\";\n    /**\n     * Toggles superscript on/off for the selection or at the insertion point.\n     */\n    CompatibleDocumentCommand[\"Superscript\"] = \"superscript\";\n    /**\n     * Toggles underline on/off for the selection or at the insertion point.\n     */\n    CompatibleDocumentCommand[\"Underline\"] = \"underline\";\n    /**\n     * Undoes the last executed command.\n     */\n    CompatibleDocumentCommand[\"Undo\"] = \"undo\";\n    /**\n     * Removes the anchor element from a selected hyperlink.\n     */\n    CompatibleDocumentCommand[\"Unlink\"] = \"unlink\";\n    /**\n     * Replaces the useCSS command. true modifies/generates style attributes in markup, false generates presentational elements.\n     */\n    CompatibleDocumentCommand[\"StyleWithCSS\"] = \"styleWithCSS\";\n})(CompatibleDocumentCommand = exports.CompatibleDocumentCommand || (exports.CompatibleDocumentCommand = {}));\n//# sourceMappingURL=DocumentCommand.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleDocumentPosition = void 0;\n/**\n * The is essentially an enum representing result from browser compareDocumentPosition API\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n */\nvar CompatibleDocumentPosition;\n(function (CompatibleDocumentPosition) {\n    /**\n     * Same node\n     */\n    CompatibleDocumentPosition[CompatibleDocumentPosition[\"Same\"] = 0] = \"Same\";\n    /**\n     * Node is disconnected from document\n     */\n    CompatibleDocumentPosition[CompatibleDocumentPosition[\"Disconnected\"] = 1] = \"Disconnected\";\n    /**\n     * Node is preceding the comparing node\n     */\n    CompatibleDocumentPosition[CompatibleDocumentPosition[\"Preceding\"] = 2] = \"Preceding\";\n    /**\n     * Node is following the comparing node\n     */\n    CompatibleDocumentPosition[CompatibleDocumentPosition[\"Following\"] = 4] = \"Following\";\n    /**\n     * Node contains the comparing node\n     */\n    CompatibleDocumentPosition[CompatibleDocumentPosition[\"Contains\"] = 8] = \"Contains\";\n    /**\n     * Node is contained by the comparing node\n     */\n    CompatibleDocumentPosition[CompatibleDocumentPosition[\"ContainedBy\"] = 16] = \"ContainedBy\";\n})(CompatibleDocumentPosition = exports.CompatibleDocumentPosition || (exports.CompatibleDocumentPosition = {}));\n//# sourceMappingURL=DocumentPosition.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleEntityClasses = void 0;\n/**\n * CSS Class names for Entity\n */\nvar CompatibleEntityClasses;\n(function (CompatibleEntityClasses) {\n    /**\n     * Class name to specify this is an entity\n     */\n    CompatibleEntityClasses[\"ENTITY_INFO_NAME\"] = \"_Entity\";\n    /**\n     * Class name to specify the type of an entity\n     */\n    CompatibleEntityClasses[\"ENTITY_TYPE_PREFIX\"] = \"_EType_\";\n    /**\n     * Class name to specify the ID of an entity\n     */\n    CompatibleEntityClasses[\"ENTITY_ID_PREFIX\"] = \"_EId_\";\n    /**\n     * Class name to specify if the entity is readonly\n     */\n    CompatibleEntityClasses[\"ENTITY_READONLY_PREFIX\"] = \"_EReadonly_\";\n})(CompatibleEntityClasses = exports.CompatibleEntityClasses || (exports.CompatibleEntityClasses = {}));\n//# sourceMappingURL=EntityClasses.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleEntityOperation = void 0;\n/**\n * Define possible operations to an entity\n */\nvar CompatibleEntityOperation;\n(function (CompatibleEntityOperation) {\n    /**\n     * Notify plugins that there is a new plugin was added into editor.\n     * Plugin can handle this event to entity hydration.\n     * This event will be only fired once for each entity DOM node.\n     * After undo, or copy/paste, since new DOM nodes were added, this event will be fired\n     * for those entities represented by newly added nodes.\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"NewEntity\"] = 0] = \"NewEntity\";\n    /**\n     * Notify plugins that user is clicking target to an entity\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"Click\"] = 1] = \"Click\";\n    /**\n     * Notify plugins that user is triggering context menu to an entity\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"ContextMenu\"] = 2] = \"ContextMenu\";\n    /**\n     * Notify plugins that user is escaping from an entity by pressing ESC key\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"Escape\"] = 3] = \"Escape\";\n    /**\n     * Notify plugins that user is removing an entity from its start position using DELETE key\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"RemoveFromStart\"] = 4] = \"RemoveFromStart\";\n    /**\n     * Notify plugins that user is remove an entity from its end position using BACKSPACE key\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"RemoveFromEnd\"] = 5] = \"RemoveFromEnd\";\n    /**\n     * Notify plugins that an entity is being overwritten.\n     * This can be caused by key in, cut, paste, delete, backspace ... on a selection\n     * which contains some entities.\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"Overwrite\"] = 6] = \"Overwrite\";\n    /**\n     * Notify plugins that an entity is being partially overwritten.\n     * This happens when user selected part of the entity then do key press, or cut, paste, delete, backspace, ...\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"PartialOverwrite\"] = 7] = \"PartialOverwrite\";\n    /**\n     * Notify plugins that editor is generating HTML content for save.\n     * Plugin should use this event to remove any temporary content, and only leave DOM nodes that\n     * should be saved as HTML string.\n     * This event will provide a cloned DOM tree for each entity, do NOT compare the DOM nodes with cached nodes\n     * because it will always return false.\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"ReplaceTemporaryContent\"] = 8] = \"ReplaceTemporaryContent\";\n    /**\n     * @deprecated\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"AddShadowRoot\"] = 9] = \"AddShadowRoot\";\n    /**\n     * @deprecated\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"RemoveShadowRoot\"] = 10] = \"RemoveShadowRoot\";\n    /**\n     * Notify plugins that a new entity state need to be updated to an entity.\n     * This is normally happened when user undo/redo the content with an entity snapshot added by a plugin that handles entity\n     */\n    CompatibleEntityOperation[CompatibleEntityOperation[\"UpdateEntityState\"] = 11] = \"UpdateEntityState\";\n})(CompatibleEntityOperation = exports.CompatibleEntityOperation || (exports.CompatibleEntityOperation = {}));\n//# sourceMappingURL=EntityOperation.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleExperimentalFeatures = void 0;\n/**\n * Experimental feature flags\n */\nvar CompatibleExperimentalFeatures;\n(function (CompatibleExperimentalFeatures) {\n    // #region Graduated and deprecated features.\n    // These features will be removed in next major release\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"NewIndentation\"] = \"NewIndentation\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"NewBullet\"] = \"NewBullet\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"NewNumbering\"] = \"NewNumbering\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"ListChain\"] = \"ListChain\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"MergePastedLine\"] = \"MergePastedLine\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"SingleDirectionResize\"] = \"SingleDirectionResize\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"PasteWithLinkPreview\"] = \"PasteWithLinkPreview\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"ImageRotate\"] = \"ImageRotate\";\n    /**\n     * @deprecated This feature is always enabled\n     */\n    CompatibleExperimentalFeatures[\"ImageCrop\"] = \"ImageCrop\";\n    /**\n     * @deprecated This feature is always enabled\n     * Check if the element has a style attribute, if not, apply the default format\n     */\n    CompatibleExperimentalFeatures[\"AlwaysApplyDefaultFormat\"] = \"AlwaysApplyDefaultFormat\";\n    /**\n     * @deprecated This feature can be enabled/disabled using Paste Plugin contructor param\n     * Paste the Html instead of the Img when the Html Body only have one IMG Child node\n     */\n    CompatibleExperimentalFeatures[\"ConvertSingleImageBody\"] = \"ConvertSingleImageBody\";\n    /**\n     * @deprecated This feature is always enabled\n     * Align table elements to left, center and right using setAlignment API\n     */\n    CompatibleExperimentalFeatures[\"TableAlignment\"] = \"TableAlignment\";\n    /**\n     * @deprecated this feature is always enabled\n     * Provide a circular resize handles that adaptive the number od handles to the size of the image\n     */\n    CompatibleExperimentalFeatures[\"AdaptiveHandlesResizer\"] = \"AdaptiveHandlesResizer\";\n    /**\n     * @deprecated this feature is always disabled\n     * Automatically transform -- into hyphen, if typed between two words.\n     */\n    CompatibleExperimentalFeatures[\"AutoHyphen\"] = \"AutoHyphen\";\n    /**\n     * @deprecated this feature is always disabled\n     * Use pending format strategy to do style based format, e.g. Font size, Color.\n     * With this feature enabled, we don't need to insert temp ZeroWidthSpace character to hold pending format\n     * when selection is collapsed. Instead, we will hold the pending format in memory and only apply it when type something\n     */\n    CompatibleExperimentalFeatures[\"PendingStyleBasedFormat\"] = \"PendingStyleBasedFormat\";\n    /**\n     * @deprecated this feature is always disabled\n     * Normalize list to make sure it can be displayed correctly in other client\n     * e.g. We will move list items with \"display: block\" into previous list item and change tag to be DIV\n     */\n    CompatibleExperimentalFeatures[\"NormalizeList\"] = \"NormalizeList\";\n    /**\n     * @deprecated this feature is always enabled\n     * When a html image is selected, the selected image data will be stored by editor core.\n     */\n    CompatibleExperimentalFeatures[\"ImageSelection\"] = \"ImageSelection\";\n    /**\n     * @deprecated this feature is always enabled\n     * Use variable-based dark mode solution rather than dataset-based solution.\n     * When enable this feature, need to pass in a DarkModelHandler object to each call of setColor and applyFormat\n     * if you need them work for dark mode\n     */\n    CompatibleExperimentalFeatures[\"VariableBasedDarkColor\"] = \"VariableBasedDarkColor\";\n    /**\n     * @deprecated this feature is always enabled\n     * Align list elements elements to left, center and right using setAlignment API\n     */\n    CompatibleExperimentalFeatures[\"ListItemAlignment\"] = \"ListItemAlignment\";\n    /**\n     * @deprecated\n     */\n    CompatibleExperimentalFeatures[\"DefaultFormatInSpan\"] = \"DefaultFormatInSpan\";\n    /**\n     * @deprecated\n     */\n    CompatibleExperimentalFeatures[\"DefaultFormatOnContainer\"] = \"DefaultFormatOnContainer\";\n    /**\n     * @deprecated This feature is always enabled\n     * Reuse existing DOM structure if possible when convert Content Model back to DOM tree\n     */\n    CompatibleExperimentalFeatures[\"ReusableContentModel\"] = \"ReusableContentModel\";\n    /**\n     * @deprecated This feature is always enabled\n     * Handle keyboard editing event with Content Model\n     */\n    CompatibleExperimentalFeatures[\"EditWithContentModel\"] = \"EditWithContentModel\";\n    /**\n     * @deprecated This feature is always enabled\n     * Trigger formatting by a especial characters. Ex: (A), 1. i).\n     */\n    CompatibleExperimentalFeatures[\"AutoFormatList\"] = \"AutoFormatList\";\n    /**\n     * @deprecated This feature is always enabled\n     * Add entities around a Read Only  Inline entity to prevent cursor to be hidden when cursor is next of it.\n     */\n    CompatibleExperimentalFeatures[\"InlineEntityReadOnlyDelimiters\"] = \"InlineEntityReadOnlyDelimiters\";\n    /**\n     * @deprecated This feature is always enabled\n     * Paste with Content model\n     */\n    CompatibleExperimentalFeatures[\"ContentModelPaste\"] = \"ContentModelPaste\";\n    //#endregion\n    /**\n     * Provide additional Tab Key Features. Requires Text Features Content Editable Features\n     */\n    CompatibleExperimentalFeatures[\"TabKeyTextFeatures\"] = \"TabKeyTextFeatures\";\n    /**\n     * With this feature enabled, when writing back a list item we will re-use all\n     * ancestor list elements, even if they don't match the types currently in the\n     * listTypes array for that item. The only list that we will ensure is correct\n     * is the one closest to the item.\n     */\n    CompatibleExperimentalFeatures[\"ReuseAllAncestorListElements\"] = \"ReuseAllAncestorListElements\";\n    /**\n     * Delete table with Backspace key with the whole was selected with table selector\n     */\n    CompatibleExperimentalFeatures[\"DeleteTableWithBackspace\"] = \"DeleteTableWithBackspace\";\n    /**\n     * Disable list chain functionality\n     */\n    CompatibleExperimentalFeatures[\"DisableListChain\"] = \"DisableListChain\";\n})(CompatibleExperimentalFeatures = exports.CompatibleExperimentalFeatures || (exports.CompatibleExperimentalFeatures = {}));\n//# sourceMappingURL=ExperimentalFeatures.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleFontSizeChange = void 0;\n/**\n * The enum used for increase or decrease font size\n * Used by setFontSize API\n */\nvar CompatibleFontSizeChange;\n(function (CompatibleFontSizeChange) {\n    /**\n     * Increase font size\n     */\n    CompatibleFontSizeChange[CompatibleFontSizeChange[\"Increase\"] = 0] = \"Increase\";\n    /**\n     * Decrease font size\n     */\n    CompatibleFontSizeChange[CompatibleFontSizeChange[\"Decrease\"] = 1] = \"Decrease\";\n})(CompatibleFontSizeChange = exports.CompatibleFontSizeChange || (exports.CompatibleFontSizeChange = {}));\n//# sourceMappingURL=FontSizeChange.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleGetContentMode = void 0;\n/**\n * Represents a mode number to indicate what kind of content to retrieve when call Editor.getContent()\n */\nvar CompatibleGetContentMode;\n(function (CompatibleGetContentMode) {\n    /**\n     * The clean content without any temporary content only for editor.\n     * This is the default value. Call to Editor.getContent() with trigger an ExtractContentWithDom event\n     * so that plugins can remove their temporary content, and will return the HTML content\n     * which is ready for save to storage.\n     */\n    CompatibleGetContentMode[CompatibleGetContentMode[\"CleanHTML\"] = 0] = \"CleanHTML\";\n    /**\n     * Retrieve the raw HTML string in current editor. Temporary content will be included.\n     */\n    CompatibleGetContentMode[CompatibleGetContentMode[\"RawHTMLOnly\"] = 1] = \"RawHTMLOnly\";\n    /**\n     * Retrieve the raw HTML string in current editor with a selection marker. This can be used for\n     * save current editor state and call to SetContent with this result can fully restore editor state\n     * including current selection\n     */\n    CompatibleGetContentMode[CompatibleGetContentMode[\"RawHTMLWithSelection\"] = 2] = \"RawHTMLWithSelection\";\n    /**\n     * Get plain text content only, all format will be ignored\n     */\n    CompatibleGetContentMode[CompatibleGetContentMode[\"PlainText\"] = 3] = \"PlainText\";\n    /**\n     * A fast way to get plain text content, the line-end positions may not be exactly same with HTML content,\n     * but the text content should be the same. This is used for quickly retrieve text content and check\n     * text only\n     */\n    CompatibleGetContentMode[CompatibleGetContentMode[\"PlainTextFast\"] = 4] = \"PlainTextFast\";\n})(CompatibleGetContentMode = exports.CompatibleGetContentMode || (exports.CompatibleGetContentMode = {}));\n//# sourceMappingURL=GetContentMode.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleImageEditOperation = void 0;\n/**\n * Operation flags for ImageEdit plugin\n */\nvar CompatibleImageEditOperation;\n(function (CompatibleImageEditOperation) {\n    /**\n     * No operation\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"None\"] = 0] = \"None\";\n    /**\n     * Resize image from corner ( horizontal and vertical resize)\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"CornerResize\"] = 1] = \"CornerResize\";\n    /**\n     * Resize image from side ( either horizontal or vertical resize)\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"SideResize\"] = 2] = \"SideResize\";\n    /**\n     * Image resize\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"Resize\"] = 3] = \"Resize\";\n    /**\n     * Image rotate\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"Rotate\"] = 4] = \"Rotate\";\n    /**\n     * Image resize and rotate\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"ResizeAndRotate\"] = 7] = \"ResizeAndRotate\";\n    /**\n     * Image crop\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"Crop\"] = 8] = \"Crop\";\n    /**\n     * All operations\n     */\n    CompatibleImageEditOperation[CompatibleImageEditOperation[\"All\"] = 15] = \"All\";\n})(CompatibleImageEditOperation = exports.CompatibleImageEditOperation || (exports.CompatibleImageEditOperation = {}));\n//# sourceMappingURL=ImageEditOperation.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleIndentation = void 0;\n/**\n * The enum used for increase or decrease indentation of a block\n * Used by setIndentation API\n */\nvar CompatibleIndentation;\n(function (CompatibleIndentation) {\n    /**\n     * Increase indentation\n     */\n    CompatibleIndentation[CompatibleIndentation[\"Increase\"] = 0] = \"Increase\";\n    /**\n     * Decrease indentation\n     */\n    CompatibleIndentation[CompatibleIndentation[\"Decrease\"] = 1] = \"Decrease\";\n})(CompatibleIndentation = exports.CompatibleIndentation || (exports.CompatibleIndentation = {}));\n//# sourceMappingURL=Indentation.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleKeys = void 0;\n/**\n * Key numbers common used keys\n */\nvar CompatibleKeys;\n(function (CompatibleKeys) {\n    CompatibleKeys[CompatibleKeys[\"NULL\"] = 0] = \"NULL\";\n    CompatibleKeys[CompatibleKeys[\"BACKSPACE\"] = 8] = \"BACKSPACE\";\n    CompatibleKeys[CompatibleKeys[\"TAB\"] = 9] = \"TAB\";\n    CompatibleKeys[CompatibleKeys[\"ENTER\"] = 13] = \"ENTER\";\n    CompatibleKeys[CompatibleKeys[\"SHIFT\"] = 16] = \"SHIFT\";\n    CompatibleKeys[CompatibleKeys[\"CTRL_LEFT\"] = 17] = \"CTRL_LEFT\";\n    CompatibleKeys[CompatibleKeys[\"ALT\"] = 18] = \"ALT\";\n    CompatibleKeys[CompatibleKeys[\"ESCAPE\"] = 27] = \"ESCAPE\";\n    CompatibleKeys[CompatibleKeys[\"SPACE\"] = 32] = \"SPACE\";\n    CompatibleKeys[CompatibleKeys[\"PAGEUP\"] = 33] = \"PAGEUP\";\n    CompatibleKeys[CompatibleKeys[\"END\"] = 35] = \"END\";\n    CompatibleKeys[CompatibleKeys[\"HOME\"] = 36] = \"HOME\";\n    CompatibleKeys[CompatibleKeys[\"LEFT\"] = 37] = \"LEFT\";\n    CompatibleKeys[CompatibleKeys[\"UP\"] = 38] = \"UP\";\n    CompatibleKeys[CompatibleKeys[\"RIGHT\"] = 39] = \"RIGHT\";\n    CompatibleKeys[CompatibleKeys[\"DOWN\"] = 40] = \"DOWN\";\n    CompatibleKeys[CompatibleKeys[\"PRINT_SCREEN\"] = 44] = \"PRINT_SCREEN\";\n    CompatibleKeys[CompatibleKeys[\"DELETE\"] = 46] = \"DELETE\";\n    /**\n     * @deprecated Just for backward compatibility\n     */\n    CompatibleKeys[CompatibleKeys[\"EIGHT_ASTIRISK\"] = 56] = \"EIGHT_ASTIRISK\";\n    CompatibleKeys[CompatibleKeys[\"EIGHT_ASTERISK\"] = 56] = \"EIGHT_ASTERISK\";\n    CompatibleKeys[CompatibleKeys[\"B\"] = 66] = \"B\";\n    CompatibleKeys[CompatibleKeys[\"I\"] = 73] = \"I\";\n    CompatibleKeys[CompatibleKeys[\"U\"] = 85] = \"U\";\n    CompatibleKeys[CompatibleKeys[\"Y\"] = 89] = \"Y\";\n    CompatibleKeys[CompatibleKeys[\"Z\"] = 90] = \"Z\";\n    CompatibleKeys[CompatibleKeys[\"META_LEFT\"] = 91] = \"META_LEFT\";\n    CompatibleKeys[CompatibleKeys[\"COMMA\"] = 188] = \"COMMA\";\n    CompatibleKeys[CompatibleKeys[\"DASH_UNDERSCORE\"] = 189] = \"DASH_UNDERSCORE\";\n    CompatibleKeys[CompatibleKeys[\"PERIOD\"] = 190] = \"PERIOD\";\n    /**\n     * @deprecated Just for backward compatibility\n     */\n    CompatibleKeys[CompatibleKeys[\"FORWARDSLASH\"] = 191] = \"FORWARDSLASH\";\n    CompatibleKeys[CompatibleKeys[\"FORWARD_SLASH\"] = 191] = \"FORWARD_SLASH\";\n    CompatibleKeys[CompatibleKeys[\"GRAVE_TILDE\"] = 192] = \"GRAVE_TILDE\";\n    /**\n     * Keys below are non-standard, and should be used in ContentEditFeatures only\n     */\n    CompatibleKeys[CompatibleKeys[\"CONTENTCHANGED\"] = 257] = \"CONTENTCHANGED\";\n    CompatibleKeys[CompatibleKeys[\"RANGE\"] = 258] = \"RANGE\";\n    CompatibleKeys[CompatibleKeys[\"Ctrl\"] = 4096] = \"Ctrl\";\n    CompatibleKeys[CompatibleKeys[\"Meta\"] = 8192] = \"Meta\";\n    CompatibleKeys[CompatibleKeys[\"Shift\"] = 16384] = \"Shift\";\n})(CompatibleKeys = exports.CompatibleKeys || (exports.CompatibleKeys = {}));\n//# sourceMappingURL=Keys.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleKnownAnnounceStrings = void 0;\n/**\n * Known announce strings\n */\nvar CompatibleKnownAnnounceStrings;\n(function (CompatibleKnownAnnounceStrings) {\n    /**\n     * String announced for a list item in a OL List\n     * @example\n     * Auto corrected, &lcub;0&rcub;\n     * Where &lcub0&rcub is the new list item bullet\n     */\n    CompatibleKnownAnnounceStrings[CompatibleKnownAnnounceStrings[\"AnnounceListItemNumbering\"] = 1] = \"AnnounceListItemNumbering\";\n    /**\n     * String announced for a list item in a UL List\n     * @example\n     * Auto corrected bullet\n     */\n    CompatibleKnownAnnounceStrings[CompatibleKnownAnnounceStrings[\"AnnounceListItemBullet\"] = 2] = \"AnnounceListItemBullet\";\n    /**\n     * String announced when cursor is moved to the last cell in a table\n     */\n    CompatibleKnownAnnounceStrings[CompatibleKnownAnnounceStrings[\"AnnounceOnFocusLastCell\"] = 3] = \"AnnounceOnFocusLastCell\";\n})(CompatibleKnownAnnounceStrings = exports.CompatibleKnownAnnounceStrings || (exports.CompatibleKnownAnnounceStrings = {}));\n//# sourceMappingURL=KnownAnnounceStrings.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleKnownCreateElementDataIndex = void 0;\n/**\n * Index of known CreateElementData used by createElement function\n */\nvar CompatibleKnownCreateElementDataIndex;\n(function (CompatibleKnownCreateElementDataIndex) {\n    /**\n     * Set a none value to help createElement function ignore falsy value\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"None\"] = 0] = \"None\";\n    /**\n     * An empty line without format\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"EmptyLine\"] = 1] = \"EmptyLine\";\n    /**\n     * Wrapper for blockquote\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"BlockquoteWrapper\"] = 2] = \"BlockquoteWrapper\";\n    /**\n     * Temp DIV for copy/paste\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"CopyPasteTempDiv\"] = 3] = \"CopyPasteTempDiv\";\n    /**\n     * ListItem with block style\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"BlockListItem\"] = 4] = \"BlockListItem\";\n    /**\n     * Wrapper element for context menu\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"ContextMenuWrapper\"] = 5] = \"ContextMenuWrapper\";\n    /**\n     * Wrapper element for image edit\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"ImageEditWrapper\"] = 6] = \"ImageEditWrapper\";\n    /**\n     * @deprecated\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"TableHorizontalResizer\"] = 7] = \"TableHorizontalResizer\";\n    /**\n     * @deprecated\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"TableVerticalResizer\"] = 8] = \"TableVerticalResizer\";\n    /**\n     * @deprecated\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"TableResizerLTR\"] = 9] = \"TableResizerLTR\";\n    /**\n     * @deprecated\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"TableResizerRTL\"] = 10] = \"TableResizerRTL\";\n    /**\n     * @deprecated\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"TableSelector\"] = 11] = \"TableSelector\";\n    /**\n     * @deprecated\n     */\n    CompatibleKnownCreateElementDataIndex[CompatibleKnownCreateElementDataIndex[\"EmptyLineFormatInSpan\"] = 12] = \"EmptyLineFormatInSpan\";\n})(CompatibleKnownCreateElementDataIndex = exports.CompatibleKnownCreateElementDataIndex || (exports.CompatibleKnownCreateElementDataIndex = {}));\n//# sourceMappingURL=KnownCreateElementDataIndex.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleKnownPasteSourceType = void 0;\n/**\n * Represent the types of sources to handle in the Paste Plugin\n */\nvar CompatibleKnownPasteSourceType;\n(function (CompatibleKnownPasteSourceType) {\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"WordDesktop\"] = 0] = \"WordDesktop\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"ExcelDesktop\"] = 1] = \"ExcelDesktop\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"ExcelOnline\"] = 2] = \"ExcelOnline\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"PowerPointDesktop\"] = 3] = \"PowerPointDesktop\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"GoogleSheets\"] = 4] = \"GoogleSheets\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"WacComponents\"] = 5] = \"WacComponents\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"Default\"] = 6] = \"Default\";\n    CompatibleKnownPasteSourceType[CompatibleKnownPasteSourceType[\"SingleImage\"] = 7] = \"SingleImage\";\n})(CompatibleKnownPasteSourceType = exports.CompatibleKnownPasteSourceType || (exports.CompatibleKnownPasteSourceType = {}));\n//# sourceMappingURL=KnownPasteSourceType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleListType = void 0;\n/**\n * Type of list (numbering or bullet)\n */\nvar CompatibleListType;\n(function (CompatibleListType) {\n    /**\n     * None list type\n     * It means this is not a list\n     */\n    CompatibleListType[CompatibleListType[\"None\"] = 0] = \"None\";\n    /**\n     * Ordered List type (numbering list)\n     * Represented by \"OL\" tag\n     */\n    CompatibleListType[CompatibleListType[\"Ordered\"] = 1] = \"Ordered\";\n    /**\n     * Unordered List type (bullet list)\n     * Represented by \"UL\" tag\n     */\n    CompatibleListType[CompatibleListType[\"Unordered\"] = 2] = \"Unordered\";\n})(CompatibleListType = exports.CompatibleListType || (exports.CompatibleListType = {}));\n//# sourceMappingURL=ListType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleNodeType = void 0;\n/**\n * The is essentially an enum represents the type of the node\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n * Values not listed here are deprecated.\n */\nvar CompatibleNodeType;\n(function (CompatibleNodeType) {\n    /**\n     * An Element node such as &lt;p&gt; or &lt;div&gt;.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"Element\"] = 1] = \"Element\";\n    /**\n     * An Attribute node such as name=\"value\".\n     */\n    CompatibleNodeType[CompatibleNodeType[\"Attribute\"] = 2] = \"Attribute\";\n    /**\n     * The actual Text of Element or Attr.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"Text\"] = 3] = \"Text\";\n    /**\n     * A ProcessingInstruction of an XML document such as &lt;?xml-stylesheet ... ?&gt; declaration.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    /**\n     * A Comment node.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"Comment\"] = 8] = \"Comment\";\n    /**\n     * A Document node.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"Document\"] = 9] = \"Document\";\n    /**\n     * A DocumentType node e.g. &lt;!DOCTYPE html&gt; for HTML5 documents.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    /**\n     * A DocumentFragment node.\n     */\n    CompatibleNodeType[CompatibleNodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n})(CompatibleNodeType = exports.CompatibleNodeType || (exports.CompatibleNodeType = {}));\n//# sourceMappingURL=NodeType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleNumberingListType = void 0;\n/**\n *  Enum used to control the different types of numbering list\n */\nvar CompatibleNumberingListType;\n(function (CompatibleNumberingListType) {\n    /**\n     * Minimum value of the enum\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"Min\"] = 1] = \"Min\";\n    /**\n     * Numbering triggered by 1.\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"Decimal\"] = 1] = \"Decimal\";\n    /**\n     * Numbering triggered by 1-\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"DecimalDash\"] = 2] = \"DecimalDash\";\n    /**\n     * Numbering triggered by 1)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"DecimalParenthesis\"] = 3] = \"DecimalParenthesis\";\n    /**\n     * Numbering triggered by (1)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"DecimalDoubleParenthesis\"] = 4] = \"DecimalDoubleParenthesis\";\n    /**\n     * Numbering triggered by a.\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerAlpha\"] = 5] = \"LowerAlpha\";\n    /**\n     * Numbering triggered by a)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerAlphaParenthesis\"] = 6] = \"LowerAlphaParenthesis\";\n    /**\n     * Numbering triggered by (a)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerAlphaDoubleParenthesis\"] = 7] = \"LowerAlphaDoubleParenthesis\";\n    /**\n     * Numbering triggered by a-\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerAlphaDash\"] = 8] = \"LowerAlphaDash\";\n    /**\n     * Numbering triggered by A.\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperAlpha\"] = 9] = \"UpperAlpha\";\n    /**\n     * Numbering triggered by A)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperAlphaParenthesis\"] = 10] = \"UpperAlphaParenthesis\";\n    /**\n     * Numbering triggered by (A)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperAlphaDoubleParenthesis\"] = 11] = \"UpperAlphaDoubleParenthesis\";\n    /**\n     * Numbering triggered by A-\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperAlphaDash\"] = 12] = \"UpperAlphaDash\";\n    /**\n     * Numbering triggered by i.\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerRoman\"] = 13] = \"LowerRoman\";\n    /**\n     * Numbering triggered by i)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerRomanParenthesis\"] = 14] = \"LowerRomanParenthesis\";\n    /**\n     * Numbering triggered by (i)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerRomanDoubleParenthesis\"] = 15] = \"LowerRomanDoubleParenthesis\";\n    /**\n     * Numbering triggered by i-\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"LowerRomanDash\"] = 16] = \"LowerRomanDash\";\n    /**\n     * Numbering triggered by I.\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperRoman\"] = 17] = \"UpperRoman\";\n    /**\n     * Numbering triggered by I)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperRomanParenthesis\"] = 18] = \"UpperRomanParenthesis\";\n    /**\n     * Numbering triggered by (I)\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperRomanDoubleParenthesis\"] = 19] = \"UpperRomanDoubleParenthesis\";\n    /**\n     * Numbering triggered by I-\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"UpperRomanDash\"] = 20] = \"UpperRomanDash\";\n    /**\n     * Maximum value of the enum\n     */\n    CompatibleNumberingListType[CompatibleNumberingListType[\"Max\"] = 20] = \"Max\";\n})(CompatibleNumberingListType = exports.CompatibleNumberingListType || (exports.CompatibleNumberingListType = {}));\n//# sourceMappingURL=NumberingListType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatiblePasteType = void 0;\n/**\n * Enum for paste options\n */\nvar CompatiblePasteType;\n(function (CompatiblePasteType) {\n    /**\n     * Default paste behavior\n     */\n    CompatiblePasteType[CompatiblePasteType[\"Normal\"] = 0] = \"Normal\";\n    /**\n     * Paste only the plain text\n     */\n    CompatiblePasteType[CompatiblePasteType[\"AsPlainText\"] = 1] = \"AsPlainText\";\n    /**\n     * Apply the current style to pasted content\n     */\n    CompatiblePasteType[CompatiblePasteType[\"MergeFormat\"] = 2] = \"MergeFormat\";\n    /**\n     * If there is a image uri in the clipboard, paste the content as image element\n     */\n    CompatiblePasteType[CompatiblePasteType[\"AsImage\"] = 3] = \"AsImage\";\n})(CompatiblePasteType = exports.CompatiblePasteType || (exports.CompatiblePasteType = {}));\n//# sourceMappingURL=PasteType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatiblePluginEventType = void 0;\n/**\n * Editor plugin event type\n */\nvar CompatiblePluginEventType;\n(function (CompatiblePluginEventType) {\n    /**\n     * HTML KeyDown event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"KeyDown\"] = 0] = \"KeyDown\";\n    /**\n     * HTML KeyPress event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"KeyPress\"] = 1] = \"KeyPress\";\n    /**\n     * HTML KeyUp event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"KeyUp\"] = 2] = \"KeyUp\";\n    /**\n     * HTML Input / TextInput event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"Input\"] = 3] = \"Input\";\n    /**\n     * HTML CompositionEnd event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"CompositionEnd\"] = 4] = \"CompositionEnd\";\n    /**\n     * HTML MouseDown event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"MouseDown\"] = 5] = \"MouseDown\";\n    /**\n     * HTML MouseUp event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"MouseUp\"] = 6] = \"MouseUp\";\n    /**\n     * Content changed event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"ContentChanged\"] = 7] = \"ContentChanged\";\n    /**\n     * Extract Content with a DOM tree event\n     * This event is triggered when getContent() is called with triggerExtractContentEvent = true\n     * Plugin can handle this event to remove the UI only markups to return clean HTML\n     * by operating on a cloned DOM tree\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"ExtractContentWithDom\"] = 8] = \"ExtractContentWithDom\";\n    /**\n     * Before Paste event, provide a chance to change copied content\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"BeforeCutCopy\"] = 9] = \"BeforeCutCopy\";\n    /**\n     * Before Paste event, provide a chance to change paste content\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"BeforePaste\"] = 10] = \"BeforePaste\";\n    /**\n     * Let plugin know editor is ready now\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"EditorReady\"] = 11] = \"EditorReady\";\n    /**\n     * Let plugin know editor is about to dispose\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"BeforeDispose\"] = 12] = \"BeforeDispose\";\n    /**\n     * Pending format state (bold, italic, underline, ... with collapsed selection) is changed\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"PendingFormatStateChanged\"] = 13] = \"PendingFormatStateChanged\";\n    /**\n     * Scroll event triggered by scroll container\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"Scroll\"] = 14] = \"Scroll\";\n    /**\n     * Operating on an entity. See enum EntityOperation for more details about each operation\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"EntityOperation\"] = 15] = \"EntityOperation\";\n    /**\n     * HTML ContextMenu event\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"ContextMenu\"] = 16] = \"ContextMenu\";\n    /**\n     * Editor has entered shadow edit mode\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"EnteredShadowEdit\"] = 17] = \"EnteredShadowEdit\";\n    /**\n     * Editor is about to leave shadow edit mode\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"LeavingShadowEdit\"] = 18] = \"LeavingShadowEdit\";\n    /**\n     * Content of image is being changed from client side\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"EditImage\"] = 19] = \"EditImage\";\n    /**\n     * Content of editor is about to be cleared by SetContent API, handle this event to cache anything you need\n     * before it is gone\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"BeforeSetContent\"] = 20] = \"BeforeSetContent\";\n    /**\n     * Zoom scale value is changed, triggered by Editor.setZoomScale() when set a different scale number\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"ZoomChanged\"] = 21] = \"ZoomChanged\";\n    /**\n     * EXPERIMENTAL FEATURE\n     * Editor changed the selection.\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"SelectionChanged\"] = 22] = \"SelectionChanged\";\n    /**\n     * EXPERIMENTAL FEATURE\n     * Editor content is about to be changed by keyboard event.\n     * This is only used by Content Model editing\n     */\n    CompatiblePluginEventType[CompatiblePluginEventType[\"BeforeKeyboardEditing\"] = 23] = \"BeforeKeyboardEditing\";\n})(CompatiblePluginEventType = exports.CompatiblePluginEventType || (exports.CompatiblePluginEventType = {}));\n//# sourceMappingURL=PluginEventType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatiblePositionType = void 0;\n/**\n * Represent the type of a position\n */\nvar CompatiblePositionType;\n(function (CompatiblePositionType) {\n    /**\n     * At the beginning of a node\n     */\n    CompatiblePositionType[CompatiblePositionType[\"Begin\"] = 0] = \"Begin\";\n    /**\n     * At the end of a node\n     */\n    CompatiblePositionType[CompatiblePositionType[\"End\"] = -1] = \"End\";\n    /**\n     * Before a node\n     */\n    CompatiblePositionType[CompatiblePositionType[\"Before\"] = -2] = \"Before\";\n    /**\n     * After a node\n     */\n    CompatiblePositionType[CompatiblePositionType[\"After\"] = -3] = \"After\";\n})(CompatiblePositionType = exports.CompatiblePositionType || (exports.CompatiblePositionType = {}));\n//# sourceMappingURL=PositionType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleQueryScope = void 0;\n/**\n * Query scope for queryElements() API\n */\nvar CompatibleQueryScope;\n(function (CompatibleQueryScope) {\n    /**\n     * Query from the whole body of root node. This is default value.\n     */\n    CompatibleQueryScope[CompatibleQueryScope[\"Body\"] = 0] = \"Body\";\n    /**\n     * Query elements on a given selection (intersect)\n     * The result element can contain the selection, contain part of selection, or inside selection\n     */\n    CompatibleQueryScope[CompatibleQueryScope[\"OnSelection\"] = 1] = \"OnSelection\";\n    /**\n     * Query elements inside a given selection only\n     */\n    CompatibleQueryScope[CompatibleQueryScope[\"InSelection\"] = 2] = \"InSelection\";\n})(CompatibleQueryScope = exports.CompatibleQueryScope || (exports.CompatibleQueryScope = {}));\n//# sourceMappingURL=QueryScope.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleRegionType = void 0;\n/**\n * Type of all possible regions. Currently we only support region of Table\n */\nvar CompatibleRegionType;\n(function (CompatibleRegionType) {\n    /**\n     * Region split by Table\n     */\n    CompatibleRegionType[CompatibleRegionType[\"Table\"] = 0] = \"Table\";\n})(CompatibleRegionType = exports.CompatibleRegionType || (exports.CompatibleRegionType = {}));\n//# sourceMappingURL=RegionType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleSelectionRangeTypes = void 0;\n/**\n * Types of Selection Ranges that the SelectionRangeEx can return\n */\nvar CompatibleSelectionRangeTypes;\n(function (CompatibleSelectionRangeTypes) {\n    /**\n     * Normal selection range provided by browser.\n     */\n    CompatibleSelectionRangeTypes[CompatibleSelectionRangeTypes[\"Normal\"] = 0] = \"Normal\";\n    /**\n     * Selection made inside of a single table.\n     */\n    CompatibleSelectionRangeTypes[CompatibleSelectionRangeTypes[\"TableSelection\"] = 1] = \"TableSelection\";\n    /**\n     * Selection made in a image.\n     */\n    CompatibleSelectionRangeTypes[CompatibleSelectionRangeTypes[\"ImageSelection\"] = 2] = \"ImageSelection\";\n})(CompatibleSelectionRangeTypes = exports.CompatibleSelectionRangeTypes || (exports.CompatibleSelectionRangeTypes = {}));\n//# sourceMappingURL=SelectionRangeTypes.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleTableBorderFormat = void 0;\n/**\n * Table format border\n */\nvar CompatibleTableBorderFormat;\n(function (CompatibleTableBorderFormat) {\n    /**\n     * All border of the table are displayed\n     *  __ __ __\n     * |__|__|__|\n     * |__|__|__|\n     * |__|__|__|\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"DEFAULT\"] = 0] = \"DEFAULT\";\n    /**\n     * Middle vertical border are not displayed\n     *  __ __ __\n     * |__ __ __|\n     * |__ __ __|\n     * |__ __ __|\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"LIST_WITH_SIDE_BORDERS\"] = 1] = \"LIST_WITH_SIDE_BORDERS\";\n    /**\n     * All borders except header rows borders are displayed\n     *  __ __ __\n     *  __|__|__\n     *  __|__|__\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"NO_HEADER_BORDERS\"] = 2] = \"NO_HEADER_BORDERS\";\n    /**\n     * The left and right border of the table are not displayed\n     *  __ __ __\n     *  __|__|__\n     *  __|__|__\n     *  __|__|__\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"NO_SIDE_BORDERS\"] = 3] = \"NO_SIDE_BORDERS\";\n    /**\n     * Only the borders that divides the header row, first column and externals are displayed\n     *  __ __ __\n     * |__ __ __|\n     * |  |     |\n     * |__|__ __|\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"FIRST_COLUMN_HEADER_EXTERNAL\"] = 4] = \"FIRST_COLUMN_HEADER_EXTERNAL\";\n    /**\n     * The header row has no vertical border, except for the first one\n     * The first column has no horizontal border, except for the first one\n     *  __ __ __\n     * |__ __ __\n     * |  |__|__|\n     * |  |__|__|\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"ESPECIAL_TYPE_1\"] = 5] = \"ESPECIAL_TYPE_1\";\n    /**\n     * The header row has no vertical border, except for the first one\n     * The only horizontal border of the table is the top and bottom of header row\n     *  __ __ __\n     * |__ __ __\n     * |  |     |\n     * |  |     |\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"ESPECIAL_TYPE_2\"] = 6] = \"ESPECIAL_TYPE_2\";\n    /**\n     * The only borders are the bottom of header row and the right border of first column\n     *  __ __ __\n     *    |\n     *    |\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"ESPECIAL_TYPE_3\"] = 7] = \"ESPECIAL_TYPE_3\";\n    /**\n     * No border\n     */\n    CompatibleTableBorderFormat[CompatibleTableBorderFormat[\"CLEAR\"] = 8] = \"CLEAR\";\n})(CompatibleTableBorderFormat = exports.CompatibleTableBorderFormat || (exports.CompatibleTableBorderFormat = {}));\n//# sourceMappingURL=TableBorderFormat.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleTableOperation = void 0;\n/**\n * Operations used by editTable() API\n */\nvar CompatibleTableOperation;\n(function (CompatibleTableOperation) {\n    /**\n     * Insert a row above current row\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"InsertAbove\"] = 0] = \"InsertAbove\";\n    /**\n     * Insert a row below current row\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"InsertBelow\"] = 1] = \"InsertBelow\";\n    /**\n     * Insert a column on the left of current column\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"InsertLeft\"] = 2] = \"InsertLeft\";\n    /**\n     * Insert a column on the right of current column\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"InsertRight\"] = 3] = \"InsertRight\";\n    /**\n     * Delete the whole table\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"DeleteTable\"] = 4] = \"DeleteTable\";\n    /**\n     * Delete current column\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"DeleteColumn\"] = 5] = \"DeleteColumn\";\n    /**\n     * Delete current row\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"DeleteRow\"] = 6] = \"DeleteRow\";\n    /**\n     * Merge current row with the row above\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"MergeAbove\"] = 7] = \"MergeAbove\";\n    /**\n     * Merge current row with the row below\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"MergeBelow\"] = 8] = \"MergeBelow\";\n    /**\n     * Merge current column with the column on the left\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"MergeLeft\"] = 9] = \"MergeLeft\";\n    /**\n     * Merge current column with the column on the right\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"MergeRight\"] = 10] = \"MergeRight\";\n    /**\n     * Merge all selected cells\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"MergeCells\"] = 11] = \"MergeCells\";\n    /**\n     * Split current table cell horizontally\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"SplitHorizontally\"] = 12] = \"SplitHorizontally\";\n    /**\n     * Split current table cell vertically\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"SplitVertically\"] = 13] = \"SplitVertically\";\n    /**\n     * Align current table at the center\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCenter\"] = 14] = \"AlignCenter\";\n    /**\n     * Align current table at the left\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignLeft\"] = 15] = \"AlignLeft\";\n    /**\n     * Align current table at the right\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignRight\"] = 16] = \"AlignRight\";\n    /**\n     * Align current content table cell at the left\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCellLeft\"] = 17] = \"AlignCellLeft\";\n    /**\n     * Align current content table cell at the center\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCellCenter\"] = 18] = \"AlignCellCenter\";\n    /**\n     * Align current content table cell at the right\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCellRight\"] = 19] = \"AlignCellRight\";\n    /**\n     * Align current content table cell at the top\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCellTop\"] = 20] = \"AlignCellTop\";\n    /**\n     * Align current table cell at the middle\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCellMiddle\"] = 21] = \"AlignCellMiddle\";\n    /**\n     * Align current table cell at the bottom\n     */\n    CompatibleTableOperation[CompatibleTableOperation[\"AlignCellBottom\"] = 22] = \"AlignCellBottom\";\n})(CompatibleTableOperation = exports.CompatibleTableOperation || (exports.CompatibleTableOperation = {}));\n//# sourceMappingURL=TableOperation.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CompatibleTableOperation = exports.CompatibleTableBorderFormat = exports.CompatibleSelectionRangeTypes = exports.CompatibleRegionType = exports.CompatibleQueryScope = exports.CompatiblePositionType = exports.CompatiblePluginEventType = exports.CompatiblePasteType = exports.CompatibleNumberingListType = exports.CompatibleNodeType = exports.CompatibleListType = exports.CompatibleKnownPasteSourceType = exports.CompatibleKnownCreateElementDataIndex = exports.CompatibleKnownAnnounceStrings = exports.CompatibleKeys = exports.CompatibleIndentation = exports.CompatibleImageEditOperation = exports.CompatibleGetContentMode = exports.CompatibleFontSizeChange = exports.CompatibleExperimentalFeatures = exports.CompatibleEntityOperation = exports.CompatibleEntityClasses = exports.CompatibleDocumentPosition = exports.CompatibleDocumentCommand = exports.CompatibleDirection = exports.CompatibleDelimiterClasses = exports.CompatibleDefinitionType = exports.CompatibleDarkModeDatasetNames = exports.CompatibleContentType = exports.CompatibleContentTypePrefix = exports.CompatibleContentPosition = exports.CompatibleColorTransformDirection = exports.CompatibleClearFormatMode = exports.CompatibleChangeSource = exports.CompatibleCapitalization = exports.CompatibleBulletListType = exports.CompatibleAlignment = void 0;\nvar Alignment_1 = require(\"./Alignment\");\nObject.defineProperty(exports, \"CompatibleAlignment\", { enumerable: true, get: function () { return Alignment_1.CompatibleAlignment; } });\nvar BulletListType_1 = require(\"./BulletListType\");\nObject.defineProperty(exports, \"CompatibleBulletListType\", { enumerable: true, get: function () { return BulletListType_1.CompatibleBulletListType; } });\nvar Capitalization_1 = require(\"./Capitalization\");\nObject.defineProperty(exports, \"CompatibleCapitalization\", { enumerable: true, get: function () { return Capitalization_1.CompatibleCapitalization; } });\nvar ChangeSource_1 = require(\"./ChangeSource\");\nObject.defineProperty(exports, \"CompatibleChangeSource\", { enumerable: true, get: function () { return ChangeSource_1.CompatibleChangeSource; } });\nvar ClearFormatMode_1 = require(\"./ClearFormatMode\");\nObject.defineProperty(exports, \"CompatibleClearFormatMode\", { enumerable: true, get: function () { return ClearFormatMode_1.CompatibleClearFormatMode; } });\nvar ColorTransformDirection_1 = require(\"./ColorTransformDirection\");\nObject.defineProperty(exports, \"CompatibleColorTransformDirection\", { enumerable: true, get: function () { return ColorTransformDirection_1.CompatibleColorTransformDirection; } });\nvar ContentPosition_1 = require(\"./ContentPosition\");\nObject.defineProperty(exports, \"CompatibleContentPosition\", { enumerable: true, get: function () { return ContentPosition_1.CompatibleContentPosition; } });\nvar ContentType_1 = require(\"./ContentType\");\nObject.defineProperty(exports, \"CompatibleContentTypePrefix\", { enumerable: true, get: function () { return ContentType_1.CompatibleContentTypePrefix; } });\nObject.defineProperty(exports, \"CompatibleContentType\", { enumerable: true, get: function () { return ContentType_1.CompatibleContentType; } });\nvar DarkModeDatasetNames_1 = require(\"./DarkModeDatasetNames\");\nObject.defineProperty(exports, \"CompatibleDarkModeDatasetNames\", { enumerable: true, get: function () { return DarkModeDatasetNames_1.CompatibleDarkModeDatasetNames; } });\nvar DefinitionType_1 = require(\"./DefinitionType\");\nObject.defineProperty(exports, \"CompatibleDefinitionType\", { enumerable: true, get: function () { return DefinitionType_1.CompatibleDefinitionType; } });\nvar DelimiterClasses_1 = require(\"./DelimiterClasses\");\nObject.defineProperty(exports, \"CompatibleDelimiterClasses\", { enumerable: true, get: function () { return DelimiterClasses_1.CompatibleDelimiterClasses; } });\nvar Direction_1 = require(\"./Direction\");\nObject.defineProperty(exports, \"CompatibleDirection\", { enumerable: true, get: function () { return Direction_1.CompatibleDirection; } });\nvar DocumentCommand_1 = require(\"./DocumentCommand\");\nObject.defineProperty(exports, \"CompatibleDocumentCommand\", { enumerable: true, get: function () { return DocumentCommand_1.CompatibleDocumentCommand; } });\nvar DocumentPosition_1 = require(\"./DocumentPosition\");\nObject.defineProperty(exports, \"CompatibleDocumentPosition\", { enumerable: true, get: function () { return DocumentPosition_1.CompatibleDocumentPosition; } });\nvar EntityClasses_1 = require(\"./EntityClasses\");\nObject.defineProperty(exports, \"CompatibleEntityClasses\", { enumerable: true, get: function () { return EntityClasses_1.CompatibleEntityClasses; } });\nvar EntityOperation_1 = require(\"./EntityOperation\");\nObject.defineProperty(exports, \"CompatibleEntityOperation\", { enumerable: true, get: function () { return EntityOperation_1.CompatibleEntityOperation; } });\nvar ExperimentalFeatures_1 = require(\"./ExperimentalFeatures\");\nObject.defineProperty(exports, \"CompatibleExperimentalFeatures\", { enumerable: true, get: function () { return ExperimentalFeatures_1.CompatibleExperimentalFeatures; } });\nvar FontSizeChange_1 = require(\"./FontSizeChange\");\nObject.defineProperty(exports, \"CompatibleFontSizeChange\", { enumerable: true, get: function () { return FontSizeChange_1.CompatibleFontSizeChange; } });\nvar GetContentMode_1 = require(\"./GetContentMode\");\nObject.defineProperty(exports, \"CompatibleGetContentMode\", { enumerable: true, get: function () { return GetContentMode_1.CompatibleGetContentMode; } });\nvar ImageEditOperation_1 = require(\"./ImageEditOperation\");\nObject.defineProperty(exports, \"CompatibleImageEditOperation\", { enumerable: true, get: function () { return ImageEditOperation_1.CompatibleImageEditOperation; } });\nvar Indentation_1 = require(\"./Indentation\");\nObject.defineProperty(exports, \"CompatibleIndentation\", { enumerable: true, get: function () { return Indentation_1.CompatibleIndentation; } });\nvar Keys_1 = require(\"./Keys\");\nObject.defineProperty(exports, \"CompatibleKeys\", { enumerable: true, get: function () { return Keys_1.CompatibleKeys; } });\nvar KnownAnnounceStrings_1 = require(\"./KnownAnnounceStrings\");\nObject.defineProperty(exports, \"CompatibleKnownAnnounceStrings\", { enumerable: true, get: function () { return KnownAnnounceStrings_1.CompatibleKnownAnnounceStrings; } });\nvar KnownCreateElementDataIndex_1 = require(\"./KnownCreateElementDataIndex\");\nObject.defineProperty(exports, \"CompatibleKnownCreateElementDataIndex\", { enumerable: true, get: function () { return KnownCreateElementDataIndex_1.CompatibleKnownCreateElementDataIndex; } });\nvar KnownPasteSourceType_1 = require(\"./KnownPasteSourceType\");\nObject.defineProperty(exports, \"CompatibleKnownPasteSourceType\", { enumerable: true, get: function () { return KnownPasteSourceType_1.CompatibleKnownPasteSourceType; } });\nvar ListType_1 = require(\"./ListType\");\nObject.defineProperty(exports, \"CompatibleListType\", { enumerable: true, get: function () { return ListType_1.CompatibleListType; } });\nvar NodeType_1 = require(\"./NodeType\");\nObject.defineProperty(exports, \"CompatibleNodeType\", { enumerable: true, get: function () { return NodeType_1.CompatibleNodeType; } });\nvar NumberingListType_1 = require(\"./NumberingListType\");\nObject.defineProperty(exports, \"CompatibleNumberingListType\", { enumerable: true, get: function () { return NumberingListType_1.CompatibleNumberingListType; } });\nvar PasteType_1 = require(\"./PasteType\");\nObject.defineProperty(exports, \"CompatiblePasteType\", { enumerable: true, get: function () { return PasteType_1.CompatiblePasteType; } });\nvar PluginEventType_1 = require(\"./PluginEventType\");\nObject.defineProperty(exports, \"CompatiblePluginEventType\", { enumerable: true, get: function () { return PluginEventType_1.CompatiblePluginEventType; } });\nvar PositionType_1 = require(\"./PositionType\");\nObject.defineProperty(exports, \"CompatiblePositionType\", { enumerable: true, get: function () { return PositionType_1.CompatiblePositionType; } });\nvar QueryScope_1 = require(\"./QueryScope\");\nObject.defineProperty(exports, \"CompatibleQueryScope\", { enumerable: true, get: function () { return QueryScope_1.CompatibleQueryScope; } });\nvar RegionType_1 = require(\"./RegionType\");\nObject.defineProperty(exports, \"CompatibleRegionType\", { enumerable: true, get: function () { return RegionType_1.CompatibleRegionType; } });\nvar SelectionRangeTypes_1 = require(\"./SelectionRangeTypes\");\nObject.defineProperty(exports, \"CompatibleSelectionRangeTypes\", { enumerable: true, get: function () { return SelectionRangeTypes_1.CompatibleSelectionRangeTypes; } });\nvar TableBorderFormat_1 = require(\"./TableBorderFormat\");\nObject.defineProperty(exports, \"CompatibleTableBorderFormat\", { enumerable: true, get: function () { return TableBorderFormat_1.CompatibleTableBorderFormat; } });\nvar TableOperation_1 = require(\"./TableOperation\");\nObject.defineProperty(exports, \"CompatibleTableOperation\", { enumerable: true, get: function () { return TableOperation_1.CompatibleTableOperation; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=index.js.map","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\n(0, tslib_1.__exportStar)(require(\"./browser/index\"), exports);\n(0, tslib_1.__exportStar)(require(\"./corePluginState/index\"), exports);\n(0, tslib_1.__exportStar)(require(\"./compatibleEnum/index\"), exports);\n(0, tslib_1.__exportStar)(require(\"./event/index\"), exports);\n(0, tslib_1.__exportStar)(require(\"./interface/index\"), exports);\n(0, tslib_1.__exportStar)(require(\"./type/index\"), exports);\n//# sourceMappingURL=compatibleTypes.js.map","import {\r\n    Editor,\r\n    ContentEdit,\r\n    Paste,\r\n    HyperLink,\r\n    ImageEdit,\r\n    toggleBold,\r\n    toggleItalic,\r\n    toggleUnderline,\r\n    toggleStrikethrough,\r\n    toggleListType,\r\n    setAlignment,\r\n    toggleBlockQuote,\r\n    toggleCodeBlock,\r\n    setDirection,\r\n    clearFormat, toggleSuperscript, toggleSubscript, setIndentation,\r\n    createElement,\r\n    insertImage,\r\n    getFormatState,\r\n    createLink, removeLink,\r\n    setHeadingLevel,\r\n} from 'roosterjs';\r\n\r\nimport \"./index.less\"\r\nimport \"./icons.less\"\r\n\r\nconst BUILD_VERSION = \"__version__\"\r\n\r\nconst isObject = item => (item && typeof item === 'object' && !Array.isArray(item))\r\nconst merge = (target, ...sources) => {\r\n    if (!sources.length) return target;\r\n    const source = sources.shift();\r\n\r\n    if (isObject(target) && isObject(source)) {\r\n        for (const key in source) {\r\n            if (isObject(source[key])) {\r\n                if (!target[key]) Object.assign(target, { [key]: {} });\r\n                merge(target[key], source[key]);\r\n            } else {\r\n                Object.assign(target, { [key]: source[key] });\r\n            }\r\n        }\r\n    }\r\n\r\n    return merge(target, ...sources);\r\n}\r\n\r\nconst css = (el, prop) => window.getComputedStyle(el, null)[prop]\r\n\r\nconst EditorDefaultOptions = {\r\n    shortcut: \"alt+ctrl+k\",\r\n    serverEndpoint: '',\r\n    maxHeight: 0,\r\n}\r\n\r\nconst ENEI_EDITOR_MODE_CLASS = 'enei_editor_mode'\r\nconst ENEI_EDITOR_TARGET_CLASS = '[enei]'\r\nconst storage = sessionStorage\r\n\r\nconst DLG_LINK = `\r\n<dialog id=\"enei-dialog-link\" class=\"enei-dialog js-enei-dialog-link\">\r\n    <form method=\"dialog\">\r\n        <header>\r\n            <h3>Create Link</h3>        \r\n        </header>\r\n        <main>    \r\n            <div>\r\n                <label>Web Address (URL)</label>\r\n                <input type=\"url\" name=\"enei-dialog-link__url\">\r\n            </div>\r\n            <div>\r\n                <label>Display as</label>\r\n                <input type=\"text\" name=\"enei-dialog-link__display\">\r\n            </div>\r\n        </main>\r\n        <menu>\r\n            <button class=\"enei__button js-enei-dialog-link__button-ok\" type=\"submit\" value=\"ok\">OK</button>\r\n            <button class=\"enei__button js-enei-dialog-link__button-cancel\" type=\"reset\" value=\"cancel\">Cancel</button>\r\n        </menu>\r\n    </form>\r\n</dialog>\r\n`\r\n\r\nconst EDITOR_HTML = `\r\n${DLG_LINK}\r\n<div class=\"enei__toolbar\">\r\n    <button class=\"enei__tool-button js-enei-bold\" title=\"Bold\"><span class=\"ei-bold\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-italic\" title=\"Italic\"><span class=\"ei-italic\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-underline\" title=\"Underline\"><span class=\"ei-underline\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-strike\" title=\"Strike\"><span class=\"ei-strike\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-superscript\" title=\"Superscript\"><span class=\"ei-superscript\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-subscript\" title=\"Subscript\"><span class=\"ei-subscript\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-list-num\" title=\"Numbered List\"><span class=\"ei-list1\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-list-bull\" title=\"Bulleted List\"><span class=\"ei-list2\"></span></button>\r\n    \r\n    <div class=\"enei__dropdown\">\r\n        <button class=\"enei__tool-button js-enei-heading\" title=\"Heading\">R</button>\r\n        <ul>\r\n            <li value=\"1\">Heading 1</li>\r\n            <li value=\"2\">Heading 2</li>\r\n            <li value=\"3\">Heading 3</li>\r\n            <li value=\"4\">Heading 4</li>\r\n            <li value=\"5\">Heading 5</li>\r\n            <li value=\"6\">Heading 6</li>\r\n            <li class=\"divider\"></li>\r\n            <li value=\"0\">Regular Text</li>\r\n        </ul>\r\n    </div>\r\n\r\n    <button class=\"enei__tool-button js-enei-p-left\" title=\"Align Left\"><span class=\"ei-paragraph-left\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-p-center\" title=\"Align Center\"><span class=\"ei-paragraph-center\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-p-right\" title=\"Align Right\"><span class=\"ei-paragraph-right\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-link\" title=\"Insert Link\"><span class=\"ei-link\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-unlink\" title=\"Remove Link\"><span class=\"ei-switch\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-image\" title=\"Insert Image\"><span class=\"ei-image\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-quote\" title=\"Quoted text\"><span class=\"ei-quotes-right\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-code\" title=\"Code\"><span class=\"ei-embed\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-indent-increase\" title=\"Increase Indent\"><span class=\"ei-indent-increase\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-indent-decrease\" title=\"Decrease Indent\"><span class=\"ei-indent-decrease\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-ltr\" title=\"LTR Text\"><span class=\"ei-ltr\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-rtl\" title=\"RTL Text\"><span class=\"ei-rtl\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-clear-format\" title=\"Clear Format\"><span class=\"ei-paint-format\"></span></button>\r\n\r\n    <button class=\"enei__tool-button js-enei-undo\" title=\"Undo Operation\"><span class=\"ei-undo\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-redo\" title=\"Redo Operation\"><span class=\"ei-redo\"></span></button>\r\n    <button class=\"enei__tool-button js-enei-revert\" title=\"Revert Content\"><span class=\"ei-revert\"></span></button>\r\n\r\n</div>\r\n<div class=\"enei__text\"></div>\r\n<div class=\"enei__actions\">\r\n    <button class=\"enei__button js-enei-ok\">Save</button>\r\n    <button class=\"enei__button js-enei-cancel\">Cancel</button>\r\n    <div style=\"margin-left: auto;\">\r\n        <span style=\"font-size: 10px;\">v${BUILD_VERSION}</span>\r\n        <a href=\"https://github.com/olton/enei-editor\" target=\"_blank\" class=\"enei__button js-enei-github\" style=\"background-color: transparent;\"><span class=\"ei-github\"></span></a>\r\n    </div>\r\n</div>\r\n`\r\n\r\nexport class EneiEditor {\r\n    body = null\r\n    editorContainer = null\r\n    editor = null\r\n    overlay = null\r\n    content = null\r\n    current = null\r\n    toolbar = null\r\n    options = {}\r\n    originalContent = null\r\n\r\n    constructor(options) {\r\n        this.options = merge({}, EditorDefaultOptions, options)\r\n        this.addEvents()\r\n        this.body = document.querySelector(\"body\")\r\n        this.restoreBlocks()\r\n    }\r\n\r\n    createEditor(){\r\n        this.editorContainer = document.createElement(\"div\")\r\n        this.editorContainer.className = 'enei__editor'\r\n        this.editorContainer.innerHTML = EDITOR_HTML\r\n        this.overlay.append(this.editorContainer)\r\n    }\r\n\r\n    createOverlay(){\r\n        this.overlay = document.createElement(\"div\")\r\n        this.overlay.classList.add(\"enei__overlay\")\r\n        this.body.append(this.overlay)\r\n        this.overlay.addEventListener('wheel', e => {\r\n            // e.preventDefault()\r\n            e.stopPropagation()\r\n        })\r\n    }\r\n\r\n    openEditor(){\r\n        const self = this, o = this.options, forElement = this.current\r\n        let {top, left, width} = forElement.getBoundingClientRect()\r\n        if (top < 56) {\r\n            top = 112\r\n        }\r\n        top -= 56\r\n        this.createOverlay()\r\n        this.createEditor()\r\n        this.originalContent = forElement.innerHTML\r\n        this.linkDialog = document.querySelector(\"#enei-dialog-link\")\r\n        this.content = this.editorContainer.querySelector(\".enei__text\")\r\n        this.toolbar = this.editorContainer.querySelector(\".enei__toolbar\")\r\n        this.content.style.fontSize = css(forElement, \"font-size\")\r\n        this.editorContainer.style.top = `${top}px`\r\n        this.editorContainer.style.left = `${left}px`\r\n        this.editorContainer.style.width = `${width}px`\r\n        this.editorContainer.style.maxHeight = `${o.maxHeight || window.innerHeight - top - 56}px`\r\n        this.editor = new Editor(this.content, {\r\n            plugins: [\r\n                new ContentEdit(),\r\n                new Paste(true /*useDirectPaste*/),\r\n                new HyperLink(href => 'Ctrl+click to open link ' + href),\r\n                new ImageEdit(),\r\n            ],\r\n            initialContent: this.originalContent,\r\n        })\r\n\r\n        const updateEditorHeight = () => {\r\n            self.editorContainer.style.height = `${this.content.height + this.toolbar.scrollHeight + 70}px`\r\n        }\r\n\r\n        const updateButtonState = editorState => {\r\n            /*\r\n            * {\r\n                \"isMultilineSelection\": false,\r\n                \"canAddImageAltText\": false,\r\n                \"isInTable\": false,\r\n                \"tableFormat\": {},\r\n                \"canMergeTableCell\": false,\r\n                \"fontName\": \"-apple-system, system-ui, BlinkMacSystemFont, \\\"Segoe UI\\\", Roboto, Ubuntu, \\\"Helvetica Neue\\\", sans-serif\",\r\n                \"fontSize\": \"12pt\",\r\n                \"textColor\": \"rgb(0, 0, 0)\",\r\n                \"backgroundColor\": \"rgb(255, 255, 255)\",\r\n                \"lineHeight\": \"24px\",\r\n                \"marginTop\": \"0px\",\r\n                \"marginBottom\": \"0px\",\r\n                \"fontWeight\": \"400\",\r\n                \"isDarkMode\": false,\r\n                \"zoomScale\": 1\r\n            }\r\n            * */\r\n            const button = name => this.toolbar.querySelector(`.js-enei-${name}`)\r\n            const setButtonState = (name, state) => button(name).classList[state ? 'add' : 'remove']('active')\r\n\r\n            const {isBold, isItalic, isUnderline, isStrikeThrough, isSubscript, isSuperscript, isBlockQuote,\r\n            isCodeInline, isCodeBlock, direction, canUndo, canRedo, textAlign, isBullet, isNumbering, canUnlink, headingLevel, headerLevel} = editorState\r\n\r\n            setButtonState('bold', isBold)\r\n            setButtonState('italic', isItalic)\r\n            setButtonState('underline', isUnderline)\r\n            setButtonState('strike', isStrikeThrough)\r\n            setButtonState('subscript', isSubscript)\r\n            setButtonState('superscript', isSuperscript)\r\n            setButtonState('quote', isBlockQuote)\r\n            setButtonState('code', isCodeBlock || isCodeInline)\r\n            setButtonState('ltr', direction === 'ltr')\r\n            setButtonState('rtl', direction === 'rtl')\r\n            setButtonState('undo', canUndo)\r\n            setButtonState('redo', canRedo)\r\n            setButtonState('p-left', ['start', 'left'].includes(textAlign))\r\n            setButtonState('p-center', textAlign === 'center')\r\n            setButtonState('p-right', ['end', 'right'].includes(textAlign))\r\n            setButtonState('list-num', isNumbering)\r\n            setButtonState('list-bull', isBullet)\r\n\r\n            button('unlink').disabled = !canUnlink\r\n\r\n            button('heading').innerHTML = headingLevel > 0 ? `H${headingLevel}` : \"R\"\r\n        }\r\n\r\n        ;[\"keyup\", \"mouseup\", \"input\", \"click\", \"contentchanged\"].forEach( ev => {\r\n            this.content.addEventListener(ev, () => {updateButtonState(getFormatState(this.editor))})\r\n        })\r\n\r\n        const focus = () => {\r\n            this.editor.focus()\r\n            updateEditorHeight()\r\n            updateButtonState(getFormatState(this.editor))\r\n        }\r\n\r\n        focus()\r\n\r\n        this.content.addEventListener(\"input\", () => {\r\n            updateEditorHeight()\r\n        })\r\n\r\n        const addEvent = (btn, fun) => {this.editorContainer.querySelector(`.js-enei-${btn}`).addEventListener(\"click\", fun)}\r\n\r\n        addEvent('cancel', () => {\r\n            this.closeEditor()\r\n        })\r\n\r\n        addEvent('ok', async () => {\r\n            await this.saveEditor()\r\n        })\r\n\r\n        addEvent('heading', (e) => {\r\n            const btn = e.target\r\n            btn.classList.toggle('active')\r\n        })\r\n\r\n        this.toolbar.querySelectorAll(\".js-enei-heading + ul > li\").forEach(el => {\r\n            el.addEventListener(\"click\", () => {\r\n                const level = +el.getAttribute('value')\r\n                setHeadingLevel(this.editor, level)\r\n                this.toolbar.querySelector(`.js-enei-heading`).classList.remove(\"active\")\r\n                focus()\r\n            })\r\n        })\r\n\r\n        addEvent(\"bold\", () => {\r\n            toggleBold(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"italic\", () => {\r\n            toggleItalic(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"underline\", () => {\r\n            toggleUnderline(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"strike\", () => {\r\n            toggleStrikethrough(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"superscript\", () => {\r\n            toggleSuperscript(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"subscript\", () => {\r\n            toggleSubscript(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"list-num\", () => {\r\n            toggleListType(this.editor, 1)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"list-bull\", () => {\r\n            toggleListType(this.editor, 2)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"p-left\", () => {\r\n            setAlignment(this.editor, 0)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"p-center\", () => {\r\n            setAlignment(this.editor, 1)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"p-right\", () => {\r\n            setAlignment(this.editor, 2)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"quote\", () => {\r\n            toggleBlockQuote(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"code\", () => {\r\n            toggleCodeBlock(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"indent-increase\", () => {\r\n            setIndentation(this.editor, 0)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"indent-decrease\", () => {\r\n            setIndentation(this.editor, 1)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"undo\", () => {\r\n            this.editor.undo()\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"redo\", () => {\r\n            this.editor.redo()\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"ltr\", () => {\r\n            setDirection(this.editor, 0)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"rtl\", () => {\r\n            setDirection(this.editor, 1)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"clear-format\", () => {\r\n            clearFormat(this.editor, 0)\r\n            focus()\r\n        })\r\n\r\n        addEvent('unlink', () => {\r\n            removeLink(this.editor)\r\n            focus()\r\n        })\r\n\r\n        addEvent(\"link\", () => {\r\n            this.linkDialog.querySelector('[name=enei-dialog-link__display]').value = this.editor.getSelectionRange()\r\n            this.linkDialog.showModal()\r\n            focus()\r\n        })\r\n\r\n        this.linkDialog.querySelector(\".js-enei-dialog-link__button-cancel\").addEventListener(\"click\", () => {\r\n            this.linkDialog.close();\r\n        })\r\n\r\n        this.linkDialog.addEventListener(\"close\", () => {\r\n            if (this.linkDialog.returnValue !== \"ok\") {\r\n                return\r\n            }\r\n            let link = this.linkDialog.querySelector('[name=enei-dialog-link__url]').value.trim()\r\n            let display = this.linkDialog.querySelector('[name=enei-dialog-link__display]').value.trim()\r\n            if (!link) {\r\n                return\r\n            }\r\n            if (!display) {\r\n                display = link\r\n            }\r\n            createLink(this.editor, link, display, display, \"_blank\")\r\n        })\r\n\r\n        addEvent(\"image\", () => {\r\n            const document = this.editor.getDocument()\r\n            const fileInput = createElement({\r\n                tag: \"input\",\r\n                attributes: {\r\n                    type: \"file\",\r\n                    accept: \"image/*\",\r\n                    display: \"none\"\r\n                }\r\n            }, this.editor.getDocument())\r\n            document.body.appendChild(fileInput)\r\n            fileInput.addEventListener('change', () => {\r\n                if (fileInput.files) {\r\n                    for (let i = 0; i < fileInput.files.length; i++) {\r\n                        insertImage(this.editor, fileInput.files[i]);\r\n                    }\r\n                }\r\n            })\r\n            try {\r\n                fileInput.click()\r\n            } finally {\r\n                document.body.removeChild(fileInput)\r\n            }\r\n\r\n            focus()\r\n        })\r\n\r\n        addEvent('revert', () => {\r\n            this.editor.setContent(this.originalContent)\r\n        })\r\n    }\r\n\r\n    async saveEditor(){\r\n        const newContent = this.content.innerHTML\r\n        const forElement = this.current\r\n        forElement.innerHTML = newContent\r\n        const id = forElement.getAttribute('enei')\r\n        const result = this.options.serverEndpoint ? await this.commitBlock(id, newContent) : id\r\n        if (!result) {\r\n            this.current.innerHTML = this.originalContent\r\n        }\r\n        this.closeEditor()\r\n    }\r\n\r\n    closeEditor(){\r\n        this.editor.dispose()\r\n        this.overlay.remove()\r\n    }\r\n\r\n    addEvents(){\r\n        const self = this, o = this.options\r\n\r\n        window.addEventListener(\"keydown\", async function(event){\r\n            if (event.repeat) return\r\n\r\n            const keys = []\r\n\r\n            if (event.altKey) keys.push('alt')\r\n            if (event.ctrlKey || event.metaKey) keys.push('ctrl')\r\n            if (event.shiftKey) keys.push('shift')\r\n            if (event.key) keys.push(event.key)\r\n\r\n            const keySeq = keys.join(\"+\")\r\n\r\n            console.log(\"You pressed: \"+ keySeq)\r\n\r\n            if ( \"ctrl+Enter\" === keySeq && self.editor) {\r\n                await self.saveEditor()\r\n            }\r\n\r\n            if ( \"Escape\" === keySeq && self.editor) {\r\n                self.closeEditor()\r\n            }\r\n\r\n            if ( o.shortcut === keySeq ) {\r\n                self.switchMode()\r\n            }\r\n\r\n            // event.preventDefault()\r\n        })\r\n    }\r\n\r\n    switchMode(){\r\n        const self = this\r\n\r\n        this.body.classList.toggle(ENEI_EDITOR_MODE_CLASS)\r\n\r\n        const clickHandler = function() {\r\n            if(!self.inEditMode()) return\r\n            self.current = this\r\n            self.openEditor()\r\n        }\r\n\r\n        const elements = document.querySelectorAll(ENEI_EDITOR_TARGET_CLASS)\r\n\r\n        if (this.inEditMode()) {\r\n            elements.forEach(el => {\r\n                el.addEventListener(\"click\", clickHandler)\r\n            })\r\n        } else {\r\n            elements.forEach(el => {\r\n                el.removeEventListener(\"click\", clickHandler)\r\n            })\r\n        }\r\n    }\r\n\r\n    inEditMode(){\r\n        return this.body.classList.contains(ENEI_EDITOR_MODE_CLASS)\r\n    }\r\n\r\n    async commitBlock(id, content){\r\n        const {serverEndpoint} = this.options\r\n        const res = await fetch(`${serverEndpoint}/commit-blocks`, {\r\n            method: \"POST\",\r\n            body: JSON.stringify([{\r\n                id,\r\n                content\r\n            }]),\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        })\r\n        if (!res.ok) {\r\n            alert(`Block not committed!`)\r\n            return null\r\n        }\r\n        const result = await res.json()\r\n        if (result.includes(id)) {\r\n            this.saveBlock(id, content)\r\n            return id\r\n        }\r\n        return null\r\n    }\r\n\r\n    saveBlocks(){\r\n        const data = {}\r\n        const blocks = document.querySelectorAll(ENEI_EDITOR_TARGET_CLASS)\r\n        blocks.forEach(el => {\r\n            const id = el.getAttribute(\"enei\")\r\n            data[id] = el.innerHTML.trim()\r\n        })\r\n        storage.setItem('ENEI', JSON.stringify(data))\r\n    }\r\n\r\n    restoreBlocks(){\r\n        let data = storage.getItem('ENEI')\r\n        if (!data) {\r\n            return\r\n        }\r\n        data = JSON.parse(data)\r\n        for(let id in data) {\r\n            const el = document.querySelector(`[enei=${id}]`)\r\n            el.innerHTML = data[id]\r\n        }\r\n    }\r\n\r\n    restoreBlock(id){\r\n        let data = storage.getItem('ENEI')\r\n        if (!data) {\r\n            return\r\n        }\r\n        const el = document.querySelector(`[enei=${id}]`)\r\n        el.innerHTML = JSON.parse(data)[id]\r\n    }\r\n\r\n    saveBlock(id, content){\r\n        let data = storage.getItem('ENEI')\r\n        if (!data) {\r\n            data = {}\r\n        } else {\r\n            data = JSON.parse(data)\r\n        }\r\n\r\n        data[id] = content.trim()\r\n        storage.setItem('ENEI', JSON.stringify(data))\r\n    }\r\n}\r\n\r\nexport const createEneiEditor = (options) => new EneiEditor(options)\r\n","import formatUndoSnapshot from '../utils/formatUndoSnapshot';\nimport { HtmlSanitizer, moveChildNodes } from 'roosterjs-editor-dom';\n/**\n * Set heading level at selection\n * @param editor The editor instance\n * @param level The heading level, can be a number from 0 to 6, in which 1 ~ 6 refers to\n * the HTML heading element &lt;H1&gt; to &lt;H6&gt;, 0 means no heading\n * if passed in param is outside the range, will be rounded to nearest number in the range\n */\nexport default function setHeadingLevel(editor, level) {\n    level = Math.min(Math.max(Math.round(level), 0), 6);\n    formatUndoSnapshot(editor, function () {\n        editor.focus();\n        var wrapped = false;\n        editor.queryElements('H1,H2,H3,H4,H5,H6', 1 /* OnSelection */, function (heading) {\n            if (!wrapped) {\n                editor.getDocument().execCommand(\"formatBlock\" /* FormatBlock */, false, '<DIV>');\n                wrapped = true;\n            }\n            var div = editor.getDocument().createElement('div');\n            moveChildNodes(div, heading);\n            editor.replaceNode(heading, div);\n        });\n        if (level > 0) {\n            var traverser = editor.getSelectionTraverser();\n            var blockElement = traverser === null || traverser === void 0 ? void 0 : traverser.currentBlockElement;\n            var sanitizer = new HtmlSanitizer({\n                cssStyleCallbacks: {\n                    'font-size': function () { return false; },\n                },\n            });\n            while (blockElement) {\n                var element = blockElement.collapseToSingleElement();\n                sanitizer.sanitize(element);\n                blockElement = traverser === null || traverser === void 0 ? void 0 : traverser.getNextBlockElement();\n            }\n            editor.getDocument().execCommand(\"formatBlock\" /* FormatBlock */, false, \"<H\" + level + \">\");\n        }\n    }, 'toggleHeader');\n}\n/**\n * @deprecated Use setHeadingLevel instead\n * Keep this for compatibility only, will be removed in next major release\n */\nexport var toggleHeader = setHeadingLevel;\n//# sourceMappingURL=setHeadingLevel.js.map","import execCommand from '../utils/execCommand';\n/**\n * Toggle strikethrough at selection\n * If selection is collapsed, it will only affect the input after caret\n * If selection contains only strikethrough text, the strikethrough style will be removed\n * If selection contains only normal text, strikethrough style will be added to the whole selected text\n * If selection contains both strikethrough and normal text, strikethrough style will be added to the whole selected text\n * @param editor The editor instance\n */\nexport default function toggleStrikethrough(editor) {\n    execCommand(editor, \"strikeThrough\" /* StrikeThrough */, 'toggleStrikethrough');\n}\n//# sourceMappingURL=toggleStrikethrough.js.map","import execCommand from '../utils/execCommand';\n/**\n * Toggle superscript at selection\n * If selection is collapsed, it will only affect the input after caret\n * If selection contains only superscript text, the superscript style will be removed\n * If selection contains only normal text, superscript style will be added to the whole selected text\n * If selection contains both superscript and normal text, the superscript style will be removed from whole selected text\n * If selection contains any subscript text, the behavior is determined by corresponding realization of browser\n * execCommand API\n * @param editor The editor instance\n */\nexport default function toggleSuperscript(editor) {\n    execCommand(editor, \"superscript\" /* Superscript */, 'toggleSuperscript');\n}\n//# sourceMappingURL=toggleSuperscript.js.map","import execCommand from '../utils/execCommand';\n/**\n * Toggle subscript at selection\n * If selection is collapsed, it will only affect the input after caret\n * If selection contains only subscript text, the subscript style will be removed\n * If selection contains only normal text, subscript style will be added to the whole selected text\n * If selection contains both subscript and normal text, the subscript style will be removed from whole selected text\n * If selection contains any superscript text, the behavior is determined by corresponding realization of browser\n * execCommand API\n * @param editor The editor instance\n */\nexport default function toggleSubscript(editor) {\n    execCommand(editor, \"subscript\" /* Subscript */, 'toggleSubscript');\n}\n//# sourceMappingURL=toggleSubscript.js.map"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","pop","push","__createBinding","o","m","k","k2","undefined","__esModule","writable","configurable","enumerable","get","__exportStar","__values","__read","ar","error","__spread","concat","__spreadArrays","il","a","j","jl","__spreadArray","to","from","pack","l","slice","__await","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__setModuleDefault","__importStar","mod","__importDefault","default","__classPrivateFieldGet","receiver","state","kind","has","__classPrivateFieldSet","set","__classPrivateFieldIn","__addDisposableResource","env","async","dispose","asyncDispose","stack","_SuppressedError","SuppressedError","suppressed","message","Error","name","__disposeResources","fail","hasError","rec","tslib_es6","ctor","descriptorIn","contextIn","initializers","extraInitializers","accept","descriptor","context","access","addInitializer","init","unshift","x","useValue","prefix","description","formatUndoSnapshot","editor","callback","apiName","addUndoSnapshot","formatApiName","safeInstanceOf","obj","typeName","_a","toString","commonAncestorContainer","targetWindow","node","document","ownerDocument","defaultView","window","getTargetWindow","targetType","mainWindow","mainWindowType","contains","container","contained","treatSameNodeAsContain","nodeType","parentNode","internalContains","isNodeAfter","node1","node2","compareDocumentPosition","splitParentNode","splitBefore","newParent","cloneNode","removeAttribute","firstChild","appendChild","nextSibling","innerHTML","insertBefore","splitBalancedNodeRange","nodes","start","isArray","end","temp","toArray","collection","collapseNodes","root","canSplitParent","collapse","childNodes","startIndex","endIndex","ref","isStart","previousSibling","getTagOfNode","tagName","toUpperCase","BLOCK_ELEMENT_TAGS","split","BLOCK_DISPLAY_STYLES","isBlockElement","tag","style","display","NodeBlockElement","element","collapseToSingleElement","getStartNode","getEndNode","equals","blockElement","isAfter","getTextContent","textContent","HTML_VOID_ELEMENTS","isVoidHtmlElement","matchesSelector","selector","matches","msMatchesSelector","findClosestElementAncestor","closest","parentElement","Position","nodeOrPosition","offsetOrPosType","isFromEndOfRange","offset","getIndexOfNode","isAtEnd","getEndOffset","endOffset","Math","max","min","normalize","newOffset","nextNode","lastChild","equalTo","position","move","getStart","range","startContainer","startOffset","getEnd","collapsed","endContainer","nodeValue","createRange","arg1","arg2","arg3","arg4","isNodePosition","getPositionFromPath","getFocusablePosition","setStart","setEnd","arg","path","getObjectKeys","keys","isAndroidRegex","userAgent","appVersion","vendor","userAgentOrVendor","isIE11OrGreater","isIE","isChrome","isFirefox","isSafari","isEdge","isWebKit","isMobileOrTablet","Browser","navigator","test","substr","isMac","isWin","isIEOrEdge","isAndroid","KnownCreateElementData","children","attributes","contenteditable","createElement","elementData","namespace","className","dataset","createElementNS","setAttribute","forEach","datasetName","attrName","child","createTextNode","childElement","wrap","wrapper","e_1","html","document_1","nodes_1","nodes_1_1","e_1_1","STRUCTURE_NODE_TAGS","StartEndBlockElement","rootNode","startNode","endNode","getBlockContext","currentNode","nodeContext","blockContext","newNode","getBlockElementAtNode","containerBlockNode","headNode","findHeadTailLeafNode","tailNode","isTail","sibling","getFirstLastBlockElement","isFirst","splitTextNode","textNode","returnFirstPart","_b","_c","firstPart","substring","secondPart","getComputedStyles","styleNames","styles","getComputedStyle","styleNames_1","styleNames_1_1","getPropertyValue","toLowerCase","px2Pt","styleName","px","round","parseFloat","CRLF","CRLF_SPACE","shouldSkipNode","ignoreSpace","replace","getLeafSibling","isNext","skipTags","getSibling","getChild","curNode","shouldContinue","getNextLeafSibling","getPreviousLeafSibling","STYLET_AGS","applyTextStyle","styler","formatNodes","fromPosition","toPosition","formatNode","parentTag","every","newNode_1","newNodeValue","removeChild","startingNode","callStylerWithInnerNode","NodeInlineElement","containerNode","parentBlock","getContainerNode","getParentBlock","getStartPosition","getEndPosition","isTextualInlineElement","inlineElement","pos","applyStyle","ImageInlineElement","_super","LinkInlineElement","getInlineElementAtNode","parent","nodeChain","parent_1","resolveInlineElement","getLeafNode","getFirstLeafNode","getFirstInlineElement","getLastInlineElement","getLastLeafNode","BodyScoper","getStartBlockElement","getStartInlineElement","isBlockInScope","trimInlineElement","EmptyInlineElement","PartialInlineElement","getDecoratedInline","thisStart","otherEnd","previousNode","getInlineElementAfter","getInlineElementBeforeAfter","isPartial","SelectionBlockScoper","startFrom","block","blockNode","getFirstLastInlineElementFromBlockElement","startInline","SelectionScoper","startBlock","inScope","selStartBlock","selEndBlock","inline","startPartial","endPartial","ContentTraverser","scoper","currentInline","currentBlock","createBodyTraverser","createSelectionTraverser","createBlockTraverser","getNextBlockElement","getPreviousNextBlockElement","getPreviousBlockElement","current","currentBlockElement","leaf","newBlock","getNextInlineElement","getPreviousNextInlineElement","getPreviousInlineElement","newInline","currentInlineElement","nextInlineElement","previousInlineElement","getNextPreviousInlineElement","WHITESPACE_REGEX","PositionContentSearcher","text","word","inlineBefore","inlineAfter","traverser","traversingComplete","inlineElements","nearestNonTextInlineElement","getWordBefore","_this","traverse","getInlineElementBefore","getSubStringBefore","getRangeFromText","exactMatch","startPosition","endPosition","textIndex","forEachTextInlineElement","textInline","nodeContent","nodeIndex","charCodeAt","some","getNearestNonTextInlineElement","previousInline","exec","ZERO_WIDTH_SPACE","getDelimiterFromElement","classList","addDelimiters","entityWrapper","nextElementSibling","previousElementSibling","isDelimiter","delimiterAfter","delimiterBefore","insertDelimiter","addDelimiterBefore","el","delimiterClass","span","insertPosition","insertAdjacentElement","readFile","file","reader_1","FileReader","onload","onerror","readAsDataURL","CLIPBOARD_HTML_HEADER_REGEX","OTHER_TEXT_TYPE","EDGE_LINK_PREVIEW","ContentHandlers","data","rawHtml","headerValues","parseInt","workaroundForEdge","type","customValues","linkPreview","JSON","parse","extractClipboardItems","items","options","pasteNativeEvent","types","image","files","all","map","item","getAsFile","customType_1","allowedCustomPasteType","textType","index","getAllowedCustomType","handler_1","getAsString","dataUrl","imageDataUri","extractClipboardEvent","event","rangeBeforePaste","dataTransfer","clipboardData","preventDefault","deleteContents","getData","nextStep","getTempDiv","removeTempDiv","div_1","contentEditable","focus","setTimeout","extractClipboardItemsForIE","NBSP_HTML","ENSP_HTML","TAB_SPACES","handleTextPaste","fragment","line","lines","includes","input","initialOffset","tIndex","lineBefore","lineAfter","tabCount","fill","join","transformTabCharacters","START_FRAGMENT","END_FRAGMENT","processStyles","querySelectorAll","INHERITABLE_PROPERTIES","getInheritableStyles","win","moveChildNodes","source","keepExistingChildren","changeElementTag","newTag","origianlTag","newElement","attr","marginTop","marginBottom","replaceChild","PREDEFINED_CSS_FOR_ELEMENT","B","EM","I","U","PRE","S","STRIKE","SUB","SUP","getPredefinedCssForElement","additionalPredefinedCssForElement","getStyles","getAttribute","pair","valueIndex","trim","setStyles","trimmedName","trimmedValue","filter","cloneObjectImpl","existingObj","cloneObject","VARIABLE_REGEX","HTML_TAG_REPLACEMENT","abbr","address","area","article","aside","bdi","bdo","blockquote","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","img","ins","kbd","legend","li","main","mark","menu","menuitem","meter","nav","ol","optgroup","option","output","picture","pre","progress","rp","rt","ruby","samp","section","select","small","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","tt","u","ul","var","wbr","xmp","form","applet","audio","base","basefont","embed","frame","frameset","iframe","link","meta","noscript","object","param","script","slot","template","title","track","video","ALLOWED_HTML_ATTRIBUTES","DEFAULT_STYLE_VALUES","overflow","padding","border","float","ALLOWED_CSS_CLASSES","removeValue","removeWidthForLiAndDiv","HtmlSanitizer","callbacks","additionalAttributes","array","additionalCssClasses","patterns","elementCallbacks","styleCallbacks","cssStyleCallbacks","width","attributeCallbacks","tagReplacements","additionalReplacements","replacements","getTagReplacement","additionalTagReplacements","allowedAttributes","additionalAllowedAttributes","self","toLocaleLowerCase","allowedCssClassesRegex","additionalAllowedCssClasses","RegExp","defaultStyleValues","additionalDefaultStyles","getDefaultStyleValues","additionalDefaultStyleValues","additionalGlobalStyleNodes","preserveHtmlComments","unknownTagReplacement","convertInlineCss","additionalStyleNodes","sanitizeHtml","sanitizer","currentStyles","currentElementOrStyle","convertCssOnly","doc","DOMParser","parseFromString","convertGlobalCssToInlineCss","sanitize","processNode","styleNodes","styleSheets","reverse","sheet","styleSheets_1","styleSheets_1_1","styleSheet","_loop_1","e_2","styleRule","cssRules","cssText","CSSRule","STYLE_RULE","selectorText","_d","e_2_1","currentStyle","isElement","isText","isFragment","isComment","shouldKeep","replacement","whiteSpace","thisStyle","processAttributes","preprocessCss","processCss","predefinedStyles","isInheritable","keep","isCssVariable","match","processCssVariable","attribute","name_1","newValue","processCssClass","originalValue","calculatedValue","originalClasses","calculatedClasses","HEX3_REGEX","HEX6_REGEX","RGB_REGEX","RGBA_REGEX","parseColor","color","ColorTones","WHITE","GRAY","BLACK","TRANSPARENT","DARK_COLORS_LIGHTNESS","BRIGHT_COLORS_LIGHTNESS","setColor","isBackgroundColor","isDarkMode","shouldAdaptTheFontColor","darkColorHandler","colorString","modeIndependentColor","cssName","colorValue","registerColor","lightModeColor","darkModeColor","setProperty","lightModeBackgroundColor","lightness","colorValues","red","green","blue","calculateLightness","isADarkOrBrightColor","adaptFontColorToBackgroundColor","applyFormat","format","elementStyle","fontFamily","fontSize","textColor","textColors","backgroundColor","backgroundColors","bold","italic","underline","fontWeight","fontStyle","textDecoration","PendableFormatCommandMap","isBold","isItalic","isUnderline","isStrikeThrough","isSubscript","isSuperscript","VISIBLE_ELEMENT_TAGS","VISIBLE_CHILD_ELEMENT_SELECTOR","isNodeEmpty","trimContent","shouldCountBrAsVisible","visibleSelector","httpExcludeRegEx","labelRegEx","domainPortWithUrlRegEx","linkMatchRules","http","except","normalizeUrl","url","https","mailto","notes","unc","ftp","news","telnet","gopher","wais","matchLink","schema","rule","scheme","originalUrl","normalizedUrl","queryElements","forEachCallback","scope","elements","startContainer_1","endContainer_1","nodeContainedByRangeOnly","targetPositions","checkPosition","isIntersectWithNodeRange","targets","unwrap","normalizeRect","clientRect","left","right","top","bottom","createNumberDefinition","isOptional","minValue","maxValue","allowNull","createBooleanDefinition","createStringDefinition","createObjectDefinition","propertyDef","validate","def","n1","n2","abs","minLength","maxLength","itemDef","validator","MetadataDataSetName","getMetadata","definition","defaultValue","str","setMetadata","stringify","removeMetadata","currentMetadata","BooleanDefinition","TableCellFormatMetadata","bgColorOverride","vAlignOverride","borderOverride","getTableCellMetadata","cell","saveTableCellMetadata","TABLE_CELL_TAG_NAME","TABLE_HEADER_TAG_NAME","applyTableFormat","cells","borderCollapse","row","rowIndex","cellIndex","hasBorderOverride","isFirstRow","isLastRow","isFirstColumn","isLastColumn","borderTop","getBorderStyle","topBorderColor","borderLeft","verticalBorderColor","borderRight","borderBottom","bottomBorderColor","setBorderColors","tableBorderFormat","borderLeftColor","borderRightColor","borderTopColor","borderBottomColor","formatBorders","setBordersType","bgColorEven","bgColorOdd","hasBandedRows","hasBandedColumns","shouldColorWholeTable","hasCellShadeOverride","verticalAlign","hasValignOverride","setCellFormat","hasFirstColumn","setFirstColumnFormat","hasHeaderRow","headerRowColor","setHeaderRowFormat","NullStringDefinition","TableFormatMetadata","keepCellShade","getTableFormatInfo","DEFAULT_FORMAT","VTable","normalizeSize","zoomScale","formatInfo","trs","tableSelection","getTableFromTd","currentTd_1","rows","sourceCol","targetCol","colSpan","rowSpan","hasTd","rect","getBoundingClientRect","spanLeft","spanAbove","height","firstCell","writeBack","skipApplyFormat","recalculateSpans","recalculateCellHeight","isEmptyCell","deleteCellShadeDataset","edit","operation","currentRow","currentCell","firstRow","selection","lastRow","lastCell","firstColumn","lastColumn","splice","cloneCell","newRow","this_1","countSpanAbove","colIndex","nextCell","getCell","newCell","getTd","_loop_2","this_2","forEachCellOfCurrentColumn","_loop_3","newCol","this_3","countSpanLeft","forEachCellOfColumn","_loop_4","this_4","forEachCellOfRow","removedRows","deletedColumns_1","_loop_5","this_5","removedColumns","rowStep","aboveCell","belowCell","mergeCells","colStep","leftCell","rightCell","nextCellBelow","nextCellRight","splitRow","marginLeft","marginRight","setAlignmentToSelectedCells","alignmentType","isVertical","horizontally","checkSpans","mergeCellContents","childElementCount","cellTd","nextCellTd","getCellsWithBorder","borderPos","getLeftCells","cellRect","found","forEachCellOfCurrentRow","getCurrentTd","isNaN","normalizeEmptyTableCells","normalizeTableCellSize","func","setHTMLElementSizeInPx","sizeTransformer","newWidth","newHeight","boxSizing","isWholeTableSelected","vTable","rowsLength","rowCells","firstX","firstY","lastX","lastY","getListTypeFromNode","isListElement","bulletListStyle","setListItemStyle","isCssStyle","elementsStyles","contentTraverser","element_1","styleValue","getInlineChildElementsStyle","styleValues","Set","size","ALPHABET","convertDecimalsToAlpha","decimal","isLowerCase","alpha","floor","MarkerTypes","RomanValues","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","convertDecimalsToRoman","romanValue","timesRomanCharAppear","repeat","numberingListStyle","markerType","Decimal","markerSeparator","markerSecondSeparator","Alpha","lowerCase","Roman","orderListStyles","unorderedListStyles","NEGATIVE_MARGIN","stylesToInherit","attrsToInherit","ListStyleDefinitionMetadata","orderedStyleType","unorderedStyleType","VListItem","listTypes","_i","newListStart","dummy","getListType","getLevel","getNode","getNewListStart","isDummy","isOrphanItem","canMerge","mergeItems","wrapIfNotBlockNode","indent","margin","listType","outdent","preventItemRemoval","expectedLength","addNegativeMargins","changeListType","setIsDummy","setNewListStart","startNumber","applyListStyle","rootList","listStyleType","marker","isDisc","isFirstLevel","level","markerNumber","setNumberingListMarkers","removeProperty","listStack","originalRoot","shouldReuseAllAncestorListElements","nextLevel","listStackEndIndex","stackLength","newList","createListElement","getDeepChildIndex","isLi","stylesToApply","attrValue","deepIndex","newRoot","marginBlockStart","marginBlockEnd","checkFirst","checkLast","VList","moveChildNodesToLi","moveLiToList","populateItems","getLastItemNumber","disableListChain","lastList","createDocumentFragment","placeholder","topList","separator","setIndentation","indentation","softOutdent","shouldAddMargin","findListItems","setAlignment","alignment","flexDirection","align","alignSelf","removeMargins","needChangeType","setListStyleType","orderedStyle","unorderedStyle","styleMetadata","getValidValue","createListStyleMetadata","appendItem","nodeTag","mergeVList","list","getListItemIndex","listIndex","listStartPos","listEndPos","newListTypes","bind","currentItem","furtherNodes","values","getRootListNode","region","ancestor","getSelectionRangeInRegion","regionBase","nodeBefore","nodeAfter","regionRange","fullSelectionEnd","fullSelectionStart","isRegion","regionStart","regionEnd","getSelectedBlockElementsInRegion","createBlockIfEmpty","deprecated","blocks","isNodeInRegion","ListSelector","createVListFromRegion","includeSiblingLists","tryIncludeSiblingNode","vList","firstNode","nodeForItem","listNode","createVListFromItemNode","arrayPush","mainArray","itemsArray","CHAIN_DATASET_NAME","AFTER_CURSOR_DATASET_NAME","lastChainIndex","VListChain","lastNumber","lastNumberBeforeCursor","createListChains","nameGenerator","regions","chains","chain","canAppendToTail","createListChainName","afterCurrentNode","append","canAppendAtCursor","createVListAtBlock","applyChainName","commit","lists","getLists","vlist","isAfterCurrentNode","regionTypeData","outerSelector","innerSelector","getRegionsFromRange","boundaryTree","allBoundaries","innerNode","inSelectionOuterNode","thisInnerNode","thisOuterNode","boundary","outerNode","boundaries","buildBoundaryTree","creator","fullRange","firstNodeOfRegion","lastNodeOfRegion","firstNodeValid","lastNodeValid","bothValid","areNodesValid","getRegionCreator","iterateNodes","started","ended","previousOuterNode","newRegions","collapseNodesInRegion","nodesOrBlockElements","lastNode","collapseNode","isPositionAtBeginningOf","targetNode","areAllPreviousNodesEmpty","getSelectionPath","getPositionPath","isPreviousText","getHtmlWithSelectionPath","content","tempNode","getInnerHTML","selectionPath","NumberArrayDefinition","CoordinatesDefinition","IsDarkModeDefinition","NormalContentMetadataDefinition","TableContentMetadataDefinition","tableId","ImageContentMetadataDefinition","imageId","extractContentMetadata","potentialMetadataComment","addRangeToSelection","skipSameRange","getSelection","needAddRange","rangeCount","currentRange","getRangeAt","removeAllRanges","addRange","canMoveCurrentSnapshot","snapshots","newIndex","currentIndex","clearProceedingSnapshots","getLength","removedSize","totalSize","autoCompleteIndex","addSnapshotV2","snapshot","isAutoCompleteSnapshot","compare","defaultCompare","currentSnapshot","isSameSnapshot","removeCount","maxSize","addSnapshot","compareSnapshots","s1","s2","entityStates","chainSanitizerCallback","newCallback","originalCallback_1","args","CONTENT_EDITABLE","getEntityFromElement","isEntity","id","isReadonly","getEntitySelector","restoreContentWithEntityPlaceholder","entities","insertClonedNode","anchor","entitySelector","tryGetWrapperFromEntityPlaceholder","removeUntil","nodeToInsert","nodeToStop","nodeToRemove","canPersist","getPlaceholder","entity","cacheGetEventData","getter","eventDataCache","CTRL_CHAR_CODE","ALT_CHAR_CODE","META_CHAR_CODE","isCharacterValue","isCtrlKey","ctrlKey","isAltKey","altKey","isMetaKey","metaKey","isModifierKey","isCtrlOrMetaPressedImpl","isCtrlOrMetaPressed","removeImportantStyleRule","styleProperties","modifiedStyles","setGlobalCssStyles","cssRule","styleId","styleTag","getElementById","insertRule","removeGlobalCssStyle","cloneCellStyles","styledCell","NOT_EDITABLE_SELECTOR","adjustSteps","safeRemove","querySelector","normalizedPosition","splitter","rootNodeToInsert","rootNodes","hasBrNextToRoot","listItem","tdNode","shouldInsertListAsText","currentTd","newTable","currentTable","cursorRow","cursorCol","columns","pasteTable","searcher","inlineElementBefore","inlineElementAfter","adjustInsertPositionForNotEditableNode","isContentEditable","nonEditableElement","lastNonEditableElement","rangeToTraverse","nextBlockElement","prevElement","tempRange","insertNode","deleteSelectedContent","nodesToDelete","nodesPairToMerge","ensureBeforeAndAfter","beforeEnd","afterEnd","beforeStart","afterStart","refNode","blockRoot","commonContainer","nodeToMerge","mergeBlocksInRegion","emptyNode","WAC_IDENTIFY_SELECTOR","PROG_ID_NAME","EXCEL_DESKTOP_ATTRIBUTE_NAME","getSourceFunctions","Map","props","htmlAttributes","shouldConvertSingleImage","htmlFirstLevelChildTags","applyInlineStyle","getSelectionRangeEx","safeCallback","isInnerNode","areAllCollapsed","ranges","triggerPluginEvent","formatState","formatCallback","triggerContentChangedEvent","getSelectionTraverser","FONT_SIZES","MIN_FONT_SIZE","MAX_FONT_SIZE","changeFontSize","change","fontSizes","changeBase","pt","ceil","last","getNewFontSize","lineHeight","applyListItemStyleWrap","parentNodes","getElementAtCursor","applyStyleToListItems","commitListChains","getSelectionRange","shouldReuseAllAncestorListElements_1","isFeatureEnabled","shouldDisableListChain_1","blockFormat","beforeRunCallback","getSelectedRegions","chains_1","execCommand","command","formatter","getDocument","getPendableFormatState","formatName","needToSwitchSelection","setBackgroundColor","getDarkColorHandler","setTextColor","shouldApplyInlineStyle","toggleBold","toggleItalic","toggleUnderline","STYLES_TO_REMOVE","TAGS_TO_UNWRAP","ATTRIBUTES_TO_PRESERVE","TAGS_TO_STOP_UNWRAP","clearNodeFormat","areAllChildrenBlock","returnBlockElement","isTableCell","isTable","removeNonBorderStyles","removeNotTableDefaultStyles","clearAttribute","updateStyles","callbackfn","clearAutoDetectFormat","isMultiBlock","transverser","isMultiBlockSelection","isOnlySiblingWithContent_1","state_1","isNodeWholeBlock","clearFormat","clearBlockFormat","nonborderStyles","balancedNodes","setDefaultFormat","defaultFormat","getDefaultFormat","isDefaultFormatEmpty","removeStyles","cNode","fontName","setFontName","setFontSize","setColorIgnoredElements_1","setDefaultFontWeight","formatType","clearInlineFormat","URI_REGEX","MAILTO_REGEX","FTP_REGEX","createLink","altText","displayText","href","checkXss","linkData","normalizedUrl_1","search","applyLinkPrefix","originalUrl_1","getAnchorNodeAtCursor","updateAnchorDisplayText","deletionInlineList","deleteNode","updateAnchorTarget","getFormatState","listTag","multiline","startingBlock","endingBlock","headingTag","tableFormat","hasTableHeader","headingLevel","isBullet","isNumbering","isMultilineSelection","headerLevel","canUnlink","canAddImageAltText","isBlockQuote","isCodeInline","isCodeBlock","isInTable","tableHasHeader","canMergeTableCell","getElementBasedFormatState","getStyleBasedFormatState","getUndoState","getZoomScale","coordinates","insertImage","imageFileOrSrc","insertImageWithSrc","isDisposed","src","editTable","vtable","saveTableSelection","transformToDarkColor","isUndefined","currentCol","calculateCellToSelect","newTd","removeLink","normalizeBlockquote","quotesHandled","textAlign","quote","isNodeRTL","marginInlineStart","marginInlineEnd","isATable","elementAtCursor","alignTable","alignList","alignText","isEmptyBlockUnderTR","setDirection","direction","collapseSelectedBlocks","handler","blockGroups","isTabKeyTextFeaturesEnabled","isFirstItem","shouldHandleWithBlockquotes","group","toggleListType","apiNameOverride","isNewList","toggleBullet","listStyle","toggleNumbering","blockWrap","wrapFunction","NodeTag","DEFAULT_STYLER","borderColor","paddingLeft","CODE_TAG","SELECTOR","PRE_TAG","TRAILING_PUNCTUATION_REGEX","MINIMUM_LENGTH","AutoLink","shouldHandleEvent","cacheGetLinkData","handleEvent","getContentSearcherOfCursor","runAsync","textOrRange","backupRange","updateCursor","replaceSelection","insertOnNewLine","replaceWithNode","clearEventDataCache","UnlinkWhenBackspaceAfterLink","contentSearcher","rawEvent","defaultDisabled","eventType","trailingPunctuation","candidate_1","AutoLinkFeatures","autoLink","unlinkWhenBackspaceAfterLink","RemoveCodeWhenEnterOnEmptyLine","childOfCode","cacheGetCodeChild","splitCode","RemoveCodeWhenBackspaceOnEmptyFirstLine","codeElement","getFocusedPosition","currentContainer","codeChild","codeParent","preParent","CodeFeatures","removeCodeWhenEnterOnEmptyLine","removeCodeWhenBackspaceOnEmptyFirstLine","NoCycleCursorMove","allowFunctionKeys","ctrlOrMeta","isPositionAtBeginning","rtl","which","CursorFeatures","noCycleCursorMove","ClickOnEntityFeature","cacheGetReadonlyEntityElement","EscapeFromEntityFeature","entityElement","EnterBeforeReadonlyEntityFeature","cacheGetNeighborEntityElement","newContainer","BackspaceAfterEntityFeature","DeleteBeforeEntityFeature","collapseOnly","regionRoot","entityNode","triggerOperation","MoveBetweenDelimitersFeature","getIsDelimiterAtCursor","checkBefore","cacheGetCheckBefore","delimiter","cacheDelimiter","getRelatedElements","delimiterPair","positionType","shiftKey","extend","RemoveEntityBetweenDelimitersFeature","cacheEntityBetweenDelimiter","focusedElement","class","pairClass","isAtEndOrBeginning","getBlockTraverser","traverseFn","getNextSibling","elAtCursor","shouldHandle","entity_1","defaultPrevented","removeDelimiters","getElementFromInline","EntityFeatures","clickOnEntity","escapeFromEntity","enterBeforeReadonlyEntity","backspaceAfterEntity","deleteBeforeEntity","moveBetweenDelimitersFeature","removeEntityBetweenDelimiters","_e","_f","NumberingTypes","Character","bulletListType","getAutoBulletListStyle","textBeforeCursor","trigger","characters","lowerRomanTypes","upperRomanTypes","numberingTriggers","lowerRomanNumbers","upperRomanNumbers","numberingListTypes","char","DecimalsTypes","LowerAlphaTypes","UpperAlphaTypes","LowerRomanTypes","UpperRomanTypes","identifyNumberingListType","numbering","isDoubleParenthesis","previousListStyle","separatorCharacter","numberingType","identifyNumberingType","getAutoNumberingListStyle","previousListChain","indexNumber","letter","convertAlphaToDecimals","Number","isValidNumbering","PREVIOUS_BLOCK_CACHE_KEY","NEXT_BLOCK_CACHE_KEY","shouldHandleIndentationEvent","indenting","keyCode","cacheGetListElement","handleIndentationEvent","currentElement","isRTL","getAnnounceData","listItemIndex","stringToAnnounce","defaultStrings","formatStrings","getAnnounceDataForList","IndentWhenTab","OutdentWhenShiftTab","IndentWhenAltShiftRight","OutdentWhenAltShiftLeft","MergeInNewLine","toggleListAndPreventDefault","OutdentWhenBackOn1stEmptyLine","getElementsByTagName","MaintainListChainWhenDelete","getBodyTraverser","getCacheNextSibling","getListChains","OutdentWhenEnterOnEmptyLine","AutoBulletList","shouldTriggerList","insertContent","textRange","prepareAutoBullet","AutoNumberingList","number","isFirstItemOfAList","getPreviousListItem","getPreviousListType","listInfo","listElement","getListStyle","isATheBeginning","listChains","previousListType","shouldTriggerNewListStyle","MergeListOnBackspaceAfterList","cursorBlock","previousBlock_1","isList","nearestInline","tempBlock","nextBlock_1","nextElement","previousList","targetBlock","rangeBeforeWriteBack","fvList","ListFeatures","autoBullet","indentWhenTab","outdentWhenShiftTab","outdentWhenBackspaceOnEmptyFirstLine","outdentWhenEnterOnEmptyLine","mergeInNewLineWhenBackspaceOnFirstChar","maintainListChain","maintainListChainWhenDelete","autoNumberingList","autoBulletList","mergeListOnBackspaceAfterList","outdentWhenAltShiftLeft","indentWhenAltShiftRight","generateBasicMarkdownFeature","triggerCharacter","elementTag","useShiftKey","cacheGetRangeForMarkdownOperation","lastTypedTriggerPosition","hasLastTypedTrigger","textContentRange","cloneRange","extractContents","elementToWrap","nonPrintedSpaceTextNode","handleMarkdownEvent","textInlineElement","inlineTextContent","parentBlockText","contentIndex","MarkdownFeatures","markdownBold","markdownItalic","markdownStrikethru","markdownInlineCode","QUOTE_TAG","STRUCTURED_TAGS","UnquoteWhenBackOnEmpty1stLine","childOfQuote","cacheGetQuoteChild","splitQuote","UnquoteWhenEnterOnEmptyLine","shouldClearFormat","isStyledBlockquote","QuoteFeatures","unquoteWhenBackspaceOnEmptyFirstLine","unquoteWhenEnterOnEmptyLine","createCommand","winKey","macKey","action","disabled","commands","undo","redo","DefaultShortcut","cacheGetCommand","stopPropagation","getModifierState","cmd","ShortcutFeatures","defaultShortcut","CHILD_PARENT_TAG_MAP","TD","TH","LI","CHILD_SELECTOR","InsertLineBeforeStructuredNodeFeature","cacheGetStructuredElement","StructuredNodeFeatures","insertLineBeforeStructuredNodeFeature","TabInTable","cacheGetTableCell","cacheIsWholeTableSelected","cacheVTable","tableCells","newPos","IndentTableOnTab","UpDownInTable","isUp","hasShiftKey","targetTd","anchorNode_1","anchorNode","anchorOffset_1","anchorOffset","selection_1","setBaseAndExtent","DeleteTableWithBackspace","firstTd","TableFeatures","tabInTable","upDownInTable","indentTableOnTab","deleteTableWithBackspace","IndentWhenTabText","activeElement","listOrTable","insertTab","shouldSetIndentation","OutdentWhenTabText","TextFeatures","indentWhenTabText","outdentWhenTabText","autoHyphen","firstBlock","lastBlock","blockStart","blockEnd","rangeBefore","rangeAfter","isRangeEmpty","numberOfChars","MAX_SAFE_INTEGER","span2","allFeatures","getAllFeatures","ImageEditInfoState","ContentEdit","settingsOverride","additionalFeatures","features","getName","initialize","feature","hasSettingForKey","addContentEditFeature","disposeFeatures","removeContentEditFeature","HyperLink","getTooltipCallback","onLinkClick","originalHref","trackedLink","disposer","onMouse","tryGetHref","setEditorDomAttribute","onBlur","updateLinkHrefIfShouldUpdate","resetLinkTracking","addDomEventHandler","mouseover","mouseout","blur","onPluginEvent","isContentEditValue","shouldCheckUpdateLink","doesLinkDisplayMatchHref","srcElement","window_1","open","updateLinkHref","escapedDisplay","innerText","linkData_1","ROTATE_KEYS","CROP_KEYS","ROTATE_CROP_KEYS","ALL_KEYS","checkEditInfoState","editInfo","compareTo","areSameNumber","flippedHorizontal","flippedVertical","angleRad","getGeneratedImageSize","beforeCrop","widthPx","heightPx","angle","originalWidth","leftPercent","rightPercent","originalHeight","topPercent","bottomPercent","visibleWidth","visibleHeight","targetWidth","cos","sin","targetHeight","generateDataURL","naturalWidth","naturalHeight","imageWidth","imageHeight","devicePixelRatio","getContext","scale","translate","rotate","drawImage","toDataURL","deleteEditInfo","getEditInfoFromImage","clientWidth","clientHeight","getInitialEditInfo","applyChange","previousSrc","wasResizedOrCropped","editingImage","applyChangesOnMouseUp","newSrc","originalSrc","saveEditInfo","MOUSE_EVENT_INFO_DESKTOP","MOUSEDOWN","MOUSEMOVE","MOUSEUP","getPageXY","getMouseEventPageXY","MOUSE_EVENT_INFO_MOBILE","getTouchEventPageXY","pageX","pageY","targetTouches","touch","HandleTypes","DragAndDropHelper","onSubmit","forceMobile","initX","initY","initValue","onMouseDown","addDocumentEvents","dndMouse","onDragStart","onMouseMove","deltaX","deltaY","onDragging","onMouseUp","removeDocumentEvents","onDragEnd","addEventListener","removeEventListener","ROTATE_SIZE","DEG_PER_RAD","PI","ROTATE_ICON_MARGIN","ROTATION","sw","nw","ne","se","Xs","Ys","CROP_HANDLE_SIZE","CROP_HANDLE_WIDTH","XS_CROP","YS_CROP","Resizer","ratio","rotateCoordinate","minWidth","minHeight","horizontalOnly","verticalOnly","shouldPreserveRatio","preserveRatio","hypotenuse","sqrt","atan2","getResizeBordersHTML","getResizeHandleHTML","handleTypes","leftOrRight","topOrBottom","setHandleStyle","Cropper","dx","dy","widthPercent","heightPercent","fullWidth","fullHeight","newLeft","crop","newRight","newTop","newBottom","basePercentage","deltaValue","fullValue","currentPercentage","getCropHandleHTML","layer","bgColor","getCropHandleHTMLInternal","Rotator","distance","newX","newY","angleInRad","minRotateDeg","angleInDeg","getRotateIconHTML","transform","stroke","DIRECTIONS","DirectionRad","DirectionOrder","DefaultOptions","imageSelector","rotateIconHTML","disableCrop","disableRotate","disableSideResize","onSelectState","ImageEditHTMLMap","onShowResizeHandle","resizeBorderColor","rotateHandleBackColor","overlayHTML","containerHTML","rotation","getCropHTMLInternal","ImageEdit","clonedImage","lastSrc","dndHelpers","wasResized","shadowSpan","isCropping","pngSource","setEditingImage","removeWrapper","changesWhenMouseUp","updateWrapper","actualWidth","actualHeight","cropContainers","getEditElements","cropOverlays","resizeHandles","rotateCenter","rotateHandle","cropHandles","marginHorizontal","marginVertical","cropLeftPx","cropRightPx","cropTopPx","cropBottomPx","borderStyle","borderWidth","getPx","setWrapperSizeDimensions","flippedHorizontally","flippedVertically","setFlipped","setSize","updateHandleCursor","elementClass","viewport","getVisibleViewport","isSmall","isASmallImage","editorRect","isSmallImage","rotateCenterRect","wrapperRect","adjustedDistance","rotateGap","rotateTop","updateRotateHandleState","handles","handle","isSideHandle","updateSideHandlesVisibility","allowedOperations","dragstart","clearDndHelpers","selectionRangeEx","mouseTarget","clonedRoot","isOperationAllowed","operationOrSelect","selectImage","tryToConvertGifToPng","maxWidth","isFixedNumberValue","checkIfImageWasResized","getImageData","canRegenerateImage","createWrapper","createDndHelpers","flipImage","rotateImage","options_1","getColorString","htmlData_1","thisOperation","insertImageWrapper","shadowRoot","attachShadow","mode","dragAndDrop","helper","rotateHandles","radIndex","idx","handleRadIndexCalculator","originalDirection","originalIndex","rotatedIndex","cursor","numberValue","isPureLiNode","hasLi_1","childNode","ImageResize","selectionBorderColor","forcePreserveRatio","resizableImageSelector","showResizeHandle","hideResizeHandle","selectImageAfterUnSelect","LAST_TD_END_REGEX","LAST_TR_END_REGEX","LAST_TR_REGEX","LAST_TABLE_REGEX","convertPastedContentFromExcel","trustedHTMLHandler","sanitizingOption","htmlBefore","trMatch","tableMatch","excelHandler","replaceChildren","createListItemBlock","startElement","endElement","insertPositionNode","listItemContainers","WORD_ONLINE_IDENTIFYING_SELECTOR","LIST_CONTAINER_ELEMENT_CLASS_NAME","IMAGE_CONTAINER_ELEMENT_CLASS_NAME","VALID_LIST_STYLE_CHAR_CODES","convertPastedContentFromWordOnline","listItemContainerListEl","replaceRegex","prevParent","nextParent","sanitizeListItemContainer","listItemBlocks","listElements","curListItemBlock","curItem","lastItemInCurBlock","getListItemBlocks","itemBlock","listItemBlock","flattenListBlock","convertedListElement","listItemContainer","getContainerListType","createNewList","itemLevel","insertConvertedListToDoc","listRootElement","itemToInsert","curListLevel","lastElementChild","lastChildTag","firstElementChild","insertListItem","parentContainer","imageNodes","getImageNodes","startAttribute","TABLE_TEMP_ELEMENTS_QUERY","convertPastedContentFromOfficeOnline","isWordOnlineWithList","MSO_COMMENT_PARENT","MSO_COMMENT_REFERENCE","MSO_COMMENT_DATE","MSO_COMMENT_ANCHOR_HREF_REGEX","MSO_SPECIAL_CHARACTER","MSO_SPECIAL_CHARACTER_COMMENT","MSO_COMMENT_CONTINUATION","MSO_ELEMENT","MSO_ELEMENT_COMMENT_LIST","MSO_COMMENT_DONE","NODE_ID_ATTRIBUTE_NAME","setObject","wordCustomData","getAndSetNodeId","dict","getObject","nextNodeId","LOOKUP_DEPTH","UNIQUE_LIST_ID_CUSTOM_DATA","MSO_LIST_STYLE_NAME","LINE_BREAKS","getOrCreateListForNode","wordConverter","listMetadata","recurringGetOrCreateListAtNode","listId","uniqueListId","convertListIfNeeded","possibleList","getRealPreviousSibling","cleanupListIgnore","levels","nodesToRemove","isEmptySpan","fixWordListComments","isIgnoreNode","getListItemMetadata","listAttribute","getStyleValue","listProps","wordListId","originalNode","isFakeBullet","fakeBullet","getFakeBulletText","removeComments","endComment","getRealNextSibling","newSpan","prevSibling","isEmptyTextNode","resetCurrentLists","currentListIdsByLevels","ll","currentUniqueListId","PERCENTAGE_REGEX","convertPastedContentFromWord","nextUniqueId","numBulletsConverted","numNumberedConverted","wordConverterArgs","listItems","listsMetadata","lastProcessedItem","itemMetadata","levelInfo","ignore","numberOfItems","secondFakeBullet","firstFakeBullet","processNodesDiscovery","startsWith","clone","textIndent","processNodeConvert","parsedLineHeight","processBlock","checkAndAddBr","DeprecatedColorList","SUPPORTED_PROTOCOLS","sanitizeLinks","htmlElement","URL","protocol","validateLink","TOP_OR_SIDE","Paste","convertSingleImageBody","getTrustedHTMLHandler","getPasteSource","pasteType","convertPastedContentFromPowerPoint","convertPasteContentForSingleImage","convertPastedContentForLI","blocksLength","handleLineMerge","property","sanitizeHtmlColorsFromPastedContent","sanitizeBlockStyles","TableSelectorFeature","getOnMouseOut","onMouseOut","CopyPastePlugin","onPaste","editor_1","paste","cleanUpAndRestoreSelection","copy","onCutCopy","cut","getState","isCut","getContent","tempDiv_1","setHtmlWithMetadata","newRange","createTableRange","deleteTableContent","deleteImage","forceInLightMode","getCustomData","tempDiv","isCopy","range_1","restoreRange","clonedVTable","resultCells_1","firstX_1","firstY_1","lastX_1","lastY_1","removeCellsOutsideSelection","selectedVTable","forEachSelectedCell","wholeTableSelected","isWholeColumnSelected","DOMEventPlugin","contentDiv","dragEvent","onDrop","onFocus","skipReselectOnFocus","tableSelectionRange","imageSelectionRange","selectionRange","onKeyDownDocument","cacheSelection","onMouseDownDocument","onScroll","scrollContainer","onKeyboardEvent","onInputEvent","onContextMenuEvent","allItems","elementBeforeCursor","eventTargetNode","contextMenuProviders","provider","getContextMenuItems","isInIME","stopPrintableKeyboardEventPropagation","allowKeyboardEventPropagation","plugins","isContextMenuProvider","eventHandlers","keypress","getEventHandler","keydown","keyup","mousedown","contextmenu","compositionstart","compositionend","drop","beforedeactivate","pluginEventType","beforeDispatch","EditPlugin","hasFunctionKey","isKeyDownEvent","handledByEditFeature","DELIMITER_SELECTOR","INLINE_ENTITY_SELECTOR","inlineEntityOnPluginEvent","normalizeDelimitersInEditor","addDelimitersIfNeeded","removeNode","removeDelimiterAttr","delimiter_1","getBlock","blockToCheck","delimiters","isEntityElement","handleCollapsedEnter","preventTypeInDelimiter","startUpdate","getPosition","endUpdate","aEditor","handleSelectionNotCollapsed","handleKeyDownEvent","nodeToMove_1","setPosition","checkEntity","entitySibling","remove","cn","ENTITY_ID_REGEX","REMOVE_ENTITY_OPERATIONS","EntityPlugin","handleCutEvent","checkRemoveEntityForRange","entityMap","handleMouseUpEvent","handleBeforePasteEvent","handleContentChangedEvent","handleExtractContentWithDomEvent","handleContextMenuEvent","handleEntityOperationEvent","triggerEvent","isClicking","workaroundSelectionIssueForIE","shouldNormalizeDelimiters","isDeleted","getExistingEntities","ensureUniqueId","commitEntity","handleNewEntity","editableEntityElements","inSelectionEntityElements_1","isFullyCovered","newItem","shouldPersist","baseId","newId","num","workaroundButton","onblur","ImageSelection","mouseSelection","keyDownSelection","imageParent","contextMenuTarget","actualSelection","CONTENT_EDITABLE_ATTRIBUTE_NAME","DARK_MODE_DEFAULT_FORMAT","LifecyclePlugin","initializer","initialContent","userSelect","adjustColor","doNotAdjustEditorColor","getDarkColor","customData","inDarkMode","onExternalContentTransform","experimentalFeatures","shadowEditFragment","shadowEditEntities","shadowEditSelectionPath","shadowEditTableSelectionPath","shadowEditImageSelectionPath","setContent","MouseUpPlugin","mouseUpEventListerAdded","mouseDownX","mouseDownY","removeMouseUpEventListener","NormalizeTablePlugin","normalizeTables","normalizeTableFromEvent","tables","rangeEx","isChanged","isDOMChanged","colgroups","PendingFormatStatePlugin","pendableFormatPosition","pendableFormatState","pendableFormatSpan","clear","getCurrentPosition","createPendingFormatSpan","currentPosition","TypeInContainerPlugin","Node","ELEMENT_NODE","styledAncestor","ensureTypeInContainer","focusedPosition","UndoPlugin","service","lastKeyPress","snapshotsService","undoMetadataSnapshotService","undoSnapshotService","canMove","delta","knownColors","clearRedo","canUndoAutoComplete","moveCurrentSnapshot","clearProceedingSnapshotsV2","isRestoring","hasNewContent","isNested","autoCompletePosition","willHandleEventExclusively","undoState","canUndo","canRedo","onKeyDown","onKeyPress","clearRedoForInput","onContentChanged","onBeforeKeyboardEditing","evt","ColorAttributeEnum","ColorAttributeName","DarkColorHandlerImpl","getKnownColorsCopy","colorKey","parsedColor","parseColorValue","reset","isInDarkMode","findLightColorFromDarkColor","darkColor","rgbSearch","find","rgbCurrent","transformElementColor","fromDarkMode","toDarkMode","names","addUndoSnapshotInternal","core","canUndoByBackspace","lifecycle","api","createContentMetadata","PendableStyleCheckers","CssFalsyCheckers","createNormalSelectionEx","checkAllCollapsed","hasFocus","addUniqueId","idPrefix","applyId","cont","getElement","STYLE_ID","borderCSS","buildBorderCSS","imageSelectionBorderColor","unselect","SELECTED_CSS_RULE","MAX_RULE_SELECTOR_LENGTH","buildCss","contentDivSelector","selectors","isAllTableSelected","tableSelector","tableRange","Range","selectNode","handleAllTableSelected","tr1","td1","tr2","td2","firstSelected","lastSelected","tableChildren","indexes","tdCount","midElement","ind","middleElSelector","removeImportant","generateCssFromCell","elementsSelector","rowRange","setStartBefore","setEndAfter","handleTableSelected","currentRules","cellTag","isValidCoordinate","iterateElements","transformer","includeSelf","isHTMLElement","allowedEventsInShadowEdit","coreApiMap","attachDomEvent","eventMap","disposers","handlerObj","extractHandler","eventName","onEvent","changeSource","additionalData","getEntityState","event_1","createPasteFragment","pasteAsText","applyCurrentStyle","pasteAsImage","getPasteType","htmlAfter","createBeforePasteEvent","reduce","attrs","TEXT_NODE","COMMENT_NODE","lastIndexOf","retrieveMetadataFromClipboard","handleImagePaste","format_1","pendableFormat","styleBasedFormat","getCurrentFormat","sanitizePasteContent","createFragmentFromClipboardData","keyboardEvent","brEl","shouldSetNodeStyles","wasNodeJustCreatedByKeyboardEvent","selectRange","domEvent","triggerExtractContentEvent","includeSelectionMarker","clonedNode","originalRange","transformColor","tryGetFromCache","shadowRange","override","pendingFormatState","styleTextColor","styleBackColor","backColor","forceGetStateFromDOM","cachedPendableFormatState","cachedPosition","isSamePosition","pendableKeys","queryCommandStateFromDOM","insertToRegionRoot","insertedNode_1","isBegin","insertedNode","rangeToRestore","getInitialRange","adjustInsertPositionRegionRoot","tempPos","adjustInsertPositionNewLine","adjustInsertPosition","nodeForCursor","restoreUndoSnapshot","darkColorHandler_1","isDarkModel_1","entityState","isSelectionRangeEx","isSelectionPath","buildRangeEx","selectTable","applyRangeEx","formatState_1","queryCommandState","restorePendingFormatState","contentChanged","newContent","metadataFromContent","selectContentMetadata","switchShadowEdit","isOn","wasInShadowEdit","getShadowEditSelectionPath","selectionType","shadowEditSelection","w","nodeToAppend","moveContentWithEntityPlaceholders","forceTransform","pluginEvent","broadcast","plugin","handledExclusively","coordinate","areValidCoordinates","css","isWholeTableSelected_1","isMergedCell","cellToSelect","createEditorCore","corePlugins","corePluginOverride","typeInContainer","_placeholder","typeAfterLink","mouseUp","copyPaste","imageSelection","normalizeTable","createCorePlugins","pluginState","getPluginState","additionalRects","rects","getIntersectedRect","coreApiOverride","originalApi","disposeErrorHandler","EditorBase","coreCreator","getCore","replaceNode","existingNode","toNode","transformColorForDarkMode","scopeOrCallback","Function","selectionEx","isEmpty","allNodes","fragment_1","applyCurrentFormat","snapshotBeforePaste","sel","focusNode","focusOffset","nameOrMap","eventsToMap","getScrollContainer","requestAnimationFrame","cancelAnimationFrame","getEditorDomAttribute","getRelativeDistanceToEditor","addScroll","elementRect","scrollLeft","scrollTop","featureSet","setDarkModeState","nextDarkMode","startShadowEdit","stopShadowEdit","isInShadowEdit","getSizeTransformer","setZoomScale","oldValue","oldZoomScale","newZoomScale","Editor","colorName","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","isArrayish","swizzle","simpleSwizzleModule","exports","results","len","fn","colorNames","require$$0","require$$1","reverseNames","cs","colorStringModule","clamp","hexDouble","string","val","model","hsl","hwb","rgb","hexAlpha","i2","hex","rgba","percent","hsla","hwba","keyword","cssKeywords","reverseKeywords","convert","conversionsModule","channels","labels","hsv","cmyk","xyz","lab","lch","ansi16","ansi256","hcg","apple","h","rdif","gdif","bdif","diff","diffc","reversed","currentClosestKeyword","currentClosestDistance","Infinity","pow","z","t1","t2","t3","smin","lmin","hi","sl","vmin","wh","bl","y2","x2","z2","ansi","mult","rem","integer","hue","chroma","mg","pure","conversions","deriveBFS","fromModel","graph","models","buildGraph","queue","adjacents","adjacent","wrapConversion","toModel","cur","conversion","route","routes","wrappedFn","wrapRounded","wrapRaw","_slice","skippedModels","hashedModelKeys","sort","limiters","Color","valpha","newArr","zeroArray","hashedKeys","limit","freeze","getset","channel","modifier","maxfn","arr","Color$1","toJSON","places","percentString","unitArray","unitObject","toFixed","roundTo","roundToPlace","saturationl","saturationv","wblack","rgbNumber","luminosity","lum","chan","contrast","color2","lum1","lum2","contrastRatio","isDark","isLight","negate","lighten","darken","saturate","desaturate","whiten","blacken","grayscale","fade","opaquer","degrees","mix","mixinColor","weight","color1","w1","w2","newAlpha","getDarkColor_1","KnownAnnounceStrings","DocumentCommand","DocumentPosition","Keys","NodeType","ContentTypePrefix","ContentType","Alignment","ChangeSource","ColorTransformDirection","ContentPosition","DarkModeDatasetNames","DelimiterClasses","Direction","EntityClasses","EntityOperation","ExperimentalFeatures","FontSizeChange","GetContentMode","Indentation","Capitalization","ListType","PositionType","QueryScope","RegionType","TableOperation","ImageEditOperation","ClearFormatMode","KnownCreateElementDataIndex","KnownPasteSourceType","TableBorderFormat","PluginEventType","SelectionRangeTypes","NumberingListType","BulletListType","DefinitionType","PasteType","getDarkColor$1","baseLValue","computedColor","colorLab","newLValue","browser","corePluginState","CompatibleAlignment","CompatibleBulletListType","CompatibleCapitalization","CompatibleChangeSource","CompatibleClearFormatMode","CompatibleColorTransformDirection","CompatibleContentPosition","CompatibleContentTypePrefix","CompatibleContentType","CompatibleDarkModeDatasetNames","CompatibleDefinitionType","CompatibleDelimiterClasses","CompatibleDirection","CompatibleDocumentCommand","CompatibleDocumentPosition","CompatibleEntityClasses","CompatibleEntityOperation","CompatibleExperimentalFeatures","CompatibleFontSizeChange","CompatibleGetContentMode","CompatibleImageEditOperation","CompatibleIndentation","CompatibleKeys","CompatibleKnownAnnounceStrings","CompatibleKnownCreateElementDataIndex","CompatibleKnownPasteSourceType","CompatibleListType","CompatibleNodeType","CompatibleNumberingListType","CompatiblePasteType","CompatiblePluginEventType","CompatiblePositionType","CompatibleQueryScope","CompatibleRegionType","CompatibleSelectionRangeTypes","CompatibleTableBorderFormat","CompatibleTableOperation","Alignment_1","BulletListType_1","Capitalization_1","require$$2","ChangeSource_1","require$$3","ClearFormatMode_1","require$$4","ColorTransformDirection_1","require$$5","ContentPosition_1","require$$6","ContentType_1","require$$7","DarkModeDatasetNames_1","require$$8","DefinitionType_1","require$$9","DelimiterClasses_1","require$$10","Direction_1","require$$11","DocumentCommand_1","require$$12","DocumentPosition_1","require$$13","EntityClasses_1","require$$14","EntityOperation_1","require$$15","ExperimentalFeatures_1","require$$16","FontSizeChange_1","require$$17","GetContentMode_1","require$$18","ImageEditOperation_1","require$$19","Indentation_1","require$$20","Keys_1","require$$21","KnownAnnounceStrings_1","require$$22","KnownCreateElementDataIndex_1","require$$23","KnownPasteSourceType_1","require$$24","ListType_1","require$$25","NodeType_1","require$$26","NumberingListType_1","require$$27","PasteType_1","require$$28","PluginEventType_1","require$$29","PositionType_1","require$$30","QueryScope_1","require$$31","RegionType_1","require$$32","SelectionRangeTypes_1","require$$33","TableBorderFormat_1","require$$34","TableOperation_1","require$$35","_interface","styleInject","insertAt","tslib_1","isObject","merge","sources","EditorDefaultOptions","shortcut","serverEndpoint","maxHeight","ENEI_EDITOR_MODE_CLASS","ENEI_EDITOR_TARGET_CLASS","storage","sessionStorage","EneiEditor","editorContainer","overlay","toolbar","originalContent","addEvents","restoreBlocks","createEditor","createOverlay","add","openEditor","forElement","prop","linkDialog","innerHeight","updateEditorHeight","scrollHeight","updateButtonState","editorState","setButtonState","ev","addEvent","btn","fun","closeEditor","saveEditor","toggle","wrapped","heading","setHeadingLevel","showModal","close","returnValue","fileInput","click","commitBlock","keySeq","console","log","switchMode","clickHandler","inEditMode","res","fetch","method","headers","ok","alert","json","saveBlock","saveBlocks","setItem","getItem","restoreBlock"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,358,359,360,361]}